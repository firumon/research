const fE=function(){const e=document.createElement("link").relList;return e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}(),Id={},mE="/",wr=function(e,n){return!n||n.length===0?e():Promise.all(n.map(r=>{if(r=`${mE}${r}`,r in Id)return;Id[r]=!0;const s=r.endsWith(".css"),i=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${i}`))return;const o=document.createElement("link");if(o.rel=s?"stylesheet":fE,s||(o.as="script",o.crossOrigin=""),o.href=r,document.head.appendChild(o),s)return new Promise((a,c)=>{o.addEventListener("load",a),o.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>e())};function Rl(t,e){const n=Object.create(null),r=t.split(",");for(let s=0;s<r.length;s++)n[r[s]]=!0;return e?s=>!!n[s.toLowerCase()]:s=>!!n[s]}const Se={},ss=[],jt=()=>{},pE=()=>!1,gE=/^on[^a-z]/,qa=t=>gE.test(t),Pl=t=>t.startsWith("onUpdate:"),Ke=Object.assign,Sl=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},_E=Object.prototype.hasOwnProperty,me=(t,e)=>_E.call(t,e),Z=Array.isArray,is=t=>$a(t)==="[object Map]",op=t=>$a(t)==="[object Set]",ie=t=>typeof t=="function",Ge=t=>typeof t=="string",Cl=t=>typeof t=="symbol",De=t=>t!==null&&typeof t=="object",ap=t=>De(t)&&ie(t.then)&&ie(t.catch),cp=Object.prototype.toString,$a=t=>cp.call(t),yE=t=>$a(t).slice(8,-1),up=t=>$a(t)==="[object Object]",xl=t=>Ge(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Yo=Rl(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ja=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},vE=/-(\w)/g,cn=ja(t=>t.replace(vE,(e,n)=>n?n.toUpperCase():"")),EE=/\B([A-Z])/g,Ds=ja(t=>t.replace(EE,"-$1").toLowerCase()),za=ja(t=>t.charAt(0).toUpperCase()+t.slice(1)),$c=ja(t=>t?`on${za(t)}`:""),Pi=(t,e)=>!Object.is(t,e),jc=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},la=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},IE=t=>{const e=parseFloat(t);return isNaN(e)?t:e},wE=t=>{const e=Ge(t)?Number(t):NaN;return isNaN(e)?t:e};let wd;const Iu=()=>wd||(wd=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});function Vl(t){if(Z(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],s=Ge(r)?RE(r):Vl(r);if(s)for(const i in s)e[i]=s[i]}return e}else{if(Ge(t))return t;if(De(t))return t}}const TE=/;(?![^(]*\))/g,AE=/:([^]+)/,bE=/\/\*[^]*?\*\//g;function RE(t){const e={};return t.replace(bE,"").split(TE).forEach(n=>{if(n){const r=n.split(AE);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function Dl(t){let e="";if(Ge(t))e=t;else if(Z(t))for(let n=0;n<t.length;n++){const r=Dl(t[n]);r&&(e+=r+" ")}else if(De(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const PE="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",SE=Rl(PE);function lp(t){return!!t||t===""}const tV=t=>Ge(t)?t:t==null?"":Z(t)||De(t)&&(t.toString===cp||!ie(t.toString))?JSON.stringify(t,hp,2):String(t),hp=(t,e)=>e&&e.__v_isRef?hp(t,e.value):is(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[r,s])=>(n[`${r} =>`]=s,n),{})}:op(e)?{[`Set(${e.size})`]:[...e.values()]}:De(e)&&!Z(e)&&!up(e)?String(e):e;let St;class dp{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=St,!e&&St&&(this.index=(St.scopes||(St.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const n=St;try{return St=this,e()}finally{St=n}}}on(){St=this}off(){St=this.parent}stop(e){if(this._active){let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.scopes)for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function fp(t){return new dp(t)}function CE(t,e=St){e&&e.active&&e.effects.push(t)}function mp(){return St}function xE(t){St&&St.cleanups.push(t)}const kl=t=>{const e=new Set(t);return e.w=0,e.n=0,e},pp=t=>(t.w&jn)>0,gp=t=>(t.n&jn)>0,VE=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=jn},DE=t=>{const{deps:e}=t;if(e.length){let n=0;for(let r=0;r<e.length;r++){const s=e[r];pp(s)&&!gp(s)?s.delete(t):e[n++]=s,s.w&=~jn,s.n&=~jn}e.length=n}},ha=new WeakMap;let ai=0,jn=1;const wu=30;let Ut;const Rr=Symbol(""),Tu=Symbol("");class Nl{constructor(e,n=null,r){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,CE(this,r)}run(){if(!this.active)return this.fn();let e=Ut,n=Ln;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=Ut,Ut=this,Ln=!0,jn=1<<++ai,ai<=wu?VE(this):Td(this),this.fn()}finally{ai<=wu&&DE(this),jn=1<<--ai,Ut=this.parent,Ln=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Ut===this?this.deferStop=!0:this.active&&(Td(this),this.onStop&&this.onStop(),this.active=!1)}}function Td(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let Ln=!0;const _p=[];function ks(){_p.push(Ln),Ln=!1}function Ns(){const t=_p.pop();Ln=t===void 0?!0:t}function Rt(t,e,n){if(Ln&&Ut){let r=ha.get(t);r||ha.set(t,r=new Map);let s=r.get(n);s||r.set(n,s=kl()),yp(s)}}function yp(t,e){let n=!1;ai<=wu?gp(t)||(t.n|=jn,n=!pp(t)):n=!t.has(Ut),n&&(t.add(Ut),Ut.deps.push(t))}function pn(t,e,n,r,s,i){const o=ha.get(t);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(n==="length"&&Z(t)){const c=Number(r);o.forEach((u,l)=>{(l==="length"||l>=c)&&a.push(u)})}else switch(n!==void 0&&a.push(o.get(n)),e){case"add":Z(t)?xl(n)&&a.push(o.get("length")):(a.push(o.get(Rr)),is(t)&&a.push(o.get(Tu)));break;case"delete":Z(t)||(a.push(o.get(Rr)),is(t)&&a.push(o.get(Tu)));break;case"set":is(t)&&a.push(o.get(Rr));break}if(a.length===1)a[0]&&Au(a[0]);else{const c=[];for(const u of a)u&&c.push(...u);Au(kl(c))}}function Au(t,e){const n=Z(t)?t:[...t];for(const r of n)r.computed&&Ad(r);for(const r of n)r.computed||Ad(r)}function Ad(t,e){(t!==Ut||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}function kE(t,e){var n;return(n=ha.get(t))==null?void 0:n.get(e)}const NE=Rl("__proto__,__v_isRef,__isVue"),vp=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Cl)),OE=Ol(),ME=Ol(!1,!0),FE=Ol(!0),bd=LE();function LE(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const r=fe(this);for(let i=0,o=this.length;i<o;i++)Rt(r,"get",i+"");const s=r[e](...n);return s===-1||s===!1?r[e](...n.map(fe)):s}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){ks();const r=fe(this)[e].apply(this,n);return Ns(),r}}),t}function BE(t){const e=fe(this);return Rt(e,"has",t),e.hasOwnProperty(t)}function Ol(t=!1,e=!1){return function(r,s,i){if(s==="__v_isReactive")return!t;if(s==="__v_isReadonly")return t;if(s==="__v_isShallow")return e;if(s==="__v_raw"&&i===(t?e?tI:Ap:e?Tp:wp).get(r))return r;const o=Z(r);if(!t){if(o&&me(bd,s))return Reflect.get(bd,s,i);if(s==="hasOwnProperty")return BE}const a=Reflect.get(r,s,i);return(Cl(s)?vp.has(s):NE(s))||(t||Rt(r,"get",s),e)?a:Ue(a)?o&&xl(s)?a:a.value:De(a)?t?Rp(a):qr(a):a}}const UE=Ep(),qE=Ep(!0);function Ep(t=!1){return function(n,r,s,i){let o=n[r];if(fs(o)&&Ue(o)&&!Ue(s))return!1;if(!t&&(!da(s)&&!fs(s)&&(o=fe(o),s=fe(s)),!Z(n)&&Ue(o)&&!Ue(s)))return o.value=s,!0;const a=Z(n)&&xl(r)?Number(r)<n.length:me(n,r),c=Reflect.set(n,r,s,i);return n===fe(i)&&(a?Pi(s,o)&&pn(n,"set",r,s):pn(n,"add",r,s)),c}}function $E(t,e){const n=me(t,e);t[e];const r=Reflect.deleteProperty(t,e);return r&&n&&pn(t,"delete",e,void 0),r}function jE(t,e){const n=Reflect.has(t,e);return(!Cl(e)||!vp.has(e))&&Rt(t,"has",e),n}function zE(t){return Rt(t,"iterate",Z(t)?"length":Rr),Reflect.ownKeys(t)}const Ip={get:OE,set:UE,deleteProperty:$E,has:jE,ownKeys:zE},KE={get:FE,set(t,e){return!0},deleteProperty(t,e){return!0}},GE=Ke({},Ip,{get:ME,set:qE}),Ml=t=>t,Ka=t=>Reflect.getPrototypeOf(t);function ko(t,e,n=!1,r=!1){t=t.__v_raw;const s=fe(t),i=fe(e);n||(e!==i&&Rt(s,"get",e),Rt(s,"get",i));const{has:o}=Ka(s),a=r?Ml:n?Bl:Si;if(o.call(s,e))return a(t.get(e));if(o.call(s,i))return a(t.get(i));t!==s&&t.get(e)}function No(t,e=!1){const n=this.__v_raw,r=fe(n),s=fe(t);return e||(t!==s&&Rt(r,"has",t),Rt(r,"has",s)),t===s?n.has(t):n.has(t)||n.has(s)}function Oo(t,e=!1){return t=t.__v_raw,!e&&Rt(fe(t),"iterate",Rr),Reflect.get(t,"size",t)}function Rd(t){t=fe(t);const e=fe(this);return Ka(e).has.call(e,t)||(e.add(t),pn(e,"add",t,t)),this}function Pd(t,e){e=fe(e);const n=fe(this),{has:r,get:s}=Ka(n);let i=r.call(n,t);i||(t=fe(t),i=r.call(n,t));const o=s.call(n,t);return n.set(t,e),i?Pi(e,o)&&pn(n,"set",t,e):pn(n,"add",t,e),this}function Sd(t){const e=fe(this),{has:n,get:r}=Ka(e);let s=n.call(e,t);s||(t=fe(t),s=n.call(e,t)),r&&r.call(e,t);const i=e.delete(t);return s&&pn(e,"delete",t,void 0),i}function Cd(){const t=fe(this),e=t.size!==0,n=t.clear();return e&&pn(t,"clear",void 0,void 0),n}function Mo(t,e){return function(r,s){const i=this,o=i.__v_raw,a=fe(o),c=e?Ml:t?Bl:Si;return!t&&Rt(a,"iterate",Rr),o.forEach((u,l)=>r.call(s,c(u),c(l),i))}}function Fo(t,e,n){return function(...r){const s=this.__v_raw,i=fe(s),o=is(i),a=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,u=s[t](...r),l=n?Ml:e?Bl:Si;return!e&&Rt(i,"iterate",c?Tu:Rr),{next(){const{value:h,done:d}=u.next();return d?{value:h,done:d}:{value:a?[l(h[0]),l(h[1])]:l(h),done:d}},[Symbol.iterator](){return this}}}}function An(t){return function(...e){return t==="delete"?!1:this}}function HE(){const t={get(i){return ko(this,i)},get size(){return Oo(this)},has:No,add:Rd,set:Pd,delete:Sd,clear:Cd,forEach:Mo(!1,!1)},e={get(i){return ko(this,i,!1,!0)},get size(){return Oo(this)},has:No,add:Rd,set:Pd,delete:Sd,clear:Cd,forEach:Mo(!1,!0)},n={get(i){return ko(this,i,!0)},get size(){return Oo(this,!0)},has(i){return No.call(this,i,!0)},add:An("add"),set:An("set"),delete:An("delete"),clear:An("clear"),forEach:Mo(!0,!1)},r={get(i){return ko(this,i,!0,!0)},get size(){return Oo(this,!0)},has(i){return No.call(this,i,!0)},add:An("add"),set:An("set"),delete:An("delete"),clear:An("clear"),forEach:Mo(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=Fo(i,!1,!1),n[i]=Fo(i,!0,!1),e[i]=Fo(i,!1,!0),r[i]=Fo(i,!0,!0)}),[t,n,e,r]}const[QE,WE,JE,YE]=HE();function Fl(t,e){const n=e?t?YE:JE:t?WE:QE;return(r,s,i)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?r:Reflect.get(me(n,s)&&s in r?n:r,s,i)}const XE={get:Fl(!1,!1)},ZE={get:Fl(!1,!0)},eI={get:Fl(!0,!1)},wp=new WeakMap,Tp=new WeakMap,Ap=new WeakMap,tI=new WeakMap;function nI(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function rI(t){return t.__v_skip||!Object.isExtensible(t)?0:nI(yE(t))}function qr(t){return fs(t)?t:Ll(t,!1,Ip,XE,wp)}function bp(t){return Ll(t,!1,GE,ZE,Tp)}function Rp(t){return Ll(t,!0,KE,eI,Ap)}function Ll(t,e,n,r,s){if(!De(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=s.get(t);if(i)return i;const o=rI(t);if(o===0)return t;const a=new Proxy(t,o===2?r:n);return s.set(t,a),a}function Bn(t){return fs(t)?Bn(t.__v_raw):!!(t&&t.__v_isReactive)}function fs(t){return!!(t&&t.__v_isReadonly)}function da(t){return!!(t&&t.__v_isShallow)}function Pp(t){return Bn(t)||fs(t)}function fe(t){const e=t&&t.__v_raw;return e?fe(e):t}function ao(t){return la(t,"__v_skip",!0),t}const Si=t=>De(t)?qr(t):t,Bl=t=>De(t)?Rp(t):t;function Sp(t){Ln&&Ut&&(t=fe(t),yp(t.dep||(t.dep=kl())))}function Cp(t,e){t=fe(t);const n=t.dep;n&&Au(n)}function Ue(t){return!!(t&&t.__v_isRef===!0)}function Ga(t){return xp(t,!1)}function sI(t){return xp(t,!0)}function xp(t,e){return Ue(t)?t:new iI(t,e)}class iI{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:fe(e),this._value=n?e:Si(e)}get value(){return Sp(this),this._value}set value(e){const n=this.__v_isShallow||da(e)||fs(e);e=n?e:fe(e),Pi(e,this._rawValue)&&(this._rawValue=e,this._value=n?e:Si(e),Cp(this))}}function os(t){return Ue(t)?t.value:t}const oI={get:(t,e,n)=>os(Reflect.get(t,e,n)),set:(t,e,n,r)=>{const s=t[e];return Ue(s)&&!Ue(n)?(s.value=n,!0):Reflect.set(t,e,n,r)}};function Vp(t){return Bn(t)?t:new Proxy(t,oI)}function aI(t){const e=Z(t)?new Array(t.length):{};for(const n in t)e[n]=uI(t,n);return e}class cI{constructor(e,n,r){this._object=e,this._key=n,this._defaultValue=r,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return kE(fe(this._object),this._key)}}function uI(t,e,n){const r=t[e];return Ue(r)?r:new cI(t,e,n)}class lI{constructor(e,n,r,s){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new Nl(e,()=>{this._dirty||(this._dirty=!0,Cp(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=r}get value(){const e=fe(this);return Sp(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function hI(t,e,n=!1){let r,s;const i=ie(t);return i?(r=t,s=jt):(r=t.get,s=t.set),new lI(r,s,i||!s,n)}function Un(t,e,n,r){let s;try{s=r?t(...r):t()}catch(i){Ha(i,e,n)}return s}function Mt(t,e,n,r){if(ie(t)){const i=Un(t,e,n,r);return i&&ap(i)&&i.catch(o=>{Ha(o,e,n)}),i}const s=[];for(let i=0;i<t.length;i++)s.push(Mt(t[i],e,n,r));return s}function Ha(t,e,n,r=!0){const s=e?e.vnode:null;if(e){let i=e.parent;const o=e.proxy,a=n;for(;i;){const u=i.ec;if(u){for(let l=0;l<u.length;l++)if(u[l](t,o,a)===!1)return}i=i.parent}const c=e.appContext.config.errorHandler;if(c){Un(c,null,10,[t,o,a]);return}}dI(t,n,s,r)}function dI(t,e,n,r=!0){console.error(t)}let Ci=!1,bu=!1;const dt=[];let Zt=0;const as=[];let dn=null,pr=0;const Dp=Promise.resolve();let Ul=null;function ql(t){const e=Ul||Dp;return t?e.then(this?t.bind(this):t):e}function fI(t){let e=Zt+1,n=dt.length;for(;e<n;){const r=e+n>>>1;xi(dt[r])<t?e=r+1:n=r}return e}function $l(t){(!dt.length||!dt.includes(t,Ci&&t.allowRecurse?Zt+1:Zt))&&(t.id==null?dt.push(t):dt.splice(fI(t.id),0,t),kp())}function kp(){!Ci&&!bu&&(bu=!0,Ul=Dp.then(Op))}function mI(t){const e=dt.indexOf(t);e>Zt&&dt.splice(e,1)}function pI(t){Z(t)?as.push(...t):(!dn||!dn.includes(t,t.allowRecurse?pr+1:pr))&&as.push(t),kp()}function xd(t,e=Ci?Zt+1:0){for(;e<dt.length;e++){const n=dt[e];n&&n.pre&&(dt.splice(e,1),e--,n())}}function Np(t){if(as.length){const e=[...new Set(as)];if(as.length=0,dn){dn.push(...e);return}for(dn=e,dn.sort((n,r)=>xi(n)-xi(r)),pr=0;pr<dn.length;pr++)dn[pr]();dn=null,pr=0}}const xi=t=>t.id==null?1/0:t.id,gI=(t,e)=>{const n=xi(t)-xi(e);if(n===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return n};function Op(t){bu=!1,Ci=!0,dt.sort(gI);const e=jt;try{for(Zt=0;Zt<dt.length;Zt++){const n=dt[Zt];n&&n.active!==!1&&Un(n,null,14)}}finally{Zt=0,dt.length=0,Np(),Ci=!1,Ul=null,(dt.length||as.length)&&Op()}}function _I(t,e,...n){if(t.isUnmounted)return;const r=t.vnode.props||Se;let s=n;const i=e.startsWith("update:"),o=i&&e.slice(7);if(o&&o in r){const l=`${o==="modelValue"?"model":o}Modifiers`,{number:h,trim:d}=r[l]||Se;d&&(s=n.map(f=>Ge(f)?f.trim():f)),h&&(s=n.map(IE))}let a,c=r[a=$c(e)]||r[a=$c(cn(e))];!c&&i&&(c=r[a=$c(Ds(e))]),c&&Mt(c,t,6,s);const u=r[a+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Mt(u,t,6,s)}}function Mp(t,e,n=!1){const r=e.emitsCache,s=r.get(t);if(s!==void 0)return s;const i=t.emits;let o={},a=!1;if(!ie(t)){const c=u=>{const l=Mp(u,e,!0);l&&(a=!0,Ke(o,l))};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!i&&!a?(De(t)&&r.set(t,null),null):(Z(i)?i.forEach(c=>o[c]=null):Ke(o,i),De(t)&&r.set(t,o),o)}function Qa(t,e){return!t||!qa(e)?!1:(e=e.slice(2).replace(/Once$/,""),me(t,e[0].toLowerCase()+e.slice(1))||me(t,Ds(e))||me(t,e))}let wt=null,Fp=null;function fa(t){const e=wt;return wt=t,Fp=t&&t.type.__scopeId||null,e}function yI(t,e=wt,n){if(!e||t._n)return t;const r=(...s)=>{r._d&&$d(-1);const i=fa(e);let o;try{o=t(...s)}finally{fa(i),r._d&&$d(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function zc(t){const{type:e,vnode:n,proxy:r,withProxy:s,props:i,propsOptions:[o],slots:a,attrs:c,emit:u,render:l,renderCache:h,data:d,setupState:f,ctx:g,inheritAttrs:v}=t;let I,A;const R=fa(t);try{if(n.shapeFlag&4){const D=s||r;I=Xt(l.call(D,D,h,i,f,d,g)),A=c}else{const D=e;I=Xt(D.length>1?D(i,{attrs:c,slots:a,emit:u}):D(i,null)),A=e.props?c:vI(c)}}catch(D){gi.length=0,Ha(D,t,1),I=Ct(zt)}let V=I;if(A&&v!==!1){const D=Object.keys(A),{shapeFlag:j}=V;D.length&&j&7&&(o&&D.some(Pl)&&(A=EI(A,o)),V=zn(V,A))}return n.dirs&&(V=zn(V),V.dirs=V.dirs?V.dirs.concat(n.dirs):n.dirs),n.transition&&(V.transition=n.transition),I=V,fa(R),I}const vI=t=>{let e;for(const n in t)(n==="class"||n==="style"||qa(n))&&((e||(e={}))[n]=t[n]);return e},EI=(t,e)=>{const n={};for(const r in t)(!Pl(r)||!(r.slice(9)in e))&&(n[r]=t[r]);return n};function II(t,e,n){const{props:r,children:s,component:i}=t,{props:o,children:a,patchFlag:c}=e,u=i.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return r?Vd(r,o,u):!!o;if(c&8){const l=e.dynamicProps;for(let h=0;h<l.length;h++){const d=l[h];if(o[d]!==r[d]&&!Qa(u,d))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?Vd(r,o,u):!0:!!o;return!1}function Vd(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(e[i]!==t[i]&&!Qa(n,i))return!0}return!1}function wI({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const TI=t=>t.__isSuspense;function AI(t,e){e&&e.pendingBranch?Z(t)?e.effects.push(...t):e.effects.push(t):pI(t)}const Lo={};function mi(t,e,n){return Lp(t,e,n)}function Lp(t,e,{immediate:n,deep:r,flush:s,onTrack:i,onTrigger:o}=Se){var a;const c=mp()===((a=Qe)==null?void 0:a.scope)?Qe:null;let u,l=!1,h=!1;if(Ue(t)?(u=()=>t.value,l=da(t)):Bn(t)?(u=()=>t,r=!0):Z(t)?(h=!0,l=t.some(D=>Bn(D)||da(D)),u=()=>t.map(D=>{if(Ue(D))return D.value;if(Bn(D))return Tr(D);if(ie(D))return Un(D,c,2)})):ie(t)?e?u=()=>Un(t,c,2):u=()=>{if(!(c&&c.isUnmounted))return d&&d(),Mt(t,c,3,[f])}:u=jt,e&&r){const D=u;u=()=>Tr(D())}let d,f=D=>{d=R.onStop=()=>{Un(D,c,4)}},g;if(ki)if(f=jt,e?n&&Mt(e,c,3,[u(),h?[]:void 0,f]):u(),s==="sync"){const D=ww();g=D.__watcherHandles||(D.__watcherHandles=[])}else return jt;let v=h?new Array(t.length).fill(Lo):Lo;const I=()=>{if(!!R.active)if(e){const D=R.run();(r||l||(h?D.some((j,X)=>Pi(j,v[X])):Pi(D,v)))&&(d&&d(),Mt(e,c,3,[D,v===Lo?void 0:h&&v[0]===Lo?[]:v,f]),v=D)}else R.run()};I.allowRecurse=!!e;let A;s==="sync"?A=I:s==="post"?A=()=>It(I,c&&c.suspense):(I.pre=!0,c&&(I.id=c.uid),A=()=>$l(I));const R=new Nl(u,A);e?n?I():v=R.run():s==="post"?It(R.run.bind(R),c&&c.suspense):R.run();const V=()=>{R.stop(),c&&c.scope&&Sl(c.scope.effects,R)};return g&&g.push(V),V}function bI(t,e,n){const r=this.proxy,s=Ge(t)?t.includes(".")?Bp(r,t):()=>r[t]:t.bind(r,r);let i;ie(e)?i=e:(i=e.handler,n=e);const o=Qe;ms(this);const a=Lp(s,i.bind(r),n);return o?ms(o):Pr(),a}function Bp(t,e){const n=e.split(".");return()=>{let r=t;for(let s=0;s<n.length&&r;s++)r=r[n[s]];return r}}function Tr(t,e){if(!De(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),Ue(t))Tr(t.value,e);else if(Z(t))for(let n=0;n<t.length;n++)Tr(t[n],e);else if(op(t)||is(t))t.forEach(n=>{Tr(n,e)});else if(up(t))for(const n in t)Tr(t[n],e);return t}function nV(t,e){const n=wt;if(n===null)return t;const r=Za(n)||n.proxy,s=t.dirs||(t.dirs=[]);for(let i=0;i<e.length;i++){let[o,a,c,u=Se]=e[i];o&&(ie(o)&&(o={mounted:o,updated:o}),o.deep&&Tr(a),s.push({dir:o,instance:r,value:a,oldValue:void 0,arg:c,modifiers:u}))}return t}function cr(t,e,n,r){const s=t.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let c=a.dir[r];c&&(ks(),Mt(c,n,8,[t.el,a,t,e]),Ns())}}function RI(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return zp(()=>{t.isMounted=!0}),Kp(()=>{t.isUnmounting=!0}),t}const Dt=[Function,Array],Up={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Dt,onEnter:Dt,onAfterEnter:Dt,onEnterCancelled:Dt,onBeforeLeave:Dt,onLeave:Dt,onAfterLeave:Dt,onLeaveCancelled:Dt,onBeforeAppear:Dt,onAppear:Dt,onAfterAppear:Dt,onAppearCancelled:Dt},PI={name:"BaseTransition",props:Up,setup(t,{slots:e}){const n=mw(),r=RI();let s;return()=>{const i=e.default&&$p(e.default(),!0);if(!i||!i.length)return;let o=i[0];if(i.length>1){for(const v of i)if(v.type!==zt){o=v;break}}const a=fe(t),{mode:c}=a;if(r.isLeaving)return Kc(o);const u=Dd(o);if(!u)return Kc(o);const l=Ru(u,a,r,n);Pu(u,l);const h=n.subTree,d=h&&Dd(h);let f=!1;const{getTransitionKey:g}=u.type;if(g){const v=g();s===void 0?s=v:v!==s&&(s=v,f=!0)}if(d&&d.type!==zt&&(!gr(u,d)||f)){const v=Ru(d,a,r,n);if(Pu(d,v),c==="out-in")return r.isLeaving=!0,v.afterLeave=()=>{r.isLeaving=!1,n.update.active!==!1&&n.update()},Kc(o);c==="in-out"&&u.type!==zt&&(v.delayLeave=(I,A,R)=>{const V=qp(r,d);V[String(d.key)]=d,I._leaveCb=()=>{A(),I._leaveCb=void 0,delete l.delayedLeave},l.delayedLeave=R})}return o}}},SI=PI;function qp(t,e){const{leavingVNodes:n}=t;let r=n.get(e.type);return r||(r=Object.create(null),n.set(e.type,r)),r}function Ru(t,e,n,r){const{appear:s,mode:i,persisted:o=!1,onBeforeEnter:a,onEnter:c,onAfterEnter:u,onEnterCancelled:l,onBeforeLeave:h,onLeave:d,onAfterLeave:f,onLeaveCancelled:g,onBeforeAppear:v,onAppear:I,onAfterAppear:A,onAppearCancelled:R}=e,V=String(t.key),D=qp(n,t),j=(B,W)=>{B&&Mt(B,r,9,W)},X=(B,W)=>{const re=W[1];j(B,W),Z(B)?B.every(Te=>Te.length<=1)&&re():B.length<=1&&re()},oe={mode:i,persisted:o,beforeEnter(B){let W=a;if(!n.isMounted)if(s)W=v||a;else return;B._leaveCb&&B._leaveCb(!0);const re=D[V];re&&gr(t,re)&&re.el._leaveCb&&re.el._leaveCb(),j(W,[B])},enter(B){let W=c,re=u,Te=l;if(!n.isMounted)if(s)W=I||c,re=A||u,Te=R||l;else return;let z=!1;const pe=B._enterCb=rt=>{z||(z=!0,rt?j(Te,[B]):j(re,[B]),oe.delayedLeave&&oe.delayedLeave(),B._enterCb=void 0)};W?X(W,[B,pe]):pe()},leave(B,W){const re=String(t.key);if(B._enterCb&&B._enterCb(!0),n.isUnmounting)return W();j(h,[B]);let Te=!1;const z=B._leaveCb=pe=>{Te||(Te=!0,W(),pe?j(g,[B]):j(f,[B]),B._leaveCb=void 0,D[re]===t&&delete D[re])};D[re]=t,d?X(d,[B,z]):z()},clone(B){return Ru(B,e,n,r)}};return oe}function Kc(t){if(Wa(t))return t=zn(t),t.children=null,t}function Dd(t){return Wa(t)?t.children?t.children[0]:void 0:t}function Pu(t,e){t.shapeFlag&6&&t.component?Pu(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function $p(t,e=!1,n){let r=[],s=0;for(let i=0;i<t.length;i++){let o=t[i];const a=n==null?o.key:String(n)+String(o.key!=null?o.key:i);o.type===Yt?(o.patchFlag&128&&s++,r=r.concat($p(o.children,e,a))):(e||o.type!==zt)&&r.push(a!=null?zn(o,{key:a}):o)}if(s>1)for(let i=0;i<r.length;i++)r[i].patchFlag=-2;return r}function jl(t,e){return ie(t)?(()=>Ke({name:t.name},e,{setup:t}))():t}const Xo=t=>!!t.type.__asyncLoader,Wa=t=>t.type.__isKeepAlive;function CI(t,e){jp(t,"a",e)}function xI(t,e){jp(t,"da",e)}function jp(t,e,n=Qe){const r=t.__wdc||(t.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(Ja(e,r,n),n){let s=n.parent;for(;s&&s.parent;)Wa(s.parent.vnode)&&VI(r,e,n,s),s=s.parent}}function VI(t,e,n,r){const s=Ja(e,t,r,!0);Gp(()=>{Sl(r[e],s)},n)}function Ja(t,e,n=Qe,r=!1){if(n){const s=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...o)=>{if(n.isUnmounted)return;ks(),ms(n);const a=Mt(e,n,t,o);return Pr(),Ns(),a});return r?s.unshift(i):s.push(i),i}}const yn=t=>(e,n=Qe)=>(!ki||t==="sp")&&Ja(t,(...r)=>e(...r),n),DI=yn("bm"),zp=yn("m"),kI=yn("bu"),NI=yn("u"),Kp=yn("bum"),Gp=yn("um"),OI=yn("sp"),MI=yn("rtg"),FI=yn("rtc");function LI(t,e=Qe){Ja("ec",t,e)}const Hp="components";function BI(t,e){return qI(Hp,t,!0,e)||t}const UI=Symbol.for("v-ndc");function qI(t,e,n=!0,r=!1){const s=wt||Qe;if(s){const i=s.type;if(t===Hp){const a=vw(i,!1);if(a&&(a===e||a===cn(e)||a===za(cn(e))))return i}const o=kd(s[t]||i[t],e)||kd(s.appContext[t],e);return!o&&r?i:o}}function kd(t,e){return t&&(t[e]||t[cn(e)]||t[za(cn(e))])}function rV(t,e,n,r){let s;const i=n&&n[r];if(Z(t)||Ge(t)){s=new Array(t.length);for(let o=0,a=t.length;o<a;o++)s[o]=e(t[o],o,void 0,i&&i[o])}else if(typeof t=="number"){s=new Array(t);for(let o=0;o<t;o++)s[o]=e(o+1,o,void 0,i&&i[o])}else if(De(t))if(t[Symbol.iterator])s=Array.from(t,(o,a)=>e(o,a,void 0,i&&i[a]));else{const o=Object.keys(t);s=new Array(o.length);for(let a=0,c=o.length;a<c;a++){const u=o[a];s[a]=e(t[u],u,a,i&&i[a])}}else s=[];return n&&(n[r]=s),s}const Su=t=>t?ag(t)?Za(t)||t.proxy:Su(t.parent):null,pi=Ke(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Su(t.parent),$root:t=>Su(t.root),$emit:t=>t.emit,$options:t=>zl(t),$forceUpdate:t=>t.f||(t.f=()=>$l(t.update)),$nextTick:t=>t.n||(t.n=ql.bind(t.proxy)),$watch:t=>bI.bind(t)}),Gc=(t,e)=>t!==Se&&!t.__isScriptSetup&&me(t,e),$I={get({_:t},e){const{ctx:n,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:c}=t;let u;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return r[e];case 2:return s[e];case 4:return n[e];case 3:return i[e]}else{if(Gc(r,e))return o[e]=1,r[e];if(s!==Se&&me(s,e))return o[e]=2,s[e];if((u=t.propsOptions[0])&&me(u,e))return o[e]=3,i[e];if(n!==Se&&me(n,e))return o[e]=4,n[e];Cu&&(o[e]=0)}}const l=pi[e];let h,d;if(l)return e==="$attrs"&&Rt(t,"get",e),l(t);if((h=a.__cssModules)&&(h=h[e]))return h;if(n!==Se&&me(n,e))return o[e]=4,n[e];if(d=c.config.globalProperties,me(d,e))return d[e]},set({_:t},e,n){const{data:r,setupState:s,ctx:i}=t;return Gc(s,e)?(s[e]=n,!0):r!==Se&&me(r,e)?(r[e]=n,!0):me(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:s,propsOptions:i}},o){let a;return!!n[o]||t!==Se&&me(t,o)||Gc(e,o)||(a=i[0])&&me(a,o)||me(r,o)||me(pi,o)||me(s.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:me(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function Nd(t){return Z(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let Cu=!0;function jI(t){const e=zl(t),n=t.proxy,r=t.ctx;Cu=!1,e.beforeCreate&&Od(e.beforeCreate,t,"bc");const{data:s,computed:i,methods:o,watch:a,provide:c,inject:u,created:l,beforeMount:h,mounted:d,beforeUpdate:f,updated:g,activated:v,deactivated:I,beforeDestroy:A,beforeUnmount:R,destroyed:V,unmounted:D,render:j,renderTracked:X,renderTriggered:oe,errorCaptured:B,serverPrefetch:W,expose:re,inheritAttrs:Te,components:z,directives:pe,filters:rt}=e;if(u&&zI(u,r,null),o)for(const Ae in o){const _e=o[Ae];ie(_e)&&(r[Ae]=_e.bind(n))}if(s){const Ae=s.call(n,n);De(Ae)&&(t.data=qr(Ae))}if(Cu=!0,i)for(const Ae in i){const _e=i[Ae],ln=ie(_e)?_e.bind(n,n):ie(_e.get)?_e.get.bind(n,n):jt,Tn=!ie(_e)&&ie(_e.set)?_e.set.bind(n):jt,Qt=kt({get:ln,set:Tn});Object.defineProperty(r,Ae,{enumerable:!0,configurable:!0,get:()=>Qt.value,set:Et=>Qt.value=Et})}if(a)for(const Ae in a)Qp(a[Ae],r,n,Ae);if(c){const Ae=ie(c)?c.call(n):c;Reflect.ownKeys(Ae).forEach(_e=>{Zo(_e,Ae[_e])})}l&&Od(l,t,"c");function le(Ae,_e){Z(_e)?_e.forEach(ln=>Ae(ln.bind(n))):_e&&Ae(_e.bind(n))}if(le(DI,h),le(zp,d),le(kI,f),le(NI,g),le(CI,v),le(xI,I),le(LI,B),le(FI,X),le(MI,oe),le(Kp,R),le(Gp,D),le(OI,W),Z(re))if(re.length){const Ae=t.exposed||(t.exposed={});re.forEach(_e=>{Object.defineProperty(Ae,_e,{get:()=>n[_e],set:ln=>n[_e]=ln})})}else t.exposed||(t.exposed={});j&&t.render===jt&&(t.render=j),Te!=null&&(t.inheritAttrs=Te),z&&(t.components=z),pe&&(t.directives=pe)}function zI(t,e,n=jt){Z(t)&&(t=xu(t));for(const r in t){const s=t[r];let i;De(s)?"default"in s?i=on(s.from||r,s.default,!0):i=on(s.from||r):i=on(s),Ue(i)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[r]=i}}function Od(t,e,n){Mt(Z(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,n)}function Qp(t,e,n,r){const s=r.includes(".")?Bp(n,r):()=>n[r];if(Ge(t)){const i=e[t];ie(i)&&mi(s,i)}else if(ie(t))mi(s,t.bind(n));else if(De(t))if(Z(t))t.forEach(i=>Qp(i,e,n,r));else{const i=ie(t.handler)?t.handler.bind(n):e[t.handler];ie(i)&&mi(s,i,t)}}function zl(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,a=i.get(e);let c;return a?c=a:!s.length&&!n&&!r?c=e:(c={},s.length&&s.forEach(u=>ma(c,u,o,!0)),ma(c,e,o)),De(e)&&i.set(e,c),c}function ma(t,e,n,r=!1){const{mixins:s,extends:i}=e;i&&ma(t,i,n,!0),s&&s.forEach(o=>ma(t,o,n,!0));for(const o in e)if(!(r&&o==="expose")){const a=KI[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const KI={data:Md,props:Fd,emits:Fd,methods:ci,computed:ci,beforeCreate:_t,created:_t,beforeMount:_t,mounted:_t,beforeUpdate:_t,updated:_t,beforeDestroy:_t,beforeUnmount:_t,destroyed:_t,unmounted:_t,activated:_t,deactivated:_t,errorCaptured:_t,serverPrefetch:_t,components:ci,directives:ci,watch:HI,provide:Md,inject:GI};function Md(t,e){return e?t?function(){return Ke(ie(t)?t.call(this,this):t,ie(e)?e.call(this,this):e)}:e:t}function GI(t,e){return ci(xu(t),xu(e))}function xu(t){if(Z(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function _t(t,e){return t?[...new Set([].concat(t,e))]:e}function ci(t,e){return t?Ke(Object.create(null),t,e):e}function Fd(t,e){return t?Z(t)&&Z(e)?[...new Set([...t,...e])]:Ke(Object.create(null),Nd(t),Nd(e!=null?e:{})):e}function HI(t,e){if(!t)return e;if(!e)return t;const n=Ke(Object.create(null),t);for(const r in e)n[r]=_t(t[r],e[r]);return n}function Wp(){return{app:null,config:{isNativeTag:pE,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let QI=0;function WI(t,e){return function(r,s=null){ie(r)||(r=Ke({},r)),s!=null&&!De(s)&&(s=null);const i=Wp(),o=new Set;let a=!1;const c=i.app={_uid:QI++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:Tw,get config(){return i.config},set config(u){},use(u,...l){return o.has(u)||(u&&ie(u.install)?(o.add(u),u.install(c,...l)):ie(u)&&(o.add(u),u(c,...l))),c},mixin(u){return i.mixins.includes(u)||i.mixins.push(u),c},component(u,l){return l?(i.components[u]=l,c):i.components[u]},directive(u,l){return l?(i.directives[u]=l,c):i.directives[u]},mount(u,l,h){if(!a){const d=Ct(r,s);return d.appContext=i,l&&e?e(d,u):t(d,u,h),a=!0,c._container=u,u.__vue_app__=c,Za(d.component)||d.component.proxy}},unmount(){a&&(t(null,c._container),delete c._container.__vue_app__)},provide(u,l){return i.provides[u]=l,c},runWithContext(u){Vi=c;try{return u()}finally{Vi=null}}};return c}}let Vi=null;function Zo(t,e){if(Qe){let n=Qe.provides;const r=Qe.parent&&Qe.parent.provides;r===n&&(n=Qe.provides=Object.create(r)),n[t]=e}}function on(t,e,n=!1){const r=Qe||wt;if(r||Vi){const s=r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:Vi._context.provides;if(s&&t in s)return s[t];if(arguments.length>1)return n&&ie(e)?e.call(r&&r.proxy):e}}function JI(){return!!(Qe||wt||Vi)}function YI(t,e,n,r=!1){const s={},i={};la(i,Xa,1),t.propsDefaults=Object.create(null),Jp(t,e,s,i);for(const o in t.propsOptions[0])o in s||(s[o]=void 0);n?t.props=r?s:bp(s):t.type.props?t.props=s:t.props=i,t.attrs=i}function XI(t,e,n,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=t,a=fe(s),[c]=t.propsOptions;let u=!1;if((r||o>0)&&!(o&16)){if(o&8){const l=t.vnode.dynamicProps;for(let h=0;h<l.length;h++){let d=l[h];if(Qa(t.emitsOptions,d))continue;const f=e[d];if(c)if(me(i,d))f!==i[d]&&(i[d]=f,u=!0);else{const g=cn(d);s[g]=Vu(c,a,g,f,t,!1)}else f!==i[d]&&(i[d]=f,u=!0)}}}else{Jp(t,e,s,i)&&(u=!0);let l;for(const h in a)(!e||!me(e,h)&&((l=Ds(h))===h||!me(e,l)))&&(c?n&&(n[h]!==void 0||n[l]!==void 0)&&(s[h]=Vu(c,a,h,void 0,t,!0)):delete s[h]);if(i!==a)for(const h in i)(!e||!me(e,h)&&!0)&&(delete i[h],u=!0)}u&&pn(t,"set","$attrs")}function Jp(t,e,n,r){const[s,i]=t.propsOptions;let o=!1,a;if(e)for(let c in e){if(Yo(c))continue;const u=e[c];let l;s&&me(s,l=cn(c))?!i||!i.includes(l)?n[l]=u:(a||(a={}))[l]=u:Qa(t.emitsOptions,c)||(!(c in r)||u!==r[c])&&(r[c]=u,o=!0)}if(i){const c=fe(n),u=a||Se;for(let l=0;l<i.length;l++){const h=i[l];n[h]=Vu(s,c,h,u[h],t,!me(u,h))}}return o}function Vu(t,e,n,r,s,i){const o=t[n];if(o!=null){const a=me(o,"default");if(a&&r===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&ie(c)){const{propsDefaults:u}=s;n in u?r=u[n]:(ms(s),r=u[n]=c.call(null,e),Pr())}else r=c}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===Ds(n))&&(r=!0))}return r}function Yp(t,e,n=!1){const r=e.propsCache,s=r.get(t);if(s)return s;const i=t.props,o={},a=[];let c=!1;if(!ie(t)){const l=h=>{c=!0;const[d,f]=Yp(h,e,!0);Ke(o,d),f&&a.push(...f)};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}if(!i&&!c)return De(t)&&r.set(t,ss),ss;if(Z(i))for(let l=0;l<i.length;l++){const h=cn(i[l]);Ld(h)&&(o[h]=Se)}else if(i)for(const l in i){const h=cn(l);if(Ld(h)){const d=i[l],f=o[h]=Z(d)||ie(d)?{type:d}:Ke({},d);if(f){const g=qd(Boolean,f.type),v=qd(String,f.type);f[0]=g>-1,f[1]=v<0||g<v,(g>-1||me(f,"default"))&&a.push(h)}}}const u=[o,a];return De(t)&&r.set(t,u),u}function Ld(t){return t[0]!=="$"}function Bd(t){const e=t&&t.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:t===null?"null":""}function Ud(t,e){return Bd(t)===Bd(e)}function qd(t,e){return Z(e)?e.findIndex(n=>Ud(n,t)):ie(e)&&Ud(e,t)?0:-1}const Xp=t=>t[0]==="_"||t==="$stable",Kl=t=>Z(t)?t.map(Xt):[Xt(t)],ZI=(t,e,n)=>{if(e._n)return e;const r=yI((...s)=>Kl(e(...s)),n);return r._c=!1,r},Zp=(t,e,n)=>{const r=t._ctx;for(const s in t){if(Xp(s))continue;const i=t[s];if(ie(i))e[s]=ZI(s,i,r);else if(i!=null){const o=Kl(i);e[s]=()=>o}}},eg=(t,e)=>{const n=Kl(e);t.slots.default=()=>n},ew=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=fe(e),la(e,"_",n)):Zp(e,t.slots={})}else t.slots={},e&&eg(t,e);la(t.slots,Xa,1)},tw=(t,e,n)=>{const{vnode:r,slots:s}=t;let i=!0,o=Se;if(r.shapeFlag&32){const a=e._;a?n&&a===1?i=!1:(Ke(s,e),!n&&a===1&&delete s._):(i=!e.$stable,Zp(e,s)),o=e}else e&&(eg(t,e),o={default:1});if(i)for(const a in s)!Xp(a)&&!(a in o)&&delete s[a]};function Du(t,e,n,r,s=!1){if(Z(t)){t.forEach((d,f)=>Du(d,e&&(Z(e)?e[f]:e),n,r,s));return}if(Xo(r)&&!s)return;const i=r.shapeFlag&4?Za(r.component)||r.component.proxy:r.el,o=s?null:i,{i:a,r:c}=t,u=e&&e.r,l=a.refs===Se?a.refs={}:a.refs,h=a.setupState;if(u!=null&&u!==c&&(Ge(u)?(l[u]=null,me(h,u)&&(h[u]=null)):Ue(u)&&(u.value=null)),ie(c))Un(c,a,12,[o,l]);else{const d=Ge(c),f=Ue(c);if(d||f){const g=()=>{if(t.f){const v=d?me(h,c)?h[c]:l[c]:c.value;s?Z(v)&&Sl(v,i):Z(v)?v.includes(i)||v.push(i):d?(l[c]=[i],me(h,c)&&(h[c]=l[c])):(c.value=[i],t.k&&(l[t.k]=c.value))}else d?(l[c]=o,me(h,c)&&(h[c]=o)):f&&(c.value=o,t.k&&(l[t.k]=o))};o?(g.id=-1,It(g,n)):g()}}}const It=AI;function nw(t){return rw(t)}function rw(t,e){const n=Iu();n.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:c,setText:u,setElementText:l,parentNode:h,nextSibling:d,setScopeId:f=jt,insertStaticContent:g}=t,v=(m,p,_,w=null,P=null,C=null,U=!1,k=null,O=!!p.dynamicChildren)=>{if(m===p)return;m&&!gr(m,p)&&(w=T(m),Et(m,P,C,!0),m=null),p.patchFlag===-2&&(O=!1,p.dynamicChildren=null);const{type:x,ref:J,shapeFlag:K}=p;switch(x){case Ya:I(m,p,_,w);break;case zt:A(m,p,_,w);break;case Hc:m==null&&R(p,_,w,U);break;case Yt:z(m,p,_,w,P,C,U,k,O);break;default:K&1?j(m,p,_,w,P,C,U,k,O):K&6?pe(m,p,_,w,P,C,U,k,O):(K&64||K&128)&&x.process(m,p,_,w,P,C,U,k,O,F)}J!=null&&P&&Du(J,m&&m.ref,C,p||m,!p)},I=(m,p,_,w)=>{if(m==null)r(p.el=a(p.children),_,w);else{const P=p.el=m.el;p.children!==m.children&&u(P,p.children)}},A=(m,p,_,w)=>{m==null?r(p.el=c(p.children||""),_,w):p.el=m.el},R=(m,p,_,w)=>{[m.el,m.anchor]=g(m.children,p,_,w,m.el,m.anchor)},V=({el:m,anchor:p},_,w)=>{let P;for(;m&&m!==p;)P=d(m),r(m,_,w),m=P;r(p,_,w)},D=({el:m,anchor:p})=>{let _;for(;m&&m!==p;)_=d(m),s(m),m=_;s(p)},j=(m,p,_,w,P,C,U,k,O)=>{U=U||p.type==="svg",m==null?X(p,_,w,P,C,U,k,O):W(m,p,P,C,U,k,O)},X=(m,p,_,w,P,C,U,k)=>{let O,x;const{type:J,props:K,shapeFlag:Y,transition:ne,dirs:ae}=m;if(O=m.el=o(m.type,C,K&&K.is,K),Y&8?l(O,m.children):Y&16&&B(m.children,O,null,w,P,C&&J!=="foreignObject",U,k),ae&&cr(m,null,w,"created"),oe(O,m,m.scopeId,U,w),K){for(const we in K)we!=="value"&&!Yo(we)&&i(O,we,null,K[we],C,m.children,w,P,ct);"value"in K&&i(O,"value",null,K.value),(x=K.onVnodeBeforeMount)&&Jt(x,w,m)}ae&&cr(m,null,w,"beforeMount");const be=(!P||P&&!P.pendingBranch)&&ne&&!ne.persisted;be&&ne.beforeEnter(O),r(O,p,_),((x=K&&K.onVnodeMounted)||be||ae)&&It(()=>{x&&Jt(x,w,m),be&&ne.enter(O),ae&&cr(m,null,w,"mounted")},P)},oe=(m,p,_,w,P)=>{if(_&&f(m,_),w)for(let C=0;C<w.length;C++)f(m,w[C]);if(P){let C=P.subTree;if(p===C){const U=P.vnode;oe(m,U,U.scopeId,U.slotScopeIds,P.parent)}}},B=(m,p,_,w,P,C,U,k,O=0)=>{for(let x=O;x<m.length;x++){const J=m[x]=k?Vn(m[x]):Xt(m[x]);v(null,J,p,_,w,P,C,U,k)}},W=(m,p,_,w,P,C,U)=>{const k=p.el=m.el;let{patchFlag:O,dynamicChildren:x,dirs:J}=p;O|=m.patchFlag&16;const K=m.props||Se,Y=p.props||Se;let ne;_&&ur(_,!1),(ne=Y.onVnodeBeforeUpdate)&&Jt(ne,_,p,m),J&&cr(p,m,_,"beforeUpdate"),_&&ur(_,!0);const ae=P&&p.type!=="foreignObject";if(x?re(m.dynamicChildren,x,k,_,w,ae,C):U||_e(m,p,k,null,_,w,ae,C,!1),O>0){if(O&16)Te(k,p,K,Y,_,w,P);else if(O&2&&K.class!==Y.class&&i(k,"class",null,Y.class,P),O&4&&i(k,"style",K.style,Y.style,P),O&8){const be=p.dynamicProps;for(let we=0;we<be.length;we++){const je=be[we],Lt=K[je],Qr=Y[je];(Qr!==Lt||je==="value")&&i(k,je,Lt,Qr,P,m.children,_,w,ct)}}O&1&&m.children!==p.children&&l(k,p.children)}else!U&&x==null&&Te(k,p,K,Y,_,w,P);((ne=Y.onVnodeUpdated)||J)&&It(()=>{ne&&Jt(ne,_,p,m),J&&cr(p,m,_,"updated")},w)},re=(m,p,_,w,P,C,U)=>{for(let k=0;k<p.length;k++){const O=m[k],x=p[k],J=O.el&&(O.type===Yt||!gr(O,x)||O.shapeFlag&70)?h(O.el):_;v(O,x,J,null,w,P,C,U,!0)}},Te=(m,p,_,w,P,C,U)=>{if(_!==w){if(_!==Se)for(const k in _)!Yo(k)&&!(k in w)&&i(m,k,_[k],null,U,p.children,P,C,ct);for(const k in w){if(Yo(k))continue;const O=w[k],x=_[k];O!==x&&k!=="value"&&i(m,k,x,O,U,p.children,P,C,ct)}"value"in w&&i(m,"value",_.value,w.value)}},z=(m,p,_,w,P,C,U,k,O)=>{const x=p.el=m?m.el:a(""),J=p.anchor=m?m.anchor:a("");let{patchFlag:K,dynamicChildren:Y,slotScopeIds:ne}=p;ne&&(k=k?k.concat(ne):ne),m==null?(r(x,_,w),r(J,_,w),B(p.children,_,J,P,C,U,k,O)):K>0&&K&64&&Y&&m.dynamicChildren?(re(m.dynamicChildren,Y,_,P,C,U,k),(p.key!=null||P&&p===P.subTree)&&tg(m,p,!0)):_e(m,p,_,J,P,C,U,k,O)},pe=(m,p,_,w,P,C,U,k,O)=>{p.slotScopeIds=k,m==null?p.shapeFlag&512?P.ctx.activate(p,_,w,U,O):rt(p,_,w,P,C,U,O):gt(m,p,O)},rt=(m,p,_,w,P,C,U)=>{const k=m.component=fw(m,w,P);if(Wa(m)&&(k.ctx.renderer=F),pw(k),k.asyncDep){if(P&&P.registerDep(k,le),!m.el){const O=k.subTree=Ct(zt);A(null,O,p,_)}return}le(k,m,p,_,P,C,U)},gt=(m,p,_)=>{const w=p.component=m.component;if(II(m,p,_))if(w.asyncDep&&!w.asyncResolved){Ae(w,p,_);return}else w.next=p,mI(w.update),w.update();else p.el=m.el,w.vnode=p},le=(m,p,_,w,P,C,U)=>{const k=()=>{if(m.isMounted){let{next:J,bu:K,u:Y,parent:ne,vnode:ae}=m,be=J,we;ur(m,!1),J?(J.el=ae.el,Ae(m,J,U)):J=ae,K&&jc(K),(we=J.props&&J.props.onVnodeBeforeUpdate)&&Jt(we,ne,J,ae),ur(m,!0);const je=zc(m),Lt=m.subTree;m.subTree=je,v(Lt,je,h(Lt.el),T(Lt),m,P,C),J.el=je.el,be===null&&wI(m,je.el),Y&&It(Y,P),(we=J.props&&J.props.onVnodeUpdated)&&It(()=>Jt(we,ne,J,ae),P)}else{let J;const{el:K,props:Y}=p,{bm:ne,m:ae,parent:be}=m,we=Xo(p);if(ur(m,!1),ne&&jc(ne),!we&&(J=Y&&Y.onVnodeBeforeMount)&&Jt(J,be,p),ur(m,!0),K&&ye){const je=()=>{m.subTree=zc(m),ye(K,m.subTree,m,P,null)};we?p.type.__asyncLoader().then(()=>!m.isUnmounted&&je()):je()}else{const je=m.subTree=zc(m);v(null,je,_,w,m,P,C),p.el=je.el}if(ae&&It(ae,P),!we&&(J=Y&&Y.onVnodeMounted)){const je=p;It(()=>Jt(J,be,je),P)}(p.shapeFlag&256||be&&Xo(be.vnode)&&be.vnode.shapeFlag&256)&&m.a&&It(m.a,P),m.isMounted=!0,p=_=w=null}},O=m.effect=new Nl(k,()=>$l(x),m.scope),x=m.update=()=>O.run();x.id=m.uid,ur(m,!0),x()},Ae=(m,p,_)=>{p.component=m;const w=m.vnode.props;m.vnode=p,m.next=null,XI(m,p.props,w,_),tw(m,p.children,_),ks(),xd(),Ns()},_e=(m,p,_,w,P,C,U,k,O=!1)=>{const x=m&&m.children,J=m?m.shapeFlag:0,K=p.children,{patchFlag:Y,shapeFlag:ne}=p;if(Y>0){if(Y&128){Tn(x,K,_,w,P,C,U,k,O);return}else if(Y&256){ln(x,K,_,w,P,C,U,k,O);return}}ne&8?(J&16&&ct(x,P,C),K!==x&&l(_,K)):J&16?ne&16?Tn(x,K,_,w,P,C,U,k,O):ct(x,P,C,!0):(J&8&&l(_,""),ne&16&&B(K,_,w,P,C,U,k,O))},ln=(m,p,_,w,P,C,U,k,O)=>{m=m||ss,p=p||ss;const x=m.length,J=p.length,K=Math.min(x,J);let Y;for(Y=0;Y<K;Y++){const ne=p[Y]=O?Vn(p[Y]):Xt(p[Y]);v(m[Y],ne,_,null,P,C,U,k,O)}x>J?ct(m,P,C,!0,!1,K):B(p,_,w,P,C,U,k,O,K)},Tn=(m,p,_,w,P,C,U,k,O)=>{let x=0;const J=p.length;let K=m.length-1,Y=J-1;for(;x<=K&&x<=Y;){const ne=m[x],ae=p[x]=O?Vn(p[x]):Xt(p[x]);if(gr(ne,ae))v(ne,ae,_,null,P,C,U,k,O);else break;x++}for(;x<=K&&x<=Y;){const ne=m[K],ae=p[Y]=O?Vn(p[Y]):Xt(p[Y]);if(gr(ne,ae))v(ne,ae,_,null,P,C,U,k,O);else break;K--,Y--}if(x>K){if(x<=Y){const ne=Y+1,ae=ne<J?p[ne].el:w;for(;x<=Y;)v(null,p[x]=O?Vn(p[x]):Xt(p[x]),_,ae,P,C,U,k,O),x++}}else if(x>Y)for(;x<=K;)Et(m[x],P,C,!0),x++;else{const ne=x,ae=x,be=new Map;for(x=ae;x<=Y;x++){const Pt=p[x]=O?Vn(p[x]):Xt(p[x]);Pt.key!=null&&be.set(Pt.key,x)}let we,je=0;const Lt=Y-ae+1;let Qr=!1,yd=0;const Js=new Array(Lt);for(x=0;x<Lt;x++)Js[x]=0;for(x=ne;x<=K;x++){const Pt=m[x];if(je>=Lt){Et(Pt,P,C,!0);continue}let Wt;if(Pt.key!=null)Wt=be.get(Pt.key);else for(we=ae;we<=Y;we++)if(Js[we-ae]===0&&gr(Pt,p[we])){Wt=we;break}Wt===void 0?Et(Pt,P,C,!0):(Js[Wt-ae]=x+1,Wt>=yd?yd=Wt:Qr=!0,v(Pt,p[Wt],_,null,P,C,U,k,O),je++)}const vd=Qr?sw(Js):ss;for(we=vd.length-1,x=Lt-1;x>=0;x--){const Pt=ae+x,Wt=p[Pt],Ed=Pt+1<J?p[Pt+1].el:w;Js[x]===0?v(null,Wt,_,Ed,P,C,U,k,O):Qr&&(we<0||x!==vd[we]?Qt(Wt,_,Ed,2):we--)}}},Qt=(m,p,_,w,P=null)=>{const{el:C,type:U,transition:k,children:O,shapeFlag:x}=m;if(x&6){Qt(m.component.subTree,p,_,w);return}if(x&128){m.suspense.move(p,_,w);return}if(x&64){U.move(m,p,_,F);return}if(U===Yt){r(C,p,_);for(let K=0;K<O.length;K++)Qt(O[K],p,_,w);r(m.anchor,p,_);return}if(U===Hc){V(m,p,_);return}if(w!==2&&x&1&&k)if(w===0)k.beforeEnter(C),r(C,p,_),It(()=>k.enter(C),P);else{const{leave:K,delayLeave:Y,afterLeave:ne}=k,ae=()=>r(C,p,_),be=()=>{K(C,()=>{ae(),ne&&ne()})};Y?Y(C,ae,be):be()}else r(C,p,_)},Et=(m,p,_,w=!1,P=!1)=>{const{type:C,props:U,ref:k,children:O,dynamicChildren:x,shapeFlag:J,patchFlag:K,dirs:Y}=m;if(k!=null&&Du(k,null,_,m,!0),J&256){p.ctx.deactivate(m);return}const ne=J&1&&Y,ae=!Xo(m);let be;if(ae&&(be=U&&U.onVnodeBeforeUnmount)&&Jt(be,p,m),J&6)Do(m.component,_,w);else{if(J&128){m.suspense.unmount(_,w);return}ne&&cr(m,null,p,"beforeUnmount"),J&64?m.type.remove(m,p,_,P,F,w):x&&(C!==Yt||K>0&&K&64)?ct(x,p,_,!1,!0):(C===Yt&&K&384||!P&&J&16)&&ct(O,p,_),w&&Gr(m)}(ae&&(be=U&&U.onVnodeUnmounted)||ne)&&It(()=>{be&&Jt(be,p,m),ne&&cr(m,null,p,"unmounted")},_)},Gr=m=>{const{type:p,el:_,anchor:w,transition:P}=m;if(p===Yt){Hr(_,w);return}if(p===Hc){D(m);return}const C=()=>{s(_),P&&!P.persisted&&P.afterLeave&&P.afterLeave()};if(m.shapeFlag&1&&P&&!P.persisted){const{leave:U,delayLeave:k}=P,O=()=>U(_,C);k?k(m.el,C,O):O()}else C()},Hr=(m,p)=>{let _;for(;m!==p;)_=d(m),s(m),m=_;s(p)},Do=(m,p,_)=>{const{bum:w,scope:P,update:C,subTree:U,um:k}=m;w&&jc(w),P.stop(),C&&(C.active=!1,Et(U,m,p,_)),k&&It(k,p),It(()=>{m.isUnmounted=!0},p),p&&p.pendingBranch&&!p.isUnmounted&&m.asyncDep&&!m.asyncResolved&&m.suspenseId===p.pendingId&&(p.deps--,p.deps===0&&p.resolve())},ct=(m,p,_,w=!1,P=!1,C=0)=>{for(let U=C;U<m.length;U++)Et(m[U],p,_,w,P)},T=m=>m.shapeFlag&6?T(m.component.subTree):m.shapeFlag&128?m.suspense.next():d(m.anchor||m.el),$=(m,p,_)=>{m==null?p._vnode&&Et(p._vnode,null,null,!0):v(p._vnode||null,m,p,null,null,null,_),xd(),Np(),p._vnode=m},F={p:v,um:Et,m:Qt,r:Gr,mt:rt,mc:B,pc:_e,pbc:re,n:T,o:t};let Q,ye;return e&&([Q,ye]=e(F)),{render:$,hydrate:Q,createApp:WI($,Q)}}function ur({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function tg(t,e,n=!1){const r=t.children,s=e.children;if(Z(r)&&Z(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=Vn(s[i]),a.el=o.el),n||tg(o,a)),a.type===Ya&&(a.el=o.el)}}function sw(t){const e=t.slice(),n=[0];let r,s,i,o,a;const c=t.length;for(r=0;r<c;r++){const u=t[r];if(u!==0){if(s=n[n.length-1],t[s]<u){e[r]=s,n.push(r);continue}for(i=0,o=n.length-1;i<o;)a=i+o>>1,t[n[a]]<u?i=a+1:o=a;u<t[n[i]]&&(i>0&&(e[r]=n[i-1]),n[i]=r)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=e[o];return n}const iw=t=>t.__isTeleport,Yt=Symbol.for("v-fgt"),Ya=Symbol.for("v-txt"),zt=Symbol.for("v-cmt"),Hc=Symbol.for("v-stc"),gi=[];let qt=null;function ng(t=!1){gi.push(qt=t?null:[])}function ow(){gi.pop(),qt=gi[gi.length-1]||null}let Di=1;function $d(t){Di+=t}function rg(t){return t.dynamicChildren=Di>0?qt||ss:null,ow(),Di>0&&qt&&qt.push(t),t}function sV(t,e,n,r,s,i){return rg(og(t,e,n,r,s,i,!0))}function sg(t,e,n,r,s){return rg(Ct(t,e,n,r,s,!0))}function ku(t){return t?t.__v_isVNode===!0:!1}function gr(t,e){return t.type===e.type&&t.key===e.key}const Xa="__vInternal",ig=({key:t})=>t!=null?t:null,ea=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Ge(t)||Ue(t)||ie(t)?{i:wt,r:t,k:e,f:!!n}:t:null);function og(t,e=null,n=null,r=0,s=null,i=t===Yt?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&ig(e),ref:e&&ea(e),scopeId:Fp,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:wt};return a?(Gl(c,n),i&128&&t.normalize(c)):n&&(c.shapeFlag|=Ge(n)?8:16),Di>0&&!o&&qt&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&qt.push(c),c}const Ct=aw;function aw(t,e=null,n=null,r=0,s=null,i=!1){if((!t||t===UI)&&(t=zt),ku(t)){const a=zn(t,e,!0);return n&&Gl(a,n),Di>0&&!i&&qt&&(a.shapeFlag&6?qt[qt.indexOf(t)]=a:qt.push(a)),a.patchFlag|=-2,a}if(Ew(t)&&(t=t.__vccOpts),e){e=cw(e);let{class:a,style:c}=e;a&&!Ge(a)&&(e.class=Dl(a)),De(c)&&(Pp(c)&&!Z(c)&&(c=Ke({},c)),e.style=Vl(c))}const o=Ge(t)?1:TI(t)?128:iw(t)?64:De(t)?4:ie(t)?2:0;return og(t,e,n,r,s,o,i,!0)}function cw(t){return t?Pp(t)||Xa in t?Ke({},t):t:null}function zn(t,e,n=!1){const{props:r,ref:s,patchFlag:i,children:o}=t,a=e?lw(r||{},e):r;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&ig(a),ref:e&&e.ref?n&&s?Z(s)?s.concat(ea(e)):[s,ea(e)]:ea(e):s,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Yt?i===-1?16:i|16:i,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&zn(t.ssContent),ssFallback:t.ssFallback&&zn(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce}}function uw(t=" ",e=0){return Ct(Ya,null,t,e)}function iV(t="",e=!1){return e?(ng(),sg(zt,null,t)):Ct(zt,null,t)}function Xt(t){return t==null||typeof t=="boolean"?Ct(zt):Z(t)?Ct(Yt,null,t.slice()):typeof t=="object"?Vn(t):Ct(Ya,null,String(t))}function Vn(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:zn(t)}function Gl(t,e){let n=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(Z(e))n=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),Gl(t,s()),s._c&&(s._d=!0));return}else{n=32;const s=e._;!s&&!(Xa in e)?e._ctx=wt:s===3&&wt&&(wt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else ie(e)?(e={default:e,_ctx:wt},n=32):(e=String(e),r&64?(n=16,e=[uw(e)]):n=8);t.children=e,t.shapeFlag|=n}function lw(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=Dl([e.class,r.class]));else if(s==="style")e.style=Vl([e.style,r.style]);else if(qa(s)){const i=e[s],o=r[s];o&&i!==o&&!(Z(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=r[s])}return e}function Jt(t,e,n,r=null){Mt(t,e,7,[n,r])}const hw=Wp();let dw=0;function fw(t,e,n){const r=t.type,s=(e?e.appContext:t.appContext)||hw,i={uid:dw++,vnode:t,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new dp(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Yp(r,s),emitsOptions:Mp(r,s),emit:null,emitted:null,propsDefaults:Se,inheritAttrs:r.inheritAttrs,ctx:Se,data:Se,props:Se,attrs:Se,slots:Se,refs:Se,setupState:Se,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=_I.bind(null,i),t.ce&&t.ce(i),i}let Qe=null;const mw=()=>Qe||wt;let Hl,Wr,jd="__VUE_INSTANCE_SETTERS__";(Wr=Iu()[jd])||(Wr=Iu()[jd]=[]),Wr.push(t=>Qe=t),Hl=t=>{Wr.length>1?Wr.forEach(e=>e(t)):Wr[0](t)};const ms=t=>{Hl(t),t.scope.on()},Pr=()=>{Qe&&Qe.scope.off(),Hl(null)};function ag(t){return t.vnode.shapeFlag&4}let ki=!1;function pw(t,e=!1){ki=e;const{props:n,children:r}=t.vnode,s=ag(t);YI(t,n,s,e),ew(t,r);const i=s?gw(t,e):void 0;return ki=!1,i}function gw(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=ao(new Proxy(t.ctx,$I));const{setup:r}=n;if(r){const s=t.setupContext=r.length>1?yw(t):null;ms(t),ks();const i=Un(r,t,0,[t.props,s]);if(Ns(),Pr(),ap(i)){if(i.then(Pr,Pr),e)return i.then(o=>{zd(t,o,e)}).catch(o=>{Ha(o,t,0)});t.asyncDep=i}else zd(t,i,e)}else cg(t,e)}function zd(t,e,n){ie(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:De(e)&&(t.setupState=Vp(e)),cg(t,n)}let Kd;function cg(t,e,n){const r=t.type;if(!t.render){if(!e&&Kd&&!r.render){const s=r.template||zl(t).template;if(s){const{isCustomElement:i,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:c}=r,u=Ke(Ke({isCustomElement:i,delimiters:a},o),c);r.render=Kd(s,u)}}t.render=r.render||jt}ms(t),ks(),jI(t),Ns(),Pr()}function _w(t){return t.attrsProxy||(t.attrsProxy=new Proxy(t.attrs,{get(e,n){return Rt(t,"get","$attrs"),e[n]}}))}function yw(t){const e=n=>{t.exposed=n||{}};return{get attrs(){return _w(t)},slots:t.slots,emit:t.emit,expose:e}}function Za(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(Vp(ao(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in pi)return pi[n](t)},has(e,n){return n in e||n in pi}}))}function vw(t,e=!0){return ie(t)?t.displayName||t.name:t.name||e&&t.__name}function Ew(t){return ie(t)&&"__vccOpts"in t}const kt=(t,e)=>hI(t,e,ki);function Ql(t,e,n){const r=arguments.length;return r===2?De(e)&&!Z(e)?ku(e)?Ct(t,null,[e]):Ct(t,e):Ct(t,null,e):(r>3?n=Array.prototype.slice.call(arguments,2):r===3&&ku(n)&&(n=[n]),Ct(t,e,n))}const Iw=Symbol.for("v-scx"),ww=()=>on(Iw),Tw="3.3.4",Aw="http://www.w3.org/2000/svg",_r=typeof document!="undefined"?document:null,Gd=_r&&_r.createElement("template"),bw={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const s=e?_r.createElementNS(Aw,t):_r.createElement(t,n?{is:n}:void 0);return t==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:t=>_r.createTextNode(t),createComment:t=>_r.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>_r.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,r,s,i){const o=n?n.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),n),!(s===i||!(s=s.nextSibling)););else{Gd.innerHTML=r?`<svg>${t}</svg>`:t;const a=Gd.content;if(r){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};function Rw(t,e,n){const r=t._vtc;r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}function Pw(t,e,n){const r=t.style,s=Ge(n);if(n&&!s){if(e&&!Ge(e))for(const i in e)n[i]==null&&Nu(r,i,"");for(const i in n)Nu(r,i,n[i])}else{const i=r.display;s?e!==n&&(r.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(r.display=i)}}const Hd=/\s*!important$/;function Nu(t,e,n){if(Z(n))n.forEach(r=>Nu(t,e,r));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const r=Sw(t,e);Hd.test(n)?t.setProperty(Ds(r),n.replace(Hd,""),"important"):t[r]=n}}const Qd=["Webkit","Moz","ms"],Qc={};function Sw(t,e){const n=Qc[e];if(n)return n;let r=cn(e);if(r!=="filter"&&r in t)return Qc[e]=r;r=za(r);for(let s=0;s<Qd.length;s++){const i=Qd[s]+r;if(i in t)return Qc[e]=i}return e}const Wd="http://www.w3.org/1999/xlink";function Cw(t,e,n,r,s){if(r&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(Wd,e.slice(6,e.length)):t.setAttributeNS(Wd,e,n);else{const i=SE(e);n==null||i&&!lp(n)?t.removeAttribute(e):t.setAttribute(e,i?"":n)}}function xw(t,e,n,r,s,i,o){if(e==="innerHTML"||e==="textContent"){r&&o(r,s,i),t[e]=n==null?"":n;return}const a=t.tagName;if(e==="value"&&a!=="PROGRESS"&&!a.includes("-")){t._value=n;const u=a==="OPTION"?t.getAttribute("value"):t.value,l=n==null?"":n;u!==l&&(t.value=l),n==null&&t.removeAttribute(e);return}let c=!1;if(n===""||n==null){const u=typeof t[e];u==="boolean"?n=lp(n):n==null&&u==="string"?(n="",c=!0):u==="number"&&(n=0,c=!0)}try{t[e]=n}catch{}c&&t.removeAttribute(e)}function Vw(t,e,n,r){t.addEventListener(e,n,r)}function Dw(t,e,n,r){t.removeEventListener(e,n,r)}function kw(t,e,n,r,s=null){const i=t._vei||(t._vei={}),o=i[e];if(r&&o)o.value=r;else{const[a,c]=Nw(e);if(r){const u=i[e]=Fw(r,s);Vw(t,a,u,c)}else o&&(Dw(t,a,o,c),i[e]=void 0)}}const Jd=/(?:Once|Passive|Capture)$/;function Nw(t){let e;if(Jd.test(t)){e={};let r;for(;r=t.match(Jd);)t=t.slice(0,t.length-r[0].length),e[r[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Ds(t.slice(2)),e]}let Wc=0;const Ow=Promise.resolve(),Mw=()=>Wc||(Ow.then(()=>Wc=0),Wc=Date.now());function Fw(t,e){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;Mt(Lw(r,n.value),e,5,[r])};return n.value=t,n.attached=Mw(),n}function Lw(t,e){if(Z(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const Yd=/^on[a-z]/,Bw=(t,e,n,r,s=!1,i,o,a,c)=>{e==="class"?Rw(t,r,s):e==="style"?Pw(t,n,r):qa(e)?Pl(e)||kw(t,e,n,r,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Uw(t,e,r,s))?xw(t,e,r,i,o,a,c):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),Cw(t,e,r,s))};function Uw(t,e,n,r){return r?!!(e==="innerHTML"||e==="textContent"||e in t&&Yd.test(e)&&ie(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||Yd.test(e)&&Ge(n)?!1:e in t}const bn="transition",Ys="animation",ug=(t,{slots:e})=>Ql(SI,qw(t),e);ug.displayName="Transition";const lg={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};ug.props=Ke({},Up,lg);const lr=(t,e=[])=>{Z(t)?t.forEach(n=>n(...e)):t&&t(...e)},Xd=t=>t?Z(t)?t.some(e=>e.length>1):t.length>1:!1;function qw(t){const e={};for(const z in t)z in lg||(e[z]=t[z]);if(t.css===!1)return e;const{name:n="v",type:r,duration:s,enterFromClass:i=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:c=i,appearActiveClass:u=o,appearToClass:l=a,leaveFromClass:h=`${n}-leave-from`,leaveActiveClass:d=`${n}-leave-active`,leaveToClass:f=`${n}-leave-to`}=t,g=$w(s),v=g&&g[0],I=g&&g[1],{onBeforeEnter:A,onEnter:R,onEnterCancelled:V,onLeave:D,onLeaveCancelled:j,onBeforeAppear:X=A,onAppear:oe=R,onAppearCancelled:B=V}=e,W=(z,pe,rt)=>{hr(z,pe?l:a),hr(z,pe?u:o),rt&&rt()},re=(z,pe)=>{z._isLeaving=!1,hr(z,h),hr(z,f),hr(z,d),pe&&pe()},Te=z=>(pe,rt)=>{const gt=z?oe:R,le=()=>W(pe,z,rt);lr(gt,[pe,le]),Zd(()=>{hr(pe,z?c:i),Rn(pe,z?l:a),Xd(gt)||ef(pe,r,v,le)})};return Ke(e,{onBeforeEnter(z){lr(A,[z]),Rn(z,i),Rn(z,o)},onBeforeAppear(z){lr(X,[z]),Rn(z,c),Rn(z,u)},onEnter:Te(!1),onAppear:Te(!0),onLeave(z,pe){z._isLeaving=!0;const rt=()=>re(z,pe);Rn(z,h),Kw(),Rn(z,d),Zd(()=>{!z._isLeaving||(hr(z,h),Rn(z,f),Xd(D)||ef(z,r,I,rt))}),lr(D,[z,rt])},onEnterCancelled(z){W(z,!1),lr(V,[z])},onAppearCancelled(z){W(z,!0),lr(B,[z])},onLeaveCancelled(z){re(z),lr(j,[z])}})}function $w(t){if(t==null)return null;if(De(t))return[Jc(t.enter),Jc(t.leave)];{const e=Jc(t);return[e,e]}}function Jc(t){return wE(t)}function Rn(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t._vtc||(t._vtc=new Set)).add(e)}function hr(t,e){e.split(/\s+/).forEach(r=>r&&t.classList.remove(r));const{_vtc:n}=t;n&&(n.delete(e),n.size||(t._vtc=void 0))}function Zd(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let jw=0;function ef(t,e,n,r){const s=t._endId=++jw,i=()=>{s===t._endId&&r()};if(n)return setTimeout(i,n);const{type:o,timeout:a,propCount:c}=zw(t,e);if(!o)return r();const u=o+"end";let l=0;const h=()=>{t.removeEventListener(u,d),i()},d=f=>{f.target===t&&++l>=c&&h()};setTimeout(()=>{l<c&&h()},a+1),t.addEventListener(u,d)}function zw(t,e){const n=window.getComputedStyle(t),r=g=>(n[g]||"").split(", "),s=r(`${bn}Delay`),i=r(`${bn}Duration`),o=tf(s,i),a=r(`${Ys}Delay`),c=r(`${Ys}Duration`),u=tf(a,c);let l=null,h=0,d=0;e===bn?o>0&&(l=bn,h=o,d=i.length):e===Ys?u>0&&(l=Ys,h=u,d=c.length):(h=Math.max(o,u),l=h>0?o>u?bn:Ys:null,d=l?l===bn?i.length:c.length:0);const f=l===bn&&/\b(transform|all)(,|$)/.test(r(`${bn}Property`).toString());return{type:l,timeout:h,propCount:d,hasTransform:f}}function tf(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,r)=>nf(n)+nf(t[r])))}function nf(t){return Number(t.slice(0,-1).replace(",","."))*1e3}function Kw(){return document.body.offsetHeight}const Gw=Ke({patchProp:Bw},bw);let rf;function Hw(){return rf||(rf=nw(Gw))}const Qw=(...t)=>{const e=Hw().createApp(...t),{mount:n}=e;return e.mount=r=>{const s=Ww(r);if(!s)return;const i=e._component;!ie(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.innerHTML="";const o=n(s,!1,s instanceof SVGElement);return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function Ww(t){return Ge(t)?document.querySelector(t):t}function Wl(t,e,n,r){return Object.defineProperty(t,e,{get:n,set:r,enumerable:!0}),t}const xr=Ga(!1);let ec;function Jw(t,e){const n=/(edg|edge|edga|edgios)\/([\w.]+)/.exec(t)||/(opr)[\/]([\w.]+)/.exec(t)||/(vivaldi)[\/]([\w.]+)/.exec(t)||/(chrome|crios)[\/]([\w.]+)/.exec(t)||/(version)(applewebkit)[\/]([\w.]+).*(safari)[\/]([\w.]+)/.exec(t)||/(webkit)[\/]([\w.]+).*(version)[\/]([\w.]+).*(safari)[\/]([\w.]+)/.exec(t)||/(firefox|fxios)[\/]([\w.]+)/.exec(t)||/(webkit)[\/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[\/]([\w.]+)/.exec(t)||[];return{browser:n[5]||n[3]||n[1]||"",version:n[2]||n[4]||"0",versionNumber:n[4]||n[2]||"0",platform:e[0]||""}}function Yw(t){return/(ipad)/.exec(t)||/(ipod)/.exec(t)||/(windows phone)/.exec(t)||/(iphone)/.exec(t)||/(kindle)/.exec(t)||/(silk)/.exec(t)||/(android)/.exec(t)||/(win)/.exec(t)||/(mac)/.exec(t)||/(linux)/.exec(t)||/(cros)/.exec(t)||/(playbook)/.exec(t)||/(bb)/.exec(t)||/(blackberry)/.exec(t)||[]}const hg="ontouchstart"in window||window.navigator.maxTouchPoints>0;function Xw(t){ec={is:{...t}},delete t.mac,delete t.desktop;const e=Math.min(window.innerHeight,window.innerWidth)>414?"ipad":"iphone";Object.assign(t,{mobile:!0,ios:!0,platform:e,[e]:!0})}function Zw(t){const e=t.toLowerCase(),n=Yw(e),r=Jw(e,n),s={};r.browser&&(s[r.browser]=!0,s.version=r.version,s.versionNumber=parseInt(r.versionNumber,10)),r.platform&&(s[r.platform]=!0);const i=s.android||s.ios||s.bb||s.blackberry||s.ipad||s.iphone||s.ipod||s.kindle||s.playbook||s.silk||s["windows phone"];return i===!0||e.indexOf("mobile")>-1?(s.mobile=!0,s.edga||s.edgios?(s.edge=!0,r.browser="edge"):s.crios?(s.chrome=!0,r.browser="chrome"):s.fxios&&(s.firefox=!0,r.browser="firefox")):s.desktop=!0,(s.ipod||s.ipad||s.iphone)&&(s.ios=!0),s["windows phone"]&&(s.winphone=!0,delete s["windows phone"]),(s.chrome||s.opr||s.safari||s.vivaldi||s.mobile===!0&&s.ios!==!0&&i!==!0)&&(s.webkit=!0),s.edg&&(r.browser="edgechromium",s.edgeChromium=!0),(s.safari&&s.blackberry||s.bb)&&(r.browser="blackberry",s.blackberry=!0),s.safari&&s.playbook&&(r.browser="playbook",s.playbook=!0),s.opr&&(r.browser="opera",s.opera=!0),s.safari&&s.android&&(r.browser="android",s.android=!0),s.safari&&s.kindle&&(r.browser="kindle",s.kindle=!0),s.safari&&s.silk&&(r.browser="silk",s.silk=!0),s.vivaldi&&(r.browser="vivaldi",s.vivaldi=!0),s.name=r.browser,s.platform=r.platform,e.indexOf("electron")>-1?s.electron=!0:document.location.href.indexOf("-extension://")>-1?s.bex=!0:(window.Capacitor!==void 0?(s.capacitor=!0,s.nativeMobile=!0,s.nativeMobileWrapper="capacitor"):(window._cordovaNative!==void 0||window.cordova!==void 0)&&(s.cordova=!0,s.nativeMobile=!0,s.nativeMobileWrapper="cordova"),hg===!0&&s.mac===!0&&(s.desktop===!0&&s.safari===!0||s.nativeMobile===!0&&s.android!==!0&&s.ios!==!0&&s.ipad!==!0)&&Xw(s)),s}const sf=navigator.userAgent||navigator.vendor||window.opera,eT={has:{touch:!1,webStorage:!1},within:{iframe:!1}},Ot={userAgent:sf,is:Zw(sf),has:{touch:hg},within:{iframe:window.self!==window.top}},Ou={install(t){const{$q:e}=t;xr.value===!0?(t.onSSRHydrated.push(()=>{Object.assign(e.platform,Ot),xr.value=!1,ec=void 0}),e.platform=qr(this)):e.platform=this}};{let t;Wl(Ot.has,"webStorage",()=>{if(t!==void 0)return t;try{if(window.localStorage)return t=!0,!0}catch{}return t=!1,!1}),Ot.is.ios===!0&&window.navigator.vendor.toLowerCase().indexOf("apple"),xr.value===!0?Object.assign(Ou,Ot,ec,eT):Object.assign(Ou,Ot)}var tc=(t,e)=>{const n=qr(t);for(const r in t)Wl(e,r,()=>n[r],s=>{n[r]=s});return e};const ps={hasPassive:!1,passiveCapture:!0,notPassiveCapture:!0};try{const t=Object.defineProperty({},"passive",{get(){Object.assign(ps,{hasPassive:!0,passive:{passive:!0},notPassive:{passive:!1},passiveCapture:{passive:!0,capture:!0},notPassiveCapture:{passive:!1,capture:!0}})}});window.addEventListener("qtest",null,t),window.removeEventListener("qtest",null,t)}catch{}function Ni(){}function oV(t){return t.button===0}function aV(t){return t.touches&&t.touches[0]?t=t.touches[0]:t.changedTouches&&t.changedTouches[0]?t=t.changedTouches[0]:t.targetTouches&&t.targetTouches[0]&&(t=t.targetTouches[0]),{top:t.clientY,left:t.clientX}}function cV(t){if(t.path)return t.path;if(t.composedPath)return t.composedPath();const e=[];let n=t.target;for(;n;){if(e.push(n),n.tagName==="HTML")return e.push(document),e.push(window),e;n=n.parentElement}}function uV(t){t.stopPropagation()}function of(t){t.cancelable!==!1&&t.preventDefault()}function lV(t){t.cancelable!==!1&&t.preventDefault(),t.stopPropagation()}function hV(t,e){if(t===void 0||e===!0&&t.__dragPrevented===!0)return;const n=e===!0?r=>{r.__dragPrevented=!0,r.addEventListener("dragstart",of,ps.notPassiveCapture)}:r=>{delete r.__dragPrevented,r.removeEventListener("dragstart",of,ps.notPassiveCapture)};t.querySelectorAll("a, img").forEach(n)}function dV(t,e,n){const r=`__q_${e}_evt`;t[r]=t[r]!==void 0?t[r].concat(n):n,n.forEach(s=>{s[0].addEventListener(s[1],t[s[2]],ps[s[3]])})}function fV(t,e){const n=`__q_${e}_evt`;t[n]!==void 0&&(t[n].forEach(r=>{r[0].removeEventListener(r[1],t[r[2]],ps[r[3]])}),t[n]=void 0)}function tT(t,e=250,n){let r=null;function s(){const i=arguments,o=()=>{r=null,n!==!0&&t.apply(this,i)};r!==null?clearTimeout(r):n===!0&&t.apply(this,i),r=setTimeout(o,e)}return s.cancel=()=>{r!==null&&clearTimeout(r)},s}const Yc=["sm","md","lg","xl"],{passive:af}=ps;var nT=tc({width:0,height:0,name:"xs",sizes:{sm:600,md:1024,lg:1440,xl:1920},lt:{sm:!0,md:!0,lg:!0,xl:!0},gt:{xs:!1,sm:!1,md:!1,lg:!1},xs:!0,sm:!1,md:!1,lg:!1,xl:!1},{setSizes:Ni,setDebounce:Ni,install({$q:t,onSSRHydrated:e}){if(t.screen=this,this.__installed===!0){t.config.screen!==void 0&&(t.config.screen.bodyClasses===!1?document.body.classList.remove(`screen--${this.name}`):this.__update(!0));return}const{visualViewport:n}=window,r=n||window,s=document.scrollingElement||document.documentElement,i=n===void 0||Ot.is.mobile===!0?()=>[Math.max(window.innerWidth,s.clientWidth),Math.max(window.innerHeight,s.clientHeight)]:()=>[n.width*n.scale+window.innerWidth-s.clientWidth,n.height*n.scale+window.innerHeight-s.clientHeight],o=t.config.screen!==void 0&&t.config.screen.bodyClasses===!0;this.__update=h=>{const[d,f]=i();if(f!==this.height&&(this.height=f),d!==this.width)this.width=d;else if(h!==!0)return;let g=this.sizes;this.gt.xs=d>=g.sm,this.gt.sm=d>=g.md,this.gt.md=d>=g.lg,this.gt.lg=d>=g.xl,this.lt.sm=d<g.sm,this.lt.md=d<g.md,this.lt.lg=d<g.lg,this.lt.xl=d<g.xl,this.xs=this.lt.sm,this.sm=this.gt.xs===!0&&this.lt.md===!0,this.md=this.gt.sm===!0&&this.lt.lg===!0,this.lg=this.gt.md===!0&&this.lt.xl===!0,this.xl=this.gt.lg,g=this.xs===!0&&"xs"||this.sm===!0&&"sm"||this.md===!0&&"md"||this.lg===!0&&"lg"||"xl",g!==this.name&&(o===!0&&(document.body.classList.remove(`screen--${this.name}`),document.body.classList.add(`screen--${g}`)),this.name=g)};let a,c={},u=16;this.setSizes=h=>{Yc.forEach(d=>{h[d]!==void 0&&(c[d]=h[d])})},this.setDebounce=h=>{u=h};const l=()=>{const h=getComputedStyle(document.body);h.getPropertyValue("--q-size-sm")&&Yc.forEach(d=>{this.sizes[d]=parseInt(h.getPropertyValue(`--q-size-${d}`),10)}),this.setSizes=d=>{Yc.forEach(f=>{d[f]&&(this.sizes[f]=d[f])}),this.__update(!0)},this.setDebounce=d=>{a!==void 0&&r.removeEventListener("resize",a,af),a=d>0?tT(this.__update,d):this.__update,r.addEventListener("resize",a,af)},this.setDebounce(u),Object.keys(c).length!==0?(this.setSizes(c),c=void 0):this.__update(),o===!0&&this.name==="xs"&&document.body.classList.add("screen--xs")};xr.value===!0?e.push(l):l()}});const lt=tc({isActive:!1,mode:!1},{__media:void 0,set(t){lt.mode=t,t==="auto"?(lt.__media===void 0&&(lt.__media=window.matchMedia("(prefers-color-scheme: dark)"),lt.__updateMedia=()=>{lt.set("auto")},lt.__media.addListener(lt.__updateMedia)),t=lt.__media.matches):lt.__media!==void 0&&(lt.__media.removeListener(lt.__updateMedia),lt.__media=void 0),lt.isActive=t===!0,document.body.classList.remove(`body--${t===!0?"light":"dark"}`),document.body.classList.add(`body--${t===!0?"dark":"light"}`)},toggle(){lt.set(lt.isActive===!1)},install({$q:t,onSSRHydrated:e,ssrContext:n}){const{dark:r}=t.config;if(t.dark=this,this.__installed===!0&&r===void 0)return;this.isActive=r===!0;const s=r!==void 0?r:!1;if(xr.value===!0){const i=a=>{this.__fromSSR=a},o=this.set;this.set=i,i(s),e.push(()=>{this.set=o,this.set(this.__fromSSR)})}else this.set(s)}}),dg=()=>!0;function rT(t){return typeof t=="string"&&t!==""&&t!=="/"&&t!=="#/"}function sT(t){return t.startsWith("#")===!0&&(t=t.substring(1)),t.startsWith("/")===!1&&(t="/"+t),t.endsWith("/")===!0&&(t=t.substring(0,t.length-1)),"#"+t}function iT(t){if(t.backButtonExit===!1)return()=>!1;if(t.backButtonExit==="*")return dg;const e=["#/"];return Array.isArray(t.backButtonExit)===!0&&e.push(...t.backButtonExit.filter(rT).map(sT)),()=>e.includes(window.location.hash)}var oT={__history:[],add:Ni,remove:Ni,install({$q:t}){if(this.__installed===!0)return;const{cordova:e,capacitor:n}=Ot.is;if(e!==!0&&n!==!0)return;const r=t.config[e===!0?"cordova":"capacitor"];if(r!==void 0&&r.backButton===!1||n===!0&&(window.Capacitor===void 0||window.Capacitor.Plugins.App===void 0))return;this.add=o=>{o.condition===void 0&&(o.condition=dg),this.__history.push(o)},this.remove=o=>{const a=this.__history.indexOf(o);a>=0&&this.__history.splice(a,1)};const s=iT(Object.assign({backButtonExit:!0},r)),i=()=>{if(this.__history.length){const o=this.__history[this.__history.length-1];o.condition()===!0&&(this.__history.pop(),o.handler())}else s()===!0?navigator.app.exitApp():window.history.back()};e===!0?document.addEventListener("deviceready",()=>{document.addEventListener("backbutton",i,!1)}):window.Capacitor.Plugins.App.addListener("backButton",i)}},cf={isoName:"en-US",nativeName:"English (US)",label:{clear:"Clear",ok:"OK",cancel:"Cancel",close:"Close",set:"Set",select:"Select",reset:"Reset",remove:"Remove",update:"Update",create:"Create",search:"Search",filter:"Filter",refresh:"Refresh",expand:t=>t?`Expand "${t}"`:"Expand",collapse:t=>t?`Collapse "${t}"`:"Collapse"},date:{days:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),daysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),firstDayOfWeek:0,format24h:!1,pluralDay:"days"},table:{noData:"No data available",noResults:"No matching records found",loading:"Loading...",selectedRecords:t=>t===1?"1 record selected.":(t===0?"No":t)+" records selected.",recordsPerPage:"Records per page:",allRows:"All",pagination:(t,e,n)=>t+"-"+e+" of "+n,columns:"Columns"},editor:{url:"URL",bold:"Bold",italic:"Italic",strikethrough:"Strikethrough",underline:"Underline",unorderedList:"Unordered List",orderedList:"Ordered List",subscript:"Subscript",superscript:"Superscript",hyperlink:"Hyperlink",toggleFullscreen:"Toggle Fullscreen",quote:"Quote",left:"Left align",center:"Center align",right:"Right align",justify:"Justify align",print:"Print",outdent:"Decrease indentation",indent:"Increase indentation",removeFormat:"Remove formatting",formatting:"Formatting",fontSize:"Font Size",align:"Align",hr:"Insert Horizontal Rule",undo:"Undo",redo:"Redo",heading1:"Heading 1",heading2:"Heading 2",heading3:"Heading 3",heading4:"Heading 4",heading5:"Heading 5",heading6:"Heading 6",paragraph:"Paragraph",code:"Code",size1:"Very small",size2:"A bit small",size3:"Normal",size4:"Medium-large",size5:"Big",size6:"Very big",size7:"Maximum",defaultFont:"Default Font",viewSource:"View Source"},tree:{noNodes:"No nodes available",noResults:"No matching nodes found"}};function uf(){const t=Array.isArray(navigator.languages)===!0&&navigator.languages.length!==0?navigator.languages[0]:navigator.language;if(typeof t=="string")return t.split(/[-_]/).map((e,n)=>n===0?e.toLowerCase():n>1||e.length<4?e.toUpperCase():e[0].toUpperCase()+e.slice(1).toLowerCase()).join("-")}const Bt=tc({__langPack:{}},{getLocale:uf,set(t=cf,e){const n={...t,rtl:t.rtl===!0,getLocale:uf};{if(n.set=Bt.set,Bt.__langConfig===void 0||Bt.__langConfig.noHtmlAttrs!==!0){const r=document.documentElement;r.setAttribute("dir",n.rtl===!0?"rtl":"ltr"),r.setAttribute("lang",n.isoName)}Object.assign(Bt.__langPack,n),Bt.props=n,Bt.isoName=n.isoName,Bt.nativeName=n.nativeName}},install({$q:t,lang:e,ssrContext:n}){t.lang=Bt.__langPack,Bt.__langConfig=t.config.lang,this.__installed===!0?e!==void 0&&this.set(e):this.set(e||cf)}});function aT(t,e,n=document.body){if(typeof t!="string")throw new TypeError("Expected a string as propName");if(typeof e!="string")throw new TypeError("Expected a string as value");if(!(n instanceof Element))throw new TypeError("Expected a DOM element");n.style.setProperty(`--q-${t}`,e)}let fg=!1;function cT(t){fg=t.isComposing===!0}function uT(t){return fg===!0||t!==Object(t)||t.isComposing===!0||t.qKeyEvent===!0}function mV(t,e){return uT(t)===!0?!1:[].concat(e).includes(t.keyCode)}function mg(t){if(t.ios===!0)return"ios";if(t.android===!0)return"android"}function lT({is:t,has:e,within:n},r){const s=[t.desktop===!0?"desktop":"mobile",`${e.touch===!1?"no-":""}touch`];if(t.mobile===!0){const i=mg(t);i!==void 0&&s.push("platform-"+i)}if(t.nativeMobile===!0){const i=t.nativeMobileWrapper;s.push(i),s.push("native-mobile"),t.ios===!0&&(r[i]===void 0||r[i].iosStatusBarPadding!==!1)&&s.push("q-ios-padding")}else t.electron===!0?s.push("electron"):t.bex===!0&&s.push("bex");return n.iframe===!0&&s.push("within-iframe"),s}function hT(){const{is:t}=Ot,e=document.body.className,n=new Set(e.replace(/ {2}/g," ").split(" "));if(ec!==void 0)n.delete("desktop"),n.add("platform-ios"),n.add("mobile");else if(t.nativeMobile!==!0&&t.electron!==!0&&t.bex!==!0){if(t.desktop===!0)n.delete("mobile"),n.delete("platform-ios"),n.delete("platform-android"),n.add("desktop");else if(t.mobile===!0){n.delete("desktop"),n.add("mobile");const s=mg(t);s!==void 0?(n.add(`platform-${s}`),n.delete(`platform-${s==="ios"?"android":"ios"}`)):(n.delete("platform-ios"),n.delete("platform-android"))}}Ot.has.touch===!0&&(n.delete("no-touch"),n.add("touch")),Ot.within.iframe===!0&&n.add("within-iframe");const r=Array.from(n).join(" ");e!==r&&(document.body.className=r)}function dT(t){for(const e in t)aT(e,t[e])}var fT={install(t){if(this.__installed!==!0){if(xr.value===!0)hT();else{const{$q:e}=t;e.config.brand!==void 0&&dT(e.config.brand);const n=lT(Ot,e.config);document.body.classList.add.apply(document.body.classList,n)}Ot.is.ios===!0&&document.body.addEventListener("touchstart",Ni),window.addEventListener("keydown",cT,!0)}}},mT={name:"material-icons",type:{positive:"check_circle",negative:"warning",info:"info",warning:"priority_high"},arrow:{up:"arrow_upward",right:"arrow_forward",down:"arrow_downward",left:"arrow_back",dropdown:"arrow_drop_down"},chevron:{left:"chevron_left",right:"chevron_right"},colorPicker:{spectrum:"gradient",tune:"tune",palette:"style"},pullToRefresh:{icon:"refresh"},carousel:{left:"chevron_left",right:"chevron_right",up:"keyboard_arrow_up",down:"keyboard_arrow_down",navigationIcon:"lens"},chip:{remove:"cancel",selected:"check"},datetime:{arrowLeft:"chevron_left",arrowRight:"chevron_right",now:"access_time",today:"today"},editor:{bold:"format_bold",italic:"format_italic",strikethrough:"strikethrough_s",underline:"format_underlined",unorderedList:"format_list_bulleted",orderedList:"format_list_numbered",subscript:"vertical_align_bottom",superscript:"vertical_align_top",hyperlink:"link",toggleFullscreen:"fullscreen",quote:"format_quote",left:"format_align_left",center:"format_align_center",right:"format_align_right",justify:"format_align_justify",print:"print",outdent:"format_indent_decrease",indent:"format_indent_increase",removeFormat:"format_clear",formatting:"text_format",fontSize:"format_size",align:"format_align_left",hr:"remove",undo:"undo",redo:"redo",heading:"format_size",code:"code",size:"format_size",font:"font_download",viewSource:"code"},expansionItem:{icon:"keyboard_arrow_down",denseIcon:"arrow_drop_down"},fab:{icon:"add",activeIcon:"close"},field:{clear:"cancel",error:"error"},pagination:{first:"first_page",prev:"keyboard_arrow_left",next:"keyboard_arrow_right",last:"last_page"},rating:{icon:"grade"},stepper:{done:"check",active:"edit",error:"warning"},tabs:{left:"chevron_left",right:"chevron_right",up:"keyboard_arrow_up",down:"keyboard_arrow_down"},table:{arrowUp:"arrow_upward",warning:"warning",firstPage:"first_page",prevPage:"chevron_left",nextPage:"chevron_right",lastPage:"last_page"},tree:{icon:"play_arrow"},uploader:{done:"done",clear:"clear",add:"add_box",upload:"cloud_upload",removeQueue:"clear_all",removeUploaded:"done_all"}};const pa=tc({iconMapFn:null,__icons:{}},{set(t,e){const n={...t,rtl:t.rtl===!0};n.set=pa.set,Object.assign(pa.__icons,n)},install({$q:t,iconSet:e,ssrContext:n}){t.config.iconMapFn!==void 0&&(this.iconMapFn=t.config.iconMapFn),t.iconSet=this.__icons,Wl(t,"iconMapFn",()=>this.iconMapFn,r=>{this.iconMapFn=r}),this.__installed===!0?e!==void 0&&this.set(e):this.set(e||mT)}}),pT="_q_",pV="_q_l_",gV="_q_pc_",_V=()=>{},lf={};let pg=!1;function gT(){pg=!0}function hf(t){return t!==null&&typeof t=="object"&&Array.isArray(t)!==!0}const df=[Ou,fT,lt,nT,oT,Bt,pa];function ff(t,e){e.forEach(n=>{n.install(t),n.__installed=!0})}function _T(t,e,n){t.config.globalProperties.$q=n.$q,t.provide(pT,n.$q),ff(n,df),e.components!==void 0&&Object.values(e.components).forEach(r=>{hf(r)===!0&&r.name!==void 0&&t.component(r.name,r)}),e.directives!==void 0&&Object.values(e.directives).forEach(r=>{hf(r)===!0&&r.name!==void 0&&t.directive(r.name,r)}),e.plugins!==void 0&&ff(n,Object.values(e.plugins).filter(r=>typeof r.install=="function"&&df.includes(r)===!1)),xr.value===!0&&(n.$q.onSSRHydrated=()=>{n.onSSRHydrated.forEach(r=>{r()}),n.$q.onSSRHydrated=()=>{}})}var yT=function(t,e={}){const n={version:"2.12.3"};pg===!1?(e.config!==void 0&&Object.assign(lf,e.config),n.config={...lf},gT()):n.config=e.config||{},_T(t,e,{parentApp:t,$q:n,lang:e.lang,iconSet:e.iconSet,onSSRHydrated:[]})},vT={version:"2.12.3",install:yT,lang:Bt,iconSet:pa},ET=(t,e)=>{const n=t.__vccOpts||t;for(const[r,s]of e)n[r]=s;return n};const IT=jl({name:"App"});function wT(t,e,n,r,s,i){const o=BI("router-view");return ng(),sg(o)}var TT=ET(IT,[["render",wT]]);function yV(t){return t}var AT=!1;/*!
  * pinia v2.1.4
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */let gg;const nc=t=>gg=t,_g=Symbol();function Mu(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var _i;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(_i||(_i={}));function bT(){const t=fp(!0),e=t.run(()=>Ga({}));let n=[],r=[];const s=ao({install(i){nc(s),s._a=i,i.provide(_g,s),i.config.globalProperties.$pinia=s,r.forEach(o=>n.push(o)),r=[]},use(i){return!this._a&&!AT?r.push(i):n.push(i),this},_p:n,_a:null,_e:t,_s:new Map,state:e});return s}const yg=()=>{};function mf(t,e,n,r=yg){t.push(e);const s=()=>{const i=t.indexOf(e);i>-1&&(t.splice(i,1),r())};return!n&&mp()&&xE(s),s}function Jr(t,...e){t.slice().forEach(n=>{n(...e)})}const RT=t=>t();function Fu(t,e){t instanceof Map&&e instanceof Map&&e.forEach((n,r)=>t.set(r,n)),t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const n in e){if(!e.hasOwnProperty(n))continue;const r=e[n],s=t[n];Mu(s)&&Mu(r)&&t.hasOwnProperty(n)&&!Ue(r)&&!Bn(r)?t[n]=Fu(s,r):t[n]=r}return t}const PT=Symbol();function ST(t){return!Mu(t)||!t.hasOwnProperty(PT)}const{assign:xn}=Object;function CT(t){return!!(Ue(t)&&t.effect)}function xT(t,e,n,r){const{state:s,actions:i,getters:o}=e,a=n.state.value[t];let c;function u(){a||(n.state.value[t]=s?s():{});const l=aI(n.state.value[t]);return xn(l,i,Object.keys(o||{}).reduce((h,d)=>(h[d]=ao(kt(()=>{nc(n);const f=n._s.get(t);return o[d].call(f,f)})),h),{}))}return c=vg(t,u,e,n,r,!0),c}function vg(t,e,n={},r,s,i){let o;const a=xn({actions:{}},n),c={deep:!0};let u,l,h=[],d=[],f;const g=r.state.value[t];!i&&!g&&(r.state.value[t]={}),Ga({});let v;function I(B){let W;u=l=!1,typeof B=="function"?(B(r.state.value[t]),W={type:_i.patchFunction,storeId:t,events:f}):(Fu(r.state.value[t],B),W={type:_i.patchObject,payload:B,storeId:t,events:f});const re=v=Symbol();ql().then(()=>{v===re&&(u=!0)}),l=!0,Jr(h,W,r.state.value[t])}const A=i?function(){const{state:W}=n,re=W?W():{};this.$patch(Te=>{xn(Te,re)})}:yg;function R(){o.stop(),h=[],d=[],r._s.delete(t)}function V(B,W){return function(){nc(r);const re=Array.from(arguments),Te=[],z=[];function pe(le){Te.push(le)}function rt(le){z.push(le)}Jr(d,{args:re,name:B,store:j,after:pe,onError:rt});let gt;try{gt=W.apply(this&&this.$id===t?this:j,re)}catch(le){throw Jr(z,le),le}return gt instanceof Promise?gt.then(le=>(Jr(Te,le),le)).catch(le=>(Jr(z,le),Promise.reject(le))):(Jr(Te,gt),gt)}}const D={_p:r,$id:t,$onAction:mf.bind(null,d),$patch:I,$reset:A,$subscribe(B,W={}){const re=mf(h,B,W.detached,()=>Te()),Te=o.run(()=>mi(()=>r.state.value[t],z=>{(W.flush==="sync"?l:u)&&B({storeId:t,type:_i.direct,events:f},z)},xn({},c,W)));return re},$dispose:R},j=qr(D);r._s.set(t,j);const X=r._a&&r._a.runWithContext||RT,oe=r._e.run(()=>(o=fp(),X(()=>o.run(e))));for(const B in oe){const W=oe[B];if(Ue(W)&&!CT(W)||Bn(W))i||(g&&ST(W)&&(Ue(W)?W.value=g[B]:Fu(W,g[B])),r.state.value[t][B]=W);else if(typeof W=="function"){const re=V(B,W);oe[B]=re,a.actions[B]=W}}return xn(j,oe),xn(fe(j),oe),Object.defineProperty(j,"$state",{get:()=>r.state.value[t],set:B=>{I(W=>{xn(W,B)})}}),r._p.forEach(B=>{xn(j,o.run(()=>B({store:j,app:r._a,pinia:r,options:a})))}),g&&i&&n.hydrate&&n.hydrate(j.$state,g),u=!0,l=!0,j}function vV(t,e,n){let r,s;const i=typeof e=="function";typeof t=="string"?(r=t,s=i?n:e):(s=t,r=t.id);function o(a,c){const u=JI();return a=a||(u?on(_g,null):null),a&&nc(a),a=gg,a._s.has(r)||(i?vg(r,e,s,a):xT(r,s,a)),a._s.get(r)}return o.$id=r,o}var Xc=()=>bT();/*!
  * vue-router v4.2.4
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const es=typeof window!="undefined";function VT(t){return t.__esModule||t[Symbol.toStringTag]==="Module"}const ve=Object.assign;function Zc(t,e){const n={};for(const r in e){const s=e[r];n[r]=Gt(s)?s.map(t):t(s)}return n}const yi=()=>{},Gt=Array.isArray,DT=/\/$/,kT=t=>t.replace(DT,"");function eu(t,e,n="/"){let r,s={},i="",o="";const a=e.indexOf("#");let c=e.indexOf("?");return a<c&&a>=0&&(c=-1),c>-1&&(r=e.slice(0,c),i=e.slice(c+1,a>-1?a:e.length),s=t(i)),a>-1&&(r=r||e.slice(0,a),o=e.slice(a,e.length)),r=FT(r!=null?r:e,n),{fullPath:r+(i&&"?")+i+o,path:r,query:s,hash:o}}function NT(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function pf(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function OT(t,e,n){const r=e.matched.length-1,s=n.matched.length-1;return r>-1&&r===s&&gs(e.matched[r],n.matched[s])&&Eg(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function gs(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function Eg(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!MT(t[n],e[n]))return!1;return!0}function MT(t,e){return Gt(t)?gf(t,e):Gt(e)?gf(e,t):t===e}function gf(t,e){return Gt(e)?t.length===e.length&&t.every((n,r)=>n===e[r]):t.length===1&&t[0]===e}function FT(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),r=t.split("/"),s=r[r.length-1];(s===".."||s===".")&&r.push("");let i=n.length-1,o,a;for(o=0;o<r.length;o++)if(a=r[o],a!==".")if(a==="..")i>1&&i--;else break;return n.slice(0,i).join("/")+"/"+r.slice(o-(o===r.length?1:0)).join("/")}var Oi;(function(t){t.pop="pop",t.push="push"})(Oi||(Oi={}));var vi;(function(t){t.back="back",t.forward="forward",t.unknown=""})(vi||(vi={}));function LT(t){if(!t)if(es){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),kT(t)}const BT=/^[^#]+#/;function UT(t,e){return t.replace(BT,"#")+e}function qT(t,e){const n=document.documentElement.getBoundingClientRect(),r=t.getBoundingClientRect();return{behavior:e.behavior,left:r.left-n.left-(e.left||0),top:r.top-n.top-(e.top||0)}}const rc=()=>({left:window.pageXOffset,top:window.pageYOffset});function $T(t){let e;if("el"in t){const n=t.el,r=typeof n=="string"&&n.startsWith("#"),s=typeof n=="string"?r?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!s)return;e=qT(s,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function _f(t,e){return(history.state?history.state.position-e:-1)+t}const Lu=new Map;function jT(t,e){Lu.set(t,e)}function zT(t){const e=Lu.get(t);return Lu.delete(t),e}let KT=()=>location.protocol+"//"+location.host;function Ig(t,e){const{pathname:n,search:r,hash:s}=e,i=t.indexOf("#");if(i>-1){let a=s.includes(t.slice(i))?t.slice(i).length:1,c=s.slice(a);return c[0]!=="/"&&(c="/"+c),pf(c,"")}return pf(n,t)+r+s}function GT(t,e,n,r){let s=[],i=[],o=null;const a=({state:d})=>{const f=Ig(t,location),g=n.value,v=e.value;let I=0;if(d){if(n.value=f,e.value=d,o&&o===g){o=null;return}I=v?d.position-v.position:0}else r(f);s.forEach(A=>{A(n.value,g,{delta:I,type:Oi.pop,direction:I?I>0?vi.forward:vi.back:vi.unknown})})};function c(){o=n.value}function u(d){s.push(d);const f=()=>{const g=s.indexOf(d);g>-1&&s.splice(g,1)};return i.push(f),f}function l(){const{history:d}=window;!d.state||d.replaceState(ve({},d.state,{scroll:rc()}),"")}function h(){for(const d of i)d();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",l)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",l,{passive:!0}),{pauseListeners:c,listen:u,destroy:h}}function yf(t,e,n,r=!1,s=!1){return{back:t,current:e,forward:n,replaced:r,position:window.history.length,scroll:s?rc():null}}function HT(t){const{history:e,location:n}=window,r={value:Ig(t,n)},s={value:e.state};s.value||i(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(c,u,l){const h=t.indexOf("#"),d=h>-1?(n.host&&document.querySelector("base")?t:t.slice(h))+c:KT()+t+c;try{e[l?"replaceState":"pushState"](u,"",d),s.value=u}catch(f){console.error(f),n[l?"replace":"assign"](d)}}function o(c,u){const l=ve({},e.state,yf(s.value.back,c,s.value.forward,!0),u,{position:s.value.position});i(c,l,!0),r.value=c}function a(c,u){const l=ve({},s.value,e.state,{forward:c,scroll:rc()});i(l.current,l,!0);const h=ve({},yf(r.value,c,null),{position:l.position+1},u);i(c,h,!1),r.value=c}return{location:r,state:s,push:a,replace:o}}function QT(t){t=LT(t);const e=HT(t),n=GT(t,e.state,e.location,e.replace);function r(i,o=!0){o||n.pauseListeners(),history.go(i)}const s=ve({location:"",base:t,go:r,createHref:UT.bind(null,t)},e,n);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function WT(t){return t=location.host?t||location.pathname+location.search:"",t.includes("#")||(t+="#"),QT(t)}function JT(t){return typeof t=="string"||t&&typeof t=="object"}function wg(t){return typeof t=="string"||typeof t=="symbol"}const Pn={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},Tg=Symbol("");var vf;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(vf||(vf={}));function _s(t,e){return ve(new Error,{type:t,[Tg]:!0},e)}function hn(t,e){return t instanceof Error&&Tg in t&&(e==null||!!(t.type&e))}const Ef="[^/]+?",YT={sensitive:!1,strict:!1,start:!0,end:!0},XT=/[.+*?^${}()[\]/\\]/g;function ZT(t,e){const n=ve({},YT,e),r=[];let s=n.start?"^":"";const i=[];for(const u of t){const l=u.length?[]:[90];n.strict&&!u.length&&(s+="/");for(let h=0;h<u.length;h++){const d=u[h];let f=40+(n.sensitive?.25:0);if(d.type===0)h||(s+="/"),s+=d.value.replace(XT,"\\$&"),f+=40;else if(d.type===1){const{value:g,repeatable:v,optional:I,regexp:A}=d;i.push({name:g,repeatable:v,optional:I});const R=A||Ef;if(R!==Ef){f+=10;try{new RegExp(`(${R})`)}catch(D){throw new Error(`Invalid custom RegExp for param "${g}" (${R}): `+D.message)}}let V=v?`((?:${R})(?:/(?:${R}))*)`:`(${R})`;h||(V=I&&u.length<2?`(?:/${V})`:"/"+V),I&&(V+="?"),s+=V,f+=20,I&&(f+=-8),v&&(f+=-20),R===".*"&&(f+=-50)}l.push(f)}r.push(l)}if(n.strict&&n.end){const u=r.length-1;r[u][r[u].length-1]+=.7000000000000001}n.strict||(s+="/?"),n.end?s+="$":n.strict&&(s+="(?:/|$)");const o=new RegExp(s,n.sensitive?"":"i");function a(u){const l=u.match(o),h={};if(!l)return null;for(let d=1;d<l.length;d++){const f=l[d]||"",g=i[d-1];h[g.name]=f&&g.repeatable?f.split("/"):f}return h}function c(u){let l="",h=!1;for(const d of t){(!h||!l.endsWith("/"))&&(l+="/"),h=!1;for(const f of d)if(f.type===0)l+=f.value;else if(f.type===1){const{value:g,repeatable:v,optional:I}=f,A=g in u?u[g]:"";if(Gt(A)&&!v)throw new Error(`Provided param "${g}" is an array but it is not repeatable (* or + modifiers)`);const R=Gt(A)?A.join("/"):A;if(!R)if(I)d.length<2&&(l.endsWith("/")?l=l.slice(0,-1):h=!0);else throw new Error(`Missing required param "${g}"`);l+=R}}return l||"/"}return{re:o,score:r,keys:i,parse:a,stringify:c}}function eA(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=e[n]-t[n];if(r)return r;n++}return t.length<e.length?t.length===1&&t[0]===40+40?-1:1:t.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function tA(t,e){let n=0;const r=t.score,s=e.score;for(;n<r.length&&n<s.length;){const i=eA(r[n],s[n]);if(i)return i;n++}if(Math.abs(s.length-r.length)===1){if(If(r))return 1;if(If(s))return-1}return s.length-r.length}function If(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const nA={type:0,value:""},rA=/[a-zA-Z0-9_]/;function sA(t){if(!t)return[[]];if(t==="/")return[[nA]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(f){throw new Error(`ERR (${n})/"${u}": ${f}`)}let n=0,r=n;const s=[];let i;function o(){i&&s.push(i),i=[]}let a=0,c,u="",l="";function h(){!u||(n===0?i.push({type:0,value:u}):n===1||n===2||n===3?(i.length>1&&(c==="*"||c==="+")&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:u,regexp:l,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):e("Invalid state to consume buffer"),u="")}function d(){u+=c}for(;a<t.length;){if(c=t[a++],c==="\\"&&n!==2){r=n,n=4;continue}switch(n){case 0:c==="/"?(u&&h(),o()):c===":"?(h(),n=1):d();break;case 4:d(),n=r;break;case 1:c==="("?n=2:rA.test(c)?d():(h(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--);break;case 2:c===")"?l[l.length-1]=="\\"?l=l.slice(0,-1)+c:n=3:l+=c;break;case 3:h(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--,l="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${u}"`),h(),o(),s}function iA(t,e,n){const r=ZT(sA(t.path),n),s=ve(r,{record:t,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function oA(t,e){const n=[],r=new Map;e=Af({strict:!1,end:!0,sensitive:!1},e);function s(l){return r.get(l)}function i(l,h,d){const f=!d,g=aA(l);g.aliasOf=d&&d.record;const v=Af(e,l),I=[g];if("alias"in l){const V=typeof l.alias=="string"?[l.alias]:l.alias;for(const D of V)I.push(ve({},g,{components:d?d.record.components:g.components,path:D,aliasOf:d?d.record:g}))}let A,R;for(const V of I){const{path:D}=V;if(h&&D[0]!=="/"){const j=h.record.path,X=j[j.length-1]==="/"?"":"/";V.path=h.record.path+(D&&X+D)}if(A=iA(V,h,v),d?d.alias.push(A):(R=R||A,R!==A&&R.alias.push(A),f&&l.name&&!Tf(A)&&o(l.name)),g.children){const j=g.children;for(let X=0;X<j.length;X++)i(j[X],A,d&&d.children[X])}d=d||A,(A.record.components&&Object.keys(A.record.components).length||A.record.name||A.record.redirect)&&c(A)}return R?()=>{o(R)}:yi}function o(l){if(wg(l)){const h=r.get(l);h&&(r.delete(l),n.splice(n.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=n.indexOf(l);h>-1&&(n.splice(h,1),l.record.name&&r.delete(l.record.name),l.children.forEach(o),l.alias.forEach(o))}}function a(){return n}function c(l){let h=0;for(;h<n.length&&tA(l,n[h])>=0&&(l.record.path!==n[h].record.path||!Ag(l,n[h]));)h++;n.splice(h,0,l),l.record.name&&!Tf(l)&&r.set(l.record.name,l)}function u(l,h){let d,f={},g,v;if("name"in l&&l.name){if(d=r.get(l.name),!d)throw _s(1,{location:l});v=d.record.name,f=ve(wf(h.params,d.keys.filter(R=>!R.optional).map(R=>R.name)),l.params&&wf(l.params,d.keys.map(R=>R.name))),g=d.stringify(f)}else if("path"in l)g=l.path,d=n.find(R=>R.re.test(g)),d&&(f=d.parse(g),v=d.record.name);else{if(d=h.name?r.get(h.name):n.find(R=>R.re.test(h.path)),!d)throw _s(1,{location:l,currentLocation:h});v=d.record.name,f=ve({},h.params,l.params),g=d.stringify(f)}const I=[];let A=d;for(;A;)I.unshift(A.record),A=A.parent;return{name:v,path:g,params:f,matched:I,meta:uA(I)}}return t.forEach(l=>i(l)),{addRoute:i,resolve:u,removeRoute:o,getRoutes:a,getRecordMatcher:s}}function wf(t,e){const n={};for(const r of e)r in t&&(n[r]=t[r]);return n}function aA(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:cA(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}}}function cA(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const r in t.components)e[r]=typeof n=="object"?n[r]:n;return e}function Tf(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function uA(t){return t.reduce((e,n)=>ve(e,n.meta),{})}function Af(t,e){const n={};for(const r in t)n[r]=r in e?e[r]:t[r];return n}function Ag(t,e){return e.children.some(n=>n===t||Ag(t,n))}const bg=/#/g,lA=/&/g,hA=/\//g,dA=/=/g,fA=/\?/g,Rg=/\+/g,mA=/%5B/g,pA=/%5D/g,Pg=/%5E/g,gA=/%60/g,Sg=/%7B/g,_A=/%7C/g,Cg=/%7D/g,yA=/%20/g;function Jl(t){return encodeURI(""+t).replace(_A,"|").replace(mA,"[").replace(pA,"]")}function vA(t){return Jl(t).replace(Sg,"{").replace(Cg,"}").replace(Pg,"^")}function Bu(t){return Jl(t).replace(Rg,"%2B").replace(yA,"+").replace(bg,"%23").replace(lA,"%26").replace(gA,"`").replace(Sg,"{").replace(Cg,"}").replace(Pg,"^")}function EA(t){return Bu(t).replace(dA,"%3D")}function IA(t){return Jl(t).replace(bg,"%23").replace(fA,"%3F")}function wA(t){return t==null?"":IA(t).replace(hA,"%2F")}function ga(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function TA(t){const e={};if(t===""||t==="?")return e;const r=(t[0]==="?"?t.slice(1):t).split("&");for(let s=0;s<r.length;++s){const i=r[s].replace(Rg," "),o=i.indexOf("="),a=ga(o<0?i:i.slice(0,o)),c=o<0?null:ga(i.slice(o+1));if(a in e){let u=e[a];Gt(u)||(u=e[a]=[u]),u.push(c)}else e[a]=c}return e}function bf(t){let e="";for(let n in t){const r=t[n];if(n=EA(n),r==null){r!==void 0&&(e+=(e.length?"&":"")+n);continue}(Gt(r)?r.map(i=>i&&Bu(i)):[r&&Bu(r)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+n,i!=null&&(e+="="+i))})}return e}function AA(t){const e={};for(const n in t){const r=t[n];r!==void 0&&(e[n]=Gt(r)?r.map(s=>s==null?null:""+s):r==null?r:""+r)}return e}const bA=Symbol(""),Rf=Symbol(""),Yl=Symbol(""),xg=Symbol(""),Uu=Symbol("");function Xs(){let t=[];function e(r){return t.push(r),()=>{const s=t.indexOf(r);s>-1&&t.splice(s,1)}}function n(){t=[]}return{add:e,list:()=>t.slice(),reset:n}}function Dn(t,e,n,r,s){const i=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise((o,a)=>{const c=h=>{h===!1?a(_s(4,{from:n,to:e})):h instanceof Error?a(h):JT(h)?a(_s(2,{from:e,to:h})):(i&&r.enterCallbacks[s]===i&&typeof h=="function"&&i.push(h),o())},u=t.call(r&&r.instances[s],e,n,c);let l=Promise.resolve(u);t.length<3&&(l=l.then(c)),l.catch(h=>a(h))})}function tu(t,e,n,r){const s=[];for(const i of t)for(const o in i.components){let a=i.components[o];if(!(e!=="beforeRouteEnter"&&!i.instances[o]))if(RA(a)){const u=(a.__vccOpts||a)[e];u&&s.push(Dn(u,n,r,i,o))}else{let c=a();s.push(()=>c.then(u=>{if(!u)return Promise.reject(new Error(`Couldn't resolve component "${o}" at "${i.path}"`));const l=VT(u)?u.default:u;i.components[o]=l;const d=(l.__vccOpts||l)[e];return d&&Dn(d,n,r,i,o)()}))}}return s}function RA(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function Pf(t){const e=on(Yl),n=on(xg),r=kt(()=>e.resolve(os(t.to))),s=kt(()=>{const{matched:c}=r.value,{length:u}=c,l=c[u-1],h=n.matched;if(!l||!h.length)return-1;const d=h.findIndex(gs.bind(null,l));if(d>-1)return d;const f=Sf(c[u-2]);return u>1&&Sf(l)===f&&h[h.length-1].path!==f?h.findIndex(gs.bind(null,c[u-2])):d}),i=kt(()=>s.value>-1&&xA(n.params,r.value.params)),o=kt(()=>s.value>-1&&s.value===n.matched.length-1&&Eg(n.params,r.value.params));function a(c={}){return CA(c)?e[os(t.replace)?"replace":"push"](os(t.to)).catch(yi):Promise.resolve()}return{route:r,href:kt(()=>r.value.href),isActive:i,isExactActive:o,navigate:a}}const PA=jl({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Pf,setup(t,{slots:e}){const n=qr(Pf(t)),{options:r}=on(Yl),s=kt(()=>({[Cf(t.activeClass,r.linkActiveClass,"router-link-active")]:n.isActive,[Cf(t.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=e.default&&e.default(n);return t.custom?i:Ql("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:s.value},i)}}}),SA=PA;function CA(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function xA(t,e){for(const n in e){const r=e[n],s=t[n];if(typeof r=="string"){if(r!==s)return!1}else if(!Gt(s)||s.length!==r.length||r.some((i,o)=>i!==s[o]))return!1}return!0}function Sf(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const Cf=(t,e,n)=>t!=null?t:e!=null?e:n,VA=jl({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const r=on(Uu),s=kt(()=>t.route||r.value),i=on(Rf,0),o=kt(()=>{let u=os(i);const{matched:l}=s.value;let h;for(;(h=l[u])&&!h.components;)u++;return u}),a=kt(()=>s.value.matched[o.value]);Zo(Rf,kt(()=>o.value+1)),Zo(bA,a),Zo(Uu,s);const c=Ga();return mi(()=>[c.value,a.value,t.name],([u,l,h],[d,f,g])=>{l&&(l.instances[h]=u,f&&f!==l&&u&&u===d&&(l.leaveGuards.size||(l.leaveGuards=f.leaveGuards),l.updateGuards.size||(l.updateGuards=f.updateGuards))),u&&l&&(!f||!gs(l,f)||!d)&&(l.enterCallbacks[h]||[]).forEach(v=>v(u))},{flush:"post"}),()=>{const u=s.value,l=t.name,h=a.value,d=h&&h.components[l];if(!d)return xf(n.default,{Component:d,route:u});const f=h.props[l],g=f?f===!0?u.params:typeof f=="function"?f(u):f:null,I=Ql(d,ve({},g,e,{onVnodeUnmounted:A=>{A.component.isUnmounted&&(h.instances[l]=null)},ref:c}));return xf(n.default,{Component:I,route:u})||I}}});function xf(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const DA=VA;function kA(t){const e=oA(t.routes,t),n=t.parseQuery||TA,r=t.stringifyQuery||bf,s=t.history,i=Xs(),o=Xs(),a=Xs(),c=sI(Pn);let u=Pn;es&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const l=Zc.bind(null,T=>""+T),h=Zc.bind(null,wA),d=Zc.bind(null,ga);function f(T,$){let F,Q;return wg(T)?(F=e.getRecordMatcher(T),Q=$):Q=T,e.addRoute(Q,F)}function g(T){const $=e.getRecordMatcher(T);$&&e.removeRoute($)}function v(){return e.getRoutes().map(T=>T.record)}function I(T){return!!e.getRecordMatcher(T)}function A(T,$){if($=ve({},$||c.value),typeof T=="string"){const _=eu(n,T,$.path),w=e.resolve({path:_.path},$),P=s.createHref(_.fullPath);return ve(_,w,{params:d(w.params),hash:ga(_.hash),redirectedFrom:void 0,href:P})}let F;if("path"in T)F=ve({},T,{path:eu(n,T.path,$.path).path});else{const _=ve({},T.params);for(const w in _)_[w]==null&&delete _[w];F=ve({},T,{params:h(_)}),$.params=h($.params)}const Q=e.resolve(F,$),ye=T.hash||"";Q.params=l(d(Q.params));const m=NT(r,ve({},T,{hash:vA(ye),path:Q.path})),p=s.createHref(m);return ve({fullPath:m,hash:ye,query:r===bf?AA(T.query):T.query||{}},Q,{redirectedFrom:void 0,href:p})}function R(T){return typeof T=="string"?eu(n,T,c.value.path):ve({},T)}function V(T,$){if(u!==T)return _s(8,{from:$,to:T})}function D(T){return oe(T)}function j(T){return D(ve(R(T),{replace:!0}))}function X(T){const $=T.matched[T.matched.length-1];if($&&$.redirect){const{redirect:F}=$;let Q=typeof F=="function"?F(T):F;return typeof Q=="string"&&(Q=Q.includes("?")||Q.includes("#")?Q=R(Q):{path:Q},Q.params={}),ve({query:T.query,hash:T.hash,params:"path"in Q?{}:T.params},Q)}}function oe(T,$){const F=u=A(T),Q=c.value,ye=T.state,m=T.force,p=T.replace===!0,_=X(F);if(_)return oe(ve(R(_),{state:typeof _=="object"?ve({},ye,_.state):ye,force:m,replace:p}),$||F);const w=F;w.redirectedFrom=$;let P;return!m&&OT(r,Q,F)&&(P=_s(16,{to:w,from:Q}),Qt(Q,Q,!0,!1)),(P?Promise.resolve(P):re(w,Q)).catch(C=>hn(C)?hn(C,2)?C:Tn(C):_e(C,w,Q)).then(C=>{if(C){if(hn(C,2))return oe(ve({replace:p},R(C.to),{state:typeof C.to=="object"?ve({},ye,C.to.state):ye,force:m}),$||w)}else C=z(w,Q,!0,p,ye);return Te(w,Q,C),C})}function B(T,$){const F=V(T,$);return F?Promise.reject(F):Promise.resolve()}function W(T){const $=Hr.values().next().value;return $&&typeof $.runWithContext=="function"?$.runWithContext(T):T()}function re(T,$){let F;const[Q,ye,m]=NA(T,$);F=tu(Q.reverse(),"beforeRouteLeave",T,$);for(const _ of Q)_.leaveGuards.forEach(w=>{F.push(Dn(w,T,$))});const p=B.bind(null,T,$);return F.push(p),ct(F).then(()=>{F=[];for(const _ of i.list())F.push(Dn(_,T,$));return F.push(p),ct(F)}).then(()=>{F=tu(ye,"beforeRouteUpdate",T,$);for(const _ of ye)_.updateGuards.forEach(w=>{F.push(Dn(w,T,$))});return F.push(p),ct(F)}).then(()=>{F=[];for(const _ of m)if(_.beforeEnter)if(Gt(_.beforeEnter))for(const w of _.beforeEnter)F.push(Dn(w,T,$));else F.push(Dn(_.beforeEnter,T,$));return F.push(p),ct(F)}).then(()=>(T.matched.forEach(_=>_.enterCallbacks={}),F=tu(m,"beforeRouteEnter",T,$),F.push(p),ct(F))).then(()=>{F=[];for(const _ of o.list())F.push(Dn(_,T,$));return F.push(p),ct(F)}).catch(_=>hn(_,8)?_:Promise.reject(_))}function Te(T,$,F){a.list().forEach(Q=>W(()=>Q(T,$,F)))}function z(T,$,F,Q,ye){const m=V(T,$);if(m)return m;const p=$===Pn,_=es?history.state:{};F&&(Q||p?s.replace(T.fullPath,ve({scroll:p&&_&&_.scroll},ye)):s.push(T.fullPath,ye)),c.value=T,Qt(T,$,F,p),Tn()}let pe;function rt(){pe||(pe=s.listen((T,$,F)=>{if(!Do.listening)return;const Q=A(T),ye=X(Q);if(ye){oe(ve(ye,{replace:!0}),Q).catch(yi);return}u=Q;const m=c.value;es&&jT(_f(m.fullPath,F.delta),rc()),re(Q,m).catch(p=>hn(p,12)?p:hn(p,2)?(oe(p.to,Q).then(_=>{hn(_,20)&&!F.delta&&F.type===Oi.pop&&s.go(-1,!1)}).catch(yi),Promise.reject()):(F.delta&&s.go(-F.delta,!1),_e(p,Q,m))).then(p=>{p=p||z(Q,m,!1),p&&(F.delta&&!hn(p,8)?s.go(-F.delta,!1):F.type===Oi.pop&&hn(p,20)&&s.go(-1,!1)),Te(Q,m,p)}).catch(yi)}))}let gt=Xs(),le=Xs(),Ae;function _e(T,$,F){Tn(T);const Q=le.list();return Q.length?Q.forEach(ye=>ye(T,$,F)):console.error(T),Promise.reject(T)}function ln(){return Ae&&c.value!==Pn?Promise.resolve():new Promise((T,$)=>{gt.add([T,$])})}function Tn(T){return Ae||(Ae=!T,rt(),gt.list().forEach(([$,F])=>T?F(T):$()),gt.reset()),T}function Qt(T,$,F,Q){const{scrollBehavior:ye}=t;if(!es||!ye)return Promise.resolve();const m=!F&&zT(_f(T.fullPath,0))||(Q||!F)&&history.state&&history.state.scroll||null;return ql().then(()=>ye(T,$,m)).then(p=>p&&$T(p)).catch(p=>_e(p,T,$))}const Et=T=>s.go(T);let Gr;const Hr=new Set,Do={currentRoute:c,listening:!0,addRoute:f,removeRoute:g,hasRoute:I,getRoutes:v,resolve:A,options:t,push:D,replace:j,go:Et,back:()=>Et(-1),forward:()=>Et(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:le.add,isReady:ln,install(T){const $=this;T.component("RouterLink",SA),T.component("RouterView",DA),T.config.globalProperties.$router=$,Object.defineProperty(T.config.globalProperties,"$route",{enumerable:!0,get:()=>os(c)}),es&&!Gr&&c.value===Pn&&(Gr=!0,D(s.location).catch(ye=>{}));const F={};for(const ye in Pn)Object.defineProperty(F,ye,{get:()=>c.value[ye],enumerable:!0});T.provide(Yl,$),T.provide(xg,bp(F)),T.provide(Uu,c);const Q=T.unmount;Hr.add(T),T.unmount=function(){Hr.delete(T),Hr.size<1&&(u=Pn,pe&&pe(),pe=null,c.value=Pn,Gr=!1,Ae=!1),Q()}}};function ct(T){return T.reduce(($,F)=>$.then(()=>W(F)),Promise.resolve())}return Do}function NA(t,e){const n=[],r=[],s=[],i=Math.max(e.matched.length,t.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(t.matched.find(u=>gs(u,a))?r.push(a):n.push(a));const c=t.matched[o];c&&(e.matched.find(u=>gs(u,c))||s.push(c))}return[n,r,s]}const OA=[{path:"/",component:()=>wr(()=>import("./MainLayout.5bbd3297.js"),["assets/MainLayout.5bbd3297.js","assets/QBtn.d8b9bc0d.js","assets/use-router-link.2c420010.js","assets/QItem.cd322270.js"]),children:[{path:"",component:()=>wr(()=>import("./IndexPage.b1b23e11.js"),["assets/IndexPage.b1b23e11.js","assets/use-router-link.2c420010.js","assets/QItem.cd322270.js","assets/index.552ef081.js"])}]},{path:"/:catchAll(.*)*",component:()=>wr(()=>import("./ErrorNotFound.3b41a703.js"),["assets/ErrorNotFound.3b41a703.js","assets/QBtn.d8b9bc0d.js","assets/use-router-link.2c420010.js"])}];var nu=function(){return kA({scrollBehavior:()=>({left:0,top:0}),routes:OA,history:WT("/")})};async function MA(t,e){const n=t(TT);n.use(vT,e);const r=typeof Xc=="function"?await Xc({}):Xc;n.use(r);const s=ao(typeof nu=="function"?await nu({store:r}):nu);return r.use(({store:i})=>{i.router=s}),{app:n,store:r,router:s}}var FA={config:{}},LA=function(){return Boolean(window.location.hostname==="localhost"||window.location.hostname==="[::1]"||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/))},qu;typeof window!="undefined"&&(typeof Promise!="undefined"?qu=new Promise(function(t){return window.addEventListener("load",t)}):qu={then:function(t){return window.addEventListener("load",t)}});function BA(t,e){e===void 0&&(e={});var n=e.registrationOptions;n===void 0&&(n={}),delete e.registrationOptions;var r=function(s){for(var i=[],o=arguments.length-1;o-- >0;)i[o]=arguments[o+1];e&&e[s]&&e[s].apply(e,i)};"serviceWorker"in navigator&&qu.then(function(){LA()?(UA(t,r,n),navigator.serviceWorker.ready.then(function(s){r("ready",s)}).catch(function(s){return Mi(r,s)})):(Vg(t,r,n),navigator.serviceWorker.ready.then(function(s){r("ready",s)}).catch(function(s){return Mi(r,s)}))})}function Mi(t,e){navigator.onLine||t("offline"),t("error",e)}function Vg(t,e,n){navigator.serviceWorker.register(t,n).then(function(r){if(e("registered",r),r.waiting){e("updated",r);return}r.onupdatefound=function(){e("updatefound",r);var s=r.installing;s.onstatechange=function(){s.state==="installed"&&(navigator.serviceWorker.controller?e("updated",r):e("cached",r))}}}).catch(function(r){return Mi(e,r)})}function UA(t,e,n){fetch(t).then(function(r){r.status===404?(e("error",new Error("Service worker not found at "+t)),Vf()):r.headers.get("content-type").indexOf("javascript")===-1?(e("error",new Error("Expected "+t+" to have javascript content-type, but received "+r.headers.get("content-type"))),Vf()):Vg(t,e,n)}).catch(function(r){return Mi(e,r)})}function Vf(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()}).catch(function(t){return Mi(emit,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dg={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qA=function(t,e){if(!t)throw $A(e)},$A=function(t){return new Error("Firebase Database ("+Dg.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kg=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},jA=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Ng={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,l=i>>2,h=(i&3)<<4|a>>4;let d=(a&15)<<2|u>>6,f=u&63;c||(f=64,o||(d=64)),r.push(n[l],n[h],n[d],n[f])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(kg(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):jA(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const h=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||u==null||h==null)throw new zA;const d=i<<2|a>>4;if(r.push(d),u!==64){const f=a<<4&240|u>>2;if(r.push(f),h!==64){const g=u<<6&192|h;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class zA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const KA=function(t){const e=kg(t);return Ng.encodeByteArray(e,!0)},_a=function(t){return KA(t).replace(/\./g,"")},$u=function(t){try{return Ng.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EV(t){return Og(void 0,t)}function Og(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!GA(n)||(t[n]=Og(t[n],e[n]));return t}function GA(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HA(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QA=()=>HA().__FIREBASE_DEFAULTS__,WA=()=>{if(typeof process=="undefined"||typeof process.env=="undefined")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},JA=()=>{if(typeof document=="undefined")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&$u(t[1]);return e&&JSON.parse(e)},sc=()=>{try{return QA()||WA()||JA()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},YA=t=>{var e,n;return(n=(e=sc())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},XA=t=>{const e=YA(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Mg=()=>{var t;return(t=sc())===null||t===void 0?void 0:t.config},IV=t=>{var e;return(e=sc())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e0(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[_a(JSON.stringify(n)),_a(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fi(){return typeof navigator!="undefined"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function wV(){return typeof window!="undefined"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fi())}function t0(){var t;const e=(t=sc())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function TV(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function AV(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function bV(){const t=Fi();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function RV(){return Dg.NODE_ADMIN===!0}function n0(){return!t0()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Fg(){try{return typeof indexedDB=="object"}catch{return!1}}function r0(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}function PV(){return!(typeof navigator=="undefined"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s0="FirebaseError";class Os extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=s0,Object.setPrototypeOf(this,Os.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Lg.prototype.create)}}class Lg{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?i0(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Os(s,a,r)}}function i0(t,e){return t.replace(o0,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const o0=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Df(t){return JSON.parse(t)}function SV(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bg=function(t){let e={},n={},r={},s="";try{const i=t.split(".");e=Df($u(i[0])||""),n=Df($u(i[1])||""),s=i[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:s}},CV=function(t){const e=Bg(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},xV=function(t){const e=Bg(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VV(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function DV(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function kV(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function NV(t,e,n){const r={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=e.call(n,t[s],s,t));return r}function Li(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(kf(i)&&kf(o)){if(!Li(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function kf(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OV(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MV{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let h=0;h<16;h++)r[h]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let h=16;h<80;h++){const d=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(d<<1|d>>>31)&4294967295}let s=this.chain_[0],i=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],u,l;for(let h=0;h<80;h++){h<40?h<20?(u=a^i&(o^a),l=1518500249):(u=i^o^a,l=1859775393):h<60?(u=i&o|a&(i|o),l=2400959708):(u=i^o^a,l=3395469782);const d=(s<<5|s>>>27)+u+c+l+r[h]&4294967295;c=a,a=o,o=(i<<30|i>>>2)&4294967295,i=s,s=d}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let s=0;const i=this.buf_;let o=this.inbuf_;for(;s<n;){if(o===0)for(;s<=r;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<n;)if(i[o]=e.charCodeAt(s),++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}else for(;s<n;)if(i[o]=e[s],++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let s=0;s<5;s++)for(let i=24;i>=0;i-=8)e[r]=this.chain_[s]>>i&255,++r;return e}}function FV(t,e){const n=new a0(t,e);return n.subscribe.bind(n)}class a0{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");c0(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=ru),s.error===void 0&&(s.error=ru),s.complete===void 0&&(s.complete=ru);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console!="undefined"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function c0(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function ru(){}function LV(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BV=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);if(s>=55296&&s<=56319){const i=s-55296;r++,qA(r<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(r)-56320;s=65536+(i<<10)+o}s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):s<65536?(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},UV=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xe(t){return t&&t._delegate?t._delegate:t}class Bi{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u0{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new ZA;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(h0(e))try{this.getOrInitializeService({instanceIdentifier:fr})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=fr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=fr){return this.instances.has(e)}getOptions(e=fr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(!!r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:l0(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=fr){return this.component?this.component.multipleInstances?e:fr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function l0(t){return t===fr?void 0:t}function h0(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d0{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new u0(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ge;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ge||(ge={}));const f0={debug:ge.DEBUG,verbose:ge.VERBOSE,info:ge.INFO,warn:ge.WARN,error:ge.ERROR,silent:ge.SILENT},m0=ge.INFO,p0={[ge.DEBUG]:"log",[ge.VERBOSE]:"log",[ge.INFO]:"info",[ge.WARN]:"warn",[ge.ERROR]:"error"},g0=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=p0[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ug{constructor(e){this.name=e,this._logLevel=m0,this._logHandler=g0,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ge))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?f0[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ge.DEBUG,...e),this._logHandler(this,ge.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ge.VERBOSE,...e),this._logHandler(this,ge.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ge.INFO,...e),this._logHandler(this,ge.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ge.WARN,...e),this._logHandler(this,ge.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ge.ERROR,...e),this._logHandler(this,ge.ERROR,...e)}}const _0=(t,e)=>e.some(n=>t instanceof n);let Nf,Of;function y0(){return Nf||(Nf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function v0(){return Of||(Of=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const qg=new WeakMap,ju=new WeakMap,$g=new WeakMap,su=new WeakMap,Xl=new WeakMap;function E0(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(qn(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&qg.set(n,t)}).catch(()=>{}),Xl.set(e,t),e}function I0(t){if(ju.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});ju.set(t,e)}let zu={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ju.get(t);if(e==="objectStoreNames")return t.objectStoreNames||$g.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return qn(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function w0(t){zu=t(zu)}function T0(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(iu(this),e,...n);return $g.set(r,e.sort?e.sort():[e]),qn(r)}:v0().includes(t)?function(...e){return t.apply(iu(this),e),qn(qg.get(this))}:function(...e){return qn(t.apply(iu(this),e))}}function A0(t){return typeof t=="function"?T0(t):(t instanceof IDBTransaction&&I0(t),_0(t,y0())?new Proxy(t,zu):t)}function qn(t){if(t instanceof IDBRequest)return E0(t);if(su.has(t))return su.get(t);const e=A0(t);return e!==t&&(su.set(t,e),Xl.set(e,t)),e}const iu=t=>Xl.get(t);function b0(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=qn(o);return r&&o.addEventListener("upgradeneeded",c=>{r(qn(o.result),c.oldVersion,c.newVersion,qn(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const R0=["get","getKey","getAll","getAllKeys","count"],P0=["put","add","delete","clear"],ou=new Map;function Mf(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ou.get(e))return ou.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=P0.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||R0.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),s&&c.done]))[0]};return ou.set(e,i),i}w0(t=>({...t,get:(e,n,r)=>Mf(e,n)||t.get(e,n,r),has:(e,n)=>!!Mf(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(C0(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function C0(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ku="@firebase/app",Ff="0.9.15";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vr=new Ug("@firebase/app"),x0="@firebase/app-compat",V0="@firebase/analytics-compat",D0="@firebase/analytics",k0="@firebase/app-check-compat",N0="@firebase/app-check",O0="@firebase/auth",M0="@firebase/auth-compat",F0="@firebase/database",L0="@firebase/database-compat",B0="@firebase/functions",U0="@firebase/functions-compat",q0="@firebase/installations",$0="@firebase/installations-compat",j0="@firebase/messaging",z0="@firebase/messaging-compat",K0="@firebase/performance",G0="@firebase/performance-compat",H0="@firebase/remote-config",Q0="@firebase/remote-config-compat",W0="@firebase/storage",J0="@firebase/storage-compat",Y0="@firebase/firestore",X0="@firebase/firestore-compat",Z0="firebase",eb="10.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ya="[DEFAULT]",tb={[Ku]:"fire-core",[x0]:"fire-core-compat",[D0]:"fire-analytics",[V0]:"fire-analytics-compat",[N0]:"fire-app-check",[k0]:"fire-app-check-compat",[O0]:"fire-auth",[M0]:"fire-auth-compat",[F0]:"fire-rtdb",[L0]:"fire-rtdb-compat",[B0]:"fire-fn",[U0]:"fire-fn-compat",[q0]:"fire-iid",[$0]:"fire-iid-compat",[j0]:"fire-fcm",[z0]:"fire-fcm-compat",[K0]:"fire-perf",[G0]:"fire-perf-compat",[H0]:"fire-rc",[Q0]:"fire-rc-compat",[W0]:"fire-gcs",[J0]:"fire-gcs-compat",[Y0]:"fire-fst",[X0]:"fire-fst-compat","fire-js":"fire-js",[Z0]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const va=new Map,Gu=new Map;function nb(t,e){try{t.container.addComponent(e)}catch(n){Vr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ea(t){const e=t.name;if(Gu.has(e))return Vr.debug(`There were multiple attempts to register component ${e}.`),!1;Gu.set(e,t);for(const n of va.values())nb(n,t);return!0}function Zl(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function rb(t,e,n=ya){Zl(t,e).clearInstance(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sb={["no-app"]:"No Firebase App '{$appName}' has been created - call initializeApp() first",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["no-options"]:"Need to provide options, when not being deployed to hosting via source.",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},$n=new Lg("app","Firebase",sb);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Bi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw $n.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ob=eb;function jg(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:ya,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw $n.create("bad-app-name",{appName:String(s)});if(n||(n=Mg()),!n)throw $n.create("no-options");const i=va.get(s);if(i){if(Li(n,i.options)&&Li(r,i.config))return i;throw $n.create("duplicate-app",{appName:s})}const o=new d0(s);for(const c of Gu.values())o.addComponent(c);const a=new ib(n,r,o);return va.set(s,a),a}function ab(t=ya){const e=va.get(t);if(!e&&t===ya&&Mg())return jg();if(!e)throw $n.create("no-app",{appName:t});return e}function cs(t,e,n){var r;let s=(r=tb[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Vr.warn(a.join(" "));return}Ea(new Bi(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cb="firebase-heartbeat-database",ub=1,Ui="firebase-heartbeat-store";let au=null;function zg(){return au||(au=b0(cb,ub,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Ui)}}}).catch(t=>{throw $n.create("idb-open",{originalErrorMessage:t.message})})),au}async function lb(t){try{return await(await zg()).transaction(Ui).objectStore(Ui).get(Kg(t))}catch(e){if(e instanceof Os)Vr.warn(e.message);else{const n=$n.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Vr.warn(n.message)}}}async function Lf(t,e){try{const r=(await zg()).transaction(Ui,"readwrite");await r.objectStore(Ui).put(e,Kg(t)),await r.done}catch(n){if(n instanceof Os)Vr.warn(n.message);else{const r=$n.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Vr.warn(r.message)}}}function Kg(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hb=1024,db=30*24*60*60*1e3;class fb{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new pb(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Bf();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const i=new Date(s.date).valueOf();return Date.now()-i<=db}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Bf(),{heartbeatsToSend:n,unsentEntries:r}=mb(this._heartbeatsCache.heartbeats),s=_a(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function Bf(){return new Date().toISOString().substring(0,10)}function mb(t,e=hb){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Uf(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Uf(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class pb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Fg()?r0().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await lb(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Lf(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Lf(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Uf(t){return _a(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gb(t){Ea(new Bi("platform-logger",e=>new S0(e),"PRIVATE")),Ea(new Bi("heartbeat",e=>new fb(e),"PRIVATE")),cs(Ku,Ff,t),cs(Ku,Ff,"esm2017"),cs("fire-js","")}gb("");var _b="firebase",yb="10.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */cs(_b,yb,"app");var vb=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},L,eh=eh||{},te=vb||self;function ic(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function co(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function Eb(t){return Object.prototype.hasOwnProperty.call(t,cu)&&t[cu]||(t[cu]=++Ib)}var cu="closure_uid_"+(1e9*Math.random()>>>0),Ib=0;function wb(t,e,n){return t.call.apply(t.bind,arguments)}function Tb(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),t.apply(e,s)}}return function(){return t.apply(e,arguments)}}function ft(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?ft=wb:ft=Tb,ft.apply(null,arguments)}function Bo(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function tt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,s,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[s].apply(r,o)}}function Zn(){this.s=this.s,this.o=this.o}var Ab=0;Zn.prototype.s=!1;Zn.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),Ab!=0)&&Eb(this)};Zn.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Gg=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function th(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function qf(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(ic(r)){const s=t.length||0,i=r.length||0;t.length=s+i;for(let o=0;o<i;o++)t[s+o]=r[o]}else t.push(r)}}function mt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}mt.prototype.h=function(){this.defaultPrevented=!0};var bb=function(){if(!te.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{te.addEventListener("test",()=>{},e),te.removeEventListener("test",()=>{},e)}catch{}return t}();function qi(t){return/^[\s\xa0]*$/.test(t)}function oc(){var t=te.navigator;return t&&(t=t.userAgent)?t:""}function en(t){return oc().indexOf(t)!=-1}function nh(t){return nh[" "](t),t}nh[" "]=function(){};function Rb(t,e){var n=yR;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var Pb=en("Opera"),ys=en("Trident")||en("MSIE"),Hg=en("Edge"),Hu=Hg||ys,Qg=en("Gecko")&&!(oc().toLowerCase().indexOf("webkit")!=-1&&!en("Edge"))&&!(en("Trident")||en("MSIE"))&&!en("Edge"),Sb=oc().toLowerCase().indexOf("webkit")!=-1&&!en("Edge");function Wg(){var t=te.document;return t?t.documentMode:void 0}var Qu;e:{var uu="",lu=function(){var t=oc();if(Qg)return/rv:([^\);]+)(\)|;)/.exec(t);if(Hg)return/Edge\/([\d\.]+)/.exec(t);if(ys)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(Sb)return/WebKit\/(\S+)/.exec(t);if(Pb)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(lu&&(uu=lu?lu[1]:""),ys){var hu=Wg();if(hu!=null&&hu>parseFloat(uu)){Qu=String(hu);break e}}Qu=uu}var Wu;if(te.document&&ys){var $f=Wg();Wu=$f||parseInt(Qu,10)||void 0}else Wu=void 0;var Cb=Wu;function $i(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(Qg){e:{try{nh(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:xb[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&$i.$.h.call(this)}}tt($i,mt);var xb={2:"touch",3:"pen",4:"mouse"};$i.prototype.h=function(){$i.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var uo="closure_listenable_"+(1e6*Math.random()|0),Vb=0;function Db(t,e,n,r,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=s,this.key=++Vb,this.fa=this.ia=!1}function ac(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function rh(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function kb(t,e){for(const n in t)e.call(void 0,t[n],n,t)}function Jg(t){const e={};for(const n in t)e[n]=t[n];return e}const jf="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Yg(t,e){let n,r;for(let s=1;s<arguments.length;s++){r=arguments[s];for(n in r)t[n]=r[n];for(let i=0;i<jf.length;i++)n=jf[i],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function cc(t){this.src=t,this.g={},this.h=0}cc.prototype.add=function(t,e,n,r,s){var i=t.toString();t=this.g[i],t||(t=this.g[i]=[],this.h++);var o=Yu(t,e,r,s);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new Db(e,this.src,i,!!r,s),e.ia=n,t.push(e)),e};function Ju(t,e){var n=e.type;if(n in t.g){var r=t.g[n],s=Gg(r,e),i;(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(ac(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Yu(t,e,n,r){for(var s=0;s<t.length;++s){var i=t[s];if(!i.fa&&i.listener==e&&i.capture==!!n&&i.la==r)return s}return-1}var sh="closure_lm_"+(1e6*Math.random()|0),du={};function Xg(t,e,n,r,s){if(r&&r.once)return e_(t,e,n,r,s);if(Array.isArray(e)){for(var i=0;i<e.length;i++)Xg(t,e[i],n,r,s);return null}return n=ah(n),t&&t[uo]?t.O(e,n,co(r)?!!r.capture:!!r,s):Zg(t,e,n,!1,r,s)}function Zg(t,e,n,r,s,i){if(!e)throw Error("Invalid event type");var o=co(s)?!!s.capture:!!s,a=oh(t);if(a||(t[sh]=a=new cc(t)),n=a.add(e,n,r,o,i),n.proxy)return n;if(r=Nb(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)bb||(s=o),s===void 0&&(s=!1),t.addEventListener(e.toString(),r,s);else if(t.attachEvent)t.attachEvent(n_(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function Nb(){function t(n){return e.call(t.src,t.listener,n)}const e=Ob;return t}function e_(t,e,n,r,s){if(Array.isArray(e)){for(var i=0;i<e.length;i++)e_(t,e[i],n,r,s);return null}return n=ah(n),t&&t[uo]?t.P(e,n,co(r)?!!r.capture:!!r,s):Zg(t,e,n,!0,r,s)}function t_(t,e,n,r,s){if(Array.isArray(e))for(var i=0;i<e.length;i++)t_(t,e[i],n,r,s);else r=co(r)?!!r.capture:!!r,n=ah(n),t&&t[uo]?(t=t.i,e=String(e).toString(),e in t.g&&(i=t.g[e],n=Yu(i,n,r,s),-1<n&&(ac(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete t.g[e],t.h--)))):t&&(t=oh(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Yu(e,n,r,s)),(n=-1<t?e[t]:null)&&ih(n))}function ih(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[uo])Ju(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(n_(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=oh(e))?(Ju(n,t),n.h==0&&(n.src=null,e[sh]=null)):ac(t)}}}function n_(t){return t in du?du[t]:du[t]="on"+t}function Ob(t,e){if(t.fa)t=!0;else{e=new $i(e,this);var n=t.listener,r=t.la||t.src;t.ia&&ih(t),t=n.call(r,e)}return t}function oh(t){return t=t[sh],t instanceof cc?t:null}var fu="__closure_events_fn_"+(1e9*Math.random()>>>0);function ah(t){return typeof t=="function"?t:(t[fu]||(t[fu]=function(e){return t.handleEvent(e)}),t[fu])}function Ze(){Zn.call(this),this.i=new cc(this),this.S=this,this.J=null}tt(Ze,Zn);Ze.prototype[uo]=!0;Ze.prototype.removeEventListener=function(t,e,n,r){t_(this,t,e,n,r)};function at(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new mt(e,t);else if(e instanceof mt)e.target=e.target||t;else{var s=e;e=new mt(r,t),Yg(e,s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var o=e.g=n[i];s=Uo(o,r,!0,e)&&s}if(o=e.g=t,s=Uo(o,r,!0,e)&&s,s=Uo(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)o=e.g=n[i],s=Uo(o,r,!1,e)&&s}Ze.prototype.N=function(){if(Ze.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)ac(n[r]);delete t.g[e],t.h--}}this.J=null};Ze.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};Ze.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function Uo(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var s=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&Ju(t.i,o),s=a.call(c,r)!==!1&&s}}return s&&!r.defaultPrevented}var ch=te.JSON.stringify;class Mb{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function Fb(){var t=uh;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class Lb{constructor(){this.h=this.g=null}add(e,n){const r=r_.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var r_=new Mb(()=>new Bb,t=>t.reset());class Bb{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function Ub(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function qb(t){te.setTimeout(()=>{throw t},0)}let ji,zi=!1,uh=new Lb,s_=()=>{const t=te.Promise.resolve(void 0);ji=()=>{t.then($b)}};var $b=()=>{for(var t;t=Fb();){try{t.h.call(t.g)}catch(n){qb(n)}var e=r_;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}zi=!1};function uc(t,e){Ze.call(this),this.h=t||1,this.g=e||te,this.j=ft(this.qb,this),this.l=Date.now()}tt(uc,Ze);L=uc.prototype;L.ga=!1;L.T=null;L.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),at(this,"tick"),this.ga&&(lh(this),this.start()))}};L.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function lh(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}L.N=function(){uc.$.N.call(this),lh(this),delete this.g};function hh(t,e,n){if(typeof t=="function")n&&(t=ft(t,n));else if(t&&typeof t.handleEvent=="function")t=ft(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:te.setTimeout(t,e||0)}function i_(t){t.g=hh(()=>{t.g=null,t.i&&(t.i=!1,i_(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class jb extends Zn{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:i_(this)}N(){super.N(),this.g&&(te.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ki(t){Zn.call(this),this.h=t,this.g={}}tt(Ki,Zn);var zf=[];function o_(t,e,n,r){Array.isArray(n)||(n&&(zf[0]=n.toString()),n=zf);for(var s=0;s<n.length;s++){var i=Xg(e,n[s],r||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function a_(t){rh(t.g,function(e,n){this.g.hasOwnProperty(n)&&ih(e)},t),t.g={}}Ki.prototype.N=function(){Ki.$.N.call(this),a_(this)};Ki.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function lc(){this.g=!0}lc.prototype.Ea=function(){this.g=!1};function zb(t,e,n,r,s,i){t.info(function(){if(t.g)if(i)for(var o="",a=i.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&h[1]=="type"?o+(l+"="+u+"&"):o+(l+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+`
`+n+`
`+o})}function Kb(t,e,n,r,s,i,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+`
`+n+`
`+i+" "+o})}function rs(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+Hb(t,n)+(r?" "+r:"")})}function Gb(t,e){t.info(function(){return"TIMEOUT: "+e})}lc.prototype.info=function(){};function Hb(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<s.length;o++)s[o]=""}}}}return ch(n)}catch{return e}}var $r={},Kf=null;function hc(){return Kf=Kf||new Ze}$r.Ta="serverreachability";function c_(t){mt.call(this,$r.Ta,t)}tt(c_,mt);function Gi(t){const e=hc();at(e,new c_(e))}$r.STAT_EVENT="statevent";function u_(t,e){mt.call(this,$r.STAT_EVENT,t),this.stat=e}tt(u_,mt);function yt(t){const e=hc();at(e,new u_(e,t))}$r.Ua="timingevent";function l_(t,e){mt.call(this,$r.Ua,t),this.size=e}tt(l_,mt);function lo(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return te.setTimeout(function(){t()},e)}var dc={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},h_={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function dh(){}dh.prototype.h=null;function Gf(t){return t.h||(t.h=t.i())}function d_(){}var ho={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function fh(){mt.call(this,"d")}tt(fh,mt);function mh(){mt.call(this,"c")}tt(mh,mt);var Xu;function fc(){}tt(fc,dh);fc.prototype.g=function(){return new XMLHttpRequest};fc.prototype.i=function(){return{}};Xu=new fc;function fo(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Ki(this),this.P=Qb,t=Hu?125:void 0,this.V=new uc(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new f_}function f_(){this.i=null,this.g="",this.h=!1}var Qb=45e3,Zu={},Ia={};L=fo.prototype;L.setTimeout=function(t){this.P=t};function el(t,e,n){t.L=1,t.v=pc(gn(e)),t.s=n,t.S=!0,m_(t,null)}function m_(t,e){t.G=Date.now(),mo(t),t.A=gn(t.v);var n=t.A,r=t.W;Array.isArray(r)||(r=[String(r)]),w_(n.i,"t",r),t.C=0,n=t.l.J,t.h=new f_,t.g=j_(t.l,n?e:null,!t.s),0<t.O&&(t.M=new jb(ft(t.Pa,t,t.g),t.O)),o_(t.U,t.g,"readystatechange",t.nb),e=t.I?Jg(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),Gi(),zb(t.j,t.u,t.A,t.m,t.W,t.s)}L.nb=function(t){t=t.target;const e=this.M;e&&tn(t)==3?e.l():this.Pa(t)};L.Pa=function(t){try{if(t==this.g)e:{const l=tn(this.g);var e=this.g.Ia();const h=this.g.da();if(!(3>l)&&(l!=3||Hu||this.g&&(this.h.h||this.g.ja()||Jf(this.g)))){this.J||l!=4||e==7||(e==8||0>=h?Gi(3):Gi(2)),mc(this);var n=this.g.da();this.ca=n;t:if(p_(this)){var r=Jf(this.g);t="";var s=r.length,i=tn(this.g)==4;if(!this.h.i){if(typeof TextDecoder=="undefined"){Ar(this),Ei(this);var o="";break t}this.h.i=new te.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:i&&e==s-1});r.splice(0,s),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,Kb(this.j,this.u,this.A,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!qi(a)){var u=a;break t}}u=null}if(n=u)rs(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,tl(this,n);else{this.i=!1,this.o=3,yt(12),Ar(this),Ei(this);break e}}this.S?(g_(this,l,o),Hu&&this.i&&l==3&&(o_(this.U,this.V,"tick",this.mb),this.V.start())):(rs(this.j,this.m,o,null),tl(this,o)),l==4&&Ar(this),this.i&&!this.J&&(l==4?B_(this.l,this):(this.i=!1,mo(this)))}else pR(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.o=3,yt(12)):(this.o=0,yt(13)),Ar(this),Ei(this)}}}catch{}finally{}};function p_(t){return t.g?t.u=="GET"&&t.L!=2&&t.l.Ha:!1}function g_(t,e,n){let r=!0,s;for(;!t.J&&t.C<n.length;)if(s=Wb(t,n),s==Ia){e==4&&(t.o=4,yt(14),r=!1),rs(t.j,t.m,null,"[Incomplete Response]");break}else if(s==Zu){t.o=4,yt(15),rs(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else rs(t.j,t.m,s,null),tl(t,s);p_(t)&&s!=Ia&&s!=Zu&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,yt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Eh(e),e.M=!0,yt(11))):(rs(t.j,t.m,n,"[Invalid Chunked Response]"),Ar(t),Ei(t))}L.mb=function(){if(this.g){var t=tn(this.g),e=this.g.ja();this.C<e.length&&(mc(this),g_(this,t,e),this.i&&t!=4&&mo(this))}};function Wb(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?Ia:(n=Number(e.substring(n,r)),isNaN(n)?Zu:(r+=1,r+n>e.length?Ia:(e=e.slice(r,r+n),t.C=r+n,e)))}L.cancel=function(){this.J=!0,Ar(this)};function mo(t){t.Y=Date.now()+t.P,__(t,t.P)}function __(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=lo(ft(t.lb,t),e)}function mc(t){t.B&&(te.clearTimeout(t.B),t.B=null)}L.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(Gb(this.j,this.A),this.L!=2&&(Gi(),yt(17)),Ar(this),this.o=2,Ei(this)):__(this,this.Y-t)};function Ei(t){t.l.H==0||t.J||B_(t.l,t)}function Ar(t){mc(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,lh(t.V),a_(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function tl(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||nl(n.i,t))){if(!t.K&&nl(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var s=r;if(s[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)Aa(n),yc(n);else break e;vh(n),yt(18)}}else n.Fa=s[1],0<n.Fa-n.V&&37500>s[2]&&n.G&&n.A==0&&!n.v&&(n.v=lo(ft(n.ib,n),6e3));if(1>=b_(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else br(n,11)}else if((t.K||n.g==t)&&Aa(n),!qi(e))for(s=n.Ja.g.parse(e),e=0;e<s.length;e++){let u=s[e];if(n.V=u[0],u=u[1],n.H==2)if(u[0]=="c"){n.K=u[1],n.pa=u[2];const l=u[3];l!=null&&(n.ra=l,n.l.info("VER="+n.ra));const h=u[4];h!=null&&(n.Ga=h,n.l.info("SVER="+n.Ga));const d=u[5];d!=null&&typeof d=="number"&&0<d&&(r=1.5*d,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const f=t.g;if(f){const g=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(g){var i=r.i;i.g||g.indexOf("spdy")==-1&&g.indexOf("quic")==-1&&g.indexOf("h2")==-1||(i.j=i.l,i.g=new Set,i.h&&(ph(i,i.h),i.h=null))}if(r.F){const v=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;v&&(r.Da=v,Ce(r.I,r.F,v))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=$_(r,r.J?r.pa:null,r.Y),o.K){R_(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.B&&(mc(a),mo(a)),r.g=o}else F_(r);0<n.j.length&&vc(n)}else u[0]!="stop"&&u[0]!="close"||br(n,7);else n.H==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?br(n,7):yh(n):u[0]!="noop"&&n.h&&n.h.Aa(u),n.A=0)}}Gi(4)}catch{}}function Jb(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map!="undefined"&&t instanceof Map||typeof Set!="undefined"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(ic(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function Yb(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map!="undefined"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set!="undefined"&&t instanceof Set)){if(ic(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}function y_(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(ic(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=Yb(t),r=Jb(t),s=r.length,i=0;i<s;i++)e.call(void 0,r[i],n&&n[i],t)}var v_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Xb(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),s=null;if(0<=r){var i=t[n].substring(0,r);s=t[n].substring(r+1)}else i=t[n];e(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function Sr(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Sr){this.h=t.h,wa(this,t.j),this.s=t.s,this.g=t.g,Ta(this,t.m),this.l=t.l;var e=t.i,n=new Hi;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Hf(this,n),this.o=t.o}else t&&(e=String(t).match(v_))?(this.h=!1,wa(this,e[1]||"",!0),this.s=ui(e[2]||""),this.g=ui(e[3]||"",!0),Ta(this,e[4]),this.l=ui(e[5]||"",!0),Hf(this,e[6]||"",!0),this.o=ui(e[7]||"")):(this.h=!1,this.i=new Hi(null,this.h))}Sr.prototype.toString=function(){var t=[],e=this.j;e&&t.push(li(e,Qf,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(li(e,Qf,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(li(n,n.charAt(0)=="/"?tR:eR,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",li(n,rR)),t.join("")};function gn(t){return new Sr(t)}function wa(t,e,n){t.j=n?ui(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Ta(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Hf(t,e,n){e instanceof Hi?(t.i=e,sR(t.i,t.h)):(n||(e=li(e,nR)),t.i=new Hi(e,t.h))}function Ce(t,e,n){t.i.set(e,n)}function pc(t){return Ce(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function ui(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function li(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,Zb),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Zb(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var Qf=/[#\/\?@]/g,eR=/[#\?:]/g,tR=/[#\?]/g,nR=/[#\?@]/g,rR=/#/g;function Hi(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function er(t){t.g||(t.g=new Map,t.h=0,t.i&&Xb(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}L=Hi.prototype;L.add=function(t,e){er(this),this.i=null,t=Ms(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function E_(t,e){er(t),e=Ms(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function I_(t,e){return er(t),e=Ms(t,e),t.g.has(e)}L.forEach=function(t,e){er(this),this.g.forEach(function(n,r){n.forEach(function(s){t.call(e,s,r,this)},this)},this)};L.ta=function(){er(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const s=t[r];for(let i=0;i<s.length;i++)n.push(e[r])}return n};L.Z=function(t){er(this);let e=[];if(typeof t=="string")I_(this,t)&&(e=e.concat(this.g.get(Ms(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};L.set=function(t,e){return er(this),this.i=null,t=Ms(this,t),I_(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};L.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function w_(t,e,n){E_(t,e),0<n.length&&(t.i=null,t.g.set(Ms(t,e),th(n)),t.h+=n.length)}L.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const i=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var s=i;o[r]!==""&&(s+="="+encodeURIComponent(String(o[r]))),t.push(s)}}return this.i=t.join("&")};function Ms(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function sR(t,e){e&&!t.j&&(er(t),t.i=null,t.g.forEach(function(n,r){var s=r.toLowerCase();r!=s&&(E_(this,r),w_(this,s,n))},t)),t.j=e}var iR=class{constructor(t,e){this.g=t,this.map=e}};function T_(t){this.l=t||oR,te.PerformanceNavigationTiming?(t=te.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(te.g&&te.g.Ka&&te.g.Ka()&&te.g.Ka().ec),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var oR=10;function A_(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function b_(t){return t.h?1:t.g?t.g.size:0}function nl(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function ph(t,e){t.g?t.g.add(e):t.h=e}function R_(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}T_.prototype.cancel=function(){if(this.i=P_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function P_(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return th(t.i)}var aR=class{stringify(t){return te.JSON.stringify(t,void 0)}parse(t){return te.JSON.parse(t,void 0)}};function cR(){this.g=new aR}function uR(t,e,n){const r=n||"";try{y_(t,function(s,i){let o=s;co(s)&&(o=ch(s)),e.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw e.push(r+"type="+encodeURIComponent("_badmap")),s}}function lR(t,e){const n=new lc;if(te.Image){const r=new Image;r.onload=Bo(qo,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Bo(qo,n,r,"TestLoadImage: error",!1,e),r.onabort=Bo(qo,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Bo(qo,n,r,"TestLoadImage: timeout",!1,e),te.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function qo(t,e,n,r,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(r)}catch{}}function po(t){this.l=t.fc||null,this.j=t.ob||!1}tt(po,dh);po.prototype.g=function(){return new gc(this.l,this.j)};po.prototype.i=function(t){return function(){return t}}({});function gc(t,e){Ze.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=gh,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}tt(gc,Ze);var gh=0;L=gc.prototype;L.open=function(t,e){if(this.readyState!=gh)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Qi(this)};L.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||te).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};L.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,go(this)),this.readyState=gh};L.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Qi(this)),this.g&&(this.readyState=3,Qi(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof te.ReadableStream!="undefined"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;S_(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function S_(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}L.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?go(this):Qi(this),this.readyState==3&&S_(this)}};L.Za=function(t){this.g&&(this.response=this.responseText=t,go(this))};L.Ya=function(t){this.g&&(this.response=t,go(this))};L.ka=function(){this.g&&go(this)};function go(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Qi(t)}L.setRequestHeader=function(t,e){this.v.append(t,e)};L.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};L.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Qi(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(gc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var hR=te.JSON.parse;function Le(t){Ze.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=C_,this.L=this.M=!1}tt(Le,Ze);var C_="",dR=/^https?$/i,fR=["POST","PUT"];L=Le.prototype;L.Oa=function(t){this.M=t};L.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Xu.g(),this.C=this.u?Gf(this.u):Gf(Xu),this.g.onreadystatechange=ft(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(i){Wf(this,i);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const i of r.keys())n.set(i,r.get(i));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(i=>i.toLowerCase()=="content-type"),s=te.FormData&&t instanceof te.FormData,!(0<=Gg(fR,e))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of n)this.g.setRequestHeader(i,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{D_(this),0<this.B&&((this.L=mR(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ft(this.ua,this)):this.A=hh(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){Wf(this,i)}};function mR(t){return ys&&typeof t.timeout=="number"&&t.ontimeout!==void 0}L.ua=function(){typeof eh!="undefined"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,at(this,"timeout"),this.abort(8))};function Wf(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,x_(t),_c(t)}function x_(t){t.F||(t.F=!0,at(t,"complete"),at(t,"error"))}L.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,at(this,"complete"),at(this,"abort"),_c(this))};L.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),_c(this,!0)),Le.$.N.call(this)};L.La=function(){this.s||(this.G||this.v||this.l?V_(this):this.kb())};L.kb=function(){V_(this)};function V_(t){if(t.h&&typeof eh!="undefined"&&(!t.C[1]||tn(t)!=4||t.da()!=2)){if(t.v&&tn(t)==4)hh(t.La,0,t);else if(at(t,"readystatechange"),tn(t)==4){t.h=!1;try{const o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var s=String(t.I).match(v_)[1]||null;!s&&te.self&&te.self.location&&(s=te.self.location.protocol.slice(0,-1)),r=!dR.test(s?s.toLowerCase():"")}n=r}if(n)at(t,"complete"),at(t,"success");else{t.m=6;try{var i=2<tn(t)?t.g.statusText:""}catch{i=""}t.j=i+" ["+t.da()+"]",x_(t)}}finally{_c(t)}}}}function _c(t,e){if(t.g){D_(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||at(t,"ready");try{n.onreadystatechange=r}catch{}}}function D_(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(te.clearTimeout(t.A),t.A=null)}L.isActive=function(){return!!this.g};function tn(t){return t.g?t.g.readyState:0}L.da=function(){try{return 2<tn(this)?this.g.status:-1}catch{return-1}};L.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};L.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),hR(e)}};function Jf(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case C_:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function pR(t){const e={};t=(t.g&&2<=tn(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(qi(t[r]))continue;var n=Ub(t[r]);const s=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const i=e[s]||[];e[s]=i,i.push(n)}kb(e,function(r){return r.join(", ")})}L.Ia=function(){return this.m};L.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function k_(t){let e="";return rh(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function _h(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=k_(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Ce(t,e,n))}function Zs(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function N_(t){this.Ga=0,this.j=[],this.l=new lc,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Zs("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Zs("baseRetryDelayMs",5e3,t),this.hb=Zs("retryDelaySeedMs",1e4,t),this.eb=Zs("forwardChannelMaxRetries",2,t),this.xa=Zs("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.dc||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new T_(t&&t.concurrentRequestLimit),this.Ja=new cR,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}L=N_.prototype;L.ra=8;L.H=1;function yh(t){if(O_(t),t.H==3){var e=t.W++,n=gn(t.I);if(Ce(n,"SID",t.K),Ce(n,"RID",e),Ce(n,"TYPE","terminate"),_o(t,n),e=new fo(t,t.l,e),e.L=2,e.v=pc(gn(n)),n=!1,te.navigator&&te.navigator.sendBeacon)try{n=te.navigator.sendBeacon(e.v.toString(),"")}catch{}!n&&te.Image&&(new Image().src=e.v,n=!0),n||(e.g=j_(e.l,null),e.g.ha(e.v)),e.G=Date.now(),mo(e)}q_(t)}function yc(t){t.g&&(Eh(t),t.g.cancel(),t.g=null)}function O_(t){yc(t),t.u&&(te.clearTimeout(t.u),t.u=null),Aa(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&te.clearTimeout(t.m),t.m=null)}function vc(t){if(!A_(t.i)&&!t.m){t.m=!0;var e=t.Na;ji||s_(),zi||(ji(),zi=!0),uh.add(e,t),t.C=0}}function gR(t,e){return b_(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=lo(ft(t.Na,t,e),U_(t,t.C)),t.C++,!0)}L.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const s=new fo(this,this.l,t);let i=this.s;if(this.U&&(i?(i=Jg(i),Yg(i,this.U)):i=this.U),this.o!==null||this.O||(s.I=i,i=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=M_(this,s,e),n=gn(this.I),Ce(n,"RID",t),Ce(n,"CVER",22),this.F&&Ce(n,"X-HTTP-Session-Id",this.F),_o(this,n),i&&(this.O?e="headers="+encodeURIComponent(String(k_(i)))+"&"+e:this.o&&_h(n,this.o,i)),ph(this.i,s),this.bb&&Ce(n,"TYPE","init"),this.P?(Ce(n,"$req",e),Ce(n,"SID","null"),s.aa=!0,el(s,n,null)):el(s,n,e),this.H=2}}else this.H==3&&(t?Yf(this,t):this.j.length==0||A_(this.i)||Yf(this))};function Yf(t,e){var n;e?n=e.m:n=t.W++;const r=gn(t.I);Ce(r,"SID",t.K),Ce(r,"RID",n),Ce(r,"AID",t.V),_o(t,r),t.o&&t.s&&_h(r,t.o,t.s),n=new fo(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=M_(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),ph(t.i,n),el(n,r,e)}function _o(t,e){t.na&&rh(t.na,function(n,r){Ce(e,r,n)}),t.h&&y_({},function(n,r){Ce(e,r,n)})}function M_(t,e,n){n=Math.min(t.j.length,n);var r=t.h?ft(t.h.Va,t.h,t):null;e:{var s=t.j;let i=-1;for(;;){const o=["count="+n];i==-1?0<n?(i=s[0].g,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let c=0;c<n;c++){let u=s[c].g;const l=s[c].map;if(u-=i,0>u)i=Math.max(0,s[c].g-100),a=!1;else try{uR(l,o,"req"+u+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function F_(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;ji||s_(),zi||(ji(),zi=!0),uh.add(e,t),t.A=0}}function vh(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=lo(ft(t.Ma,t),U_(t,t.A)),t.A++,!0)}L.Ma=function(){if(this.u=null,L_(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=lo(ft(this.jb,this),t)}};L.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,yt(10),yc(this),L_(this))};function Eh(t){t.B!=null&&(te.clearTimeout(t.B),t.B=null)}function L_(t){t.g=new fo(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=gn(t.wa);Ce(e,"RID","rpc"),Ce(e,"SID",t.K),Ce(e,"AID",t.V),Ce(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Ce(e,"TO",t.qa),Ce(e,"TYPE","xmlhttp"),_o(t,e),t.o&&t.s&&_h(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.v=pc(gn(e)),n.s=null,n.S=!0,m_(n,t)}L.ib=function(){this.v!=null&&(this.v=null,yc(this),vh(this),yt(19))};function Aa(t){t.v!=null&&(te.clearTimeout(t.v),t.v=null)}function B_(t,e){var n=null;if(t.g==e){Aa(t),Eh(t),t.g=null;var r=2}else if(nl(t.i,e))n=e.F,R_(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.G;var s=t.C;r=hc(),at(r,new l_(r,n)),vc(t)}else F_(t);else if(s=e.o,s==3||s==0&&0<e.ca||!(r==1&&gR(t,e)||r==2&&vh(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),s){case 1:br(t,5);break;case 4:br(t,10);break;case 3:br(t,6);break;default:br(t,2)}}}function U_(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function br(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=ft(t.pb,t);n||(n=new Sr("//www.google.com/images/cleardot.gif"),te.location&&te.location.protocol=="http"||wa(n,"https"),pc(n)),lR(n.toString(),r)}else yt(2);t.H=0,t.h&&t.h.za(e),q_(t),O_(t)}L.pb=function(t){t?(this.l.info("Successfully pinged google.com"),yt(2)):(this.l.info("Failed to ping google.com"),yt(1))};function q_(t){if(t.H=0,t.ma=[],t.h){const e=P_(t.i);(e.length!=0||t.j.length!=0)&&(qf(t.ma,e),qf(t.ma,t.j),t.i.i.length=0,th(t.j),t.j.length=0),t.h.ya()}}function $_(t,e,n){var r=n instanceof Sr?gn(n):new Sr(n);if(r.g!="")e&&(r.g=e+"."+r.g),Ta(r,r.m);else{var s=te.location;r=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var i=new Sr(null);r&&wa(i,r),e&&(i.g=e),s&&Ta(i,s),n&&(i.l=n),r=i}return n=t.F,e=t.Da,n&&e&&Ce(r,n,e),Ce(r,"VER",t.ra),_o(t,r),r}function j_(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ha&&!t.va?new Le(new po({ob:!0})):new Le(t.va),e.Oa(t.J),e}L.isActive=function(){return!!this.h&&this.h.isActive(this)};function z_(){}L=z_.prototype;L.Ba=function(){};L.Aa=function(){};L.za=function(){};L.ya=function(){};L.isActive=function(){return!0};L.Va=function(){};function ba(){if(ys&&!(10<=Number(Cb)))throw Error("Environmental error: no available transport.")}ba.prototype.g=function(t,e){return new xt(t,e)};function xt(t,e){Ze.call(this),this.g=new N_(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!qi(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!qi(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Fs(this)}tt(xt,Ze);xt.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;yt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=$_(t,null,t.Y),vc(t)};xt.prototype.close=function(){yh(this.g)};xt.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=ch(t),t=n);e.j.push(new iR(e.fb++,t)),e.H==3&&vc(e)};xt.prototype.N=function(){this.g.h=null,delete this.j,yh(this.g),delete this.g,xt.$.N.call(this)};function K_(t){fh.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}tt(K_,fh);function G_(){mh.call(this),this.status=1}tt(G_,mh);function Fs(t){this.g=t}tt(Fs,z_);Fs.prototype.Ba=function(){at(this.g,"a")};Fs.prototype.Aa=function(t){at(this.g,new K_(t))};Fs.prototype.za=function(t){at(this.g,new G_)};Fs.prototype.ya=function(){at(this.g,"b")};function _R(){this.blockSize=-1}function Ht(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}tt(Ht,_R);Ht.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function mu(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var s=0;16>s;++s)r[s]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(s=0;16>s;++s)r[s]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],s=t.g[2];var i=t.g[3],o=e+(i^n&(s^i))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=i+(s^e&(n^s))+r[1]+3905402710&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(n^i&(e^n))+r[2]+606105819&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(e^s&(i^e))+r[3]+3250441966&4294967295,n=s+(o<<22&4294967295|o>>>10),o=e+(i^n&(s^i))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=i+(s^e&(n^s))+r[5]+1200080426&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(n^i&(e^n))+r[6]+2821735955&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(e^s&(i^e))+r[7]+4249261313&4294967295,n=s+(o<<22&4294967295|o>>>10),o=e+(i^n&(s^i))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=i+(s^e&(n^s))+r[9]+2336552879&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(n^i&(e^n))+r[10]+4294925233&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(e^s&(i^e))+r[11]+2304563134&4294967295,n=s+(o<<22&4294967295|o>>>10),o=e+(i^n&(s^i))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=i+(s^e&(n^s))+r[13]+4254626195&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(n^i&(e^n))+r[14]+2792965006&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(e^s&(i^e))+r[15]+1236535329&4294967295,n=s+(o<<22&4294967295|o>>>10),o=e+(s^i&(n^s))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(e^n))+r[6]+3225465664&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^n&(i^e))+r[11]+643717713&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^e&(s^i))+r[0]+3921069994&4294967295,n=s+(o<<20&4294967295|o>>>12),o=e+(s^i&(n^s))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(e^n))+r[10]+38016083&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^n&(i^e))+r[15]+3634488961&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^e&(s^i))+r[4]+3889429448&4294967295,n=s+(o<<20&4294967295|o>>>12),o=e+(s^i&(n^s))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(e^n))+r[14]+3275163606&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^n&(i^e))+r[3]+4107603335&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^e&(s^i))+r[8]+1163531501&4294967295,n=s+(o<<20&4294967295|o>>>12),o=e+(s^i&(n^s))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(e^n))+r[2]+4243563512&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^n&(i^e))+r[7]+1735328473&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^e&(s^i))+r[12]+2368359562&4294967295,n=s+(o<<20&4294967295|o>>>12),o=e+(n^s^i)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=i+(e^n^s)+r[8]+2272392833&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^n)+r[11]+1839030562&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^e)+r[14]+4259657740&4294967295,n=s+(o<<23&4294967295|o>>>9),o=e+(n^s^i)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=i+(e^n^s)+r[4]+1272893353&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^n)+r[7]+4139469664&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^e)+r[10]+3200236656&4294967295,n=s+(o<<23&4294967295|o>>>9),o=e+(n^s^i)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=i+(e^n^s)+r[0]+3936430074&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^n)+r[3]+3572445317&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^e)+r[6]+76029189&4294967295,n=s+(o<<23&4294967295|o>>>9),o=e+(n^s^i)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=i+(e^n^s)+r[12]+3873151461&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^n)+r[15]+530742520&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^e)+r[2]+3299628645&4294967295,n=s+(o<<23&4294967295|o>>>9),o=e+(s^(n|~i))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=i+(n^(e|~s))+r[7]+1126891415&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~n))+r[14]+2878612391&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~e))+r[5]+4237533241&4294967295,n=s+(o<<21&4294967295|o>>>11),o=e+(s^(n|~i))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=i+(n^(e|~s))+r[3]+2399980690&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~n))+r[10]+4293915773&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~e))+r[1]+2240044497&4294967295,n=s+(o<<21&4294967295|o>>>11),o=e+(s^(n|~i))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=i+(n^(e|~s))+r[15]+4264355552&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~n))+r[6]+2734768916&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~e))+r[13]+1309151649&4294967295,n=s+(o<<21&4294967295|o>>>11),o=e+(s^(n|~i))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=i+(n^(e|~s))+r[11]+3174756917&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~n))+r[2]+718787259&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(s+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+s&4294967295,t.g[3]=t.g[3]+i&4294967295}Ht.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,s=this.h,i=0;i<e;){if(s==0)for(;i<=n;)mu(this,t,i),i+=this.blockSize;if(typeof t=="string"){for(;i<e;)if(r[s++]=t.charCodeAt(i++),s==this.blockSize){mu(this,r),s=0;break}}else for(;i<e;)if(r[s++]=t[i++],s==this.blockSize){mu(this,r),s=0;break}}this.h=s,this.i+=e};Ht.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function Ie(t,e){this.h=e;for(var n=[],r=!0,s=t.length-1;0<=s;s--){var i=t[s]|0;r&&i==e||(n[s]=i,r=!1)}this.g=n}var yR={};function Ih(t){return-128<=t&&128>t?Rb(t,function(e){return new Ie([e|0],0>e?-1:0)}):new Ie([t|0],0>t?-1:0)}function nn(t){if(isNaN(t)||!isFinite(t))return us;if(0>t)return it(nn(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=rl;return new Ie(e,0)}function H_(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return it(H_(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=nn(Math.pow(e,8)),r=us,s=0;s<t.length;s+=8){var i=Math.min(8,t.length-s),o=parseInt(t.substring(s,s+i),e);8>i?(i=nn(Math.pow(e,i)),r=r.R(i).add(nn(o))):(r=r.R(n),r=r.add(nn(o)))}return r}var rl=4294967296,us=Ih(0),sl=Ih(1),Xf=Ih(16777216);L=Ie.prototype;L.ea=function(){if(Nt(this))return-it(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:rl+r)*e,e*=rl}return t};L.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(fn(this))return"0";if(Nt(this))return"-"+it(this).toString(t);for(var e=nn(Math.pow(t,6)),n=this,r="";;){var s=Pa(n,e).g;n=Ra(n,s.R(e));var i=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=s,fn(n))return i+r;for(;6>i.length;)i="0"+i;r=i+r}};L.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function fn(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Nt(t){return t.h==-1}L.X=function(t){return t=Ra(this,t),Nt(t)?-1:fn(t)?0:1};function it(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Ie(n,~t.h).add(sl)}L.abs=function(){return Nt(this)?it(this):this};L.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,s=0;s<=e;s++){var i=r+(this.D(s)&65535)+(t.D(s)&65535),o=(i>>>16)+(this.D(s)>>>16)+(t.D(s)>>>16);r=o>>>16,i&=65535,o&=65535,n[s]=o<<16|i}return new Ie(n,n[n.length-1]&-2147483648?-1:0)};function Ra(t,e){return t.add(it(e))}L.R=function(t){if(fn(this)||fn(t))return us;if(Nt(this))return Nt(t)?it(this).R(it(t)):it(it(this).R(t));if(Nt(t))return it(this.R(it(t)));if(0>this.X(Xf)&&0>t.X(Xf))return nn(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var s=0;s<t.g.length;s++){var i=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(s)>>>16,c=t.D(s)&65535;n[2*r+2*s]+=o*c,$o(n,2*r+2*s),n[2*r+2*s+1]+=i*c,$o(n,2*r+2*s+1),n[2*r+2*s+1]+=o*a,$o(n,2*r+2*s+1),n[2*r+2*s+2]+=i*a,$o(n,2*r+2*s+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Ie(n,0)};function $o(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function ei(t,e){this.g=t,this.h=e}function Pa(t,e){if(fn(e))throw Error("division by zero");if(fn(t))return new ei(us,us);if(Nt(t))return e=Pa(it(t),e),new ei(it(e.g),it(e.h));if(Nt(e))return e=Pa(t,it(e)),new ei(it(e.g),e.h);if(30<t.g.length){if(Nt(t)||Nt(e))throw Error("slowDivide_ only works with positive integers.");for(var n=sl,r=e;0>=r.X(t);)n=Zf(n),r=Zf(r);var s=Yr(n,1),i=Yr(r,1);for(r=Yr(r,2),n=Yr(n,2);!fn(r);){var o=i.add(r);0>=o.X(t)&&(s=s.add(n),i=o),r=Yr(r,1),n=Yr(n,1)}return e=Ra(t,s.R(e)),new ei(s,e)}for(s=us;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),i=nn(n),o=i.R(e);Nt(o)||0<o.X(t);)n-=r,i=nn(n),o=i.R(e);fn(i)&&(i=sl),s=s.add(i),t=Ra(t,o)}return new ei(s,t)}L.gb=function(t){return Pa(this,t).h};L.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Ie(n,this.h&t.h)};L.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Ie(n,this.h|t.h)};L.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Ie(n,this.h^t.h)};function Zf(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Ie(n,t.h)}function Yr(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,s=[],i=0;i<r;i++)s[i]=0<e?t.D(i+n)>>>e|t.D(i+n+1)<<32-e:t.D(i+n);return new Ie(s,t.h)}ba.prototype.createWebChannel=ba.prototype.g;xt.prototype.send=xt.prototype.u;xt.prototype.open=xt.prototype.m;xt.prototype.close=xt.prototype.close;dc.NO_ERROR=0;dc.TIMEOUT=8;dc.HTTP_ERROR=6;h_.COMPLETE="complete";d_.EventType=ho;ho.OPEN="a";ho.CLOSE="b";ho.ERROR="c";ho.MESSAGE="d";Ze.prototype.listen=Ze.prototype.O;Le.prototype.listenOnce=Le.prototype.P;Le.prototype.getLastError=Le.prototype.Sa;Le.prototype.getLastErrorCode=Le.prototype.Ia;Le.prototype.getStatus=Le.prototype.da;Le.prototype.getResponseJson=Le.prototype.Wa;Le.prototype.getResponseText=Le.prototype.ja;Le.prototype.send=Le.prototype.ha;Le.prototype.setWithCredentials=Le.prototype.Oa;Ht.prototype.digest=Ht.prototype.l;Ht.prototype.reset=Ht.prototype.reset;Ht.prototype.update=Ht.prototype.j;Ie.prototype.add=Ie.prototype.add;Ie.prototype.multiply=Ie.prototype.R;Ie.prototype.modulo=Ie.prototype.gb;Ie.prototype.compare=Ie.prototype.X;Ie.prototype.toNumber=Ie.prototype.ea;Ie.prototype.toString=Ie.prototype.toString;Ie.prototype.getBits=Ie.prototype.D;Ie.fromNumber=nn;Ie.fromString=H_;var vR=function(){return new ba},ER=function(){return hc()},pu=dc,IR=h_,wR=$r,em={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},TR=po,jo=d_,AR=Le,bR=Ht,ls=Ie;const tm="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ye.UNAUTHENTICATED=new Ye(null),Ye.GOOGLE_CREDENTIALS=new Ye("google-credentials-uid"),Ye.FIRST_PARTY=new Ye("first-party-uid"),Ye.MOCK_USER=new Ye("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ls="10.1.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kn=new Ug("@firebase/firestore");function il(){return Kn.logLevel}function RR(t){Kn.setLogLevel(t)}function S(t,...e){if(Kn.logLevel<=ge.DEBUG){const n=e.map(wh);Kn.debug(`Firestore (${Ls}): ${t}`,...n)}}function Be(t,...e){if(Kn.logLevel<=ge.ERROR){const n=e.map(wh);Kn.error(`Firestore (${Ls}): ${t}`,...n)}}function Ft(t,...e){if(Kn.logLevel<=ge.WARN){const n=e.map(wh);Kn.warn(`Firestore (${Ls}): ${t}`,...n)}}function wh(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q(t="Unexpected state"){const e=`FIRESTORE (${Ls}) INTERNAL ASSERTION FAILED: `+t;throw Be(e),new Error(e)}function G(t,e){t||q()}function PR(t,e){t||q()}function M(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class b extends Os{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q_{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class W_{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ye.UNAUTHENTICATED))}shutdown(){}}class SR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class CR{constructor(e){this.t=e,this.currentUser=Ye.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new We;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new We,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},a=c=>{S("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(S("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new We)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(S("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(G(typeof r.accessToken=="string"),new Q_(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return G(e===null||typeof e=="string"),new Ye(e)}}class xR{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Ye.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class VR{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new xR(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Ye.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class J_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class DR{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const r=i=>{i.error!=null&&S("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,S("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{S("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):S("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(G(typeof n.token=="string"),this.R=n.token,new J_(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}class kR{getToken(){return Promise.resolve(new J_(""))}invalidateToken(){}start(e,n){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NR(t){const e=typeof self!="undefined"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_{static V(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=NR(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function ee(t,e){return t<e?-1:t>e?1:0}function vs(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function X_(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new b(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new b(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new b(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new b(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ne.fromMillis(Date.now())}static fromDate(e){return Ne.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Ne(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ee(this.nanoseconds,e.nanoseconds):ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H{constructor(e){this.timestamp=e}static fromTimestamp(e){return new H(e)}static min(){return new H(new Ne(0,0))}static max(){return new H(new Ne(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(e,n,r){n===void 0?n=0:n>e.length&&q(),r===void 0?r=e.length-n:r>e.length-n&&q(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Wi.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Wi?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class de extends Wi{construct(e,n,r){return new de(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new b(E.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new de(n)}static emptyPath(){return new de([])}}const OR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Me extends Wi{construct(e,n,r){return new Me(e,n,r)}static isValidIdentifier(e){return OR.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Me.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Me(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new b(E.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new b(E.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new b(E.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new b(E.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Me(n)}static emptyPath(){return new Me([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N{constructor(e){this.path=e}static fromPath(e){return new N(de.fromString(e))}static fromName(e){return new N(de.fromString(e).popFirst(5))}static empty(){return new N(de.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&de.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return de.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new N(new de(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function ol(t){return t.fields.find(e=>e.kind===2)}function mr(t){return t.fields.filter(e=>e.kind!==2)}function MR(t,e){let n=ee(t.collectionGroup,e.collectionGroup);if(n!==0)return n;for(let r=0;r<Math.min(t.fields.length,e.fields.length);++r)if(n=FR(t.fields[r],e.fields[r]),n!==0)return n;return ee(t.fields.length,e.fields.length)}Sa.UNKNOWN_ID=-1;class ta{constructor(e,n){this.fieldPath=e,this.kind=n}}function FR(t,e){const n=Me.comparator(t.fieldPath,e.fieldPath);return n!==0?n:ee(t.kind,e.kind)}class Ji{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Ji(0,Vt.min())}}function Z_(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=H.fromTimestamp(r===1e9?new Ne(n+1,0):new Ne(n,r));return new Vt(s,N.empty(),e)}function ey(t){return new Vt(t.readTime,t.key,-1)}class Vt{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Vt(H.min(),N.empty(),-1)}static max(){return new Vt(H.max(),N.empty(),-1)}}function Th(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=N.comparator(t.documentKey,e.documentKey),n!==0?n:ee(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ty="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ny{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tr(t){if(t.code!==E.FAILED_PRECONDITION||t.message!==ty)throw t;S("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&q(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new y((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof y?n:y.resolve(n)}catch(n){return y.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):y.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):y.reject(n)}static resolve(e){return new y((n,r)=>{n(e)})}static reject(e){return new y((n,r)=>{r(e)})}static waitFor(e){return new y((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=y.resolve(!1);for(const r of e)n=n.next(s=>s?y.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new y((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(l=>{o[u]=l,++a,a===i&&r(o)},l=>s(l))}})}static doWhile(e,n){return new y((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.m=new We,this.transaction.oncomplete=()=>{this.m.resolve()},this.transaction.onabort=()=>{n.error?this.m.reject(new Ii(e,n.error)):this.m.resolve()},this.transaction.onerror=r=>{const s=Ah(r.target.error);this.m.reject(new Ii(e,s))}}static open(e,n,r,s){try{return new Ec(n,e.transaction(s,r))}catch(i){throw new Ii(n,i)}}get g(){return this.m.promise}abort(e){e&&this.m.reject(e),this.aborted||(S("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}p(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new BR(n)}}class $t{constructor(e,n,r){this.name=e,this.version=n,this.S=r,$t.D(Fi())===12.2&&Be("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return S("SimpleDb","Removing database:",e),yr(window.indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Fg())return!1;if($t.C())return!0;const e=Fi(),n=$t.D(e),r=0<n&&n<10,s=$t.F(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static C(){var e;return typeof process!="undefined"&&((e=process.env)===null||e===void 0?void 0:e.M)==="YES"}static O(e,n){return e.store(n)}static D(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static F(e){const n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async N(e){return this.db||(S("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new Ii(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new b(E.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new b(E.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Ii(e,o))},s.onupgradeneeded=i=>{S("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.S.B(o,s.transaction,i.oldVersion,this.version).next(()=>{S("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.L&&(this.db.onversionchange=n=>this.L(n)),this.db}k(e){this.L=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.N(e);const a=Ec.open(this.db,e,i?"readonly":"readwrite",r),c=s(a).next(u=>(a.p(),u)).catch(u=>(a.abort(u),y.reject(u))).toPromise();return c.catch(()=>{}),await a.g,c}catch(a){const c=a,u=c.name!=="FirebaseError"&&o<3;if(S("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}class LR{constructor(e){this.q=e,this.K=!1,this.$=null}get isDone(){return this.K}get U(){return this.$}set cursor(e){this.q=e}done(){this.K=!0}W(e){this.$=e}delete(){return yr(this.q.delete())}}class Ii extends b{constructor(e,n){super(E.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function nr(t){return t.name==="IndexedDbTransactionError"}class BR{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(S("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(S("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),yr(r)}add(e){return S("SimpleDb","ADD",this.store.name,e,e),yr(this.store.add(e))}get(e){return yr(this.store.get(e)).next(n=>(n===void 0&&(n=null),S("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return S("SimpleDb","DELETE",this.store.name,e),yr(this.store.delete(e))}count(){return S("SimpleDb","COUNT",this.store.name),yr(this.store.count())}G(e,n){const r=this.options(e,n);if(r.index||typeof this.store.getAll!="function"){const s=this.cursor(r),i=[];return this.j(s,(o,a)=>{i.push(a)}).next(()=>i)}{const s=this.store.getAll(r.range);return new y((i,o)=>{s.onerror=a=>{o(a.target.error)},s.onsuccess=a=>{i(a.target.result)}})}}H(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new y((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}J(e,n){S("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.Y=!1;const s=this.cursor(r);return this.j(s,(i,o,a)=>a.delete())}Z(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.j(s,n)}X(e){const n=this.cursor({});return new y((r,s)=>{n.onerror=i=>{const o=Ah(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}j(e,n){const r=[];return new y((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const c=new LR(a),u=n(a.primaryKey,a.value,c);if(u instanceof y){const l=u.catch(h=>(c.done(),y.reject(h)));r.push(l)}c.isDone?s():c.U===null?a.continue():a.continue(c.U)}}).next(()=>y.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function yr(t){return new y((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=Ah(r.target.error);n(s)}})}let nm=!1;function Ah(t){const e=$t.D(Fi());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new b("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return nm||(nm=!0,setTimeout(()=>{throw r},0)),r}}return t}class UR{constructor(e,n){this.asyncQueue=e,this.ee=n,this.task=null}start(){this.te(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}te(e){S("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{S("IndexBackiller",`Documents written: ${await this.ee.ne()}`)}catch(n){nr(n)?S("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):await tr(n)}await this.te(6e4)})}}class qR{constructor(e,n){this.localStore=e,this.persistence=n}async ne(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.re(n,e))}re(e,n){const r=new Set;let s=n,i=!0;return y.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return S("IndexBackiller",`Processing collection: ${o}`),this.ie(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}ie(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.se(s,i)).next(a=>(S("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}se(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=ey(i);Th(o,r)>0&&(r=o)}),new Vt(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.oe(r),this._e=r=>n.writeSequenceNumber(r))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}Tt.ae=-1;function yo(t){return t==null}function Yi(t){return t===0&&1/t==-1/0}function ry(t){return typeof t=="number"&&Number.isInteger(t)&&!Yi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=rm(e)),e=$R(t.get(n),e);return rm(e)}function $R(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function rm(t){return t+""}function rn(t){const e=t.length;if(G(e>=2),e===2)return G(t.charAt(0)===""&&t.charAt(1)===""),de.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf("",i);switch((o<0||o>n)&&q(),t.charAt(o+1)){case"":const a=t.substring(i,o);let c;s.length===0?c=a:(s+=a,c=s,s=""),r.push(c);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:q()}i=o+2}return new de(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sm=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function na(t,e){return[t,pt(e)]}function sy(t,e,n){return[t,pt(e),n]}const jR={},zR=["prefixPath","collectionGroup","readTime","documentId"],KR=["prefixPath","collectionGroup","documentId"],GR=["collectionGroup","readTime","prefixPath","documentId"],HR=["canonicalId","targetId"],QR=["targetId","path"],WR=["path","targetId"],JR=["collectionId","parent"],YR=["indexId","uid"],XR=["uid","sequenceNumber"],ZR=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],eP=["indexId","uid","orderedDocumentKey"],tP=["userId","collectionPath","documentId"],nP=["userId","collectionPath","largestBatchId"],rP=["userId","collectionGroup","largestBatchId"],iy=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],sP=[...iy,"documentOverlays"],oy=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],ay=oy,iP=[...ay,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al extends ny{constructor(e,n){super(),this.ue=e,this.currentSequenceNumber=n}}function nt(t,e){const n=M(t);return $t.O(n.ue,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function im(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function rr(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function cy(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e,n){this.comparator=e,this.root=n||st.EMPTY}insert(e,n){return new Re(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,st.BLACK,null,null))}remove(e){return new Re(this.comparator,this.root.remove(e,this.comparator).copy(null,null,st.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new zo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new zo(this.root,e,this.comparator,!1)}getReverseIterator(){return new zo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new zo(this.root,e,this.comparator,!0)}}class zo{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class st{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r!=null?r:st.RED,this.left=s!=null?s:st.EMPTY,this.right=i!=null?i:st.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new st(e!=null?e:this.key,n!=null?n:this.value,r!=null?r:this.color,s!=null?s:this.left,i!=null?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return st.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return st.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,st.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,st.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw q();const e=this.left.check();if(e!==this.right.check())throw q();return e+(this.isRed()?0:1)}}st.EMPTY=null,st.RED=!0,st.BLACK=!1;st.EMPTY=new class{constructor(){this.size=0}get key(){throw q()}get value(){throw q()}get color(){throw q()}get left(){throw q()}get right(){throw q()}copy(e,n,r,s,i){return this}insert(e,n,r){return new st(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e){this.comparator=e,this.data=new Re(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new om(this.data.getIterator())}getIteratorFrom(e){return new om(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ve)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ve(this.comparator);return n.data=e,n}}class om{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Xr(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e){this.fields=e,e.sort(Me.comparator)}static empty(){return new At([])}unionWith(e){let n=new Ve(Me.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new At(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return vs(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uy extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oP(){return typeof atob!="undefined"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException!="undefined"&&i instanceof DOMException?new uy("Invalid base64 string: "+i):i}}(e);return new He(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new He(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}He.EMPTY_BYTE_STRING=new He("");const aP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Gn(t){if(G(!!t),typeof t=="string"){let e=0;const n=aP.exec(t);if(G(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Oe(t.seconds),nanos:Oe(t.nanos)}}function Oe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function _n(t){return typeof t=="string"?He.fromBase64String(t):He.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ic(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function wc(t){const e=t.mapValue.fields.__previous_value__;return Ic(e)?wc(e):e}function Xi(t){const e=Gn(t.mapValue.fields.__local_write_time__.timestampValue);return new Ne(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cP{constructor(e,n,r,s,i,o,a,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}}class Hn{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Hn("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Hn&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mn={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ra={nullValue:"NULL_VALUE"};function Qn(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ic(t)?4:ly(t)?9007199254740991:10:q()}function un(t,e){if(t===e)return!0;const n=Qn(t);if(n!==Qn(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Xi(t).isEqual(Xi(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Gn(s.timestampValue),a=Gn(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return _n(s.bytesValue).isEqual(_n(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Oe(s.geoPointValue.latitude)===Oe(i.geoPointValue.latitude)&&Oe(s.geoPointValue.longitude)===Oe(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Oe(s.integerValue)===Oe(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Oe(s.doubleValue),a=Oe(i.doubleValue);return o===a?Yi(o)===Yi(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return vs(t.arrayValue.values||[],e.arrayValue.values||[],un);case 10:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(im(o)!==im(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!un(o[c],a[c])))return!1;return!0}(t,e);default:return q()}}function Zi(t,e){return(t.values||[]).find(n=>un(n,e))!==void 0}function Wn(t,e){if(t===e)return 0;const n=Qn(t),r=Qn(e);if(n!==r)return ee(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ee(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=Oe(i.integerValue||i.doubleValue),c=Oe(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return am(t.timestampValue,e.timestampValue);case 4:return am(Xi(t),Xi(e));case 5:return ee(t.stringValue,e.stringValue);case 6:return function(i,o){const a=_n(i),c=_n(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){const l=ee(a[u],c[u]);if(l!==0)return l}return ee(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=ee(Oe(i.latitude),Oe(o.latitude));return a!==0?a:ee(Oe(i.longitude),Oe(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(i,o){const a=i.values||[],c=o.values||[];for(let u=0;u<a.length&&u<c.length;++u){const l=Wn(a[u],c[u]);if(l)return l}return ee(a.length,c.length)}(t.arrayValue,e.arrayValue);case 10:return function(i,o){if(i===Mn.mapValue&&o===Mn.mapValue)return 0;if(i===Mn.mapValue)return 1;if(o===Mn.mapValue)return-1;const a=i.fields||{},c=Object.keys(a),u=o.fields||{},l=Object.keys(u);c.sort(),l.sort();for(let h=0;h<c.length&&h<l.length;++h){const d=ee(c[h],l[h]);if(d!==0)return d;const f=Wn(a[c[h]],u[l[h]]);if(f!==0)return f}return ee(c.length,l.length)}(t.mapValue,e.mapValue);default:throw q()}}function am(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ee(t,e);const n=Gn(t),r=Gn(e),s=ee(n.seconds,r.seconds);return s!==0?s:ee(n.nanos,r.nanos)}function Es(t){return cl(t)}function cl(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Gn(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return _n(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return N.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=cl(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${cl(n.fields[o])}`;return s+"}"}(t.mapValue):q()}function sa(t){switch(Qn(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=wc(t);return e?16+sa(e):16;case 5:return 2*t.stringValue.length;case 6:return _n(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+sa(i),0)}(t.arrayValue);case 10:return function(r){let s=0;return rr(r.fields,(i,o)=>{s+=i.length+sa(o)}),s}(t.mapValue);default:throw q()}}function Dr(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ul(t){return!!t&&"integerValue"in t}function eo(t){return!!t&&"arrayValue"in t}function cm(t){return!!t&&"nullValue"in t}function um(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ia(t){return!!t&&"mapValue"in t}function wi(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return rr(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=wi(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=wi(t.arrayValue.values[n]);return e}return Object.assign({},t)}function ly(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function uP(t){return"nullValue"in t?ra:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Dr(Hn.empty(),N.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:q()}function lP(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Dr(Hn.empty(),N.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Mn:q()}function lm(t,e){const n=Wn(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function hm(t,e){const n=Wn(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{constructor(e){this.value=e}static empty(){return new ot({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!ia(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=wi(n)}setAll(e){let n=Me.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=wi(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());ia(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return un(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];ia(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){rr(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new ot(wi(this.value))}}function hy(t){const e=[];return rr(t.fields,(n,r)=>{const s=new Me([n]);if(ia(r)){const i=hy(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new At(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new xe(e,0,H.min(),H.min(),H.min(),ot.empty(),0)}static newFoundDocument(e,n,r,s){return new xe(e,1,n,H.min(),r,s,0)}static newNoDocument(e,n){return new xe(e,2,n,H.min(),H.min(),ot.empty(),0)}static newUnknownDocument(e,n){return new xe(e,3,n,H.min(),H.min(),ot.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(H.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ot.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ot.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=H.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof xe&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new xe(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e,n){this.position=e,this.inclusive=n}}function dm(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=N.comparator(N.fromName(o.referenceValue),n.key):r=Wn(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function fm(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!un(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(e,n="asc"){this.field=e,this.dir=n}}function hP(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dy{}class ce extends dy{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new dP(e,n,r):n==="array-contains"?new pP(e,r):n==="in"?new yy(e,r):n==="not-in"?new gP(e,r):n==="array-contains-any"?new _P(e,r):new ce(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new fP(e,r):new mP(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Wn(n,this.value)):n!==null&&Qn(this.value)===Qn(n)&&this.matchesComparison(Wn(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return q()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Ee extends dy{constructor(e,n){super(),this.filters=e,this.op=n,this.ce=null}static create(e,n){return new Ee(e,n)}matches(e){return Is(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.le(n=>n.isInequality());return e!==null?e.field:null}le(e){for(const n of this.getFlattenedFilters())if(e(n))return n;return null}}function Is(t){return t.op==="and"}function ll(t){return t.op==="or"}function bh(t){return fy(t)&&Is(t)}function fy(t){for(const e of t.filters)if(e instanceof Ee)return!1;return!0}function hl(t){if(t instanceof ce)return t.field.canonicalString()+t.op.toString()+Es(t.value);if(bh(t))return t.filters.map(e=>hl(e)).join(",");{const e=t.filters.map(n=>hl(n)).join(",");return`${t.op}(${e})`}}function my(t,e){return t instanceof ce?function(r,s){return s instanceof ce&&r.op===s.op&&r.field.isEqual(s.field)&&un(r.value,s.value)}(t,e):t instanceof Ee?function(r,s){return s instanceof Ee&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&my(o,s.filters[a]),!0):!1}(t,e):void q()}function py(t,e){const n=t.filters.concat(e);return Ee.create(n,t.op)}function gy(t){return t instanceof ce?function(n){return`${n.field.canonicalString()} ${n.op} ${Es(n.value)}`}(t):t instanceof Ee?function(n){return n.op.toString()+" {"+n.getFilters().map(gy).join(" ,")+"}"}(t):"Filter"}class dP extends ce{constructor(e,n,r){super(e,n,r),this.key=N.fromName(r.referenceValue)}matches(e){const n=N.comparator(e.key,this.key);return this.matchesComparison(n)}}class fP extends ce{constructor(e,n){super(e,"in",n),this.keys=_y("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class mP extends ce{constructor(e,n){super(e,"not-in",n),this.keys=_y("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function _y(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>N.fromName(r.referenceValue))}class pP extends ce{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return eo(n)&&Zi(n.arrayValue,this.value)}}class yy extends ce{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Zi(this.value.arrayValue,n)}}class gP extends ce{constructor(e,n){super(e,"not-in",n)}matches(e){if(Zi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Zi(this.value.arrayValue,n)}}class _P extends ce{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!eo(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Zi(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.he=null}}function dl(t,e=null,n=[],r=[],s=null,i=null,o=null){return new yP(t,e,n,r,s,i,o)}function kr(t){const e=M(t);if(e.he===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>hl(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),yo(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Es(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Es(r)).join(",")),e.he=n}return e.he}function vo(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!hP(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!my(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!fm(t.startAt,e.startAt)&&fm(t.endAt,e.endAt)}function Ca(t){return N.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function xa(t,e){return t.filters.filter(n=>n instanceof ce&&n.field.isEqual(e))}function mm(t,e,n){let r=ra,s=!0;for(const i of xa(t,e)){let o=ra,a=!0;switch(i.op){case"<":case"<=":o=uP(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=ra}lm({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];lm({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function pm(t,e,n){let r=Mn,s=!0;for(const i of xa(t,e)){let o=Mn,a=!0;switch(i.op){case">=":case">":o=lP(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=Mn}hm({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];hm({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.Pe=null,this.Ie=null,this.startAt,this.endAt}}function vy(t,e,n,r,s,i,o,a){return new vn(t,e,n,r,s,i,o,a)}function Bs(t){return new vn(t)}function gm(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Rh(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Tc(t){for(const e of t.filters){const n=e.getFirstInequalityField();if(n!==null)return n}return null}function Ph(t){return t.collectionGroup!==null}function Cr(t){const e=M(t);if(e.Pe===null){e.Pe=[];const n=Tc(e),r=Rh(e);if(n!==null&&r===null)n.isKeyField()||e.Pe.push(new hs(n)),e.Pe.push(new hs(Me.keyField(),"asc"));else{let s=!1;for(const i of e.explicitOrderBy)e.Pe.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.Pe.push(new hs(Me.keyField(),i))}}}return e.Pe}function vt(t){const e=M(t);if(!e.Ie)if(e.limitType==="F")e.Ie=dl(e.path,e.collectionGroup,Cr(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const i of Cr(e)){const o=i.dir==="desc"?"asc":"desc";n.push(new hs(i.field,o))}const r=e.endAt?new Jn(e.endAt.position,e.endAt.inclusive):null,s=e.startAt?new Jn(e.startAt.position,e.startAt.inclusive):null;e.Ie=dl(e.path,e.collectionGroup,n,e.filters,e.limit,r,s)}return e.Ie}function fl(t,e){e.getFirstInequalityField(),Tc(t);const n=t.filters.concat([e]);return new vn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Va(t,e,n){return new vn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Eo(t,e){return vo(vt(t),vt(e))&&t.limitType===e.limitType}function Ey(t){return`${kr(vt(t))}|lt:${t.limitType}`}function ml(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>gy(s)).join(", ")}]`),yo(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Es(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Es(s)).join(",")),`Target(${r})`}(vt(t))}; limitType=${t.limitType})`}function Io(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):N.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Cr(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,c){const u=dm(o,a,c);return o.inclusive?u<=0:u<0}(r.startAt,Cr(r),s)||r.endAt&&!function(o,a,c){const u=dm(o,a,c);return o.inclusive?u>=0:u>0}(r.endAt,Cr(r),s))}(t,e)}function Iy(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function wy(t){return(e,n)=>{let r=!1;for(const s of Cr(t)){const i=vP(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function vP(t,e,n){const r=t.field.isKeyField()?N.comparator(e.key,n.key):function(i,o,a){const c=o.data.field(i),u=a.data.field(i);return c!==null&&u!==null?Wn(c,u):q()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return q()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){rr(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return cy(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EP=new Re(N.comparator);function bt(){return EP}const Ty=new Re(N.comparator);function hi(...t){let e=Ty;for(const n of t)e=e.insert(n.key,n);return e}function Ay(t){let e=Ty;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function sn(){return Ti()}function by(){return Ti()}function Ti(){return new En(t=>t.toString(),(t,e)=>t.isEqual(e))}const IP=new Re(N.comparator),wP=new Ve(N.comparator);function se(...t){let e=wP;for(const n of t)e=e.add(n);return e}const TP=new Ve(ee);function Sh(){return TP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ry(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Yi(e)?"-0":e}}function Py(t){return{integerValue:""+t}}function Sy(t,e){return ry(e)?Py(e):Ry(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(){this._=void 0}}function AP(t,e,n){return t instanceof ws?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Ic(i)&&(i=wc(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof Nr?xy(t,e):t instanceof Or?Vy(t,e):function(s,i){const o=Cy(s,i),a=_m(o)+_m(s.Te);return ul(o)&&ul(s.Te)?Py(a):Ry(s.serializer,a)}(t,e)}function bP(t,e,n){return t instanceof Nr?xy(t,e):t instanceof Or?Vy(t,e):n}function Cy(t,e){return t instanceof Ts?function(r){return ul(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class ws extends Ac{}class Nr extends Ac{constructor(e){super(),this.elements=e}}function xy(t,e){const n=Dy(e);for(const r of t.elements)n.some(s=>un(s,r))||n.push(r);return{arrayValue:{values:n}}}class Or extends Ac{constructor(e){super(),this.elements=e}}function Vy(t,e){let n=Dy(e);for(const r of t.elements)n=n.filter(s=>!un(s,r));return{arrayValue:{values:n}}}class Ts extends Ac{constructor(e,n){super(),this.serializer=e,this.Te=n}}function _m(t){return Oe(t.integerValue||t.doubleValue)}function Dy(t){return eo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(e,n){this.field=e,this.transform=n}}function RP(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Nr&&s instanceof Nr||r instanceof Or&&s instanceof Or?vs(r.elements,s.elements,un):r instanceof Ts&&s instanceof Ts?un(r.Te,s.Te):r instanceof ws&&s instanceof ws}(t.transform,e.transform)}class PP{constructor(e,n){this.version=e,this.transformResults=n}}class ke{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new ke}static exists(e){return new ke(void 0,e)}static updateTime(e){return new ke(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function oa(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class bc{}function ky(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new qs(t.key,ke.none()):new Us(t.key,t.data,ke.none());{const n=t.data,r=ot.empty();let s=new Ve(Me.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new In(t.key,r,new At(s.toArray()),ke.none())}}function SP(t,e,n){t instanceof Us?function(s,i,o){const a=s.value.clone(),c=vm(s.fieldTransforms,i,o.transformResults);a.setAll(c),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof In?function(s,i,o){if(!oa(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=vm(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(Ny(s)),c.setAll(a),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Ai(t,e,n,r){return t instanceof Us?function(i,o,a,c){if(!oa(i.precondition,o))return a;const u=i.value.clone(),l=Em(i.fieldTransforms,c,o);return u.setAll(l),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof In?function(i,o,a,c){if(!oa(i.precondition,o))return a;const u=Em(i.fieldTransforms,c,o),l=o.data;return l.setAll(Ny(i)),l.setAll(u),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(i,o,a){return oa(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function CP(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Cy(r.transform,s||null);i!=null&&(n===null&&(n=ot.empty()),n.set(r.field,i))}return n||null}function ym(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&vs(r,s,(i,o)=>RP(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Us extends bc{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class In extends bc{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Ny(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function vm(t,e,n){const r=new Map;G(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,bP(o,a,n[s]))}return r}function Em(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,AP(i,o,e))}return r}class qs extends bc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ch extends bc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&SP(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Ai(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Ai(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=by();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const c=ky(o,a);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(H.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),se())}isEqual(e){return this.batchId===e.batchId&&vs(this.mutations,e.mutations,(n,r)=>ym(n,r))&&vs(this.baseMutations,e.baseMutations,(n,r)=>ym(n,r))}}class Vh{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){G(e.mutations.length===r.length);let s=function(){return IP}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Vh(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{constructor(e,n,r){this.alias=e,this.Ee=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ze,he;function Oy(t){switch(t){default:return q();case E.CANCELLED:case E.UNKNOWN:case E.DEADLINE_EXCEEDED:case E.RESOURCE_EXHAUSTED:case E.INTERNAL:case E.UNAVAILABLE:case E.UNAUTHENTICATED:return!1;case E.INVALID_ARGUMENT:case E.NOT_FOUND:case E.ALREADY_EXISTS:case E.PERMISSION_DENIED:case E.FAILED_PRECONDITION:case E.ABORTED:case E.OUT_OF_RANGE:case E.UNIMPLEMENTED:case E.DATA_LOSS:return!0}}function My(t){if(t===void 0)return Be("GRPC error has no .code"),E.UNKNOWN;switch(t){case ze.OK:return E.OK;case ze.CANCELLED:return E.CANCELLED;case ze.UNKNOWN:return E.UNKNOWN;case ze.DEADLINE_EXCEEDED:return E.DEADLINE_EXCEEDED;case ze.RESOURCE_EXHAUSTED:return E.RESOURCE_EXHAUSTED;case ze.INTERNAL:return E.INTERNAL;case ze.UNAVAILABLE:return E.UNAVAILABLE;case ze.UNAUTHENTICATED:return E.UNAUTHENTICATED;case ze.INVALID_ARGUMENT:return E.INVALID_ARGUMENT;case ze.NOT_FOUND:return E.NOT_FOUND;case ze.ALREADY_EXISTS:return E.ALREADY_EXISTS;case ze.PERMISSION_DENIED:return E.PERMISSION_DENIED;case ze.FAILED_PRECONDITION:return E.FAILED_PRECONDITION;case ze.ABORTED:return E.ABORTED;case ze.OUT_OF_RANGE:return E.OUT_OF_RANGE;case ze.UNIMPLEMENTED:return E.UNIMPLEMENTED;case ze.DATA_LOSS:return E.DATA_LOSS;default:return q()}}(he=ze||(ze={}))[he.OK=0]="OK",he[he.CANCELLED=1]="CANCELLED",he[he.UNKNOWN=2]="UNKNOWN",he[he.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",he[he.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",he[he.NOT_FOUND=5]="NOT_FOUND",he[he.ALREADY_EXISTS=6]="ALREADY_EXISTS",he[he.PERMISSION_DENIED=7]="PERMISSION_DENIED",he[he.UNAUTHENTICATED=16]="UNAUTHENTICATED",he[he.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",he[he.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",he[he.ABORTED=10]="ABORTED",he[he.OUT_OF_RANGE=11]="OUT_OF_RANGE",he[he.UNIMPLEMENTED=12]="UNIMPLEMENTED",he[he.INTERNAL=13]="INTERNAL",he[he.UNAVAILABLE=14]="UNAVAILABLE",he[he.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rc{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return Ko}static getOrCreateInstance(){return Ko===null&&(Ko=new Rc),Ko}onExistenceFilterMismatch(e){const n=Symbol();return this.onExistenceFilterMismatchCallbacks.set(n,e),()=>this.onExistenceFilterMismatchCallbacks.delete(n)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(n=>n(e))}}let Ko=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fy(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DP=new ls([4294967295,4294967295],0);function Im(t){const e=Fy().encode(t),n=new bR;return n.update(e),new Uint8Array(n.digest())}function wm(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new ls([n,r],0),new ls([s,i],0)]}class kh{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new di(`Invalid padding: ${n}`);if(r<0)throw new di(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new di(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new di(`Invalid padding when bitmap length is 0: ${n}`);this.de=8*e.length-n,this.Ae=ls.fromNumber(this.de)}Re(e,n,r){let s=e.add(n.multiply(ls.fromNumber(r)));return s.compare(DP)===1&&(s=new ls([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Ae).toNumber()}Ve(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.de===0)return!1;const n=Im(e),[r,s]=wm(n);for(let i=0;i<this.hashCount;i++){const o=this.Re(r,s,i);if(!this.Ve(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new kh(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.de===0)return;const n=Im(e),[r,s]=wm(n);for(let i=0;i<this.hashCount;i++){const o=this.Re(r,s,i);this.me(o)}}me(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class di extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Ao.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new To(H.min(),s,new Re(ee),bt(),se())}}class Ao{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Ao(r,n,se(),se(),se())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aa{constructor(e,n,r,s){this.fe=e,this.removedTargetIds=n,this.key=r,this.ge=s}}class Ly{constructor(e,n){this.targetId=e,this.pe=n}}class By{constructor(e,n,r=He.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Tm{constructor(){this.ye=0,this.we=bm(),this.Se=He.EMPTY_BYTE_STRING,this.be=!1,this.De=!0}get current(){return this.be}get resumeToken(){return this.Se}get ve(){return this.ye!==0}get Ce(){return this.De}Fe(e){e.approximateByteSize()>0&&(this.De=!0,this.Se=e)}Me(){let e=se(),n=se(),r=se();return this.we.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:q()}}),new Ao(this.Se,this.be,e,n,r)}xe(){this.De=!1,this.we=bm()}Oe(e,n){this.De=!0,this.we=this.we.insert(e,n)}Ne(e){this.De=!0,this.we=this.we.remove(e)}Be(){this.ye+=1}Le(){this.ye-=1}ke(){this.De=!0,this.be=!0}}class kP{constructor(e){this.qe=e,this.Qe=new Map,this.Ke=bt(),this.$e=Am(),this.Ue=new Re(ee)}We(e){for(const n of e.fe)e.ge&&e.ge.isFoundDocument()?this.Ge(n,e.ge):this.ze(n,e.key,e.ge);for(const n of e.removedTargetIds)this.ze(n,e.key,e.ge)}je(e){this.forEachTarget(e,n=>{const r=this.He(n);switch(e.state){case 0:this.Je(n)&&r.Fe(e.resumeToken);break;case 1:r.Le(),r.ve||r.xe(),r.Fe(e.resumeToken);break;case 2:r.Le(),r.ve||this.removeTarget(n);break;case 3:this.Je(n)&&(r.ke(),r.Fe(e.resumeToken));break;case 4:this.Je(n)&&(this.Ye(n),r.Fe(e.resumeToken));break;default:q()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Qe.forEach((r,s)=>{this.Je(s)&&n(s)})}Ze(e){var n,r;const s=e.targetId,i=e.pe.count,o=this.Xe(s);if(o){const a=o.target;if(Ca(a))if(i===0){const c=new N(a.path);this.ze(s,c,xe.newNoDocument(c,H.min()))}else G(i===1);else{const c=this.et(s);if(c!==i){const u=this.tt(e,c);if(u.status!==0){this.Ye(s);const l=u.status===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ue=this.Ue.insert(s,l)}(n=Rc.instance)===null||n===void 0||n.notifyOnExistenceFilterMismatch(function(h,d,f,g){var v,I,A,R,V,D;const j={localCacheCount:f,existenceFilterCount:g.count},X=g.unchangedNames;return X&&(j.bloomFilter={applied:h===0,hashCount:(v=X==null?void 0:X.hashCount)!==null&&v!==void 0?v:0,bitmapLength:(R=(A=(I=X==null?void 0:X.bits)===null||I===void 0?void 0:I.bitmap)===null||A===void 0?void 0:A.length)!==null&&R!==void 0?R:0,padding:(D=(V=X==null?void 0:X.bits)===null||V===void 0?void 0:V.padding)!==null&&D!==void 0?D:0},d&&(j.bloomFilter.mightContain=d)),j}(u.status,(r=u.nt)!==null&&r!==void 0?r:null,c,e.pe))}}}}tt(e,n){const{unchangedNames:r,count:s}=e.pe;if(!r||!r.bits)return{status:1};const{bits:{bitmap:i="",padding:o=0},hashCount:a=0}=r;let c,u;try{c=_n(i).toUint8Array()}catch(h){if(h instanceof uy)return Ft("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),{status:1};throw h}try{u=new kh(c,o,a)}catch(h){return Ft(h instanceof di?"BloomFilter error: ":"Applying bloom filter failed: ",h),{status:1}}const l=h=>{const d=this.qe.rt();return u.mightContain(`projects/${d.projectId}/databases/${d.database}/documents/${h}`)};return u.de===0?{status:1}:{status:s===n-this.it(e.targetId,l)?0:2,nt:l}}it(e,n){const r=this.qe.getRemoteKeysForTarget(e);let s=0;return r.forEach(i=>{n(i.path.canonicalString())||(this.ze(e,i,null),s++)}),s}st(e){const n=new Map;this.Qe.forEach((i,o)=>{const a=this.Xe(o);if(a){if(i.current&&Ca(a.target)){const c=new N(a.target.path);this.Ke.get(c)!==null||this.ot(o,c)||this.ze(o,c,xe.newNoDocument(c,e))}i.Ce&&(n.set(o,i.Me()),i.xe())}});let r=se();this.$e.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const u=this.Xe(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.Ke.forEach((i,o)=>o.setReadTime(e));const s=new To(e,n,this.Ue,this.Ke,r);return this.Ke=bt(),this.$e=Am(),this.Ue=new Re(ee),s}Ge(e,n){if(!this.Je(e))return;const r=this.ot(e,n.key)?2:0;this.He(e).Oe(n.key,r),this.Ke=this.Ke.insert(n.key,n),this.$e=this.$e.insert(n.key,this._t(n.key).add(e))}ze(e,n,r){if(!this.Je(e))return;const s=this.He(e);this.ot(e,n)?s.Oe(n,1):s.Ne(n),this.$e=this.$e.insert(n,this._t(n).delete(e)),r&&(this.Ke=this.Ke.insert(n,r))}removeTarget(e){this.Qe.delete(e)}et(e){const n=this.He(e).Me();return this.qe.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Be(e){this.He(e).Be()}He(e){let n=this.Qe.get(e);return n||(n=new Tm,this.Qe.set(e,n)),n}_t(e){let n=this.$e.get(e);return n||(n=new Ve(ee),this.$e=this.$e.insert(e,n)),n}Je(e){const n=this.Xe(e)!==null;return n||S("WatchChangeAggregator","Detected inactive target",e),n}Xe(e){const n=this.Qe.get(e);return n&&n.ve?null:this.qe.ut(e)}Ye(e){this.Qe.set(e,new Tm),this.qe.getRemoteKeysForTarget(e).forEach(n=>{this.ze(e,n,null)})}ot(e,n){return this.qe.getRemoteKeysForTarget(e).has(n)}}function Am(){return new Re(N.comparator)}function bm(){return new Re(N.comparator)}const NP=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),OP=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),MP=(()=>({and:"AND",or:"OR"}))();class FP{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function pl(t,e){return t.useProto3Json||yo(e)?e:{value:e}}function As(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Uy(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function LP(t,e){return As(t,e.toTimestamp())}function qe(t){return G(!!t),H.fromTimestamp(function(n){const r=Gn(n);return new Ne(r.seconds,r.nanos)}(t))}function Nh(t,e){return function(r){return new de(["projects",r.projectId,"databases",r.database])}(t).child("documents").child(e).canonicalString()}function qy(t){const e=de.fromString(t);return G(Wy(e)),e}function to(t,e){return Nh(t.databaseId,e.path)}function an(t,e){const n=qy(e);if(n.get(1)!==t.databaseId.projectId)throw new b(E.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new b(E.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new N(jy(n))}function gl(t,e){return Nh(t.databaseId,e)}function $y(t){const e=qy(t);return e.length===4?de.emptyPath():jy(e)}function no(t){return new de(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function jy(t){return G(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Rm(t,e,n){return{name:to(t,e),fields:n.value.mapValue.fields}}function zy(t,e,n){const r=an(t,e.name),s=qe(e.updateTime),i=e.createTime?qe(e.createTime):H.min(),o=new ot({mapValue:{fields:e.fields}}),a=xe.newFoundDocument(r,s,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function BP(t,e){return"found"in e?function(r,s){G(!!s.found),s.found.name,s.found.updateTime;const i=an(r,s.found.name),o=qe(s.found.updateTime),a=s.found.createTime?qe(s.found.createTime):H.min(),c=new ot({mapValue:{fields:s.found.fields}});return xe.newFoundDocument(i,o,a,c)}(t,e):"missing"in e?function(r,s){G(!!s.missing),G(!!s.readTime);const i=an(r,s.missing),o=qe(s.readTime);return xe.newNoDocument(i,o)}(t,e):q()}function UP(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:q()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,l){return u.useProto3Json?(G(l===void 0||typeof l=="string"),He.fromBase64String(l||"")):(G(l===void 0||l instanceof Uint8Array),He.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const l=u.code===void 0?E.UNKNOWN:My(u.code);return new b(l,u.message||"")}(o);n=new By(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=an(t,r.document.name),i=qe(r.document.updateTime),o=r.document.createTime?qe(r.document.createTime):H.min(),a=new ot({mapValue:{fields:r.document.fields}}),c=xe.newFoundDocument(s,i,o,a),u=r.targetIds||[],l=r.removedTargetIds||[];n=new aa(u,l,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=an(t,r.document),i=r.readTime?qe(r.readTime):H.min(),o=xe.newNoDocument(s,i),a=r.removedTargetIds||[];n=new aa([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=an(t,r.document),i=r.removedTargetIds||[];n=new aa([],i,s,null)}else{if(!("filter"in e))return q();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new VP(s,i),a=r.targetId;n=new Ly(a,o)}}return n}function ro(t,e){let n;if(e instanceof Us)n={update:Rm(t,e.key,e.value)};else if(e instanceof qs)n={delete:to(t,e.key)};else if(e instanceof In)n={update:Rm(t,e.key,e.data),updateMask:GP(e.fieldMask)};else{if(!(e instanceof Ch))return q();n={verify:to(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof ws)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Nr)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Or)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ts)return{fieldPath:o.field.canonicalString(),increment:a.Te};throw q()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:LP(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:q()}(t,e.precondition)),n}function _l(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?ke.updateTime(qe(i.updateTime)):i.exists!==void 0?ke.exists(i.exists):ke.none()}(e.currentDocument):ke.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let c=null;if("setToServerValue"in a)G(a.setToServerValue==="REQUEST_TIME"),c=new ws;else if("appendMissingElements"in a){const l=a.appendMissingElements.values||[];c=new Nr(l)}else if("removeAllFromArray"in a){const l=a.removeAllFromArray.values||[];c=new Or(l)}else"increment"in a?c=new Ts(o,a.increment):q();const u=Me.fromServerFormat(a.fieldPath);return new wo(u,c)}(t,s)):[];if(e.update){e.update.name;const s=an(t,e.update.name),i=new ot({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const u=c.fieldPaths||[];return new At(u.map(l=>Me.fromServerFormat(l)))}(e.updateMask);return new In(s,i,o,n,r)}return new Us(s,i,n,r)}if(e.delete){const s=an(t,e.delete);return new qs(s,n)}if(e.verify){const s=an(t,e.verify);return new Ch(s,n)}return q()}function qP(t,e){return t&&t.length>0?(G(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?qe(s.updateTime):qe(i);return o.isEqual(H.min())&&(o=qe(i)),new PP(o,s.transformResults||[])}(n,e))):[]}function Ky(t,e){return{documents:[gl(t,e.path)]}}function Oh(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=gl(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=gl(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(c){if(c.length!==0)return Qy(Ee.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const i=function(c){if(c.length!==0)return c.map(u=>function(h){return{field:kn(h.field),direction:jP(h.dir)}}(u))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const o=pl(t,e.limit);return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),n}function Gy(t){let e=$y(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){G(r===1);const l=n.from[0];l.allDescendants?s=l.collectionId:e=e.child(l.collectionId)}let i=[];n.where&&(i=function(h){const d=Hy(h);return d instanceof Ee&&bh(d)?d.getFilters():[d]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(d=>function(g){return new hs(ts(g.field),function(I){switch(I){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(d))}(n.orderBy));let a=null;n.limit&&(a=function(h){let d;return d=typeof h=="object"?h.value:h,yo(d)?null:d}(n.limit));let c=null;n.startAt&&(c=function(h){const d=!!h.before,f=h.values||[];return new Jn(f,d)}(n.startAt));let u=null;return n.endAt&&(u=function(h){const d=!h.before,f=h.values||[];return new Jn(f,d)}(n.endAt)),vy(e,s,o,i,a,"F",c,u)}function $P(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return q()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Hy(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=ts(n.unaryFilter.field);return ce.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=ts(n.unaryFilter.field);return ce.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ts(n.unaryFilter.field);return ce.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ts(n.unaryFilter.field);return ce.create(o,"!=",{nullValue:"NULL_VALUE"});default:return q()}}(t):t.fieldFilter!==void 0?function(n){return ce.create(ts(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return q()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ee.create(n.compositeFilter.filters.map(r=>Hy(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return q()}}(n.compositeFilter.op))}(t):q()}function jP(t){return NP[t]}function zP(t){return OP[t]}function KP(t){return MP[t]}function kn(t){return{fieldPath:t.canonicalString()}}function ts(t){return Me.fromServerFormat(t.fieldPath)}function Qy(t){return t instanceof ce?function(n){if(n.op==="=="){if(um(n.value))return{unaryFilter:{field:kn(n.field),op:"IS_NAN"}};if(cm(n.value))return{unaryFilter:{field:kn(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(um(n.value))return{unaryFilter:{field:kn(n.field),op:"IS_NOT_NAN"}};if(cm(n.value))return{unaryFilter:{field:kn(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:kn(n.field),op:zP(n.op),value:n.value}}}(t):t instanceof Ee?function(n){const r=n.getFilters().map(s=>Qy(s));return r.length===1?r[0]:{compositeFilter:{op:KP(n.op),filters:r}}}(t):q()}function GP(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Wy(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e,n,r,s,i=H.min(),o=H.min(),a=He.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new mn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new mn(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new mn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new mn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy{constructor(e){this.ct=e}}function HP(t,e){let n;if(e.document)n=zy(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=N.fromSegments(e.noDocument.path),s=Fr(e.noDocument.readTime);n=xe.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return q();{const r=N.fromSegments(e.unknownDocument.path),s=Fr(e.unknownDocument.version);n=xe.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new Ne(s[0],s[1]);return H.fromTimestamp(i)}(e.readTime)),n}function Pm(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Da(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:to(i,o.key),fields:o.data.value.mapValue.fields,updateTime:As(i,o.version.toTimestamp()),createTime:As(i,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Mr(e.version)};else{if(!e.isUnknownDocument())return q();r.unknownDocument={path:n.path.toArray(),version:Mr(e.version)}}return r}function Da(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Mr(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Fr(t){const e=new Ne(t.seconds,t.nanoseconds);return H.fromTimestamp(e)}function vr(t,e){const n=(e.baseMutations||[]).map(i=>_l(t.ct,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>_l(t.ct,i)),s=Ne.fromMillis(e.localWriteTimeMs);return new xh(e.batchId,s,n,r)}function fi(t){const e=Fr(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Fr(t.lastLimboFreeSnapshotVersion):H.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){return G(i.documents.length===1),vt(Bs($y(i.documents[0])))}(t.query):function(i){return vt(Gy(i))}(t.query),new mn(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,He.fromBase64String(t.resumeToken))}function Yy(t,e){const n=Mr(e.snapshotVersion),r=Mr(e.lastLimboFreeSnapshotVersion);let s;s=Ca(e.target)?Ky(t.ct,e.target):Oh(t.ct,e.target);const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:kr(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function Mh(t){const e=Gy({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Va(e,e.limit,"L"):e}function gu(t,e){return new Dh(e.largestBatchId,_l(t.ct,e.overlayMutation))}function Sm(t,e){const n=e.path.lastSegment();return[t,pt(e.path.popLast()),n]}function Cm(t,e,n,r){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:Mr(r.readTime),documentKey:pt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QP{getBundleMetadata(e,n){return xm(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:Fr(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return xm(e).put(function(s){return{bundleId:s.id,createTime:Mr(qe(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return Vm(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:Mh(i.bundledQuery),readTime:Fr(i.readTime)}}(r)})}saveNamedQuery(e,n){return Vm(e).put(function(s){return{name:s.name,readTime:Mr(qe(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function xm(t){return nt(t,"bundles")}function Vm(t){return nt(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new Pc(e,r)}getOverlay(e,n){return ti(e).get(Sm(this.userId,n)).next(r=>r?gu(this.serializer,r):null)}getOverlays(e,n){const r=sn();return y.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new Dh(n,o);s.push(this.ht(e,a))}),y.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(pt(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(ti(e).J("collectionPathOverlayIndex",a))}),y.waitFor(i)}getOverlaysForCollection(e,n,r){const s=sn(),i=pt(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return ti(e).G("collectionPathOverlayIndex",o).next(a=>{for(const c of a){const u=gu(this.serializer,c);s.set(u.getKey(),u)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=sn();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return ti(e).Z({index:"collectionGroupOverlayIndex",range:a},(c,u,l)=>{const h=gu(this.serializer,u);i.size()<s||h.largestBatchId===o?(i.set(h.getKey(),h),o=h.largestBatchId):l.done()}).next(()=>i)}ht(e,n){return ti(e).put(function(s,i,o){const[a,c,u]=Sm(i,o.mutation.key);return{userId:i,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:ro(s.ct,o.mutation)}}(this.serializer,this.userId,n))}}function ti(t){return nt(t,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(){}Pt(e,n){this.It(e,n),n.Tt()}It(e,n){if("nullValue"in e)this.Et(n,5);else if("booleanValue"in e)this.Et(n,10),n.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(n,15),n.dt(Oe(e.integerValue));else if("doubleValue"in e){const r=Oe(e.doubleValue);isNaN(r)?this.Et(n,13):(this.Et(n,15),Yi(r)?n.dt(0):n.dt(r))}else if("timestampValue"in e){const r=e.timestampValue;this.Et(n,20),typeof r=="string"?n.At(r):(n.At(`${r.seconds||""}`),n.dt(r.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,n),this.Vt(n);else if("bytesValue"in e)this.Et(n,30),n.ft(_n(e.bytesValue)),this.Vt(n);else if("referenceValue"in e)this.gt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Et(n,45),n.dt(r.latitude||0),n.dt(r.longitude||0)}else"mapValue"in e?ly(e)?this.Et(n,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,n),this.Vt(n)):"arrayValue"in e?(this.wt(e.arrayValue,n),this.Vt(n)):q()}Rt(e,n){this.Et(n,25),this.St(e,n)}St(e,n){n.At(e)}yt(e,n){const r=e.fields||{};this.Et(n,55);for(const s of Object.keys(r))this.Rt(s,n),this.It(r[s],n)}wt(e,n){const r=e.values||[];this.Et(n,50);for(const s of r)this.It(s,n)}gt(e,n){this.Et(n,37),N.fromName(e).path.forEach(r=>{this.Et(n,60),this.St(r,n)})}Et(e,n){e.dt(n)}Vt(e){e.dt(2)}}Er.bt=new Er;function WP(t){if(t===0)return 8;let e=0;return t>>4==0&&(e+=4,t<<=4),t>>6==0&&(e+=2,t<<=2),t>>7==0&&(e+=1),e}function Dm(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=WP(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class JP{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.vt(r.value),r=n.next();this.Ct()}Ft(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Mt(r.value),r=n.next();this.xt()}Ot(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.vt(r);else if(r<2048)this.vt(960|r>>>6),this.vt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.vt(480|r>>>12),this.vt(128|63&r>>>6),this.vt(128|63&r);else{const s=n.codePointAt(0);this.vt(240|s>>>18),this.vt(128|63&s>>>12),this.vt(128|63&s>>>6),this.vt(128|63&s)}}this.Ct()}Nt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{const s=n.codePointAt(0);this.Mt(240|s>>>18),this.Mt(128|63&s>>>12),this.Mt(128|63&s>>>6),this.Mt(128|63&s)}}this.xt()}Bt(e){const n=this.Lt(e),r=Dm(n);this.kt(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}qt(e){const n=this.Lt(e),r=Dm(n);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Lt(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}vt(e){const n=255&e;n===0?(this.Kt(0),this.Kt(255)):n===255?(this.Kt(255),this.Kt(0)):this.Kt(n)}Mt(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}Ct(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class YP{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Bt(e)}Tt(){this.Gt.Qt()}}class XP{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}}class ni{constructor(){this.Gt=new JP,this.zt=new YP(this.Gt),this.jt=new XP(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e,n,r,s){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=s}Jt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Ir(this.indexId,this.documentKey,this.arrayValue,r)}}function Sn(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=km(t.arrayValue,e.arrayValue),n!==0?n:(n=km(t.directionalValue,e.directionalValue),n!==0?n:N.comparator(t.documentKey,e.documentKey)))}function km(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{constructor(e){this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=r:this.Zt.push(r)}}en(e){G(e.collectionGroup===this.collectionId);const n=ol(e);if(n!==void 0&&!this.tn(n))return!1;const r=mr(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.tn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Xt!==void 0){if(!s.has(this.Xt.field.canonicalString())){const a=r[i];if(!this.nn(this.Xt,a)||!this.rn(this.Yt[o++],a))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.Yt.length||!this.rn(this.Yt[o++],a))return!1}return!0}tn(e){for(const n of this.Zt)if(this.nn(n,e))return!0;return!1}nn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}rn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xy(t){var e,n;if(G(t instanceof ce||t instanceof Ee),t instanceof ce){if(t instanceof yy){const s=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(i=>ce.create(t.field,"==",i)))||[];return Ee.create(s,"or")}return t}const r=t.filters.map(s=>Xy(s));return Ee.create(r,t.op)}function eS(t){if(t.getFilters().length===0)return[];const e=El(Xy(t));return G(Zy(e)),yl(e)||vl(e)?[e]:e.getFilters()}function yl(t){return t instanceof ce}function vl(t){return t instanceof Ee&&bh(t)}function Zy(t){return yl(t)||vl(t)||function(n){if(n instanceof Ee&&ll(n)){for(const r of n.getFilters())if(!yl(r)&&!vl(r))return!1;return!0}return!1}(t)}function El(t){if(G(t instanceof ce||t instanceof Ee),t instanceof ce)return t;if(t.filters.length===1)return El(t.filters[0]);const e=t.filters.map(r=>El(r));let n=Ee.create(e,t.op);return n=ka(n),Zy(n)?n:(G(n instanceof Ee),G(Is(n)),G(n.filters.length>1),n.filters.reduce((r,s)=>Fh(r,s)))}function Fh(t,e){let n;return G(t instanceof ce||t instanceof Ee),G(e instanceof ce||e instanceof Ee),n=t instanceof ce?e instanceof ce?function(s,i){return Ee.create([s,i],"and")}(t,e):Nm(t,e):e instanceof ce?Nm(e,t):function(s,i){if(G(s.filters.length>0&&i.filters.length>0),Is(s)&&Is(i))return py(s,i.getFilters());const o=ll(s)?s:i,a=ll(s)?i:s,c=o.filters.map(u=>Fh(u,a));return Ee.create(c,"or")}(t,e),ka(n)}function Nm(t,e){if(Is(e))return py(e,t.getFilters());{const n=e.filters.map(r=>Fh(t,r));return Ee.create(n,"or")}}function ka(t){if(G(t instanceof ce||t instanceof Ee),t instanceof ce)return t;const e=t.getFilters();if(e.length===1)return ka(e[0]);if(fy(t))return t;const n=e.map(s=>ka(s)),r=[];return n.forEach(s=>{s instanceof ce?r.push(s):s instanceof Ee&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Ee.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tS{constructor(){this.sn=new Lh}addToCollectionParentIndex(e,n){return this.sn.add(n),y.resolve()}getCollectionParents(e,n){return y.resolve(this.sn.getEntries(n))}addFieldIndex(e,n){return y.resolve()}deleteFieldIndex(e,n){return y.resolve()}getDocumentsMatchingTarget(e,n){return y.resolve(null)}getIndexType(e,n){return y.resolve(0)}getFieldIndexes(e,n){return y.resolve([])}getNextCollectionGroupToUpdate(e){return y.resolve(null)}getMinOffset(e,n){return y.resolve(Vt.min())}getMinOffsetFromCollectionGroup(e,n){return y.resolve(Vt.min())}updateCollectionGroup(e,n,r){return y.resolve()}updateIndexEntries(e,n){return y.resolve()}}class Lh{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Ve(de.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Ve(de.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Go=new Uint8Array(0);class nS{constructor(e,n){this.user=e,this.databaseId=n,this.on=new Lh,this._n=new En(r=>kr(r),(r,s)=>vo(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.on.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.on.add(n)});const i={collectionId:r,parent:pt(s)};return Om(e).put(i)}return y.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[X_(n),""],!1,!0);return Om(e).G(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(rn(o.parent))}return r})}addFieldIndex(e,n){const r=Ho(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=si(e);return i.next(a=>{o.put(Cm(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=Ho(e),s=si(e),i=ri(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,n){const r=ri(e);let s=!0;const i=new Map;return y.forEach(this.an(n),o=>this.un(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=se();const a=[];return y.forEach(i,(c,u)=>{S("IndexedDbIndexManager",`Using index ${function(V){return`id=${V.indexId}|cg=${V.collectionGroup}|f=${V.fields.map(D=>`${D.fieldPath}:${D.kind}`).join(",")}`}(c)} to execute ${kr(n)}`);const l=function(V,D){const j=ol(D);if(j===void 0)return null;for(const X of xa(V,j.fieldPath))switch(X.op){case"array-contains-any":return X.value.arrayValue.values||[];case"array-contains":return[X.value]}return null}(u,c),h=function(V,D){const j=new Map;for(const X of mr(D))for(const oe of xa(V,X.fieldPath))switch(oe.op){case"==":case"in":j.set(X.fieldPath.canonicalString(),oe.value);break;case"not-in":case"!=":return j.set(X.fieldPath.canonicalString(),oe.value),Array.from(j.values())}return null}(u,c),d=function(V,D){const j=[];let X=!0;for(const oe of mr(D)){const B=oe.kind===0?mm(V,oe.fieldPath,V.startAt):pm(V,oe.fieldPath,V.startAt);j.push(B.value),X&&(X=B.inclusive)}return new Jn(j,X)}(u,c),f=function(V,D){const j=[];let X=!0;for(const oe of mr(D)){const B=oe.kind===0?pm(V,oe.fieldPath,V.endAt):mm(V,oe.fieldPath,V.endAt);j.push(B.value),X&&(X=B.inclusive)}return new Jn(j,X)}(u,c),g=this.cn(c,u,d),v=this.cn(c,u,f),I=this.ln(c,u,h),A=this.hn(c.indexId,l,g,d.inclusive,v,f.inclusive,I);return y.forEach(A,R=>r.H(R,n.limit).next(V=>{V.forEach(D=>{const j=N.fromSegments(D.documentKey);o.has(j)||(o=o.add(j),a.push(j))})}))}).next(()=>a)}return y.resolve(null)})}an(e){let n=this._n.get(e);return n||(e.filters.length===0?n=[e]:n=eS(Ee.create(e.filters,"and")).map(r=>dl(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this._n.set(e,n),n)}hn(e,n,r,s,i,o,a){const c=(n!=null?n.length:1)*Math.max(r.length,i.length),u=c/(n!=null?n.length:1),l=[];for(let h=0;h<c;++h){const d=n?this.Pn(n[h/u]):Go,f=this.In(e,d,r[h%u],s),g=this.Tn(e,d,i[h%u],o),v=a.map(I=>this.In(e,d,I,!0));l.push(...this.createRange(f,g,v))}return l}In(e,n,r,s){const i=new Ir(e,N.empty(),n,r);return s?i:i.Jt()}Tn(e,n,r,s){const i=new Ir(e,N.empty(),n,r);return s?i.Jt():i}un(e,n){const r=new ZP(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.en(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const s=this.an(n);return y.forEach(s,i=>this.un(e,i).next(o=>{o?r!==0&&o.fields.length<function(c){let u=new Ve(Me.comparator),l=!1;for(const h of c.filters)for(const d of h.getFlattenedFilters())d.field.isKeyField()||(d.op==="array-contains"||d.op==="array-contains-any"?l=!0:u=u.add(d.field));for(const h of c.orderBy)h.field.isKeyField()||(u=u.add(h.field));return u.size+(l?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}En(e,n){const r=new ni;for(const s of mr(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Ht(s.kind);Er.bt.Pt(i,o)}return r.Wt()}Pn(e){const n=new ni;return Er.bt.Pt(e,n.Ht(0)),n.Wt()}dn(e,n){const r=new ni;return Er.bt.Pt(Dr(this.databaseId,n),r.Ht(function(i){const o=mr(i);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}ln(e,n,r){if(r===null)return[];let s=[];s.push(new ni);let i=0;for(const o of mr(e)){const a=r[i++];for(const c of s)if(this.An(n,o.fieldPath)&&eo(a))s=this.Rn(s,o,a);else{const u=c.Ht(o.kind);Er.bt.Pt(a,u)}}return this.Vn(s)}cn(e,n,r){return this.ln(e,n,r.position)}Vn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Wt();return n}Rn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const c=new ni;c.seed(a.Wt()),Er.bt.Pt(o,c.Ht(n.kind)),i.push(c)}return i}An(e,n){return!!e.filters.find(r=>r instanceof ce&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Ho(e),s=si(e);return(n?r.G("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.G()).next(i=>{const o=[];return y.forEach(i,a=>s.get([a.indexId,this.uid]).next(c=>{o.push(function(l,h){const d=h?new Ji(h.sequenceNumber,new Vt(Fr(h.readTime),new N(rn(h.documentKey)),h.largestBatchId)):Ji.empty(),f=l.fields.map(([g,v])=>new ta(Me.fromServerFormat(g),v));return new Sa(l.indexId,l.collectionGroup,f,d)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:ee(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=Ho(e),i=si(e);return this.mn(e).next(o=>s.G("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>y.forEach(a,c=>i.put(Cm(c.indexId,this.user,o,r)))))}updateIndexEntries(e,n){const r=new Map;return y.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?y.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),y.forEach(a,c=>this.fn(e,s,c).next(u=>{const l=this.gn(i,c);return u.isEqual(l)?y.resolve():this.pn(e,i,c,u,l)}))))})}yn(e,n,r,s){return ri(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.dn(r,n.key),documentKey:n.key.path.toArray()})}wn(e,n,r,s){return ri(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.dn(r,n.key),n.key.path.toArray()])}fn(e,n,r){const s=ri(e);let i=new Ve(Sn);return s.Z({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.dn(r,n)])},(o,a)=>{i=i.add(new Ir(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>i)}gn(e,n){let r=new Ve(Sn);const s=this.En(n,e);if(s==null)return r;const i=ol(n);if(i!=null){const o=e.data.field(i.fieldPath);if(eo(o))for(const a of o.arrayValue.values||[])r=r.add(new Ir(n.indexId,e.key,this.Pn(a),s))}else r=r.add(new Ir(n.indexId,e.key,Go,s));return r}pn(e,n,r,s,i){S("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(c,u,l,h,d){const f=c.getIterator(),g=u.getIterator();let v=Xr(f),I=Xr(g);for(;v||I;){let A=!1,R=!1;if(v&&I){const V=l(v,I);V<0?R=!0:V>0&&(A=!0)}else v!=null?R=!0:A=!0;A?(h(I),I=Xr(g)):R?(d(v),v=Xr(f)):(v=Xr(f),I=Xr(g))}}(s,i,Sn,a=>{o.push(this.yn(e,n,r,a))},a=>{o.push(this.wn(e,n,r,a))}),y.waitFor(o)}mn(e){let n=1;return si(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Sn(o,a)).filter((o,a,c)=>!a||Sn(o,c[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=Sn(o,e),c=Sn(o,n);if(a===0)s[0]=e.Jt();else if(a>0&&c<0)s.push(o),s.push(o.Jt());else if(c>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Sn(s[o],s[o+1]))return[];const a=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,Go,[]],c=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,Go,[]];i.push(IDBKeyRange.bound(a,c))}return i}Sn(e,n){return Sn(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(Mm)}getMinOffset(e,n){return y.mapArray(this.an(n),r=>this.un(e,r).next(s=>s||q())).next(Mm)}}function Om(t){return nt(t,"collectionParents")}function ri(t){return nt(t,"indexEntries")}function Ho(t){return nt(t,"indexConfiguration")}function si(t){return nt(t,"indexState")}function Mm(t){G(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;Th(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new Vt(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fm={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class ht{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new ht(e,ht.DEFAULT_COLLECTION_PERCENTILE,ht.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ev(t,e,n){const r=t.store("mutations"),s=t.store("documentMutations"),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.Z({range:o},(l,h,d)=>(a++,d.delete()));i.push(c.next(()=>{G(a===1)}));const u=[];for(const l of n.mutations){const h=sy(e,l.key.path,n.batchId);i.push(s.delete(h)),u.push(l.key)}return y.waitFor(i).next(()=>u)}function Na(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw q();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ht.DEFAULT_COLLECTION_PERCENTILE=10,ht.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ht.DEFAULT=new ht(41943040,ht.DEFAULT_COLLECTION_PERCENTILE,ht.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ht.DISABLED=new ht(-1,0,0);class Sc{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.bn={}}static lt(e,n,r,s){G(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new Sc(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Cn(e).Z({index:"userMutationsIndex",range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=ns(e),o=Cn(e);return o.add({}).next(a=>{G(typeof a=="number");const c=new xh(a,n,r,s),u=function(f,g,v){const I=v.baseMutations.map(R=>ro(f.ct,R)),A=v.mutations.map(R=>ro(f.ct,R));return{userId:g,batchId:v.batchId,localWriteTimeMs:v.localWriteTime.toMillis(),baseMutations:I,mutations:A}}(this.serializer,this.userId,c),l=[];let h=new Ve((d,f)=>ee(d.canonicalString(),f.canonicalString()));for(const d of s){const f=sy(this.userId,d.key.path,a);h=h.add(d.key.path.popLast()),l.push(o.put(u)),l.push(i.put(f,jR))}return h.forEach(d=>{l.push(this.indexManager.addToCollectionParentIndex(e,d))}),e.addOnCommittedListener(()=>{this.bn[a]=c.keys()}),y.waitFor(l).next(()=>c)})}lookupMutationBatch(e,n){return Cn(e).get(n).next(r=>r?(G(r.userId===this.userId),vr(this.serializer,r)):null)}Dn(e,n){return this.bn[n]?y.resolve(this.bn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.bn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Cn(e).Z({index:"userMutationsIndex",range:s},(o,a,c)=>{a.userId===this.userId&&(G(a.batchId>=r),i=vr(this.serializer,a)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Cn(e).Z({index:"userMutationsIndex",range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Cn(e).G("userMutationsIndex",n).next(r=>r.map(s=>vr(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=na(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return ns(e).Z({range:s},(o,a,c)=>{const[u,l,h]=o,d=rn(l);if(u===this.userId&&n.path.isEqual(d))return Cn(e).get(h).next(f=>{if(!f)throw q();G(f.userId===this.userId),i.push(vr(this.serializer,f))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ve(ee);const s=[];return n.forEach(i=>{const o=na(this.userId,i.path),a=IDBKeyRange.lowerBound(o),c=ns(e).Z({range:a},(u,l,h)=>{const[d,f,g]=u,v=rn(f);d===this.userId&&i.path.isEqual(v)?r=r.add(g):h.done()});s.push(c)}),y.waitFor(s).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=na(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new Ve(ee);return ns(e).Z({range:o},(c,u,l)=>{const[h,d,f]=c,g=rn(d);h===this.userId&&r.isPrefixOf(g)?g.length===s&&(a=a.add(f)):l.done()}).next(()=>this.vn(e,a))}vn(e,n){const r=[],s=[];return n.forEach(i=>{s.push(Cn(e).get(i).next(o=>{if(o===null)throw q();G(o.userId===this.userId),r.push(vr(this.serializer,o))}))}),y.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return ev(e.ue,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Cn(n.batchId)}),y.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}Cn(e){delete this.bn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return y.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return ns(e).Z({range:r},(i,o,a)=>{if(i[0]===this.userId){const c=rn(i[1]);s.push(c)}else a.done()}).next(()=>{G(s.length===0)})})}containsKey(e,n){return tv(e,this.userId,n)}Fn(e){return nv(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function tv(t,e,n){const r=na(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return ns(t).Z({range:i,Y:!0},(a,c,u)=>{const[l,h,d]=a;l===e&&h===s&&(o=!0),u.done()}).next(()=>o)}function Cn(t){return nt(t,"mutations")}function ns(t){return nt(t,"documentMutations")}function nv(t){return nt(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e){this.Mn=e}next(){return this.Mn+=2,this.Mn}static xn(){return new Lr(0)}static On(){return new Lr(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Nn(e).next(n=>{const r=new Lr(n.highestTargetId);return n.highestTargetId=r.next(),this.Bn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Nn(e).next(n=>H.fromTimestamp(new Ne(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Nn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Nn(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.Bn(e,s)))}addTargetData(e,n){return this.Ln(e,n).next(()=>this.Nn(e).next(r=>(r.targetCount+=1,this.kn(n,r),this.Bn(e,r))))}updateTargetData(e,n){return this.Ln(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Zr(e).delete(n.targetId)).next(()=>this.Nn(e)).next(r=>(G(r.targetCount>0),r.targetCount-=1,this.Bn(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return Zr(e).Z((o,a)=>{const c=fi(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>y.waitFor(i)).next(()=>s)}forEachTarget(e,n){return Zr(e).Z((r,s)=>{const i=fi(s);n(i)})}Nn(e){return Lm(e).get("targetGlobalKey").next(n=>(G(n!==null),n))}Bn(e,n){return Lm(e).put("targetGlobalKey",n)}Ln(e,n){return Zr(e).put(Yy(this.serializer,n))}kn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Nn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=kr(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Zr(e).Z({range:s,index:"queryTargetsIndex"},(o,a,c)=>{const u=fi(a);vo(n,u.target)&&(i=u,c.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=Nn(e);return n.forEach(o=>{const a=pt(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),y.waitFor(s)}removeMatchingKeys(e,n,r){const s=Nn(e);return y.forEach(n,i=>{const o=pt(i.path);return y.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=Nn(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=Nn(e);let i=se();return s.Z({range:r,Y:!0},(o,a,c)=>{const u=rn(o[1]),l=new N(u);i=i.add(l)}).next(()=>i)}containsKey(e,n){const r=pt(n.path),s=IDBKeyRange.bound([r],[X_(r)],!1,!0);let i=0;return Nn(e).Z({index:"documentTargetsIndex",Y:!0,range:s},([o,a],c,u)=>{o!==0&&(i++,u.done())}).next(()=>i>0)}ut(e,n){return Zr(e).get(n).next(r=>r?fi(r):null)}}function Zr(t){return nt(t,"targets")}function Lm(t){return nt(t,"targetGlobal")}function Nn(t){return nt(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bm([t,e],[n,r]){const s=ee(t,n);return s===0?ee(e,r):s}class sS{constructor(e){this.qn=e,this.buffer=new Ve(Bm),this.Qn=0}Kn(){return++this.Qn}$n(e){const n=[e,this.Kn()];if(this.buffer.size<this.qn)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Bm(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class rv{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Un=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Wn(6e4)}stop(){this.Un&&(this.Un.cancel(),this.Un=null)}get started(){return this.Un!==null}Wn(e){S("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Un=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Un=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){nr(n)?S("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await tr(n)}await this.Wn(3e5)})}}class iS{constructor(e,n){this.Gn=e,this.params=n}calculateTargetCount(e,n){return this.Gn.zn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return y.resolve(Tt.ae);const r=new sS(n);return this.Gn.forEachTarget(e,s=>r.$n(s.sequenceNumber)).next(()=>this.Gn.jn(e,s=>r.$n(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Gn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Gn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(S("LruGarbageCollector","Garbage collection skipped; disabled"),y.resolve(Fm)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(S("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Fm):this.Hn(e,n))}getCacheSize(e){return this.Gn.getCacheSize(e)}Hn(e,n){let r,s,i,o,a,c,u;const l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(S("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,o=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,n))).next(h=>(i=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(u=Date.now(),il()<=ge.DEBUG&&S("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-l}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(u-c)+`ms
Total Duration: ${u-l}ms`),y.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h})))}}function sv(t,e){return new iS(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oS{constructor(e,n){this.db=e,this.garbageCollector=sv(this,n)}zn(e){const n=this.Jn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}Jn(e){let n=0;return this.jn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}jn(e,n){return this.Yn(e,(r,s)=>n(s))}addReference(e,n,r){return Qo(e,r)}removeReference(e,n,r){return Qo(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Qo(e,n)}Zn(e,n){return function(s,i){let o=!1;return nv(s).X(a=>tv(s,a,i).next(c=>(c&&(o=!0),y.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.Yn(e,(o,a)=>{if(a<=n){const c=this.Zn(e,o).next(u=>{if(!u)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,H.min()),Nn(e).delete(function(h){return[0,pt(h.path)]}(o))))});s.push(c)}}).next(()=>y.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Qo(e,n)}Yn(e,n){const r=Nn(e);let s,i=Tt.ae;return r.Z({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:u})=>{o===0?(i!==Tt.ae&&n(new N(rn(s)),i),i=u,s=c):i=Tt.ae}).next(()=>{i!==Tt.ae&&n(new N(rn(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Qo(t,e){return Nn(t).put(function(r,s){return{targetId:0,path:pt(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(){this.changes=new En(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,xe.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?y.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aS{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return dr(e).put(r)}removeEntry(e,n,r){return dr(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Da(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Xn(e,r)))}getEntry(e,n){let r=xe.newInvalidDocument(n);return dr(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(ii(n))},(s,i)=>{r=this.er(n,i)}).next(()=>r)}tr(e,n){let r={size:0,document:xe.newInvalidDocument(n)};return dr(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(ii(n))},(s,i)=>{r={document:this.er(n,i),size:Na(i)}}).next(()=>r)}getEntries(e,n){let r=bt();return this.nr(e,n,(s,i)=>{const o=this.er(s,i);r=r.insert(s,o)}).next(()=>r)}rr(e,n){let r=bt(),s=new Re(N.comparator);return this.nr(e,n,(i,o)=>{const a=this.er(i,o);r=r.insert(i,a),s=s.insert(i,Na(o))}).next(()=>({documents:r,ir:s}))}nr(e,n,r){if(n.isEmpty())return y.resolve();let s=new Ve($m);n.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound(ii(s.first()),ii(s.last())),o=s.getIterator();let a=o.getNext();return dr(e).Z({index:"documentKeyIndex",range:i},(c,u,l)=>{const h=N.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&$m(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?l.W(ii(a)):l.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s){const i=n.path,o=[i.popLast().toArray(),i.lastSegment(),Da(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],a=[i.popLast().toArray(),i.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return dr(e).G(IDBKeyRange.bound(o,a,!0)).next(c=>{let u=bt();for(const l of c){const h=this.er(N.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);h.isFoundDocument()&&(Io(n,h)||s.has(h.key))&&(u=u.insert(h.key,h))}return u})}getAllFromCollectionGroup(e,n,r,s){let i=bt();const o=qm(n,r),a=qm(n,Vt.max());return dr(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,u,l)=>{const h=this.er(N.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);i=i.insert(h.key,h),i.size===s&&l.done()}).next(()=>i)}newChangeBuffer(e){return new cS(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return Um(e).get("remoteDocumentGlobalKey").next(n=>(G(!!n),n))}Xn(e,n){return Um(e).put("remoteDocumentGlobalKey",n)}er(e,n){if(n){const r=HP(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(H.min())))return r}return xe.newInvalidDocument(e)}}function ov(t){return new aS(t)}class cS extends iv{constructor(e,n){super(),this.sr=e,this.trackRemovals=n,this._r=new En(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new Ve((i,o)=>ee(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this._r.get(i);if(n.push(this.sr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const c=Pm(this.sr.serializer,o);s=s.add(i.path.popLast()),r+=Na(c)-a.size,n.push(this.sr.addEntry(e,i,c))}else if(r-=a.size,this.trackRemovals){const c=Pm(this.sr.serializer,o.convertToNoDocument(H.min()));n.push(this.sr.addEntry(e,i,c))}}),s.forEach(i=>{n.push(this.sr.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.sr.updateMetadata(e,r)),y.waitFor(n)}getFromCache(e,n){return this.sr.tr(e,n).next(r=>(this._r.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.sr.rr(e,n).next(({documents:r,ir:s})=>(s.forEach((i,o)=>{this._r.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function Um(t){return nt(t,"remoteDocumentGlobal")}function dr(t){return nt(t,"remoteDocumentsV14")}function ii(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function qm(t,e){const n=e.documentKey.path.toArray();return[t,Da(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function $m(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=ee(n[i],r[i]),s)return s;return s=ee(n.length,r.length),s||(s=ee(n[n.length-2],r[r.length-2]),s||ee(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uS{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Ai(r.mutation,s,At.empty(),Ne.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,se()).next(()=>r))}getLocalViewOfDocuments(e,n,r=se()){const s=sn();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=hi();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=sn();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,se()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=bt();const o=Ti(),a=function(){return Ti()}();return n.forEach((c,u)=>{const l=r.get(u.key);s.has(u.key)&&(l===void 0||l.mutation instanceof In)?i=i.insert(u.key,u):l!==void 0?(o.set(u.key,l.mutation.getFieldMask()),Ai(l.mutation,u,l.mutation.getFieldMask(),Ne.now())):o.set(u.key,At.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,l)=>o.set(u,l)),n.forEach((u,l)=>{var h;return a.set(u,new uS(l,(h=o.get(u))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Ti();let s=new Re((o,a)=>o-a),i=se();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let l=r.get(c)||At.empty();l=a.applyToLocalView(u,l),r.set(c,l);const h=(s.get(a.batchId)||se()).add(c);s=s.insert(a.batchId,h)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),u=c.key,l=c.value,h=by();l.forEach(d=>{if(!i.has(d)){const f=ky(n.get(d),r.get(d));f!==null&&h.set(d,f),i=i.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,h))}return y.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r){return function(i){return N.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Ph(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r):this.getDocumentsMatchingCollectionQuery(e,n,r)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):y.resolve(sn());let a=-1,c=i;return o.next(u=>y.forEach(u,(l,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(l)?y.resolve():this.remoteDocumentCache.getEntry(e,l).next(d=>{c=c.insert(l,d)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,se())).next(l=>({batchId:a,changes:Ay(l)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new N(n)).next(r=>{let s=hi();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r){const s=n.collectionGroup;let i=hi();return this.indexManager.getCollectionParents(e,s).next(o=>y.forEach(o,a=>{const c=function(l,h){return new vn(h,null,l.explicitOrderBy.slice(),l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt)}(n,a.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r).next(u=>{u.forEach((l,h)=>{i=i.insert(l,h)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s))).next(i=>{s.forEach((a,c)=>{const u=c.getKey();i.get(u)===null&&(i=i.insert(u,xe.newInvalidDocument(u)))});let o=hi();return i.forEach((a,c)=>{const u=s.get(a);u!==void 0&&Ai(u.mutation,c,At.empty(),Ne.now()),Io(n,c)&&(o=o.insert(a,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(e){this.serializer=e,this.ar=new Map,this.ur=new Map}getBundleMetadata(e,n){return y.resolve(this.ar.get(n))}saveBundleMetadata(e,n){return this.ar.set(n.id,function(s){return{id:s.id,version:s.version,createTime:qe(s.createTime)}}(n)),y.resolve()}getNamedQuery(e,n){return y.resolve(this.ur.get(n))}saveNamedQuery(e,n){return this.ur.set(n.name,function(s){return{name:s.name,query:Mh(s.bundledQuery),readTime:qe(s.readTime)}}(n)),y.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hS{constructor(){this.overlays=new Re(N.comparator),this.cr=new Map}getOverlay(e,n){return y.resolve(this.overlays.get(n))}getOverlays(e,n){const r=sn();return y.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),y.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.cr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.cr.delete(r)),y.resolve()}getOverlaysForCollection(e,n,r){const s=sn(),i=n.length+1,o=new N(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return y.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Re((u,l)=>u-l);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let l=i.get(u.largestBatchId);l===null&&(l=sn(),i=i.insert(u.largestBatchId,l)),l.set(u.getKey(),u)}}const a=sn(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,l)=>a.set(u,l)),!(a.size()>=s)););return y.resolve(a)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.cr.get(s.largestBatchId).delete(r.key);this.cr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Dh(n,r));let i=this.cr.get(n);i===void 0&&(i=se(),this.cr.set(n,i)),this.cr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{constructor(){this.lr=new Ve(Je.hr),this.Pr=new Ve(Je.Ir)}isEmpty(){return this.lr.isEmpty()}addReference(e,n){const r=new Je(e,n);this.lr=this.lr.add(r),this.Pr=this.Pr.add(r)}Tr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Er(new Je(e,n))}dr(e,n){e.forEach(r=>this.removeReference(r,n))}Ar(e){const n=new N(new de([])),r=new Je(n,e),s=new Je(n,e+1),i=[];return this.Pr.forEachInRange([r,s],o=>{this.Er(o),i.push(o.key)}),i}Rr(){this.lr.forEach(e=>this.Er(e))}Er(e){this.lr=this.lr.delete(e),this.Pr=this.Pr.delete(e)}Vr(e){const n=new N(new de([])),r=new Je(n,e),s=new Je(n,e+1);let i=se();return this.Pr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Je(e,0),r=this.lr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Je{constructor(e,n){this.key=e,this.mr=n}static hr(e,n){return N.comparator(e.key,n.key)||ee(e.mr,n.mr)}static Ir(e,n){return ee(e.mr,n.mr)||N.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.gr=1,this.pr=new Ve(Je.hr)}checkEmpty(e){return y.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.gr;this.gr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new xh(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.pr=this.pr.add(new Je(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return y.resolve(o)}lookupMutationBatch(e,n){return y.resolve(this.yr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.wr(r),i=s<0?0:s;return y.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return y.resolve(this.mutationQueue.length===0?-1:this.gr-1)}getAllMutationBatches(e){return y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Je(n,0),s=new Je(n,Number.POSITIVE_INFINITY),i=[];return this.pr.forEachInRange([r,s],o=>{const a=this.yr(o.mr);i.push(a)}),y.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ve(ee);return n.forEach(s=>{const i=new Je(s,0),o=new Je(s,Number.POSITIVE_INFINITY);this.pr.forEachInRange([i,o],a=>{r=r.add(a.mr)})}),y.resolve(this.Sr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;N.isDocumentKey(i)||(i=i.child(""));const o=new Je(new N(i),0);let a=new Ve(ee);return this.pr.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(a=a.add(c.mr)),!0)},o),y.resolve(this.Sr(a))}Sr(e){const n=[];return e.forEach(r=>{const s=this.yr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){G(this.br(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.pr;return y.forEach(n.mutations,s=>{const i=new Je(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.pr=r})}Cn(e){}containsKey(e,n){const r=new Je(n,0),s=this.pr.firstAfterOrEqual(r);return y.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,y.resolve()}br(e,n){return this.wr(e)}wr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}yr(e){const n=this.wr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(e){this.Dr=e,this.docs=function(){return new Re(N.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Dr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return y.resolve(r?r.document.mutableCopy():xe.newInvalidDocument(n))}getEntries(e,n){let r=bt();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():xe.newInvalidDocument(s))}),y.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=bt();const o=n.path,a=new N(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:u,value:{document:l}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||Th(ey(l),r)<=0||(s.has(l.key)||Io(n,l))&&(i=i.insert(l.key,l.mutableCopy()))}return y.resolve(i)}getAllFromCollectionGroup(e,n,r,s){q()}vr(e,n){return y.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new mS(this)}getSize(e){return y.resolve(this.size)}}class mS extends iv{constructor(e){super(),this.sr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.sr.addEntry(e,s)):this.sr.removeEntry(r)}),y.waitFor(n)}getFromCache(e,n){return this.sr.getEntry(e,n)}getAllFromCache(e,n){return this.sr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{constructor(e){this.persistence=e,this.Cr=new En(n=>kr(n),vo),this.lastRemoteSnapshotVersion=H.min(),this.highestTargetId=0,this.Fr=0,this.Mr=new Bh,this.targetCount=0,this.Or=Lr.xn()}forEachTarget(e,n){return this.Cr.forEach((r,s)=>n(s)),y.resolve()}getLastRemoteSnapshotVersion(e){return y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return y.resolve(this.Fr)}allocateTargetId(e){return this.highestTargetId=this.Or.next(),y.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Fr&&(this.Fr=n),y.resolve()}Ln(e){this.Cr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Or=new Lr(n),this.highestTargetId=n),e.sequenceNumber>this.Fr&&(this.Fr=e.sequenceNumber)}addTargetData(e,n){return this.Ln(n),this.targetCount+=1,y.resolve()}updateTargetData(e,n){return this.Ln(n),y.resolve()}removeTargetData(e,n){return this.Cr.delete(n.target),this.Mr.Ar(n.targetId),this.targetCount-=1,y.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Cr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Cr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),y.waitFor(i).next(()=>s)}getTargetCount(e){return y.resolve(this.targetCount)}getTargetData(e,n){const r=this.Cr.get(n)||null;return y.resolve(r)}addMatchingKeys(e,n,r){return this.Mr.Tr(n,r),y.resolve()}removeMatchingKeys(e,n,r){this.Mr.dr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),y.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Mr.Ar(n),y.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Mr.Vr(n);return y.resolve(r)}containsKey(e,n){return y.resolve(this.Mr.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e,n){this.Nr={},this.overlays={},this.Br=new Tt(0),this.Lr=!1,this.Lr=!0,this.referenceDelegate=e(this),this.kr=new pS(this),this.indexManager=new tS,this.remoteDocumentCache=function(s){return new fS(s)}(r=>this.referenceDelegate.qr(r)),this.serializer=new Jy(n),this.Qr=new lS(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Lr=!1,Promise.resolve()}get started(){return this.Lr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new hS,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Nr[e.toKey()];return r||(r=new dS(n,this.referenceDelegate),this.Nr[e.toKey()]=r),r}getTargetCache(){return this.kr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Qr}runTransaction(e,n,r){S("MemoryPersistence","Starting transaction:",e);const s=new gS(this.Br.next());return this.referenceDelegate.Kr(),r(s).next(i=>this.referenceDelegate.$r(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ur(e,n){return y.or(Object.values(this.Nr).map(r=>()=>r.containsKey(e,n)))}}class gS extends ny{constructor(e){super(),this.currentSequenceNumber=e}}class Cc{constructor(e){this.persistence=e,this.Wr=new Bh,this.Gr=null}static zr(e){return new Cc(e)}get jr(){if(this.Gr)return this.Gr;throw q()}addReference(e,n,r){return this.Wr.addReference(r,n),this.jr.delete(r.toString()),y.resolve()}removeReference(e,n,r){return this.Wr.removeReference(r,n),this.jr.add(r.toString()),y.resolve()}markPotentiallyOrphaned(e,n){return this.jr.add(n.toString()),y.resolve()}removeTarget(e,n){this.Wr.Ar(n.targetId).forEach(s=>this.jr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.jr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Kr(){this.Gr=new Set}$r(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return y.forEach(this.jr,r=>{const s=N.fromPath(r);return this.Hr(e,s).next(i=>{i||n.removeEntry(s,H.min())})}).next(()=>(this.Gr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Hr(e,n).next(r=>{r?this.jr.delete(n.toString()):this.jr.add(n.toString())})}qr(e){return 0}Hr(e,n){return y.or([()=>y.resolve(this.Wr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ur(e,n)])}}class Oa{constructor(e,n){this.persistence=e,this.Jr=new En(r=>pt(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=sv(this,n)}static zr(e,n){return new Oa(e,n)}Kr(){}$r(e){return y.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}zn(e){const n=this.Jn(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}Jn(e){let n=0;return this.jn(e,r=>{n++}).next(()=>n)}jn(e,n){return y.forEach(this.Jr,(r,s)=>this.Zn(e,r,s).next(i=>i?y.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.vr(e,o=>this.Zn(e,o,n).next(a=>{a||(r++,i.removeEntry(o,H.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.Jr.set(n,e.currentSequenceNumber),y.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.Jr.set(r,e.currentSequenceNumber),y.resolve()}removeReference(e,n,r){return this.Jr.set(r,e.currentSequenceNumber),y.resolve()}updateLimboDocument(e,n){return this.Jr.set(n,e.currentSequenceNumber),y.resolve()}qr(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=sa(e.data.value)),n}Zn(e,n,r){return y.or([()=>this.persistence.Ur(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.Jr.get(n);return y.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S{constructor(e){this.serializer=e}B(e,n,r,s){const i=new Ec("createOrUpgrade",n);r<1&&s>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",sm,{unique:!0}),c.createObjectStore("documentMutations")}(e),jm(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=y.resolve();return r<3&&s>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),jm(e)),o=o.next(()=>function(c){const u=c.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:H.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",l)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(c,u){return u.store("mutations").G().next(l=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",sm,{unique:!0});const h=u.store("mutations"),d=l.map(f=>h.put(f));return y.waitFor(d)})}(e,i))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.Yr(i))),r<6&&s>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.Zr(i)))),r<7&&s>=7&&(o=o.next(()=>this.Xr(i))),r<8&&s>=8&&(o=o.next(()=>this.ei(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.ti(i))),r<11&&s>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(c){const u=c.createObjectStore("documentOverlays",{keyPath:tP});u.createIndex("collectionPathOverlayIndex",nP,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",rP,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(c){const u=c.createObjectStore("remoteDocumentsV14",{keyPath:zR});u.createIndex("documentKeyIndex",KR),u.createIndex("collectionGroupIndex",GR)}(e)).next(()=>this.ni(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(o=o.next(()=>this.ri(e,i))),r<15&&s>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:YR}).createIndex("sequenceNumberIndex",XR,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:ZR}).createIndex("documentKeyIndex",eP,{unique:!1})}(e))),o}Zr(e){let n=0;return e.store("remoteDocuments").Z((r,s)=>{n+=Na(s)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Yr(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.G().next(s=>y.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.G("userMutationsIndex",o).next(a=>y.forEach(a,c=>{G(c.userId===i.userId);const u=vr(this.serializer,c);return ev(e,i.userId,u).next(()=>{})}))}))}Xr(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.Z((o,a)=>{const c=new de(o),u=function(h){return[0,pt(h)]}(c);i.push(n.get(u).next(l=>l?y.resolve():(h=>n.put({targetId:0,path:pt(h),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>y.waitFor(i))})}ei(e,n){e.createObjectStore("collectionParents",{keyPath:JR});const r=n.store("collectionParents"),s=new Lh,i=o=>{if(s.add(o)){const a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:pt(c)})}};return n.store("remoteDocuments").Z({Y:!0},(o,a)=>{const c=new de(o);return i(c.popLast())}).next(()=>n.store("documentMutations").Z({Y:!0},([o,a,c],u)=>{const l=rn(a);return i(l.popLast())}))}ti(e){const n=e.store("targets");return n.Z((r,s)=>{const i=fi(s),o=Yy(this.serializer,i);return n.put(o)})}ni(e,n){const r=n.store("remoteDocuments"),s=[];return r.Z((i,o)=>{const a=n.store("remoteDocumentsV14"),c=function(h){return h.document?new N(de.fromString(h.document.name).popFirst(5)):h.noDocument?N.fromSegments(h.noDocument.path):h.unknownDocument?N.fromSegments(h.unknownDocument.path):q()}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(u))}).next(()=>y.waitFor(s))}ri(e,n){const r=n.store("mutations"),s=ov(this.serializer),i=new Uh(Cc.zr,this.serializer.ct);return r.G().next(o=>{const a=new Map;return o.forEach(c=>{var u;let l=(u=a.get(c.userId))!==null&&u!==void 0?u:se();vr(this.serializer,c).keys().forEach(h=>l=l.add(h)),a.set(c.userId,l)}),y.forEach(a,(c,u)=>{const l=new Ye(u),h=Pc.lt(this.serializer,l),d=i.getIndexManager(l),f=Sc.lt(l,this.serializer,d,i.referenceDelegate);return new av(s,f,h,d).recalculateAndSaveOverlaysForDocumentKeys(new al(n,Tt.ae),c).next()})})}}function jm(t){t.createObjectStore("targetDocuments",{keyPath:QR}).createIndex("documentTargetsIndex",WR,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",HR,{unique:!0}),t.createObjectStore("targetGlobal")}const _u="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class qh{constructor(e,n,r,s,i,o,a,c,u,l,h=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ii=i,this.window=o,this.document=a,this.si=u,this.oi=l,this._i=h,this.Br=null,this.Lr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ai=null,this.inForeground=!1,this.ui=null,this.ci=null,this.li=Number.NEGATIVE_INFINITY,this.hi=d=>Promise.resolve(),!qh.v())throw new b(E.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new oS(this,s),this.Pi=n+"main",this.serializer=new Jy(c),this.Ii=new $t(this.Pi,this._i,new _S(this.serializer)),this.kr=new rS(this.referenceDelegate,this.serializer),this.remoteDocumentCache=ov(this.serializer),this.Qr=new QP,this.window&&this.window.localStorage?this.Ti=this.window.localStorage:(this.Ti=null,l===!1&&Be("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ei().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new b(E.FAILED_PRECONDITION,_u);return this.di(),this.Ai(),this.Ri(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.kr.getHighestSequenceNumber(e))}).then(e=>{this.Br=new Tt(e,this.si)}).then(()=>{this.Lr=!0}).catch(e=>(this.Ii&&this.Ii.close(),Promise.reject(e)))}Vi(e){return this.hi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ii.k(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ii.enqueueAndForget(async()=>{this.started&&await this.Ei()}))}Ei(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Wo(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.mi(e).next(n=>{n||(this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.hi(!1)))})}).next(()=>this.fi(e)).next(n=>this.isPrimary&&!n?this.gi(e).next(()=>!1):!!n&&this.pi(e).next(()=>!0))).catch(e=>{if(nr(e))return S("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return S("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ii.enqueueRetryable(()=>this.hi(e)),this.isPrimary=e})}mi(e){return oi(e).get("owner").next(n=>y.resolve(this.yi(n)))}wi(e){return Wo(e).delete(this.clientId)}async Si(){if(this.isPrimary&&!this.bi(this.li,18e5)){this.li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=nt(n,"clientMetadata");return r.G().next(s=>{const i=this.Di(s,18e5),o=s.filter(a=>i.indexOf(a)===-1);return y.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ti)for(const n of e)this.Ti.removeItem(this.vi(n.clientId))}}Ri(){this.ci=this.ii.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ei().then(()=>this.Si()).then(()=>this.Ri()))}yi(e){return!!e&&e.ownerId===this.clientId}fi(e){return this.oi?y.resolve(!0):oi(e).get("owner").next(n=>{if(n!==null&&this.bi(n.leaseTimestampMs,5e3)&&!this.Ci(n.ownerId)){if(this.yi(n)&&this.networkEnabled)return!0;if(!this.yi(n)){if(!n.allowTabSynchronization)throw new b(E.FAILED_PRECONDITION,_u);return!1}}return!(!this.networkEnabled||!this.inForeground)||Wo(e).G().next(r=>this.Di(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&S("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Lr=!1,this.Fi(),this.ci&&(this.ci.cancel(),this.ci=null),this.Mi(),this.xi(),await this.Ii.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new al(e,Tt.ae);return this.gi(n).next(()=>this.wi(n))}),this.Ii.close(),this.Oi()}Di(e,n){return e.filter(r=>this.bi(r.updateTimeMs,n)&&!this.Ci(r.clientId))}Ni(){return this.runTransaction("getActiveClients","readonly",e=>Wo(e).G().next(n=>this.Di(n,18e5).map(r=>r.clientId)))}get started(){return this.Lr}getMutationQueue(e,n){return Sc.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.kr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new nS(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Pc.lt(this.serializer,e)}getBundleCache(){return this.Qr}runTransaction(e,n,r){S("IndexedDbPersistence","Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(c){return c===15?iP:c===14?ay:c===13?oy:c===12?sP:c===11?iy:void q()}(this._i);let o;return this.Ii.runTransaction(e,s,i,a=>(o=new al(a,this.Br?this.Br.next():Tt.ae),n==="readwrite-primary"?this.mi(o).next(c=>!!c||this.fi(o)).next(c=>{if(!c)throw Be(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.hi(!1)),new b(E.FAILED_PRECONDITION,ty);return r(o)}).next(c=>this.pi(o).next(()=>c)):this.Bi(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Bi(e){return oi(e).get("owner").next(n=>{if(n!==null&&this.bi(n.leaseTimestampMs,5e3)&&!this.Ci(n.ownerId)&&!this.yi(n)&&!(this.oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new b(E.FAILED_PRECONDITION,_u)})}pi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return oi(e).put("owner",n)}static v(){return $t.v()}gi(e){const n=oi(e);return n.get("owner").next(r=>this.yi(r)?(S("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):y.resolve())}bi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Be(`Detected an update time that is in the future: ${e} > ${r}`),!1))}di(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ui=()=>{this.ii.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ei()))},this.document.addEventListener("visibilitychange",this.ui),this.inForeground=this.document.visibilityState==="visible")}Mi(){this.ui&&(this.document.removeEventListener("visibilitychange",this.ui),this.ui=null)}Ai(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ai=()=>{this.Fi();const n=/(?:Version|Mobile)\/1[456]/;n0()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ii.enterRestrictedMode(!0),this.ii.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ai))}xi(){this.ai&&(this.window.removeEventListener("pagehide",this.ai),this.ai=null)}Ci(e){var n;try{const r=((n=this.Ti)===null||n===void 0?void 0:n.getItem(this.vi(e)))!==null;return S("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Be("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Fi(){if(this.Ti)try{this.Ti.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){Be("Failed to set zombie client id.",e)}}Oi(){if(this.Ti)try{this.Ti.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function oi(t){return nt(t,"owner")}function Wo(t){return nt(t,"clientMetadata")}function $h(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Li=r,this.ki=s}static qi(e,n){let r=se(),s=se();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new jh(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cv{constructor(){this.Qi=!1}initialize(e,n){this.Ki=e,this.indexManager=n,this.Qi=!0}getDocumentsMatchingQuery(e,n,r,s){return this.$i(e,n).next(i=>i||this.Ui(e,n,s,r)).next(i=>i||this.Wi(e,n))}$i(e,n){if(gm(n))return y.resolve(null);let r=vt(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Va(n,null,"F"),r=vt(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=se(...i);return this.Ki.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.Gi(n,a);return this.zi(n,u,o,c.readTime)?this.$i(e,Va(n,null,"F")):this.ji(e,u,n,c)}))})))}Ui(e,n,r,s){return gm(n)||s.isEqual(H.min())?this.Wi(e,n):this.Ki.getDocuments(e,r).next(i=>{const o=this.Gi(n,i);return this.zi(n,o,r,s)?this.Wi(e,n):(il()<=ge.DEBUG&&S("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),ml(n)),this.ji(e,o,n,Z_(s,-1)))})}Gi(e,n){let r=new Ve(wy(e));return n.forEach((s,i)=>{Io(e,i)&&(r=r.add(i))}),r}zi(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Wi(e,n){return il()<=ge.DEBUG&&S("QueryEngine","Using full collection scan to execute query:",ml(n)),this.Ki.getDocumentsMatchingQuery(e,n,Vt.min())}ji(e,n,r,s){return this.Ki.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{constructor(e,n,r,s){this.persistence=e,this.Hi=n,this.serializer=s,this.Ji=new Re(ee),this.Yi=new En(i=>kr(i),vo),this.Zi=new Map,this.Xi=e.getRemoteDocumentCache(),this.kr=e.getTargetCache(),this.Qr=e.getBundleCache(),this.es(r)}es(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new av(this.Xi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Xi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ji))}}function uv(t,e,n,r){return new yS(t,e,n,r)}async function lv(t,e){const n=M(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.es(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let c=se();for(const u of s){o.push(u.batchId);for(const l of u.mutations)c=c.add(l.key)}for(const u of i){a.push(u.batchId);for(const l of u.mutations)c=c.add(l.key)}return n.localDocuments.getDocuments(r,c).next(u=>({ts:u,removedBatchIds:o,addedBatchIds:a}))})})}function vS(t,e){const n=M(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Xi.newChangeBuffer({trackRemovals:!0});return function(a,c,u,l){const h=u.batch,d=h.keys();let f=y.resolve();return d.forEach(g=>{f=f.next(()=>l.getEntry(c,g)).next(v=>{const I=u.docVersions.get(g);G(I!==null),v.version.compareTo(I)<0&&(h.applyToRemoteDocument(v,u),v.isValidDocument()&&(v.setReadTime(u.commitVersion),l.addEntry(v)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(c,h))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=se();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function hv(t){const e=M(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.kr.getLastRemoteSnapshotVersion(n))}function ES(t,e){const n=M(t),r=e.snapshotVersion;let s=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Xi.newChangeBuffer({trackRemovals:!0});s=n.Ji;const a=[];e.targetChanges.forEach((l,h)=>{const d=s.get(h);if(!d)return;a.push(n.kr.removeMatchingKeys(i,l.removedDocuments,h).next(()=>n.kr.addMatchingKeys(i,l.addedDocuments,h)));let f=d.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?f=f.withResumeToken(He.EMPTY_BYTE_STRING,H.min()).withLastLimboFreeSnapshotVersion(H.min()):l.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(l.resumeToken,r)),s=s.insert(h,f),function(v,I,A){return v.resumeToken.approximateByteSize()===0||I.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=3e8?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(d,f,l)&&a.push(n.kr.updateTargetData(i,f))});let c=bt(),u=se();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,l))}),a.push(dv(i,o,e.documentUpdates).next(l=>{c=l.ns,u=l.rs})),!r.isEqual(H.min())){const l=n.kr.getLastRemoteSnapshotVersion(i).next(h=>n.kr.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(l)}return y.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.Ji=s,i))}function dv(t,e,n){let r=se(),s=se();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=bt();return n.forEach((a,c)=>{const u=i.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(H.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):S("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{ns:o,rs:s}})}function IS(t,e){const n=M(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function bs(t,e){const n=M(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.kr.getTargetData(r,e).next(i=>i?(s=i,y.resolve(s)):n.kr.allocateTargetId(r).next(o=>(s=new mn(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.kr.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ji.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(r.targetId,r),n.Yi.set(e,r.targetId)),r})}async function Rs(t,e,n){const r=M(t),s=r.Ji.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!nr(o))throw o;S("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ji=r.Ji.remove(e),r.Yi.delete(s.target)}function Ma(t,e,n){const r=M(t);let s=H.min(),i=se();return r.persistence.runTransaction("Execute query","readonly",o=>function(c,u,l){const h=M(c),d=h.Yi.get(l);return d!==void 0?y.resolve(h.Ji.get(d)):h.kr.getTargetData(u,l)}(r,o,vt(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.kr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>r.Hi.getDocumentsMatchingQuery(o,e,n?s:H.min(),n?i:se())).next(a=>(pv(r,Iy(e),a),{documents:a,ss:i})))}function fv(t,e){const n=M(t),r=M(n.kr),s=n.Ji.get(e);return s?Promise.resolve(s.target):n.persistence.runTransaction("Get target data","readonly",i=>r.ut(i,e).next(o=>o?o.target:null))}function mv(t,e){const n=M(t),r=n.Zi.get(e)||H.min();return n.persistence.runTransaction("Get new document changes","readonly",s=>n.Xi.getAllFromCollectionGroup(s,e,Z_(r,-1),Number.MAX_SAFE_INTEGER)).then(s=>(pv(n,e,s),s))}function pv(t,e,n){let r=t.Zi.get(e)||H.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Zi.set(e,r)}async function wS(t,e,n,r){const s=M(t);let i=se(),o=bt();for(const u of n){const l=e.os(u.metadata.name);u.document&&(i=i.add(l));const h=e._s(u);h.setReadTime(e.us(u.metadata.readTime)),o=o.insert(l,h)}const a=s.Xi.newChangeBuffer({trackRemovals:!0}),c=await bs(s,function(l){return vt(Bs(de.fromString(`__bundle__/docs/${l}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",u=>dv(u,a,o).next(l=>(a.apply(u),l)).next(l=>s.kr.removeMatchingKeysForTargetId(u,c.targetId).next(()=>s.kr.addMatchingKeys(u,i,c.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(u,l.ns,l.rs)).next(()=>l.ns)))}async function TS(t,e,n=se()){const r=await bs(t,vt(Mh(e.bundledQuery))),s=M(t);return s.persistence.runTransaction("Save named query","readwrite",i=>{const o=qe(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return s.Qr.saveNamedQuery(i,e);const a=r.withResumeToken(He.EMPTY_BYTE_STRING,o);return s.Ji=s.Ji.insert(a.targetId,a),s.kr.updateTargetData(i,a).next(()=>s.kr.removeMatchingKeysForTargetId(i,r.targetId)).next(()=>s.kr.addMatchingKeys(i,n,r.targetId)).next(()=>s.Qr.saveNamedQuery(i,e))})}function zm(t,e){return`firestore_clients_${t}_${e}`}function Km(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function yu(t,e){return`firestore_targets_${t}_${e}`}class Fa{constructor(e,n,r,s){this.user=e,this.batchId=n,this.state=r,this.error=s}static cs(e,n,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new b(s.error.code,s.error.message))),o?new Fa(e,n,s.state,i):(Be("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}ls(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class bi{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static cs(e,n){const r=JSON.parse(n);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new b(r.error.code,r.error.message))),i?new bi(e,r.state,s):(Be("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}ls(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class La{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static cs(e,n){const r=JSON.parse(n);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=Sh();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=ry(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new La(e,i):(Be("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class zh{constructor(e,n){this.clientId=e,this.onlineState=n}static cs(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new zh(n.clientId,n.onlineState):(Be("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Il{constructor(){this.activeTargetIds=Sh()}hs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Ps(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ls(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class vu{constructor(e,n,r,s,i){this.window=e,this.ii=n,this.persistenceKey=r,this.Is=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Ts=this.Es.bind(this),this.ds=new Re(ee),this.started=!1,this.As=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Rs=zm(this.persistenceKey,this.Is),this.Vs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.ds=this.ds.insert(this.Is,new Il),this.fs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.gs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.ps=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.ys=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.ws=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.Ts)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ni();for(const r of e){if(r===this.Is)continue;const s=this.getItem(zm(this.persistenceKey,r));if(s){const i=La.cs(r,s);i&&(this.ds=this.ds.insert(i.clientId,i))}}this.Ss();const n=this.storage.getItem(this.ys);if(n){const r=this.bs(n);r&&this.Ds(r)}for(const r of this.As)this.Es(r);this.As=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.vs(this.ds)}isActiveQueryTarget(e){let n=!1;return this.ds.forEach((r,s)=>{s.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Cs(e,"pending")}updateMutationState(e,n,r){this.Cs(e,n,r),this.Fs(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(yu(this.persistenceKey,e));if(r){const s=bi.cs(e,r);s&&(n=s.state)}}return this.Ms.hs(e),this.Ss(),n}removeLocalQueryTarget(e){this.Ms.Ps(e),this.Ss()}isLocalQueryTarget(e){return this.Ms.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(yu(this.persistenceKey,e))}updateQueryState(e,n,r){this.xs(e,n,r)}handleUserChange(e,n,r){n.forEach(s=>{this.Fs(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Os(e)}notifyBundleLoaded(e){this.Ns(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Ts),this.removeItem(this.Rs),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return S("SharedClientState","READ",e,n),n}setItem(e,n){S("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){S("SharedClientState","REMOVE",e),this.storage.removeItem(e)}Es(e){const n=e;if(n.storageArea===this.storage){if(S("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Rs)return void Be("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ii.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.fs.test(n.key)){if(n.newValue==null){const r=this.Bs(n.key);return this.Ls(r,null)}{const r=this.ks(n.key,n.newValue);if(r)return this.Ls(r.clientId,r)}}else if(this.gs.test(n.key)){if(n.newValue!==null){const r=this.qs(n.key,n.newValue);if(r)return this.Qs(r)}}else if(this.ps.test(n.key)){if(n.newValue!==null){const r=this.Ks(n.key,n.newValue);if(r)return this.$s(r)}}else if(n.key===this.ys){if(n.newValue!==null){const r=this.bs(n.newValue);if(r)return this.Ds(r)}}else if(n.key===this.Vs){const r=function(i){let o=Tt.ae;if(i!=null)try{const a=JSON.parse(i);G(typeof a=="number"),o=a}catch(a){Be("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==Tt.ae&&this.sequenceNumberHandler(r)}else if(n.key===this.ws){const r=this.Us(n.newValue);await Promise.all(r.map(s=>this.syncEngine.Ws(s)))}}}else this.As.push(n)})}}get Ms(){return this.ds.get(this.Is)}Ss(){this.setItem(this.Rs,this.Ms.ls())}Cs(e,n,r){const s=new Fa(this.currentUser,e,n,r),i=Km(this.persistenceKey,this.currentUser,e);this.setItem(i,s.ls())}Fs(e){const n=Km(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Os(e){const n={clientId:this.Is,onlineState:e};this.storage.setItem(this.ys,JSON.stringify(n))}xs(e,n,r){const s=yu(this.persistenceKey,e),i=new bi(e,n,r);this.setItem(s,i.ls())}Ns(e){const n=JSON.stringify(Array.from(e));this.setItem(this.ws,n)}Bs(e){const n=this.fs.exec(e);return n?n[1]:null}ks(e,n){const r=this.Bs(e);return La.cs(r,n)}qs(e,n){const r=this.gs.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return Fa.cs(new Ye(i),s,n)}Ks(e,n){const r=this.ps.exec(e),s=Number(r[1]);return bi.cs(s,n)}bs(e){return zh.cs(e)}Us(e){return JSON.parse(e)}async Qs(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Gs(e.batchId,e.state,e.error);S("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}$s(e){return this.syncEngine.zs(e.targetId,e.state,e.error)}Ls(e,n){const r=n?this.ds.insert(e,n):this.ds.remove(e),s=this.vs(this.ds),i=this.vs(r),o=[],a=[];return i.forEach(c=>{s.has(c)||o.push(c)}),s.forEach(c=>{i.has(c)||a.push(c)}),this.syncEngine.js(o,a).then(()=>{this.ds=r})}Ds(e){this.ds.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}vs(e){let n=Sh();return e.forEach((r,s)=>{n=n.unionWith(s.activeTargetIds)}),n}}class gv{constructor(){this.Hs=new Il,this.Js={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.Hs.hs(e),this.Js[e]||"not-current"}updateQueryState(e,n,r){this.Js[e]=n}removeLocalQueryTarget(e){this.Hs.Ps(e)}isLocalQueryTarget(e){return this.Hs.activeTargetIds.has(e)}clearQueryState(e){delete this.Js[e]}getAllActiveQueryTargets(){return this.Hs.activeTargetIds}isActiveQueryTarget(e){return this.Hs.activeTargetIds.has(e)}start(){return this.Hs=new Il,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{Ys(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm{constructor(){this.Zs=()=>this.Xs(),this.eo=()=>this.no(),this.ro=[],this.io()}Ys(e){this.ro.push(e)}shutdown(){window.removeEventListener("online",this.Zs),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Zs),window.addEventListener("offline",this.eo)}Xs(){S("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ro)e(0)}no(){S("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ro)e(1)}static v(){return typeof window!="undefined"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jo=null;function Eu(){return Jo===null?Jo=function(){return 268435456+Math.round(2147483648*Math.random())}():Jo++,"0x"+Jo.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bS={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS{constructor(e){this.so=e.so,this.oo=e.oo}_o(e){this.ao=e}uo(e){this.co=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.so(e)}ho(){this.ao()}Po(e){this.co(e)}Io(e){this.lo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ut="WebChannelConnection";class PS extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.To=r+"://"+n.host,this.Eo=`projects/${s}/databases/${i}`,this.Ao=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Ro(){return!1}Vo(n,r,s,i,o){const a=Eu(),c=this.mo(n,r);S("RestConnection",`Sending RPC '${n}' ${a}:`,c,s);const u={"google-cloud-resource-prefix":this.Eo,"x-goog-request-params":this.Ao};return this.fo(u,i,o),this.po(n,c,u,s).then(l=>(S("RestConnection",`Received RPC '${n}' ${a}: `,l),l),l=>{throw Ft("RestConnection",`RPC '${n}' ${a} failed with error: `,l,"url: ",c,"request:",s),l})}yo(n,r,s,i,o,a){return this.Vo(n,r,s,i,o)}fo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ls}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}mo(n,r){const s=bS[n];return`${this.To}/v1/${r}:${s}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}po(e,n,r,s){const i=Eu();return new Promise((o,a)=>{const c=new AR;c.setWithCredentials(!0),c.listenOnce(IR.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case pu.NO_ERROR:const l=c.getResponseJson();S(ut,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(l)),o(l);break;case pu.TIMEOUT:S(ut,`RPC '${e}' ${i} timed out`),a(new b(E.DEADLINE_EXCEEDED,"Request time out"));break;case pu.HTTP_ERROR:const h=c.getStatus();if(S(ut,`RPC '${e}' ${i} failed with status:`,h,"response text:",c.getResponseText()),h>0){let d=c.getResponseJson();Array.isArray(d)&&(d=d[0]);const f=d==null?void 0:d.error;if(f&&f.status&&f.message){const g=function(I){const A=I.toLowerCase().replace(/_/g,"-");return Object.values(E).indexOf(A)>=0?A:E.UNKNOWN}(f.status);a(new b(g,f.message))}else a(new b(E.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new b(E.UNAVAILABLE,"Connection failed."));break;default:q()}}finally{S(ut,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(s);S(ut,`RPC '${e}' ${i} sending request:`,s),c.send(n,"POST",u,r,15)})}wo(e,n,r){const s=Eu(),i=[this.To,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=vR(),a=ER(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.xmlHttpFactory=new TR({})),this.fo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const l=i.join("");S(ut,`Creating RPC '${e}' stream ${s}: ${l}`,c);const h=o.createWebChannel(l,c);let d=!1,f=!1;const g=new RS({so:I=>{f?S(ut,`Not sending because RPC '${e}' stream ${s} is closed:`,I):(d||(S(ut,`Opening RPC '${e}' stream ${s} transport.`),h.open(),d=!0),S(ut,`RPC '${e}' stream ${s} sending:`,I),h.send(I))},oo:()=>h.close()}),v=(I,A,R)=>{I.listen(A,V=>{try{R(V)}catch(D){setTimeout(()=>{throw D},0)}})};return v(h,jo.EventType.OPEN,()=>{f||S(ut,`RPC '${e}' stream ${s} transport opened.`)}),v(h,jo.EventType.CLOSE,()=>{f||(f=!0,S(ut,`RPC '${e}' stream ${s} transport closed`),g.Po())}),v(h,jo.EventType.ERROR,I=>{f||(f=!0,Ft(ut,`RPC '${e}' stream ${s} transport errored:`,I),g.Po(new b(E.UNAVAILABLE,"The operation could not be completed")))}),v(h,jo.EventType.MESSAGE,I=>{var A;if(!f){const R=I.data[0];G(!!R);const V=R,D=V.error||((A=V[0])===null||A===void 0?void 0:A.error);if(D){S(ut,`RPC '${e}' stream ${s} received error:`,D);const j=D.status;let X=function(W){const re=ze[W];if(re!==void 0)return My(re)}(j),oe=D.message;X===void 0&&(X=E.INTERNAL,oe="Unknown error status: "+j+" with message "+D.message),f=!0,g.Po(new b(X,oe)),h.close()}else S(ut,`RPC '${e}' stream ${s} received:`,R),g.Io(R)}}),v(a,wR.STAT_EVENT,I=>{I.stat===em.PROXY?S(ut,`RPC '${e}' stream ${s} detected buffering proxy`):I.stat===em.NOPROXY&&S(ut,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{g.ho()},0),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _v(){return typeof window!="undefined"?window:null}function ca(){return typeof document!="undefined"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bo(t){return new FP(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ii=e,this.timerId=n,this.So=r,this.bo=s,this.Do=i,this.vo=0,this.Co=null,this.Fo=Date.now(),this.reset()}reset(){this.vo=0}Mo(){this.vo=this.Do}xo(e){this.cancel();const n=Math.floor(this.vo+this.Oo()),r=Math.max(0,Date.now()-this.Fo),s=Math.max(0,n-r);s>0&&S("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.vo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Co=this.ii.enqueueAfterDelay(this.timerId,s,()=>(this.Fo=Date.now(),e())),this.vo*=this.bo,this.vo<this.So&&(this.vo=this.So),this.vo>this.Do&&(this.vo=this.Do)}No(){this.Co!==null&&(this.Co.skipDelay(),this.Co=null)}cancel(){this.Co!==null&&(this.Co.cancel(),this.Co=null)}Oo(){return(Math.random()-.5)*this.vo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yv{constructor(e,n,r,s,i,o,a,c){this.ii=e,this.Bo=r,this.Lo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.ko=0,this.qo=null,this.Qo=null,this.stream=null,this.Ko=new Kh(e,n)}$o(){return this.state===1||this.state===5||this.Uo()}Uo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Wo()}async stop(){this.$o()&&await this.close(0)}Go(){this.state=0,this.Ko.reset()}zo(){this.Uo()&&this.qo===null&&(this.qo=this.ii.enqueueAfterDelay(this.Bo,6e4,()=>this.jo()))}Ho(e){this.Jo(),this.stream.send(e)}async jo(){if(this.Uo())return this.close(0)}Jo(){this.qo&&(this.qo.cancel(),this.qo=null)}Yo(){this.Qo&&(this.Qo.cancel(),this.Qo=null)}async close(e,n){this.Jo(),this.Yo(),this.Ko.cancel(),this.ko++,e!==4?this.Ko.reset():n&&n.code===E.RESOURCE_EXHAUSTED?(Be(n.toString()),Be("Using maximum backoff delay to prevent overloading the backend."),this.Ko.Mo()):n&&n.code===E.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Zo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.uo(n)}Zo(){}auth(){this.state=1;const e=this.Xo(this.ko),n=this.ko;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.ko===n&&this.e_(r,s)},r=>{e(()=>{const s=new b(E.UNKNOWN,"Fetching auth token failed: "+r.message);return this.t_(s)})})}e_(e,n){const r=this.Xo(this.ko);this.stream=this.n_(e,n),this.stream._o(()=>{r(()=>(this.state=2,this.Qo=this.ii.enqueueAfterDelay(this.Lo,1e4,()=>(this.Uo()&&(this.state=3),Promise.resolve())),this.listener._o()))}),this.stream.uo(s=>{r(()=>this.t_(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Wo(){this.state=5,this.Ko.xo(async()=>{this.state=0,this.start()})}t_(e){return S("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return n=>{this.ii.enqueueAndForget(()=>this.ko===e?n():(S("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class SS extends yv{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}n_(e,n){return this.connection.wo("Listen",e,n)}onMessage(e){this.Ko.reset();const n=UP(this.serializer,e),r=function(i){if(!("targetChange"in i))return H.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?H.min():o.readTime?qe(o.readTime):H.min()}(e);return this.listener.r_(n,r)}i_(e){const n={};n.database=no(this.serializer),n.addTarget=function(i,o){let a;const c=o.target;if(a=Ca(c)?{documents:Ky(i,c)}:{query:Oh(i,c)},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Uy(i,o.resumeToken);const u=pl(i,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(H.min())>0){a.readTime=As(i,o.snapshotVersion.toTimestamp());const u=pl(i,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=$P(this.serializer,e);r&&(n.labels=r),this.Ho(n)}s_(e){const n={};n.database=no(this.serializer),n.removeTarget=e,this.Ho(n)}}class CS extends yv{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i,this.o_=!1}get __(){return this.o_}start(){this.o_=!1,this.lastStreamToken=void 0,super.start()}Zo(){this.o_&&this.a_([])}n_(e,n){return this.connection.wo("Write",e,n)}onMessage(e){if(G(!!e.streamToken),this.lastStreamToken=e.streamToken,this.o_){this.Ko.reset();const n=qP(e.writeResults,e.commitTime),r=qe(e.commitTime);return this.listener.u_(r,n)}return G(!e.writeResults||e.writeResults.length===0),this.o_=!0,this.listener.c_()}l_(){const e={};e.database=no(this.serializer),this.Ho(e)}a_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>ro(this.serializer,r))};this.Ho(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.h_=!1}P_(){if(this.h_)throw new b(E.FAILED_PRECONDITION,"The client has already been terminated.")}Vo(e,n,r){return this.P_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.Vo(e,n,r,s,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===E.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new b(E.UNKNOWN,s.toString())})}yo(e,n,r,s){return this.P_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.yo(e,n,r,i,o,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===E.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new b(E.UNKNOWN,i.toString())})}terminate(){this.h_=!0}}async function VS(t,e,n){var r;const s=M(t),{request:i,I_:o}=function(h,d,f){const g=Oh(h,d),v={},I=[];let A=0;return f.forEach(R=>{const V="aggregate_"+A++;v[V]=R.alias,R.Ee==="count"?I.push({alias:V,count:{}}):R.Ee==="avg"?I.push({alias:V,avg:{field:kn(R.fieldPath)}}):R.Ee==="sum"&&I.push({alias:V,sum:{field:kn(R.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:I,structuredQuery:g.structuredQuery},parent:g.parent},I_:v}}(s.serializer,vt(e),n),a=i.parent;s.connection.Ro||delete i.parent;const c=(await s.yo("RunAggregationQuery",a,i,1)).filter(l=>!!l.result);G(c.length===1);const u=(r=c[0].result)===null||r===void 0?void 0:r.aggregateFields;return Object.keys(u).reduce((l,h)=>(l[o[h]]=u[h],l),{})}class DS{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.T_=0,this.E_=null,this.d_=!0}A_(){this.T_===0&&(this.R_("Unknown"),this.E_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.E_=null,this.V_("Backend didn't respond within 10 seconds."),this.R_("Offline"),Promise.resolve())))}m_(e){this.state==="Online"?this.R_("Unknown"):(this.T_++,this.T_>=1&&(this.f_(),this.V_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.R_("Offline")))}set(e){this.f_(),this.T_=0,e==="Online"&&(this.d_=!1),this.R_(e)}R_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}V_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.d_?(Be(n),this.d_=!1):S("OnlineStateTracker",n)}f_(){this.E_!==null&&(this.E_.cancel(),this.E_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kS{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.g_=[],this.p_=new Map,this.y_=new Set,this.w_=[],this.S_=i,this.S_.Ys(o=>{r.enqueueAndForget(async()=>{sr(this)&&(S("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=M(c);u.y_.add(4),await $s(u),u.b_.set("Unknown"),u.y_.delete(4),await Ro(u)}(this))})}),this.b_=new DS(r,s)}}async function Ro(t){if(sr(t))for(const e of t.w_)await e(!0)}async function $s(t){for(const e of t.w_)await e(!1)}function xc(t,e){const n=M(t);n.p_.has(e.targetId)||(n.p_.set(e.targetId,e),Qh(n)?Hh(n):zs(n).Uo()&&Gh(n,e))}function so(t,e){const n=M(t),r=zs(n);n.p_.delete(e),r.Uo()&&vv(n,e),n.p_.size===0&&(r.Uo()?r.zo():sr(n)&&n.b_.set("Unknown"))}function Gh(t,e){if(t.D_.Be(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(H.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}zs(t).i_(e)}function vv(t,e){t.D_.Be(e),zs(t).s_(e)}function Hh(t){t.D_=new kP({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>t.p_.get(e)||null,rt:()=>t.datastore.serializer.databaseId}),zs(t).start(),t.b_.A_()}function Qh(t){return sr(t)&&!zs(t).$o()&&t.p_.size>0}function sr(t){return M(t).y_.size===0}function Ev(t){t.D_=void 0}async function NS(t){t.p_.forEach((e,n)=>{Gh(t,e)})}async function OS(t,e){Ev(t),Qh(t)?(t.b_.m_(e),Hh(t)):t.b_.set("Unknown")}async function MS(t,e,n){if(t.b_.set("Online"),e instanceof By&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.p_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.p_.delete(a),s.D_.removeTarget(a))}(t,e)}catch(r){S("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ba(t,r)}else if(e instanceof aa?t.D_.We(e):e instanceof Ly?t.D_.Ze(e):t.D_.je(e),!n.isEqual(H.min()))try{const r=await hv(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.D_.st(o);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const l=i.p_.get(u);l&&i.p_.set(u,l.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,u)=>{const l=i.p_.get(c);if(!l)return;i.p_.set(c,l.withResumeToken(He.EMPTY_BYTE_STRING,l.snapshotVersion)),vv(i,c);const h=new mn(l.target,c,u,l.sequenceNumber);Gh(i,h)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){S("RemoteStore","Failed to raise snapshot:",r),await Ba(t,r)}}async function Ba(t,e,n){if(!nr(e))throw e;t.y_.add(1),await $s(t),t.b_.set("Offline"),n||(n=()=>hv(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{S("RemoteStore","Retrying IndexedDB access"),await n(),t.y_.delete(1),await Ro(t)})}function Iv(t,e){return e().catch(n=>Ba(t,n,e))}async function js(t){const e=M(t),n=Yn(e);let r=e.g_.length>0?e.g_[e.g_.length-1].batchId:-1;for(;FS(e);)try{const s=await IS(e.localStore,r);if(s===null){e.g_.length===0&&n.zo();break}r=s.batchId,LS(e,s)}catch(s){await Ba(e,s)}wv(e)&&Tv(e)}function FS(t){return sr(t)&&t.g_.length<10}function LS(t,e){t.g_.push(e);const n=Yn(t);n.Uo()&&n.__&&n.a_(e.mutations)}function wv(t){return sr(t)&&!Yn(t).$o()&&t.g_.length>0}function Tv(t){Yn(t).start()}async function BS(t){Yn(t).l_()}async function US(t){const e=Yn(t);for(const n of t.g_)e.a_(n.mutations)}async function qS(t,e,n){const r=t.g_.shift(),s=Vh.from(r,e,n);await Iv(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await js(t)}async function $S(t,e){e&&Yn(t).__&&await async function(r,s){if(function(o){return Oy(o)&&o!==E.ABORTED}(s.code)){const i=r.g_.shift();Yn(r).Go(),await Iv(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await js(r)}}(t,e),wv(t)&&Tv(t)}async function Hm(t,e){const n=M(t);n.asyncQueue.verifyOperationInProgress(),S("RemoteStore","RemoteStore received new credentials");const r=sr(n);n.y_.add(3),await $s(n),r&&n.b_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.y_.delete(3),await Ro(n)}async function wl(t,e){const n=M(t);e?(n.y_.delete(2),await Ro(n)):e||(n.y_.add(2),await $s(n),n.b_.set("Unknown"))}function zs(t){return t.v_||(t.v_=function(n,r,s){const i=M(n);return i.P_(),new SS(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{_o:NS.bind(null,t),uo:OS.bind(null,t),r_:MS.bind(null,t)}),t.w_.push(async e=>{e?(t.v_.Go(),Qh(t)?Hh(t):t.b_.set("Unknown")):(await t.v_.stop(),Ev(t))})),t.v_}function Yn(t){return t.C_||(t.C_=function(n,r,s){const i=M(n);return i.P_(),new CS(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{_o:BS.bind(null,t),uo:$S.bind(null,t),c_:US.bind(null,t),u_:qS.bind(null,t)}),t.w_.push(async e=>{e?(t.C_.Go(),await js(t)):(await t.C_.stop(),t.g_.length>0&&(S("RemoteStore",`Stopping write stream with ${t.g_.length} pending writes`),t.g_=[]))})),t.C_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new We,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new Wh(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new b(E.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ks(t,e){if(Be("AsyncQueue",`${e}: ${t}`),nr(t))return new b(E.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds{constructor(e){this.comparator=e?(n,r)=>e(n,r)||N.comparator(n.key,r.key):(n,r)=>N.comparator(n.key,r.key),this.keyedMap=hi(),this.sortedSet=new Re(this.comparator)}static emptySet(e){return new ds(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ds)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ds;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{constructor(){this.F_=new Re(N.comparator)}track(e){const n=e.doc.key,r=this.F_.get(n);r?e.type!==0&&r.type===3?this.F_=this.F_.insert(n,e):e.type===3&&r.type!==1?this.F_=this.F_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.F_=this.F_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.F_=this.F_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.F_=this.F_.remove(n):e.type===1&&r.type===2?this.F_=this.F_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.F_=this.F_.insert(n,{type:2,doc:e.doc}):q():this.F_=this.F_.insert(n,e)}M_(){const e=[];return this.F_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ps{constructor(e,n,r,s,i,o,a,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Ps(e,n,ds.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Eo(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(){this.x_=void 0,this.listeners=[]}}class zS{constructor(){this.queries=new En(e=>Ey(e),Eo),this.onlineState="Unknown",this.O_=new Set}}async function Jh(t,e){const n=M(t),r=e.query;let s=!1,i=n.queries.get(r);if(i||(s=!0,i=new jS),s)try{i.x_=await n.onListen(r)}catch(o){const a=Ks(o,`Initialization of query '${ml(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,i),i.listeners.push(e),e.N_(n.onlineState),i.x_&&e.B_(i.x_)&&Xh(n)}async function Yh(t,e){const n=M(t),r=e.query;let s=!1;const i=n.queries.get(r);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),s=i.listeners.length===0)}if(s)return n.queries.delete(r),n.onUnlisten(r)}function KS(t,e){const n=M(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.listeners)a.B_(s)&&(r=!0);o.x_=s}}r&&Xh(n)}function GS(t,e,n){const r=M(t),s=r.queries.get(e);if(s)for(const i of s.listeners)i.onError(n);r.queries.delete(e)}function Xh(t){t.O_.forEach(e=>{e.next()})}class Zh{constructor(e,n,r){this.query=e,this.L_=n,this.k_=!1,this.q_=null,this.onlineState="Unknown",this.options=r||{}}B_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ps(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.k_?this.Q_(e)&&(this.L_.next(e),n=!0):this.K_(e,this.onlineState)&&(this.U_(e),n=!0),this.q_=e,n}onError(e){this.L_.error(e)}N_(e){this.onlineState=e;let n=!1;return this.q_&&!this.k_&&this.K_(this.q_,e)&&(this.U_(this.q_),n=!0),n}K_(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.W_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Q_(e){if(e.docChanges.length>0)return!0;const n=this.q_&&this.q_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}U_(e){e=Ps.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.k_=!0,this.L_.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS{constructor(e,n){this.G_=e,this.byteLength=n}z_(){return"metadata"in this.G_}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm{constructor(e){this.serializer=e}os(e){return an(this.serializer,e)}_s(e){return e.metadata.exists?zy(this.serializer,e.document,!1):xe.newNoDocument(this.os(e.metadata.name),this.us(e.metadata.readTime))}us(e){return qe(e)}}class QS{constructor(e,n,r){this.j_=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Av(e)}H_(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.G_.namedQuery)this.queries.push(e.G_.namedQuery);else if(e.G_.documentMetadata){this.documents.push({metadata:e.G_.documentMetadata}),e.G_.documentMetadata.exists||++n;const r=de.fromString(e.G_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.G_.document&&(this.documents[this.documents.length-1].document=e.G_.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}J_(e){const n=new Map,r=new Wm(this.serializer);for(const s of e)if(s.metadata.queries){const i=r.os(s.metadata.name);for(const o of s.metadata.queries){const a=(n.get(o)||se()).add(i);n.set(o,a)}}return n}async complete(){const e=await wS(this.localStore,new Wm(this.serializer),this.documents,this.j_.id),n=this.J_(this.documents);for(const r of this.queries)await TS(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Y_:this.collectionGroups,Z_:e}}}function Av(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bv{constructor(e){this.key=e}}class Rv{constructor(e){this.key=e}}class Pv{constructor(e,n){this.query=e,this.X_=n,this.ea=null,this.hasCachedResults=!1,this.current=!1,this.ta=se(),this.mutatedKeys=se(),this.na=wy(e),this.ra=new ds(this.na)}get ia(){return this.X_}sa(e,n){const r=n?n.oa:new Qm,s=n?n.ra:this.ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((l,h)=>{const d=s.get(l),f=Io(this.query,h)?h:null,g=!!d&&this.mutatedKeys.has(d.key),v=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let I=!1;d&&f?d.data.isEqual(f.data)?g!==v&&(r.track({type:3,doc:f}),I=!0):this._a(d,f)||(r.track({type:2,doc:f}),I=!0,(c&&this.na(f,c)>0||u&&this.na(f,u)<0)&&(a=!0)):!d&&f?(r.track({type:0,doc:f}),I=!0):d&&!f&&(r.track({type:1,doc:d}),I=!0,(c||u)&&(a=!0)),I&&(f?(o=o.add(f),i=v?i.add(l):i.delete(l)):(o=o.delete(l),i=i.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),i=i.delete(l.key),r.track({type:1,doc:l})}return{ra:o,oa:r,zi:a,mutatedKeys:i}}_a(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const s=this.ra;this.ra=e.ra,this.mutatedKeys=e.mutatedKeys;const i=e.oa.M_();i.sort((u,l)=>function(d,f){const g=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return q()}};return g(d)-g(f)}(u.type,l.type)||this.na(u.doc,l.doc)),this.aa(r);const o=n?this.ua():[],a=this.ta.size===0&&this.current?1:0,c=a!==this.ea;return this.ea=a,i.length!==0||c?{snapshot:new Ps(this.query,e.ra,s,i,e.mutatedKeys,a===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),ca:o}:{ca:o}}N_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ra:this.ra,oa:new Qm,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{ca:[]}}la(e){return!this.X_.has(e)&&!!this.ra.has(e)&&!this.ra.get(e).hasLocalMutations}aa(e){e&&(e.addedDocuments.forEach(n=>this.X_=this.X_.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.X_=this.X_.delete(n)),this.current=e.current)}ua(){if(!this.current)return[];const e=this.ta;this.ta=se(),this.ra.forEach(r=>{this.la(r.key)&&(this.ta=this.ta.add(r.key))});const n=[];return e.forEach(r=>{this.ta.has(r)||n.push(new Rv(r))}),this.ta.forEach(r=>{e.has(r)||n.push(new bv(r))}),n}ha(e){this.X_=e.ss,this.ta=se();const n=this.sa(e.documents);return this.applyChanges(n,!0)}Pa(){return Ps.fromInitialDocuments(this.query,this.ra,this.mutatedKeys,this.ea===0,this.hasCachedResults)}}class WS{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class JS{constructor(e){this.key=e,this.Ia=!1}}class YS{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ta={},this.Ea=new En(a=>Ey(a),Eo),this.da=new Map,this.Aa=new Set,this.Ra=new Re(N.comparator),this.Va=new Map,this.ma=new Bh,this.fa={},this.ga=new Map,this.pa=Lr.On(),this.onlineState="Unknown",this.ya=void 0}get isPrimaryClient(){return this.ya===!0}}async function XS(t,e){const n=sd(t);let r,s;const i=n.Ea.get(e);if(i)r=i.targetId,n.sharedClientState.addLocalQueryTarget(r),s=i.view.Pa();else{const o=await bs(n.localStore,vt(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=await ed(n,e,r,a==="current",o.resumeToken),n.isPrimaryClient&&xc(n.remoteStore,o)}return s}async function ed(t,e,n,r,s){t.wa=(h,d,f)=>async function(v,I,A,R){let V=I.view.sa(A);V.zi&&(V=await Ma(v.localStore,I.query,!1).then(({documents:X})=>I.view.sa(X,V)));const D=R&&R.targetChanges.get(I.targetId),j=I.view.applyChanges(V,v.isPrimaryClient,D);return Tl(v,I.targetId,j.ca),j.snapshot}(t,h,d,f);const i=await Ma(t.localStore,e,!0),o=new Pv(e,i.ss),a=o.sa(i.documents),c=Ao.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=o.applyChanges(a,t.isPrimaryClient,c);Tl(t,n,u.ca);const l=new WS(e,n,o);return t.Ea.set(e,l),t.da.has(n)?t.da.get(n).push(e):t.da.set(n,[e]),u.snapshot}async function ZS(t,e){const n=M(t),r=n.Ea.get(e),s=n.da.get(r.targetId);if(s.length>1)return n.da.set(r.targetId,s.filter(i=>!Eo(i,e))),void n.Ea.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Rs(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),so(n.remoteStore,r.targetId),Ss(n,r.targetId)}).catch(tr)):(Ss(n,r.targetId),await Rs(n.localStore,r.targetId,!0))}async function eC(t,e,n){const r=id(t);try{const s=await function(o,a){const c=M(o),u=Ne.now(),l=a.reduce((f,g)=>f.add(g.key),se());let h,d;return c.persistence.runTransaction("Locally write mutations","readwrite",f=>{let g=bt(),v=se();return c.Xi.getEntries(f,l).next(I=>{g=I,g.forEach((A,R)=>{R.isValidDocument()||(v=v.add(A))})}).next(()=>c.localDocuments.getOverlayedDocuments(f,g)).next(I=>{h=I;const A=[];for(const R of a){const V=CP(R,h.get(R.key).overlayedDocument);V!=null&&A.push(new In(R.key,V,hy(V.value.mapValue),ke.exists(!0)))}return c.mutationQueue.addMutationBatch(f,u,A,a)}).next(I=>{d=I;const A=I.applyToLocalDocumentSet(h,v);return c.documentOverlayCache.saveOverlays(f,I.batchId,A)})}).then(()=>({batchId:d.batchId,changes:Ay(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,c){let u=o.fa[o.currentUser.toKey()];u||(u=new Re(ee)),u=u.insert(a,c),o.fa[o.currentUser.toKey()]=u}(r,s.batchId,n),await wn(r,s.changes),await js(r.remoteStore)}catch(s){const i=Ks(s,"Failed to persist write");n.reject(i)}}async function Sv(t,e){const n=M(t);try{const r=await ES(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Va.get(i);o&&(G(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.Ia=!0:s.modifiedDocuments.size>0?G(o.Ia):s.removedDocuments.size>0&&(G(o.Ia),o.Ia=!1))}),await wn(n,r,e)}catch(r){await tr(r)}}function Jm(t,e,n){const r=M(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Ea.forEach((i,o)=>{const a=o.view.N_(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const c=M(o);c.onlineState=a;let u=!1;c.queries.forEach((l,h)=>{for(const d of h.listeners)d.N_(a)&&(u=!0)}),u&&Xh(c)}(r.eventManager,e),s.length&&r.Ta.r_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function tC(t,e,n){const r=M(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Va.get(e),i=s&&s.key;if(i){let o=new Re(N.comparator);o=o.insert(i,xe.newNoDocument(i,H.min()));const a=se().add(i),c=new To(H.min(),new Map,new Re(ee),o,a);await Sv(r,c),r.Ra=r.Ra.remove(i),r.Va.delete(e),rd(r)}else await Rs(r.localStore,e,!1).then(()=>Ss(r,e,n)).catch(tr)}async function nC(t,e){const n=M(t),r=e.batch.batchId;try{const s=await vS(n.localStore,e);nd(n,r,null),td(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await wn(n,s)}catch(s){await tr(s)}}async function rC(t,e,n){const r=M(t);try{const s=await function(o,a){const c=M(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let l;return c.mutationQueue.lookupMutationBatch(u,a).next(h=>(G(h!==null),l=h.keys(),c.mutationQueue.removeMutationBatch(u,h))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,l,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,l)).next(()=>c.localDocuments.getDocuments(u,l))})}(r.localStore,e);nd(r,e,n),td(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await wn(r,s)}catch(s){await tr(s)}}async function sC(t,e){const n=M(t);sr(n.remoteStore)||S("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const a=M(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(n.localStore);if(r===-1)return void e.resolve();const s=n.ga.get(r)||[];s.push(e),n.ga.set(r,s)}catch(r){const s=Ks(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function td(t,e){(t.ga.get(e)||[]).forEach(n=>{n.resolve()}),t.ga.delete(e)}function nd(t,e,n){const r=M(t);let s=r.fa[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.fa[r.currentUser.toKey()]=s}}function Ss(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.da.get(e))t.Ea.delete(r),n&&t.Ta.Sa(r,n);t.da.delete(e),t.isPrimaryClient&&t.ma.Ar(e).forEach(r=>{t.ma.containsKey(r)||Cv(t,r)})}function Cv(t,e){t.Aa.delete(e.path.canonicalString());const n=t.Ra.get(e);n!==null&&(so(t.remoteStore,n),t.Ra=t.Ra.remove(e),t.Va.delete(n),rd(t))}function Tl(t,e,n){for(const r of n)r instanceof bv?(t.ma.addReference(r.key,e),iC(t,r)):r instanceof Rv?(S("SyncEngine","Document no longer in limbo: "+r.key),t.ma.removeReference(r.key,e),t.ma.containsKey(r.key)||Cv(t,r.key)):q()}function iC(t,e){const n=e.key,r=n.path.canonicalString();t.Ra.get(n)||t.Aa.has(r)||(S("SyncEngine","New document in limbo: "+n),t.Aa.add(r),rd(t))}function rd(t){for(;t.Aa.size>0&&t.Ra.size<t.maxConcurrentLimboResolutions;){const e=t.Aa.values().next().value;t.Aa.delete(e);const n=new N(de.fromString(e)),r=t.pa.next();t.Va.set(r,new JS(n)),t.Ra=t.Ra.insert(n,r),xc(t.remoteStore,new mn(vt(Bs(n.path)),r,"TargetPurposeLimboResolution",Tt.ae))}}async function wn(t,e,n){const r=M(t),s=[],i=[],o=[];r.Ea.isEmpty()||(r.Ea.forEach((a,c)=>{o.push(r.wa(c,e,n).then(u=>{if((u||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,u!=null&&u.fromCache?"not-current":"current"),u){s.push(u);const l=jh.qi(c.targetId,u);i.push(l)}}))}),await Promise.all(o),r.Ta.r_(s),await async function(c,u){const l=M(c);try{await l.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>y.forEach(u,d=>y.forEach(d.Li,f=>l.persistence.referenceDelegate.addReference(h,d.targetId,f)).next(()=>y.forEach(d.ki,f=>l.persistence.referenceDelegate.removeReference(h,d.targetId,f)))))}catch(h){if(!nr(h))throw h;S("LocalStore","Failed to update sequence numbers: "+h)}for(const h of u){const d=h.targetId;if(!h.fromCache){const f=l.Ji.get(d),g=f.snapshotVersion,v=f.withLastLimboFreeSnapshotVersion(g);l.Ji=l.Ji.insert(d,v)}}}(r.localStore,i))}async function oC(t,e){const n=M(t);if(!n.currentUser.isEqual(e)){S("SyncEngine","User change. New user:",e.toKey());const r=await lv(n.localStore,e);n.currentUser=e,function(i,o){i.ga.forEach(a=>{a.forEach(c=>{c.reject(new b(E.CANCELLED,o))})}),i.ga.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await wn(n,r.ts)}}function aC(t,e){const n=M(t),r=n.Va.get(e);if(r&&r.Ia)return se().add(r.key);{let s=se();const i=n.da.get(e);if(!i)return s;for(const o of i){const a=n.Ea.get(o);s=s.unionWith(a.view.ia)}return s}}async function cC(t,e){const n=M(t),r=await Ma(n.localStore,e.query,!0),s=e.view.ha(r);return n.isPrimaryClient&&Tl(n,e.targetId,s.ca),s}async function uC(t,e){const n=M(t);return mv(n.localStore,e).then(r=>wn(n,r))}async function lC(t,e,n,r){const s=M(t),i=await function(a,c){const u=M(a),l=M(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",h=>l.Dn(h,c).next(d=>d?u.localDocuments.getDocuments(h,d):y.resolve(null)))}(s.localStore,e);i!==null?(n==="pending"?await js(s.remoteStore):n==="acknowledged"||n==="rejected"?(nd(s,e,r||null),td(s,e),function(a,c){M(M(a).mutationQueue).Cn(c)}(s.localStore,e)):q(),await wn(s,i)):S("SyncEngine","Cannot apply mutation batch with id: "+e)}async function hC(t,e){const n=M(t);if(sd(n),id(n),e===!0&&n.ya!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),s=await Ym(n,r.toArray());n.ya=!0,await wl(n.remoteStore,!0);for(const i of s)xc(n.remoteStore,i)}else if(e===!1&&n.ya!==!1){const r=[];let s=Promise.resolve();n.da.forEach((i,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(Ss(n,o),Rs(n.localStore,o,!0))),so(n.remoteStore,o)}),await s,await Ym(n,r),function(o){const a=M(o);a.Va.forEach((c,u)=>{so(a.remoteStore,u)}),a.ma.Rr(),a.Va=new Map,a.Ra=new Re(N.comparator)}(n),n.ya=!1,await wl(n.remoteStore,!1)}}async function Ym(t,e,n){const r=M(t),s=[],i=[];for(const o of e){let a;const c=r.da.get(o);if(c&&c.length!==0){a=await bs(r.localStore,vt(c[0]));for(const u of c){const l=r.Ea.get(u),h=await cC(r,l);h.snapshot&&i.push(h.snapshot)}}else{const u=await fv(r.localStore,o);a=await bs(r.localStore,u),await ed(r,xv(u),o,!1,a.resumeToken)}s.push(a)}return r.Ta.r_(i),s}function xv(t){return vy(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function dC(t){return function(n){return M(M(n).persistence).Ni()}(M(t).localStore)}async function fC(t,e,n,r){const s=M(t);if(s.ya)return void S("SyncEngine","Ignoring unexpected query state notification.");const i=s.da.get(e);if(i&&i.length>0)switch(n){case"current":case"not-current":{const o=await mv(s.localStore,Iy(i[0])),a=To.createSynthesizedRemoteEventForCurrentChange(e,n==="current",He.EMPTY_BYTE_STRING);await wn(s,o,a);break}case"rejected":await Rs(s.localStore,e,!0),Ss(s,e,r);break;default:q()}}async function mC(t,e,n){const r=sd(t);if(r.ya){for(const s of e){if(r.da.has(s)){S("SyncEngine","Adding an already active target "+s);continue}const i=await fv(r.localStore,s),o=await bs(r.localStore,i);await ed(r,xv(i),o.targetId,!1,o.resumeToken),xc(r.remoteStore,o)}for(const s of n)r.da.has(s)&&await Rs(r.localStore,s,!1).then(()=>{so(r.remoteStore,s),Ss(r,s)}).catch(tr)}}function sd(t){const e=M(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Sv.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=aC.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=tC.bind(null,e),e.Ta.r_=KS.bind(null,e.eventManager),e.Ta.Sa=GS.bind(null,e.eventManager),e}function id(t){const e=M(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=nC.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=rC.bind(null,e),e}function pC(t,e,n){const r=M(t);(async function(i,o,a){try{const c=await o.getMetadata();if(await function(f,g){const v=M(f),I=qe(g.createTime);return v.persistence.runTransaction("hasNewerBundle","readonly",A=>v.Qr.getBundleMetadata(A,g.id)).then(A=>!!A&&A.createTime.compareTo(I)>=0)}(i.localStore,c))return await o.close(),a._completeWith(function(f){return{taskState:"Success",documentsLoaded:f.totalDocuments,bytesLoaded:f.totalBytes,totalDocuments:f.totalDocuments,totalBytes:f.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(Av(c));const u=new QS(c,i.localStore,o.serializer);let l=await o.ba();for(;l;){const d=await u.H_(l);d&&a._updateProgress(d),l=await o.ba()}const h=await u.complete();return await wn(i,h.Z_,void 0),await function(f,g){const v=M(f);return v.persistence.runTransaction("Save bundle","readwrite",I=>v.Qr.saveBundleMetadata(I,g))}(i.localStore,c),a._completeWith(h.progress),Promise.resolve(h.Y_)}catch(c){return Ft("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})(r,e,n).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}class Cs{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=bo(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return uv(this.persistence,new cv,e.initialUser,this.serializer)}createPersistence(e){return new Uh(Cc.zr,this.serializer)}createSharedClientState(e){return new gv}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class gC extends Cs{constructor(e){super(),this.cacheSizeBytes=e}createGarbageCollectionScheduler(e,n){G(this.persistence.referenceDelegate instanceof Oa);const r=this.persistence.referenceDelegate.garbageCollector;return new rv(r,e.asyncQueue,n)}createPersistence(e){const n=this.cacheSizeBytes!==void 0?ht.withCacheSize(this.cacheSizeBytes):ht.DEFAULT;return new Uh(r=>Oa.zr(r,n),this.serializer)}}class od extends Cs{constructor(e,n,r){super(),this.Da=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Da.initialize(this,e),await id(this.Da.syncEngine),await js(this.Da.remoteStore),await this.persistence.Vi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return uv(this.persistence,new cv,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new rv(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){const r=new qR(n,this.persistence);return new UR(e.asyncQueue,r)}createPersistence(e){const n=$h(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?ht.withCacheSize(this.cacheSizeBytes):ht.DEFAULT;return new qh(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,_v(),ca(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new gv}}class Vv extends od{constructor(e,n){super(e,n,!1),this.Da=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Da.syncEngine;this.sharedClientState instanceof vu&&(this.sharedClientState.syncEngine={Gs:lC.bind(null,n),zs:fC.bind(null,n),js:mC.bind(null,n),Ni:dC.bind(null,n),Ws:uC.bind(null,n)},await this.sharedClientState.start()),await this.persistence.Vi(async r=>{await hC(this.Da.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){const n=_v();if(!vu.v(n))throw new b(E.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=$h(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new vu(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class Gs{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Jm(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=oC.bind(null,this.syncEngine),await wl(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new zS}()}createDatastore(e){const n=bo(e.databaseInfo.databaseId),r=function(i){return new PS(i)}(e.databaseInfo);return function(i,o,a,c){return new xS(i,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new kS(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>Jm(this.syncEngine,n,0),function(){return Gm.v()?new Gm:new AS}())}createSyncEngine(e,n){return function(s,i,o,a,c,u,l){const h=new YS(s,i,o,a,c,u);return l&&(h.ya=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(n){const r=M(n);S("RemoteStore","RemoteStore shutting down."),r.y_.add(5),await $s(r),r.S_.shutdown(),r.b_.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xm(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vc{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.va(this.observer.next,e)}error(e){this.observer.error?this.va(this.observer.error,e):Be("Uncaught Error in snapshot listener:",e.toString())}Ca(){this.muted=!0}va(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(e,n){this.Fa=e,this.serializer=n,this.metadata=new We,this.buffer=new Uint8Array,this.Ma=function(){return new TextDecoder("utf-8")}(),this.xa().then(r=>{r&&r.z_()?this.metadata.resolve(r.G_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.G_)}`))},r=>this.metadata.reject(r))}close(){return this.Fa.cancel()}async getMetadata(){return this.metadata.promise}async ba(){return await this.getMetadata(),this.xa()}async xa(){const e=await this.Oa();if(e===null)return null;const n=this.Ma.decode(e),r=Number(n);isNaN(r)&&this.Na(`length string (${n}) is not valid number`);const s=await this.Ba(r);return new HS(JSON.parse(s),e.length+r)}La(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async Oa(){for(;this.La()<0&&!await this.ka(););if(this.buffer.length===0)return null;const e=this.La();e<0&&this.Na("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async Ba(e){for(;this.buffer.length<e;)await this.ka()&&this.Na("Reached the end of bundle when more is expected.");const n=this.Ma.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}Na(e){throw this.Fa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ka(){const e=await this.Fa.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new b(E.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const n=await async function(s,i){const o=M(s),a=no(o.serializer)+"/documents",c={documents:i.map(d=>to(o.serializer,d))},u=await o.yo("BatchGetDocuments",a,c,i.length),l=new Map;u.forEach(d=>{const f=BP(o.serializer,d);l.set(f.key.toString(),f)});const h=[];return i.forEach(d=>{const f=l.get(d.toString());G(!!f),h.push(f)}),h}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new qs(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const s=N.fromPath(r);this.mutations.push(new Ch(s,this.precondition(s)))}),await async function(r,s){const i=M(r),o=no(i.serializer)+"/documents",a={writes:s.map(c=>ro(i.serializer,c))};await i.Vo("Commit",o,a)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw q();n=H.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new b(E.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(H.min())?ke.exists(!1):ke.updateTime(n):ke.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(H.min()))throw new b(E.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ke.updateTime(n)}return ke.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e,n,r,s,i){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=s,this.deferred=i,this.qa=r.maxAttempts,this.Ko=new Kh(this.asyncQueue,"transaction_retry")}run(){this.qa-=1,this.Qa()}Qa(){this.Ko.xo(async()=>{const e=new yC(this.datastore),n=this.Ka(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.$a(s)}))}).catch(r=>{this.$a(r)})})}Ka(e){try{const n=this.updateFunction(e);return!yo(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}$a(e){this.qa>0&&this.Ua(e)?(this.qa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Qa(),Promise.resolve()))):this.deferred.reject(e)}Ua(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!Oy(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC{constructor(e,n,r,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Ye.UNAUTHENTICATED,this.clientId=Y_.V(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{S("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(S("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new b(E.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new We;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Ks(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function ua(t,e){t.asyncQueue.verifyOperationInProgress(),S("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await lv(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Al(t,e){t.asyncQueue.verifyOperationInProgress();const n=await ad(t);S("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(s=>Hm(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,i)=>Hm(e.remoteStore,i)),t._onlineComponents=e}function Dv(t){return t.name==="FirebaseError"?t.code===E.FAILED_PRECONDITION||t.code===E.UNIMPLEMENTED:!(typeof DOMException!="undefined"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function ad(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){S("FirestoreClient","Using user provided OfflineComponentProvider");try{await ua(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!Dv(n))throw n;Ft("Error using user provided cache. Falling back to memory cache: "+n),await ua(t,new Cs)}}else S("FirestoreClient","Using default OfflineComponentProvider"),await ua(t,new Cs);return t._offlineComponents}async function Dc(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(S("FirestoreClient","Using user provided OnlineComponentProvider"),await Al(t,t._uninitializedComponentsProvider._online)):(S("FirestoreClient","Using default OnlineComponentProvider"),await Al(t,new Gs))),t._onlineComponents}function kv(t){return ad(t).then(e=>e.persistence)}function kc(t){return ad(t).then(e=>e.localStore)}function Nv(t){return Dc(t).then(e=>e.remoteStore)}function cd(t){return Dc(t).then(e=>e.syncEngine)}function Ov(t){return Dc(t).then(e=>e.datastore)}async function xs(t){const e=await Dc(t),n=e.eventManager;return n.onListen=XS.bind(null,e.syncEngine),n.onUnlisten=ZS.bind(null,e.syncEngine),n}function IC(t){return t.asyncQueue.enqueue(async()=>{const e=await kv(t),n=await Nv(t);return e.setNetworkEnabled(!0),function(s){const i=M(s);return i.y_.delete(0),Ro(i)}(n)})}function wC(t){return t.asyncQueue.enqueue(async()=>{const e=await kv(t),n=await Nv(t);return e.setNetworkEnabled(!1),async function(s){const i=M(s);i.y_.add(0),await $s(i),i.b_.set("Offline")}(n)})}function TC(t,e){const n=new We;return t.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await function(u,l){const h=M(u);return h.persistence.runTransaction("read document","readonly",d=>h.localDocuments.getDocument(d,l))}(s,i);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new b(E.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const c=Ks(a,`Failed to get document '${i} from cache`);o.reject(c)}}(await kc(t),e,n)),n.promise}function Mv(t,e,n={}){const r=new We;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,u){const l=new Vc({next:d=>{o.enqueueAndForget(()=>Yh(i,h));const f=d.docs.has(a);!f&&d.fromCache?u.reject(new b(E.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&d.fromCache&&c&&c.source==="server"?u.reject(new b(E.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(d)},error:d=>u.reject(d)}),h=new Zh(Bs(a.path),l,{includeMetadataChanges:!0,W_:!0});return Jh(i,h)}(await xs(t),t.asyncQueue,e,n,r)),r.promise}function AC(t,e){const n=new We;return t.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await Ma(s,i,!0),c=new Pv(i,a.ss),u=c.sa(a.documents),l=c.applyChanges(u,!1);o.resolve(l.snapshot)}catch(a){const c=Ks(a,`Failed to execute query '${i} against cache`);o.reject(c)}}(await kc(t),e,n)),n.promise}function Fv(t,e,n={}){const r=new We;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,u){const l=new Vc({next:d=>{o.enqueueAndForget(()=>Yh(i,h)),d.fromCache&&c.source==="server"?u.reject(new b(E.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(d)},error:d=>u.reject(d)}),h=new Zh(a,l,{includeMetadataChanges:!0,W_:!0});return Jh(i,h)}(await xs(t),t.asyncQueue,e,n,r)),r.promise}function bC(t,e){const n=new Vc(e);return t.asyncQueue.enqueueAndForget(async()=>function(s,i){M(s).O_.add(i),i.next()}(await xs(t),n)),()=>{n.Ca(),t.asyncQueue.enqueueAndForget(async()=>function(s,i){M(s).O_.delete(i)}(await xs(t),n))}}function RC(t,e,n,r){const s=function(o,a){let c;return c=typeof o=="string"?Fy().encode(o):o,function(l,h){return new _C(l,h)}(function(l,h){if(l instanceof Uint8Array)return Xm(l,h);if(l instanceof ArrayBuffer)return Xm(new Uint8Array(l),h);if(l instanceof ReadableStream)return l.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(n,bo(e));t.asyncQueue.enqueueAndForget(async()=>{pC(await cd(t),s,r)})}function PC(t,e){return t.asyncQueue.enqueue(async()=>function(r,s){const i=M(r);return i.persistence.runTransaction("Get named query","readonly",o=>i.Qr.getNamedQuery(o,s))}(await kc(t),e))}function SC(t,e){return t.asyncQueue.enqueue(async()=>async function(r,s){const i=M(r),o=i.indexManager,a=[];return i.persistence.runTransaction("Configure indexes","readwrite",c=>o.getFieldIndexes(c).next(u=>function(h,d,f,g,v){h=[...h],d=[...d],h.sort(f),d.sort(f);const I=h.length,A=d.length;let R=0,V=0;for(;R<A&&V<I;){const D=f(h[V],d[R]);D<0?v(h[V++]):D>0?g(d[R++]):(R++,V++)}for(;R<A;)g(d[R++]);for(;V<I;)v(h[V++])}(u,s,MR,l=>{a.push(o.addFieldIndex(c,l))},l=>{a.push(o.deleteFieldIndex(c,l))})).next(()=>y.waitFor(a)))}(await kc(t),e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lv(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zm=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ud(t,e,n){if(!n)throw new b(E.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Bv(t,e,n,r){if(e===!0&&r===!0)throw new b(E.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function ep(t){if(!N.isDocumentKey(t))throw new b(E.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function tp(t){if(N.isDocumentKey(t))throw new b(E.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Nc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":q()}function ue(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new b(E.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Nc(t);throw new b(E.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Uv(t,e){if(e<=0)throw new b(E.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new b(E.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new b(E.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Bv("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Lv((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new b(E.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new b(E.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new b(E.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Po{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new np({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new b(E.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new b(E.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new np(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new W_;switch(r.type){case"firstParty":return new VR(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new b(E.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Zm.get(n);r&&(S("ComponentProvider","Removing Datastore"),Zm.delete(n),r.terminate())}(this),Promise.resolve()}}function qv(t,e,n,r={}){var s;const i=(t=ue(t,Po))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&Ft("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=Ye.MOCK_USER;else{a=e0(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new b(E.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Ye(u)}t._authCredentials=new SR(new Q_(a,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new et(this.firestore,e,this._query)}}class Fe{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Kt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Fe(this.firestore,e,this._key)}}class Kt extends et{constructor(e,n,r){super(e,n,Bs(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Fe(this.firestore,null,new N(e))}withConverter(e){return new Kt(this.firestore,e,this._path)}}function CC(t,e,...n){if(t=Xe(t),ud("collection","path",e),t instanceof Po){const r=de.fromString(e,...n);return tp(r),new Kt(t,null,r)}{if(!(t instanceof Fe||t instanceof Kt))throw new b(E.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(de.fromString(e,...n));return tp(r),new Kt(t.firestore,null,r)}}function xC(t,e){if(t=ue(t,Po),ud("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new b(E.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new et(t,null,function(r){return new vn(de.emptyPath(),r)}(e))}function $v(t,e,...n){if(t=Xe(t),arguments.length===1&&(e=Y_.V()),ud("doc","path",e),t instanceof Po){const r=de.fromString(e,...n);return ep(r),new Fe(t,null,new N(r))}{if(!(t instanceof Fe||t instanceof Kt))throw new b(E.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(de.fromString(e,...n));return ep(r),new Fe(t.firestore,t instanceof Kt?t.converter:null,new N(r))}}function VC(t,e){return t=Xe(t),e=Xe(e),(t instanceof Fe||t instanceof Kt)&&(e instanceof Fe||e instanceof Kt)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function ld(t,e){return t=Xe(t),e=Xe(e),t instanceof et&&e instanceof et&&t.firestore===e.firestore&&Eo(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(){this.Wa=Promise.resolve(),this.Ga=[],this.za=!1,this.ja=[],this.Ha=null,this.Ja=!1,this.Ya=!1,this.Za=[],this.Ko=new Kh(this,"async_queue_retry"),this.Xa=()=>{const n=ca();n&&S("AsyncQueue","Visibility state changed to "+n.visibilityState),this.Ko.No()};const e=ca();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Xa)}get isShuttingDown(){return this.za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.eu(),this.tu(e)}enterRestrictedMode(e){if(!this.za){this.za=!0,this.Ya=e||!1;const n=ca();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Xa)}}enqueue(e){if(this.eu(),this.za)return new Promise(()=>{});const n=new We;return this.tu(()=>this.za&&this.Ya?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ga.push(e),this.nu()))}async nu(){if(this.Ga.length!==0){try{await this.Ga[0](),this.Ga.shift(),this.Ko.reset()}catch(e){if(!nr(e))throw e;S("AsyncQueue","Operation failed with retryable error: "+e)}this.Ga.length>0&&this.Ko.xo(()=>this.nu())}}tu(e){const n=this.Wa.then(()=>(this.Ja=!0,e().catch(r=>{this.Ha=r,this.Ja=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Be("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.Ja=!1,r))));return this.Wa=n,n}enqueueAfterDelay(e,n,r){this.eu(),this.Za.indexOf(e)>-1&&(n=0);const s=Wh.createAndSchedule(this,e,n,r,i=>this.ru(i));return this.ja.push(s),s}eu(){this.Ha&&q()}verifyOperationInProgress(){}async iu(){let e;do e=this.Wa,await e;while(e!==this.Wa)}su(e){for(const n of this.ja)if(n.timerId===e)return!0;return!1}ou(e){return this.iu().then(()=>{this.ja.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.ja)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.iu()})}_u(e){this.Za.push(e)}ru(e){const n=this.ja.indexOf(e);this.ja.splice(n,1)}}function bl(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class jv{constructor(){this._progressObserver={},this._taskCompletionResolver=new We,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kC=-1;class Pe extends Po{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=function(){return new DC}(),this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Kv(this),this._firestoreClient.terminate()}}function NC(t,e,n){n||(n="(default)");const r=Zl(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(Li(i,e))return s;throw new b(E.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new b(E.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new b(E.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function zv(t,e){const n=typeof t=="object"?t:ab(),r=typeof t=="string"?t:e||"(default)",s=Zl(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=XA("firestore");i&&qv(s,...i)}return s}function $e(t){return t._firestoreClient||Kv(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Kv(t){var e,n,r;const s=t._freezeSettings(),i=function(a,c,u,l){return new cP(a,c,u,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,Lv(l.experimentalLongPollingOptions),l.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._firestoreClient=new EC(t._authCredentials,t._appCheckCredentials,t._queue,i),((n=s.localCache)===null||n===void 0?void 0:n._offlineComponentProvider)&&((r=s.localCache)===null||r===void 0?void 0:r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.localCache.kind,_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider})}function OC(t,e){Hv(t=ue(t,Pe));const n=$e(t);if(n._uninitializedComponentsProvider)throw new b(E.FAILED_PRECONDITION,"SDK cache is already specified.");Ft("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings(),s=new Gs;return Gv(n,s,new od(s,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function MC(t){Hv(t=ue(t,Pe));const e=$e(t);if(e._uninitializedComponentsProvider)throw new b(E.FAILED_PRECONDITION,"SDK cache is already specified.");Ft("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings(),r=new Gs;return Gv(e,r,new Vv(r,n.cacheSizeBytes))}function Gv(t,e,n){const r=new We;return t.asyncQueue.enqueue(async()=>{try{await ua(t,n),await Al(t,e),r.resolve()}catch(s){const i=s;if(!Dv(i))throw i;Ft("Error enabling indexeddb cache. Falling back to memory cache: "+i),r.reject(i)}}).then(()=>r.promise)}function FC(t){if(t._initialized&&!t._terminated)throw new b(E.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new We;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!$t.v())return Promise.resolve();const s=r+"main";await $t.delete(s)}($h(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function LC(t){return function(n){const r=new We;return n.asyncQueue.enqueueAndForget(async()=>sC(await cd(n),r)),r.promise}($e(t=ue(t,Pe)))}function BC(t){return IC($e(t=ue(t,Pe)))}function UC(t){return wC($e(t=ue(t,Pe)))}function qC(t){return rb(t.app,"firestore",t._databaseId.database),t._delete()}function $C(t,e){const n=$e(t=ue(t,Pe)),r=new jv;return RC(n,t._databaseId,e,r),r}function jC(t,e){return PC($e(t=ue(t,Pe)),e).then(n=>n?new et(t,null,n.query):null)}function Hv(t){if(t._initialized||t._terminated)throw new b(E.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(e="count",n){this._aggregateType=e,this._internalFieldPath=n,this.type="AggregateField"}}class Qv{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Xn(He.fromBase64String(e))}catch(n){throw new b(E.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Xn(He.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new b(E.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Me(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function zC(){return new ir("__name__")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oc{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new b(E.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new b(E.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ee(this._lat,e._lat)||ee(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KC=/^__.*__$/;class GC{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new In(e,this.data,this.fieldMask,n,this.fieldTransforms):new Us(e,this.data,n,this.fieldTransforms)}}class Wv{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new In(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Jv(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw q()}}class Mc{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.au(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get uu(){return this.settings.uu}cu(e){return new Mc(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}lu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.cu({path:r,hu:!1});return s.Pu(e),s}Iu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.cu({path:r,hu:!1});return s.au(),s}Tu(e){return this.cu({path:void 0,hu:!0})}Eu(e){return Ua(e,this.settings.methodName,this.settings.du||!1,this.path,this.settings.Au)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}au(){if(this.path)for(let e=0;e<this.path.length;e++)this.Pu(this.path.get(e))}Pu(e){if(e.length===0)throw this.Eu("Document fields must not be empty");if(Jv(this.uu)&&KC.test(e))throw this.Eu('Document fields cannot begin and end with "__"')}}class HC{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||bo(e)}Ru(e,n,r,s=!1){return new Mc({uu:e,methodName:n,Au:r,path:Me.emptyPath(),hu:!1,du:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function jr(t){const e=t._freezeSettings(),n=bo(t._databaseId);return new HC(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Fc(t,e,n,r,s,i={}){const o=t.Ru(i.merge||i.mergeFields?2:0,e,n,s);md("Data must be an object, but it was:",o,r);const a=Zv(r,o);let c,u;if(i.merge)c=new At(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const l=[];for(const h of i.mergeFields){const d=io(e,h,n);if(!o.contains(d))throw new b(E.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);tE(l,d)||l.push(d)}c=new At(l),u=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,u=o.fieldTransforms;return new GC(new ot(a),c,u)}class So extends or{_toFieldTransform(e){if(e.uu!==2)throw e.uu===1?e.Eu(`${this._methodName}() can only appear at the top level of your update data`):e.Eu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof So}}function Yv(t,e,n){return new Mc({uu:3,Au:e.settings.Au,methodName:t._methodName,hu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class hd extends or{_toFieldTransform(e){return new wo(e.path,new ws)}isEqual(e){return e instanceof hd}}class QC extends or{constructor(e,n){super(e),this.Vu=n}_toFieldTransform(e){const n=Yv(this,e,!0),r=this.Vu.map(i=>zr(i,n)),s=new Nr(r);return new wo(e.path,s)}isEqual(e){return this===e}}class WC extends or{constructor(e,n){super(e),this.Vu=n}_toFieldTransform(e){const n=Yv(this,e,!0),r=this.Vu.map(i=>zr(i,n)),s=new Or(r);return new wo(e.path,s)}isEqual(e){return this===e}}class JC extends or{constructor(e,n){super(e),this.mu=n}_toFieldTransform(e){const n=new Ts(e.serializer,Sy(e.serializer,this.mu));return new wo(e.path,n)}isEqual(e){return this===e}}function dd(t,e,n,r){const s=t.Ru(1,e,n);md("Data must be an object, but it was:",s,r);const i=[],o=ot.empty();rr(r,(c,u)=>{const l=Lc(e,c,n);u=Xe(u);const h=s.Iu(l);if(u instanceof So)i.push(l);else{const d=zr(u,h);d!=null&&(i.push(l),o.set(l,d))}});const a=new At(i);return new Wv(o,a,s.fieldTransforms)}function fd(t,e,n,r,s,i){const o=t.Ru(1,e,n),a=[io(e,r,n)],c=[s];if(i.length%2!=0)throw new b(E.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<i.length;d+=2)a.push(io(e,i[d])),c.push(i[d+1]);const u=[],l=ot.empty();for(let d=a.length-1;d>=0;--d)if(!tE(u,a[d])){const f=a[d];let g=c[d];g=Xe(g);const v=o.Iu(f);if(g instanceof So)u.push(f);else{const I=zr(g,v);I!=null&&(u.push(f),l.set(f,I))}}const h=new At(u);return new Wv(l,h,o.fieldTransforms)}function Xv(t,e,n,r=!1){return zr(n,t.Ru(r?4:3,e))}function zr(t,e){if(eE(t=Xe(t)))return md("Unsupported field value:",e,t),Zv(t,e);if(t instanceof or)return function(r,s){if(!Jv(s.uu))throw s.Eu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Eu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.hu&&e.uu!==4)throw e.Eu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let c=zr(a,s.Tu(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Xe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Sy(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Ne.fromDate(r);return{timestampValue:As(s.serializer,i)}}if(r instanceof Ne){const i=new Ne(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:As(s.serializer,i)}}if(r instanceof Oc)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Xn)return{bytesValue:Uy(s.serializer,r._byteString)};if(r instanceof Fe){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Eu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Nh(r.firestore._databaseId||s.databaseId,r._key.path)}}throw s.Eu(`Unsupported field value: ${Nc(r)}`)}(t,e)}function Zv(t,e){const n={};return cy(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):rr(t,(r,s)=>{const i=zr(s,e.lu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function eE(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ne||t instanceof Oc||t instanceof Xn||t instanceof Fe||t instanceof or)}function md(t,e,n){if(!eE(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Nc(n);throw r==="an object"?e.Eu(t+" a custom object"):e.Eu(t+" "+r)}}function io(t,e,n){if((e=Xe(e))instanceof ir)return e._internalPath;if(typeof e=="string")return Lc(t,e);throw Ua("Field path arguments must be of type string or ",t,!1,void 0,n)}const YC=new RegExp("[~\\*/\\[\\]]");function Lc(t,e,n){if(e.search(YC)>=0)throw Ua(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ir(...e.split("."))._internalPath}catch{throw Ua(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ua(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new b(E.INVALID_ARGUMENT,a+t+c)}function tE(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Fe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new XC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Bc("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class XC extends oo{data(){return super.data()}}function Bc(t,e){return typeof e=="string"?Lc(t,e):e instanceof ir?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nE(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new b(E.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class pd{}class Hs extends pd{}function ZC(t,e,...n){let r=[];e instanceof pd&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof Kr).length,a=i.filter(c=>c instanceof Qs).length;if(o>1||o>0&&a>0)throw new b(E.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Qs extends Hs{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Qs(e,n,r)}_apply(e){const n=this._parse(e);return sE(e._query,n),new et(e.firestore,e.converter,fl(e._query,n))}_parse(e){const n=jr(e.firestore);return function(i,o,a,c,u,l,h){let d;if(u.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new b(E.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){sp(h,l);const f=[];for(const g of h)f.push(rp(c,i,g));d={arrayValue:{values:f}}}else d=rp(c,i,h)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||sp(h,l),d=Xv(a,o,h,l==="in"||l==="not-in");return ce.create(u,l,d)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function ex(t,e,n){const r=e,s=Bc("where",t);return Qs._create(s,r,n)}class Kr extends pd{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Kr(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ee.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const c of a)sE(o,c),o=fl(o,c)}(e._query,n),new et(e.firestore,e.converter,fl(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function tx(...t){return t.forEach(e=>oE("or",e)),Kr._create("or",t)}function nx(...t){return t.forEach(e=>oE("and",e)),Kr._create("and",t)}class Uc extends Hs{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Uc(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new b(E.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new b(E.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const a=new hs(i,o);return function(u,l){if(Rh(u)===null){const h=Tc(u);h!==null&&iE(u,h,l.field)}}(s,a),a}(e._query,this._field,this._direction);return new et(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new vn(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function rx(t,e="asc"){const n=e,r=Bc("orderBy",t);return Uc._create(r,n)}class Co extends Hs{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Co(e,n,r)}_apply(e){return new et(e.firestore,e.converter,Va(e._query,this._limit,this._limitType))}}function sx(t){return Uv("limit",t),Co._create("limit",t,"F")}function ix(t){return Uv("limitToLast",t),Co._create("limitToLast",t,"L")}class xo extends Hs{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new xo(e,n,r)}_apply(e){const n=rE(e,this.type,this._docOrFields,this._inclusive);return new et(e.firestore,e.converter,function(s,i){return new vn(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,n))}}function ox(...t){return xo._create("startAt",t,!0)}function ax(...t){return xo._create("startAfter",t,!1)}class Vo extends Hs{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Vo(e,n,r)}_apply(e){const n=rE(e,this.type,this._docOrFields,this._inclusive);return new et(e.firestore,e.converter,function(s,i){return new vn(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,n))}}function cx(...t){return Vo._create("endBefore",t,!1)}function ux(...t){return Vo._create("endAt",t,!0)}function rE(t,e,n,r){if(n[0]=Xe(n[0]),n[0]instanceof oo)return function(i,o,a,c,u){if(!c)throw new b(E.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const l=[];for(const h of Cr(i))if(h.field.isKeyField())l.push(Dr(o,c.key));else{const d=c.data.field(h.field);if(Ic(d))throw new b(E.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(d===null){const f=h.field.canonicalString();throw new b(E.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}l.push(d)}return new Jn(l,u)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const s=jr(t.firestore);return function(o,a,c,u,l,h){const d=o.explicitOrderBy;if(l.length>d.length)throw new b(E.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const f=[];for(let g=0;g<l.length;g++){const v=l[g];if(d[g].field.isKeyField()){if(typeof v!="string")throw new b(E.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof v}`);if(!Ph(o)&&v.indexOf("/")!==-1)throw new b(E.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${v}' contains a slash.`);const I=o.path.child(de.fromString(v));if(!N.isDocumentKey(I))throw new b(E.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${I}' is not because it contains an odd number of segments.`);const A=new N(I);f.push(Dr(a,A))}else{const I=Xv(c,u,v);f.push(I)}}return new Jn(f,h)}(t._query,t.firestore._databaseId,s,e,n,r)}}function rp(t,e,n){if(typeof(n=Xe(n))=="string"){if(n==="")throw new b(E.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ph(e)&&n.indexOf("/")!==-1)throw new b(E.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(de.fromString(n));if(!N.isDocumentKey(r))throw new b(E.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Dr(t,new N(r))}if(n instanceof Fe)return Dr(t,n._key);throw new b(E.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Nc(n)}.`)}function sp(t,e){if(!Array.isArray(t)||t.length===0)throw new b(E.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function sE(t,e){if(e.isInequality()){const r=Tc(t),s=e.field;if(r!==null&&!r.isEqual(s))throw new b(E.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${r.toString()}' and '${s.toString()}'`);const i=Rh(t);i!==null&&iE(t,s,i)}const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new b(E.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new b(E.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function iE(t,e,n){if(!n.isEqual(e))throw new b(E.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}function oE(t,e){if(!(e instanceof Qs||e instanceof Kr))throw new b(E.INVALID_ARGUMENT,`Function ${t}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class gd{convertValue(e,n="none"){switch(Qn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Oe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(_n(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw q()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return rr(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertGeoPoint(e){return new Oc(Oe(e.latitude),Oe(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=wc(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Xi(e));default:return null}}convertTimestamp(e){const n=Gn(e);return new Ne(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=de.fromString(e);G(Wy(r));const s=new Hn(r.get(1),r.get(3)),i=new N(r.popFirst(5));return s.isEqual(n)||Be(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qc(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class lx extends gd{constructor(e){super(),this.firestore=e}convertBytes(e){return new Xn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Fe(this.firestore,null,n)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hx(t){return new Vs("sum",io("sum",t))}function dx(t){return new Vs("avg",io("average",t))}function aE(){return new Vs("count")}function fx(t,e){var n,r;return t instanceof Vs&&e instanceof Vs&&t._aggregateType===e._aggregateType&&((n=t._internalFieldPath)===null||n===void 0?void 0:n.canonicalString())===((r=e._internalFieldPath)===null||r===void 0?void 0:r.canonicalString())}function mx(t,e){return ld(t.query,e.query)&&Li(t.data(),e.data())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Br extends oo{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Ri(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Bc("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Ri extends Br{data(e={}){return super.data(e)}}class Ur{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Fn(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ri(this._firestore,this._userDataWriter,r.key,r,new Fn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new b(E.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const c=new Ri(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Fn(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const c=new Ri(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Fn(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,l=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),l=o.indexOf(a.doc.key)),{type:px(a.type),doc:c,oldIndex:u,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function px(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return q()}}function gx(t,e){return t instanceof Br&&e instanceof Br?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Ur&&e instanceof Ur&&t._firestore===e._firestore&&ld(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _x(t){t=ue(t,Fe);const e=ue(t.firestore,Pe);return Mv($e(e),t._key).then(n=>_d(e,t,n))}class ar extends gd{constructor(e){super(),this.firestore=e}convertBytes(e){return new Xn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Fe(this.firestore,null,n)}}function yx(t){t=ue(t,Fe);const e=ue(t.firestore,Pe),n=$e(e),r=new ar(e);return TC(n,t._key).then(s=>new Br(e,r,t._key,s,new Fn(s!==null&&s.hasLocalMutations,!0),t.converter))}function vx(t){t=ue(t,Fe);const e=ue(t.firestore,Pe);return Mv($e(e),t._key,{source:"server"}).then(n=>_d(e,t,n))}function Ex(t){t=ue(t,et);const e=ue(t.firestore,Pe),n=$e(e),r=new ar(e);return nE(t._query),Fv(n,t._query).then(s=>new Ur(e,r,t,s))}function Ix(t){t=ue(t,et);const e=ue(t.firestore,Pe),n=$e(e),r=new ar(e);return AC(n,t._query).then(s=>new Ur(e,r,t,s))}function wx(t){t=ue(t,et);const e=ue(t.firestore,Pe),n=$e(e),r=new ar(e);return Fv(n,t._query,{source:"server"}).then(s=>new Ur(e,r,t,s))}function Tx(t,e,n){t=ue(t,Fe);const r=ue(t.firestore,Pe),s=qc(t.converter,e,n);return Ws(r,[Fc(jr(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,ke.none())])}function Ax(t,e,n,...r){t=ue(t,Fe);const s=ue(t.firestore,Pe),i=jr(s);let o;return o=typeof(e=Xe(e))=="string"||e instanceof ir?fd(i,"updateDoc",t._key,e,n,r):dd(i,"updateDoc",t._key,e),Ws(s,[o.toMutation(t._key,ke.exists(!0))])}function bx(t){return Ws(ue(t.firestore,Pe),[new qs(t._key,ke.none())])}function Rx(t,e){const n=ue(t.firestore,Pe),r=$v(t),s=qc(t.converter,e);return Ws(n,[Fc(jr(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,ke.exists(!1))]).then(()=>r)}function Px(t,...e){var n,r,s;t=Xe(t);let i={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||bl(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges};if(bl(e[o])){const h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(s=h.complete)===null||s===void 0?void 0:s.bind(h)}let c,u,l;if(t instanceof Fe)u=ue(t.firestore,Pe),l=Bs(t._key.path),c={next:h=>{e[o]&&e[o](_d(u,t,h))},error:e[o+1],complete:e[o+2]};else{const h=ue(t,et);u=ue(h.firestore,Pe),l=h._query;const d=new ar(u);c={next:f=>{e[o]&&e[o](new Ur(u,d,h,f))},error:e[o+1],complete:e[o+2]},nE(t._query)}return function(d,f,g,v){const I=new Vc(v),A=new Zh(f,I,g);return d.asyncQueue.enqueueAndForget(async()=>Jh(await xs(d),A)),()=>{I.Ca(),d.asyncQueue.enqueueAndForget(async()=>Yh(await xs(d),A))}}($e(u),l,a,c)}function Sx(t,e){return bC($e(t=ue(t,Pe)),bl(e)?e:{next:e})}function Ws(t,e){return function(r,s){const i=new We;return r.asyncQueue.enqueueAndForget(async()=>eC(await cd(r),s,i)),i.promise}($e(t),e)}function _d(t,e,n){const r=n.docs.get(e._key),s=new ar(t);return new Br(t,s,e._key,r,new Fn(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cx(t){return cE(t,{count:aE()})}function cE(t,e){const n=ue(t.firestore,Pe),r=$e(n),s=function(o,a){const c=[];for(const u in o)Object.prototype.hasOwnProperty.call(o,u)&&c.push(a(o[u],u,o));return c}(e,(i,o)=>new xP(o,i._aggregateType,i._internalFieldPath));return function(o,a,c){const u=new We;return o.asyncQueue.enqueueAndForget(async()=>{try{const l=await Ov(o);u.resolve(VS(l,a,c))}catch(l){u.reject(l)}}),u.promise}(r,t._query,s).then(i=>function(a,c,u){const l=new ar(a);return new Qv(c,l,u)}(n,t,i))}class xx{constructor(e){this.kind="memory",this._onlineComponentProvider=new Gs,e!=null&&e.garbageCollector?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider=new Cs}toJSON(){return{kind:this.kind}}}class Vx{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=uE(void 0),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class Dx{constructor(){this.kind="memoryEager",this._offlineComponentProvider=new Cs}toJSON(){return{kind:this.kind}}}class kx{constructor(e){this.kind="memoryLru",this._offlineComponentProvider=new gC(e)}toJSON(){return{kind:this.kind}}}function Nx(){return new Dx}function Ox(t){return new kx(t==null?void 0:t.cacheSizeBytes)}function Mx(t){return new xx(t)}function Fx(t){return new Vx(t)}class Lx{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=new Gs,this._offlineComponentProvider=new od(this._onlineComponentProvider,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}class Bx{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=new Gs,this._offlineComponentProvider=new Vv(this._onlineComponentProvider,e==null?void 0:e.cacheSizeBytes)}}function uE(t){return new Lx(t==null?void 0:t.forceOwnership)}function Ux(){return new Bx}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qx={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lE{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=jr(e)}set(e,n,r){this._verifyNotCommitted();const s=On(e,this._firestore),i=qc(s.converter,n,r),o=Fc(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,ke.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=On(e,this._firestore);let o;return o=typeof(n=Xe(n))=="string"||n instanceof ir?fd(this._dataReader,"WriteBatch.update",i._key,n,r,s):dd(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,ke.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=On(e,this._firestore);return this._mutations=this._mutations.concat(new qs(n._key,ke.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new b(E.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function On(t,e){if((t=Xe(t)).firestore!==e)throw new b(E.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hE extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=jr(n)}get(n){const r=On(n,this._firestore),s=new lx(this._firestore);return this._transaction.lookup([r._key]).then(i=>{if(!i||i.length!==1)return q();const o=i[0];if(o.isFoundDocument())return new oo(this._firestore,s,o.key,o,r.converter);if(o.isNoDocument())return new oo(this._firestore,s,r._key,null,r.converter);throw q()})}set(n,r,s){const i=On(n,this._firestore),o=qc(i.converter,r,s),a=Fc(this._dataReader,"Transaction.set",i._key,o,i.converter!==null,s);return this._transaction.set(i._key,a),this}update(n,r,s,...i){const o=On(n,this._firestore);let a;return a=typeof(r=Xe(r))=="string"||r instanceof ir?fd(this._dataReader,"Transaction.update",o._key,r,s,i):dd(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){const r=On(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=On(e,this._firestore),r=new ar(this._firestore);return super.get(e).then(s=>new Br(this._firestore,r,n._key,s._document,new Fn(!1,!1),n.converter))}}function $x(t,e,n){t=ue(t,Pe);const r=Object.assign(Object.assign({},qx),n);return function(i){if(i.maxAttempts<1)throw new b(E.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,o,a){const c=new We;return i.asyncQueue.enqueueAndForget(async()=>{const u=await Ov(i);new vC(i.asyncQueue,u,a,o,c).run()}),c.promise}($e(t),s=>e(new hE(t,s)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jx(){return new So("deleteField")}function zx(){return new hd("serverTimestamp")}function Kx(...t){return new QC("arrayUnion",t)}function Gx(...t){return new WC("arrayRemove",t)}function Hx(t){return new JC("increment",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qx(t){return $e(t=ue(t,Pe)),new lE(t,e=>Ws(t,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wx(t,e){var n;const r=$e(t=ue(t,Pe));if(!r._uninitializedComponentsProvider||((n=r._uninitializedComponentsProvider)===null||n===void 0?void 0:n._offlineKind)==="memory")return Ft("Cannot enable indexes when persistence is disabled"),Promise.resolve();const s=function(o){const a=typeof o=="string"?function(l){try{return JSON.parse(l)}catch(h){throw new b(E.INVALID_ARGUMENT,"Failed to parse JSON: "+(h==null?void 0:h.message))}}(o):o,c=[];if(Array.isArray(a.indexes))for(const u of a.indexes){const l=ip(u,"collectionGroup"),h=[];if(Array.isArray(u.fields))for(const d of u.fields){const f=Lc("setIndexConfiguration",ip(d,"fieldPath"));d.arrayConfig==="CONTAINS"?h.push(new ta(f,2)):d.order==="ASCENDING"?h.push(new ta(f,0)):d.order==="DESCENDING"&&h.push(new ta(f,1))}c.push(new Sa(Sa.UNKNOWN_ID,l,h,Ji.empty()))}return c}(e);return SC(r,s)}function ip(t,e){if(typeof t[e]!="string")throw new b(E.INVALID_ARGUMENT,"Missing string value for: "+e);return t[e]}(function(e,n=!0){(function(s){Ls=s})(ob),Ea(new Bi("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new Pe(new CR(r.getProvider("auth-internal")),new DR(r.getProvider("app-check-internal")),function(u,l){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new b(E.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Hn(u.options.projectId,l)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),cs(tm,"4.1.0",e),cs(tm,"4.1.0","esm2017")})();const Jx={apiKey:"AIzaSyCcRSq6K213Zn_64FKVfQP-GvGKqDlEykk",authDomain:"firumon-9abec.firebaseapp.com",projectId:"firumon-9abec",storageBucket:"firumon-9abec.appspot.com",messagingSenderId:"985218982992",appId:"1:985218982992:web:cb6f437c446a40f204dd55"},dE=jg(Jx),Yx=zv(dE);var Xx=Object.freeze(Object.defineProperty({__proto__:null,default:dE,firestore:Yx,AbstractUserDataWriter:gd,AggregateField:Vs,AggregateQuerySnapshot:Qv,Bytes:Xn,CACHE_SIZE_UNLIMITED:kC,CollectionReference:Kt,DocumentReference:Fe,DocumentSnapshot:Br,FieldPath:ir,FieldValue:or,Firestore:Pe,FirestoreError:b,GeoPoint:Oc,LoadBundleTask:jv,Query:et,QueryCompositeFilterConstraint:Kr,QueryConstraint:Hs,QueryDocumentSnapshot:Ri,QueryEndAtConstraint:Vo,QueryFieldFilterConstraint:Qs,QueryLimitConstraint:Co,QueryOrderByConstraint:Uc,QuerySnapshot:Ur,QueryStartAtConstraint:xo,SnapshotMetadata:Fn,Timestamp:Ne,Transaction:hE,WriteBatch:lE,_ByteString:He,_DatabaseId:Hn,_DocumentKey:N,_EmptyAppCheckTokenProvider:kR,_EmptyAuthCredentialsProvider:W_,_FieldPath:Me,_TestingHooks:Rc,_cast:ue,_debugAssert:PR,_isBase64Available:oP,_logWarn:Ft,_validateIsNotUsedTogether:Bv,addDoc:Rx,aggregateFieldEqual:fx,aggregateQuerySnapshotEqual:mx,and:nx,arrayRemove:Gx,arrayUnion:Kx,average:dx,clearIndexedDbPersistence:FC,collection:CC,collectionGroup:xC,connectFirestoreEmulator:qv,count:aE,deleteDoc:bx,deleteField:jx,disableNetwork:UC,doc:$v,documentId:zC,enableIndexedDbPersistence:OC,enableMultiTabIndexedDbPersistence:MC,enableNetwork:BC,endAt:ux,endBefore:cx,ensureFirestoreConfigured:$e,executeWrite:Ws,getAggregateFromServer:cE,getCountFromServer:Cx,getDoc:_x,getDocFromCache:yx,getDocFromServer:vx,getDocs:Ex,getDocsFromCache:Ix,getDocsFromServer:wx,getFirestore:zv,increment:Hx,initializeFirestore:NC,limit:sx,limitToLast:ix,loadBundle:$C,memoryEagerGarbageCollector:Nx,memoryLocalCache:Mx,memoryLruGarbageCollector:Ox,namedQuery:jC,onSnapshot:Px,onSnapshotsInSync:Sx,or:tx,orderBy:rx,persistentLocalCache:Fx,persistentMultipleTabManager:Ux,persistentSingleTabManager:uE,query:ZC,queryEqual:ld,refEqual:VC,runTransaction:$x,serverTimestamp:zx,setDoc:Tx,setIndexConfiguration:Wx,setLogLevel:RR,snapshotEqual:gx,startAfter:ax,startAt:ox,sum:hx,terminate:qC,updateDoc:Ax,waitForPendingWrites:LC,where:ex,writeBatch:Qx},Symbol.toStringTag,{value:"Module"}));BA("/sw.js",{ready(t){},registered(){},cached(){},updatefound(){},updated(){},offline(){},error(){}});const Zx="/";async function eV({app:t,router:e,store:n},r){let s=!1;const i=c=>{try{return e.resolve(c).href}catch{}return Object(c)===c?null:c},o=c=>{if(s=!0,typeof c=="string"&&/^https?:\/\//.test(c)){window.location.href=c;return}const u=i(c);u!==null&&(window.location.href=u,window.location.reload())},a=window.location.href.replace(window.location.origin,"");for(let c=0;s===!1&&c<r.length;c++)try{await r[c]({app:t,router:e,store:n,ssrContext:null,redirect:o,urlPath:a,publicPath:Zx})}catch(u){if(u&&u.url){o(u.url);return}console.error("[Quasar] boot error:",u);return}s!==!0&&(t.use(e),t.mount("#q-app"))}MA(Qw,FA).then(t=>{const[e,n]=Promise.allSettled!==void 0?["allSettled",r=>r.map(s=>{if(s.status==="rejected"){console.error("[Quasar] boot error:",s.reason);return}return s.value.default})]:["all",r=>r.map(s=>s.default)];return Promise[e]([wr(()=>Promise.resolve().then(function(){return Xx}),void 0),wr(()=>import("./vuefire.53464e00.js"),["assets/vuefire.53464e00.js","assets/index.552ef081.js"]),wr(()=>import("./notification.d87a19b6.js"),[]),wr(()=>import("./sw.c5864adb.js"),[])]).then(r=>{const s=n(r).filter(i=>typeof i=="function");eV(t,s)})});export{xE as $,Df as A,VV as B,Bi as C,ZA as D,Lg as E,Os as F,BV as G,MV as H,DV as I,NV as J,$A as K,Ug as L,LV as M,RV as N,xV as O,CV as P,UV as Q,EV as R,ob as S,KA as T,Ga as U,os as V,sI as W,Ue as X,mi as Y,OI as Z,Ea as _,AV as a,mp as a0,Ex as a1,Px as a2,_x as a3,Ne as a4,Oc as a5,r0 as a6,PV as a7,kt as a8,Ql as a9,jl as aA,ET as aB,ng as aC,sg as aD,yI as aE,Ct as aF,iV as aG,uw as aH,tV as aI,BI as aJ,og as aK,sV as aL,rV as aM,Yt as aN,lw as aO,mV as aP,ug as aQ,ao as aR,vV as aS,CC as aT,Yx as aU,xr as aa,zp as ab,Kp as ac,Ni as ad,ql as ae,ps as af,_V as ag,pV as ah,oT as ai,Ot as aj,lV as ak,cV as al,xI as am,Ou as an,oV as ao,dV as ap,hV as aq,of as ar,uV as as,aV as at,fV as au,nV as av,Zo as aw,gV as ax,qr as ay,Gp as az,yV as b,TV as c,Xe as d,FV as e,dE as f,IV as g,Zl as h,wV as i,YA as j,ab as k,ge as l,Fi as m,Li as n,$u as o,bV as p,OV as q,cs as r,kV as s,Fg as t,Ng as u,fp as v,mw as w,on as x,qA as y,SV as z};
