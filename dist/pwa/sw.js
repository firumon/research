(()=>{try{self["workbox:core:6.5.4"]&&_()}catch{}var fw=(n,...e)=>{let t=n;return e.length>0&&(t+=` :: ${JSON.stringify(e)}`),t};var fp=fw;var Q=class extends Error{constructor(e,t){let r=fp(e,t);super(r),this.name=e,this.details=t}};var nl=new Set;var Ut={googleAnalytics:"googleAnalytics",precache:"precache-v2",prefix:"workbox",runtime:"runtime",suffix:typeof registration!="undefined"?registration.scope:""},rl=n=>[Ut.prefix,n,Ut.suffix].filter(e=>e&&e.length>0).join("-"),pw=n=>{for(let e of Object.keys(Ut))n(e)},rt={updateDetails:n=>{pw(e=>{typeof n[e]=="string"&&(Ut[e]=n[e])})},getGoogleAnalyticsName:n=>n||rl(Ut.googleAnalytics),getPrecacheName:n=>n||rl(Ut.precache),getPrefix:()=>Ut.prefix,getRuntimeName:n=>n||rl(Ut.runtime),getSuffix:()=>Ut.suffix};function pp(n,e){let t=new URL(n);for(let r of e)t.searchParams.delete(r);return t.href}async function il(n,e,t,r){let i=pp(e.url,t);if(e.url===i)return n.match(e,r);let s=Object.assign(Object.assign({},r),{ignoreSearch:!0}),o=await n.keys(e,s);for(let a of o){let c=pp(a.url,t);if(i===c)return n.match(a,r)}}var Oi;function sl(){if(Oi===void 0){let n=new Response("");if("body"in n)try{new Response(n.body),Oi=!0}catch{Oi=!1}Oi=!1}return Oi}var Vi=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};async function ol(){for(let n of nl)await n()}var al=n=>new URL(String(n),location.href).href.replace(new RegExp(`^${location.origin}`),"");function No(n){return new Promise(e=>setTimeout(e,n))}function So(n,e){let t=e();return n.waitUntil(t),t}async function cl(n,e){let t=null;if(n.url&&(t=new URL(n.url).origin),t!==self.location.origin)throw new Q("cross-origin-copy-response",{origin:t});let r=n.clone(),i={headers:new Headers(r.headers),status:r.status,statusText:r.statusText},s=e?e(i):i,o=sl()?r.body:await r.blob();return new Response(o,s)}function ll(){self.addEventListener("activate",()=>self.clients.claim())}try{self["workbox:precaching:6.5.4"]&&_()}catch{}var gw="__WB_REVISION__";function gp(n){if(!n)throw new Q("add-to-cache-list-unexpected-type",{entry:n});if(typeof n=="string"){let s=new URL(n,location.href);return{cacheKey:s.href,url:s.href}}let{revision:e,url:t}=n;if(!t)throw new Q("add-to-cache-list-unexpected-type",{entry:n});if(!e){let s=new URL(t,location.href);return{cacheKey:s.href,url:s.href}}let r=new URL(t,location.href),i=new URL(t,location.href);return r.searchParams.set(gw,e),{cacheKey:r.href,url:i.href}}var ko=class{constructor(){this.updatedURLs=[],this.notUpdatedURLs=[],this.handlerWillStart=async({request:e,state:t})=>{t&&(t.originalRequest=e)},this.cachedResponseWillBeUsed=async({event:e,state:t,cachedResponse:r})=>{if(e.type==="install"&&t&&t.originalRequest&&t.originalRequest instanceof Request){let i=t.originalRequest.url;r?this.notUpdatedURLs.push(i):this.updatedURLs.push(i)}return r}}};var Po=class{constructor({precacheController:e}){this.cacheKeyWillBeUsed=async({request:t,params:r})=>{let i=(r==null?void 0:r.cacheKey)||this._precacheController.getCacheKeyForURL(t.url);return i?new Request(i,{headers:t.headers}):t},this._precacheController=e}};try{self["workbox:strategies:6.5.4"]&&_()}catch{}function Do(n){return typeof n=="string"?new Request(n):n}var xo=class{constructor(e,t){this._cacheKeys={},Object.assign(this,t),this.event=t.event,this._strategy=e,this._handlerDeferred=new Vi,this._extendLifetimePromises=[],this._plugins=[...e.plugins],this._pluginStateMap=new Map;for(let r of this._plugins)this._pluginStateMap.set(r,{});this.event.waitUntil(this._handlerDeferred.promise)}async fetch(e){let{event:t}=this,r=Do(e);if(r.mode==="navigate"&&t instanceof FetchEvent&&t.preloadResponse){let o=await t.preloadResponse;if(o)return o}let i=this.hasCallback("fetchDidFail")?r.clone():null;try{for(let o of this.iterateCallbacks("requestWillFetch"))r=await o({request:r.clone(),event:t})}catch(o){if(o instanceof Error)throw new Q("plugin-error-request-will-fetch",{thrownErrorMessage:o.message})}let s=r.clone();try{let o;o=await fetch(r,r.mode==="navigate"?void 0:this._strategy.fetchOptions);for(let a of this.iterateCallbacks("fetchDidSucceed"))o=await a({event:t,request:s,response:o});return o}catch(o){throw i&&await this.runCallbacks("fetchDidFail",{error:o,event:t,originalRequest:i.clone(),request:s.clone()}),o}}async fetchAndCachePut(e){let t=await this.fetch(e),r=t.clone();return this.waitUntil(this.cachePut(e,r)),t}async cacheMatch(e){let t=Do(e),r,{cacheName:i,matchOptions:s}=this._strategy,o=await this.getCacheKey(t,"read"),a=Object.assign(Object.assign({},s),{cacheName:i});r=await caches.match(o,a);for(let c of this.iterateCallbacks("cachedResponseWillBeUsed"))r=await c({cacheName:i,matchOptions:s,cachedResponse:r,request:o,event:this.event})||void 0;return r}async cachePut(e,t){let r=Do(e);await No(0);let i=await this.getCacheKey(r,"write");if(!t)throw new Q("cache-put-with-no-response",{url:al(i.url)});let s=await this._ensureResponseSafeToCache(t);if(!s)return!1;let{cacheName:o,matchOptions:a}=this._strategy,c=await self.caches.open(o),l=this.hasCallback("cacheDidUpdate"),u=l?await il(c,i.clone(),["__WB_REVISION__"],a):null;try{await c.put(i,l?s.clone():s)}catch(h){if(h instanceof Error)throw h.name==="QuotaExceededError"&&await ol(),h}for(let h of this.iterateCallbacks("cacheDidUpdate"))await h({cacheName:o,oldResponse:u,newResponse:s.clone(),request:i,event:this.event});return!0}async getCacheKey(e,t){let r=`${e.url} | ${t}`;if(!this._cacheKeys[r]){let i=e;for(let s of this.iterateCallbacks("cacheKeyWillBeUsed"))i=Do(await s({mode:t,request:i,event:this.event,params:this.params}));this._cacheKeys[r]=i}return this._cacheKeys[r]}hasCallback(e){for(let t of this._strategy.plugins)if(e in t)return!0;return!1}async runCallbacks(e,t){for(let r of this.iterateCallbacks(e))await r(t)}*iterateCallbacks(e){for(let t of this._strategy.plugins)if(typeof t[e]=="function"){let r=this._pluginStateMap.get(t);yield s=>{let o=Object.assign(Object.assign({},s),{state:r});return t[e](o)}}}waitUntil(e){return this._extendLifetimePromises.push(e),e}async doneWaiting(){let e;for(;e=this._extendLifetimePromises.shift();)await e}destroy(){this._handlerDeferred.resolve(null)}async _ensureResponseSafeToCache(e){let t=e,r=!1;for(let i of this.iterateCallbacks("cacheWillUpdate"))if(t=await i({request:this.request,response:t,event:this.event})||void 0,r=!0,!t)break;return r||t&&t.status!==200&&(t=void 0),t}};var Oo=class{constructor(e={}){this.cacheName=rt.getRuntimeName(e.cacheName),this.plugins=e.plugins||[],this.fetchOptions=e.fetchOptions,this.matchOptions=e.matchOptions}handle(e){let[t]=this.handleAll(e);return t}handleAll(e){e instanceof FetchEvent&&(e={event:e,request:e.request});let t=e.event,r=typeof e.request=="string"?new Request(e.request):e.request,i="params"in e?e.params:void 0,s=new xo(this,{event:t,request:r,params:i}),o=this._getResponse(s,r,t),a=this._awaitComplete(o,s,r,t);return[o,a]}async _getResponse(e,t,r){await e.runCallbacks("handlerWillStart",{event:r,request:t});let i;try{if(i=await this._handle(t,e),!i||i.type==="error")throw new Q("no-response",{url:t.url})}catch(s){if(s instanceof Error){for(let o of e.iterateCallbacks("handlerDidError"))if(i=await o({error:s,event:r,request:t}),i)break}if(!i)throw s}for(let s of e.iterateCallbacks("handlerWillRespond"))i=await s({event:r,request:t,response:i});return i}async _awaitComplete(e,t,r,i){let s,o;try{s=await e}catch{}try{await t.runCallbacks("handlerDidRespond",{event:i,request:r,response:s}),await t.doneWaiting()}catch(a){a instanceof Error&&(o=a)}if(await t.runCallbacks("handlerDidComplete",{event:i,request:r,response:s,error:o}),t.destroy(),o)throw o}};var Qe=class extends Oo{constructor(e={}){e.cacheName=rt.getPrecacheName(e.cacheName),super(e),this._fallbackToNetwork=e.fallbackToNetwork!==!1,this.plugins.push(Qe.copyRedirectedCacheableResponsesPlugin)}async _handle(e,t){let r=await t.cacheMatch(e);return r||(t.event&&t.event.type==="install"?await this._handleInstall(e,t):await this._handleFetch(e,t))}async _handleFetch(e,t){let r,i=t.params||{};if(this._fallbackToNetwork){let s=i.integrity,o=e.integrity,a=!o||o===s;if(r=await t.fetch(new Request(e,{integrity:e.mode!=="no-cors"?o||s:void 0})),s&&a&&e.mode!=="no-cors"){this._useDefaultCacheabilityPluginIfNeeded();let c=await t.cachePut(e,r.clone())}}else throw new Q("missing-precache-entry",{cacheName:this.cacheName,url:e.url});return r}async _handleInstall(e,t){this._useDefaultCacheabilityPluginIfNeeded();let r=await t.fetch(e);if(!await t.cachePut(e,r.clone()))throw new Q("bad-precaching-response",{url:e.url,status:r.status});return r}_useDefaultCacheabilityPluginIfNeeded(){let e=null,t=0;for(let[r,i]of this.plugins.entries())i!==Qe.copyRedirectedCacheableResponsesPlugin&&(i===Qe.defaultPrecacheCacheabilityPlugin&&(e=r),i.cacheWillUpdate&&t++);t===0?this.plugins.push(Qe.defaultPrecacheCacheabilityPlugin):t>1&&e!==null&&this.plugins.splice(e,1)}};Qe.defaultPrecacheCacheabilityPlugin={async cacheWillUpdate({response:n}){return!n||n.status>=400?null:n}};Qe.copyRedirectedCacheableResponsesPlugin={async cacheWillUpdate({response:n}){return n.redirected?await cl(n):n}};var Li=class{constructor({cacheName:e,plugins:t=[],fallbackToNetwork:r=!0}={}){this._urlsToCacheKeys=new Map,this._urlsToCacheModes=new Map,this._cacheKeysToIntegrities=new Map,this._strategy=new Qe({cacheName:rt.getPrecacheName(e),plugins:[...t,new Po({precacheController:this})],fallbackToNetwork:r}),this.install=this.install.bind(this),this.activate=this.activate.bind(this)}get strategy(){return this._strategy}precache(e){this.addToCacheList(e),this._installAndActiveListenersAdded||(self.addEventListener("install",this.install),self.addEventListener("activate",this.activate),this._installAndActiveListenersAdded=!0)}addToCacheList(e){let t=[];for(let r of e){typeof r=="string"?t.push(r):r&&r.revision===void 0&&t.push(r.url);let{cacheKey:i,url:s}=gp(r),o=typeof r!="string"&&r.revision?"reload":"default";if(this._urlsToCacheKeys.has(s)&&this._urlsToCacheKeys.get(s)!==i)throw new Q("add-to-cache-list-conflicting-entries",{firstEntry:this._urlsToCacheKeys.get(s),secondEntry:i});if(typeof r!="string"&&r.integrity){if(this._cacheKeysToIntegrities.has(i)&&this._cacheKeysToIntegrities.get(i)!==r.integrity)throw new Q("add-to-cache-list-conflicting-integrities",{url:s});this._cacheKeysToIntegrities.set(i,r.integrity)}if(this._urlsToCacheKeys.set(s,i),this._urlsToCacheModes.set(s,o),t.length>0){let a=`Workbox is precaching URLs without revision info: ${t.join(", ")}
This is generally NOT safe. Learn more at https://bit.ly/wb-precache`;console.warn(a)}}}install(e){return So(e,async()=>{let t=new ko;this.strategy.plugins.push(t);for(let[s,o]of this._urlsToCacheKeys){let a=this._cacheKeysToIntegrities.get(o),c=this._urlsToCacheModes.get(s),l=new Request(s,{integrity:a,cache:c,credentials:"same-origin"});await Promise.all(this.strategy.handleAll({params:{cacheKey:o},request:l,event:e}))}let{updatedURLs:r,notUpdatedURLs:i}=t;return{updatedURLs:r,notUpdatedURLs:i}})}activate(e){return So(e,async()=>{let t=await self.caches.open(this.strategy.cacheName),r=await t.keys(),i=new Set(this._urlsToCacheKeys.values()),s=[];for(let o of r)i.has(o.url)||(await t.delete(o),s.push(o.url));return{deletedURLs:s}})}getURLsToCacheKeys(){return this._urlsToCacheKeys}getCachedURLs(){return[...this._urlsToCacheKeys.keys()]}getCacheKeyForURL(e){let t=new URL(e,location.href);return this._urlsToCacheKeys.get(t.href)}getIntegrityForCacheKey(e){return this._cacheKeysToIntegrities.get(e)}async matchPrecache(e){let t=e instanceof Request?e.url:e,r=this.getCacheKeyForURL(t);if(r)return(await self.caches.open(this.strategy.cacheName)).match(r)}createHandlerBoundToURL(e){let t=this.getCacheKeyForURL(e);if(!t)throw new Q("non-precached-url",{url:e});return r=>(r.request=new Request(e),r.params=Object.assign({cacheKey:t},r.params),this.strategy.handle(r))}};var ul,vt=()=>(ul||(ul=new Li),ul);try{self["workbox:routing:6.5.4"]&&_()}catch{}var Vo="GET";var br=n=>n&&typeof n=="object"?n:{handle:n};var Be=class{constructor(e,t,r=Vo){this.handler=br(t),this.match=e,this.method=r}setCatchHandler(e){this.catchHandler=br(e)}};var Mi=class extends Be{constructor(e,t,r){let i=({url:s})=>{let o=e.exec(s.href);if(!!o&&!(s.origin!==location.origin&&o.index!==0))return o.slice(1)};super(i,t,r)}};var Fi=class{constructor(){this._routes=new Map,this._defaultHandlerMap=new Map}get routes(){return this._routes}addFetchListener(){self.addEventListener("fetch",e=>{let{request:t}=e,r=this.handleRequest({request:t,event:e});r&&e.respondWith(r)})}addCacheListener(){self.addEventListener("message",e=>{if(e.data&&e.data.type==="CACHE_URLS"){let{payload:t}=e.data,r=Promise.all(t.urlsToCache.map(i=>{typeof i=="string"&&(i=[i]);let s=new Request(...i);return this.handleRequest({request:s,event:e})}));e.waitUntil(r),e.ports&&e.ports[0]&&r.then(()=>e.ports[0].postMessage(!0))}})}handleRequest({request:e,event:t}){let r=new URL(e.url,location.href);if(!r.protocol.startsWith("http"))return;let i=r.origin===location.origin,{params:s,route:o}=this.findMatchingRoute({event:t,request:e,sameOrigin:i,url:r}),a=o&&o.handler,c=[],l=e.method;if(!a&&this._defaultHandlerMap.has(l)&&(a=this._defaultHandlerMap.get(l)),!a)return;let u;try{u=a.handle({url:r,request:e,event:t,params:s})}catch(d){u=Promise.reject(d)}let h=o&&o.catchHandler;return u instanceof Promise&&(this._catchHandler||h)&&(u=u.catch(async d=>{if(h)try{return await h.handle({url:r,request:e,event:t,params:s})}catch(f){f instanceof Error&&(d=f)}if(this._catchHandler)return this._catchHandler.handle({url:r,request:e,event:t});throw d})),u}findMatchingRoute({url:e,sameOrigin:t,request:r,event:i}){let s=this._routes.get(r.method)||[];for(let o of s){let a,c=o.match({url:e,sameOrigin:t,request:r,event:i});if(c)return a=c,(Array.isArray(a)&&a.length===0||c.constructor===Object&&Object.keys(c).length===0||typeof c=="boolean")&&(a=void 0),{route:o,params:a}}return{}}setDefaultHandler(e,t=Vo){this._defaultHandlerMap.set(t,br(e))}setCatchHandler(e){this._catchHandler=br(e)}registerRoute(e){this._routes.has(e.method)||this._routes.set(e.method,[]),this._routes.get(e.method).push(e)}unregisterRoute(e){if(!this._routes.has(e.method))throw new Q("unregister-route-but-not-found-with-method",{method:e.method});let t=this._routes.get(e.method).indexOf(e);if(t>-1)this._routes.get(e.method).splice(t,1);else throw new Q("unregister-route-route-not-registered")}};var Ui,Lo=()=>(Ui||(Ui=new Fi,Ui.addFetchListener(),Ui.addCacheListener()),Ui);function Bi(n,e,t){let r;if(typeof n=="string"){let s=new URL(n,location.href),o=({url:a})=>a.href===s.href;r=new Be(o,e,t)}else if(n instanceof RegExp)r=new Mi(n,e,t);else if(typeof n=="function")r=new Be(n,e,t);else if(n instanceof Be)r=n;else throw new Q("unsupported-route-type",{moduleName:"workbox-routing",funcName:"registerRoute",paramName:"capture"});return Lo().registerRoute(r),r}function _p(n,e=[]){for(let t of[...n.searchParams.keys()])e.some(r=>r.test(t))&&n.searchParams.delete(t);return n}function*yp(n,{ignoreURLParametersMatching:e=[/^utm_/,/^fbclid$/],directoryIndex:t="index.html",cleanURLs:r=!0,urlManipulation:i}={}){let s=new URL(n,location.href);s.hash="",yield s.href;let o=_p(s,e);if(yield o.href,t&&o.pathname.endsWith("/")){let a=new URL(o.href);a.pathname+=t,yield a.href}if(r){let a=new URL(o.href);a.pathname+=".html",yield a.href}if(i){let a=i({url:s});for(let c of a)yield c.href}}var qi=class extends Be{constructor(e,t){let r=({request:i})=>{let s=e.getURLsToCacheKeys();for(let o of yp(i.url,t)){let a=s.get(o);if(a){let c=e.getIntegrityForCacheKey(a);return{cacheKey:a,integrity:c}}}};super(r,e.strategy)}};function hl(n){let e=vt(),t=new qi(e,n);Bi(t)}var _w="-precache-",vp=async(n,e=_w)=>{let r=(await self.caches.keys()).filter(i=>i.includes(e)&&i.includes(self.registration.scope)&&i!==n);return await Promise.all(r.map(i=>self.caches.delete(i))),r};function dl(){self.addEventListener("activate",n=>{let e=rt.getPrecacheName();n.waitUntil(vp(e).then(t=>{}))})}function fl(n){return vt().createHandlerBoundToURL(n)}function pl(n){vt().precache(n)}function ml(n,e){pl(n),hl(e)}var $i=class extends Be{constructor(e,{allowlist:t=[/./],denylist:r=[]}={}){super(i=>this._match(i),e),this._allowlist=t,this._denylist=r}_match({url:e,request:t}){if(t&&t.mode!=="navigate")return!1;let r=e.pathname+e.search;for(let i of this._denylist)if(i.test(r))return!1;return!!this._allowlist.some(i=>i.test(r))}};var _l={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var v=function(n,e){if(!n)throw xn(e)},xn=function(n){return new Error("Firebase Database ("+_l.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};var wp=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},yw=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Rr={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,l=c?n[i+2]:0,u=s>>2,h=(s&3)<<4|a>>4,d=(a&15)<<2|l>>6,f=l&63;c||(f=64,o||(d=64)),r.push(t[u],t[h],t[d],t[f])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(wp(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):yw(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let l=i<n.length?t[n.charAt(i)]:64;++i;let h=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||l==null||h==null)throw new yl;let d=s<<2|a>>4;if(r.push(d),l!==64){let f=a<<4&240|l>>2;if(r.push(f),h!==64){let p=l<<6&192|h;r.push(p)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},yl=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},El=function(n){let e=wp(n);return Rr.encodeByteArray(e,!0)},ji=function(n){return El(n).replace(/\./g,"")},Wi=function(n){try{return Rr.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Tp(n){return Ip(void 0,n)}function Ip(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(let t in e)!e.hasOwnProperty(t)||!vw(t)||(n[t]=Ip(n[t],e[t]));return n}function vw(n){return n!=="__proto__"}function bp(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("Unable to locate global object.")}var Ew=()=>bp().__FIREBASE_DEFAULTS__,ww=()=>{if(typeof process=="undefined"||typeof process.env=="undefined")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Tw=()=>{if(typeof document=="undefined")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Wi(n[1]);return e&&JSON.parse(e)},wl=()=>{try{return Ew()||ww()||Tw()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Cp=n=>{var e,t;return(t=(e=wl())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Fo=n=>{let e=Cp(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Tl=()=>{var n;return(n=wl())===null||n===void 0?void 0:n.config},Rp=n=>{var e;return(e=wl())===null||e===void 0?void 0:e[`_${n}`]};var Et=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Uo(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n),a="";return[ji(JSON.stringify(t)),ji(JSON.stringify(o)),a].join(".")}function be(){return typeof navigator!="undefined"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Hi(){return typeof window!="undefined"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(be())}function Ap(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Bo(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Np(){let n=be();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function wt(){return _l.NODE_CLIENT===!0||_l.NODE_ADMIN===!0}function Ki(){try{return typeof indexedDB=="object"}catch{return!1}}function Sp(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var Iw="FirebaseError",we=class extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Iw,Object.setPrototypeOf(this,we.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,it.prototype.create)}},it=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?bw(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new we(i,a,r)}};function bw(n,e){return n.replace(Cw,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var Cw=/\{\$([^}]+)}/g;function Cr(n){return JSON.parse(n)}function de(n){return JSON.stringify(n)}var kp=function(n){let e={},t={},r={},i="";try{let s=n.split(".");e=Cr(Wi(s[0])||""),t=Cr(Wi(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}};var Pp=function(n){let e=kp(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},Dp=function(n){let e=kp(n).claims;return typeof e=="object"&&e.admin===!0};function Tt(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function On(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function qo(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function zi(n,e,t){let r={};for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function Ar(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(Ep(s)&&Ep(o)){if(!Ar(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function Ep(n){return n!==null&&typeof n=="object"}function Nr(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Sr(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function kr(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}var Mo=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);let r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let h=0;h<16;h++)r[h]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let h=16;h<80;h++){let d=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(d<<1|d>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],l,u;for(let h=0;h<80;h++){h<40?h<20?(l=a^s&(o^a),u=1518500249):(l=s^o^a,u=1859775393):h<60?(l=s&o|a&(s|o),u=2400959708):(l=s^o^a,u=3395469782);let d=(i<<5|i>>>27)+l+c+u+r[h]&4294967295;c=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=d}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);let r=t-this.blockSize,i=0,s=this.buf_,o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){let e=[],t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}};function xp(n,e){let t=new vl(n,e);return t.subscribe.bind(t)}var vl=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Rw(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=gl),i.error===void 0&&(i.error=gl),i.complete===void 0&&(i.complete=gl);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console!="undefined"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Rw(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function gl(){}function Op(n,e){return`${n} failed: ${e} argument `}var Vp=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){let s=i-55296;r++,v(r<n.length,"Surrogate pair missing trail surrogate.");let o=n.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Gi=function(n){let e=0;for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};var SV=4*60*60*1e3;function qe(n){return n&&n._delegate?n._delegate:n}var ae=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Vn="[DEFAULT]";var $o=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Et;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Nw(e))try{this.getOrInitializeService({instanceIdentifier:Vn})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Vn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Vn){return this.instances.has(e)}getOptions(e=Vn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(!!r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Aw(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Vn){return this.component?this.component.multipleInstances?e:Vn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Aw(n){return n===Vn?void 0:n}function Nw(n){return n.instantiationMode==="EAGER"}var Qi=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new $o(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var Sw=[],O;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(O||(O={}));var kw={debug:O.DEBUG,verbose:O.VERBOSE,info:O.INFO,warn:O.WARN,error:O.ERROR,silent:O.SILENT},Pw=O.INFO,Dw={[O.DEBUG]:"log",[O.VERBOSE]:"log",[O.INFO]:"info",[O.WARN]:"warn",[O.ERROR]:"error"},xw=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=Dw[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Ye=class{constructor(e){this.name=e,this._logLevel=Pw,this._logHandler=xw,this._userLogHandler=null,Sw.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in O))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?kw[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,O.DEBUG,...e),this._logHandler(this,O.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,O.VERBOSE,...e),this._logHandler(this,O.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,O.INFO,...e),this._logHandler(this,O.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,O.WARN,...e),this._logHandler(this,O.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,O.ERROR,...e),this._logHandler(this,O.ERROR,...e)}};var Ow=(n,e)=>e.some(t=>n instanceof t),Lp,Mp;function Vw(){return Lp||(Lp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Lw(){return Mp||(Mp=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Fp=new WeakMap,bl=new WeakMap,Up=new WeakMap,Il=new WeakMap,Rl=new WeakMap;function Mw(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(It(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Fp.set(t,n)}).catch(()=>{}),Rl.set(e,n),e}function Fw(n){if(bl.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});bl.set(n,e)}var Cl={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return bl.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Up.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return It(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Bp(n){Cl=n(Cl)}function Uw(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(jo(this),e,...t);return Up.set(r,e.sort?e.sort():[e]),It(r)}:Lw().includes(n)?function(...e){return n.apply(jo(this),e),It(Fp.get(this))}:function(...e){return It(n.apply(jo(this),e))}}function Bw(n){return typeof n=="function"?Uw(n):(n instanceof IDBTransaction&&Fw(n),Ow(n,Vw())?new Proxy(n,Cl):n)}function It(n){if(n instanceof IDBRequest)return Mw(n);if(Il.has(n))return Il.get(n);let e=Bw(n);return e!==n&&(Il.set(n,e),Rl.set(e,n)),e}var jo=n=>Rl.get(n);function $p(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),a=It(o);return r&&o.addEventListener("upgradeneeded",c=>{r(It(o.result),c.oldVersion,c.newVersion,It(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var qw=["get","getKey","getAll","getAllKeys","count"],$w=["put","add","delete","clear"],Al=new Map;function qp(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Al.get(e))return Al.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=$w.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||qw.includes(t)))return;let s=async function(o,...a){let c=this.transaction(o,i?"readwrite":"readonly"),l=c.store;return r&&(l=l.index(a.shift())),(await Promise.all([l[t](...a),i&&c.done]))[0]};return Al.set(e,s),s}Bp(n=>({...n,get:(e,t,r)=>qp(e,t)||n.get(e,t,r),has:(e,t)=>!!qp(e,t)||n.has(e,t)}));var Sl=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(jw(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function jw(n){let e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}var kl="@firebase/app",jp="0.9.15";var Ln=new Ye("@firebase/app"),Ww="@firebase/app-compat",Hw="@firebase/analytics-compat",Kw="@firebase/analytics",zw="@firebase/app-check-compat",Gw="@firebase/app-check",Qw="@firebase/auth",Yw="@firebase/auth-compat",Jw="@firebase/database",Xw="@firebase/database-compat",Zw="@firebase/functions",eT="@firebase/functions-compat",tT="@firebase/installations",nT="@firebase/installations-compat",rT="@firebase/messaging",iT="@firebase/messaging-compat",sT="@firebase/performance",oT="@firebase/performance-compat",aT="@firebase/remote-config",cT="@firebase/remote-config-compat",lT="@firebase/storage",uT="@firebase/storage-compat",hT="@firebase/firestore",dT="@firebase/firestore-compat",fT="firebase",pT="10.1.0";var Pl="[DEFAULT]",mT={[kl]:"fire-core",[Ww]:"fire-core-compat",[Kw]:"fire-analytics",[Hw]:"fire-analytics-compat",[Gw]:"fire-app-check",[zw]:"fire-app-check-compat",[Qw]:"fire-auth",[Yw]:"fire-auth-compat",[Jw]:"fire-rtdb",[Xw]:"fire-rtdb-compat",[Zw]:"fire-fn",[eT]:"fire-fn-compat",[tT]:"fire-iid",[nT]:"fire-iid-compat",[rT]:"fire-fcm",[iT]:"fire-fcm-compat",[sT]:"fire-perf",[oT]:"fire-perf-compat",[aT]:"fire-rc",[cT]:"fire-rc-compat",[lT]:"fire-gcs",[uT]:"fire-gcs-compat",[hT]:"fire-fst",[dT]:"fire-fst-compat","fire-js":"fire-js",[fT]:"fire-js-all"};var Wo=new Map,Dl=new Map;function gT(n,e){try{n.container.addComponent(e)}catch(t){Ln.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ve(n){let e=n.name;if(Dl.has(e))return Ln.debug(`There were multiple attempts to register component ${e}.`),!1;Dl.set(e,n);for(let t of Wo.values())gT(t,n);return!0}function Pr(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}var _T={["no-app"]:"No Firebase App '{$appName}' has been created - call initializeApp() first",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["no-options"]:"Need to provide options, when not being deployed to hosting via source.",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},en=new it("app","Firebase",_T);var xl=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ae("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw en.create("app-deleted",{appName:this._name})}};var bt=pT;function Ll(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:Pl,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw en.create("bad-app-name",{appName:String(i)});if(t||(t=Tl()),!t)throw en.create("no-options");let s=Wo.get(i);if(s){if(Ar(t,s.options)&&Ar(r,s.config))return s;throw en.create("duplicate-app",{appName:i})}let o=new Qi(i);for(let c of Dl.values())o.addComponent(c);let a=new xl(t,r,o);return Wo.set(i,a),a}function tn(n=Pl){let e=Wo.get(n);if(!e&&n===Pl&&Tl())return Ll();if(!e)throw en.create("no-app",{appName:n});return e}function ce(n,e,t){var r;let i=(r=mT[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ln.warn(a.join(" "));return}Ve(new ae(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var yT="firebase-heartbeat-database",vT=1,Yi="firebase-heartbeat-store",Nl=null;function zp(){return Nl||(Nl=$p(yT,vT,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Yi)}}}).catch(n=>{throw en.create("idb-open",{originalErrorMessage:n.message})})),Nl}async function ET(n){try{return await(await zp()).transaction(Yi).objectStore(Yi).get(Gp(n))}catch(e){if(e instanceof we)Ln.warn(e.message);else{let t=en.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ln.warn(t.message)}}}async function Wp(n,e){try{let r=(await zp()).transaction(Yi,"readwrite");await r.objectStore(Yi).put(e,Gp(n)),await r.done}catch(t){if(t instanceof we)Ln.warn(t.message);else{let r=en.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ln.warn(r.message)}}}function Gp(n){return`${n.name}!${n.options.appId}`}var wT=1024,TT=30*24*60*60*1e3,Ol=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Vl(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Hp();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{let s=new Date(i.date).valueOf();return Date.now()-s<=TT}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";let e=Hp(),{heartbeatsToSend:t,unsentEntries:r}=IT(this._heartbeatsCache.heartbeats),i=ji(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}};function Hp(){return new Date().toISOString().substring(0,10)}function IT(n,e=wT){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Kp(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Kp(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Vl=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Ki()?Sp().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await ET(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){let i=await this.read();return Wp(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){let i=await this.read();return Wp(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}};function Kp(n){return ji(JSON.stringify({version:2,heartbeats:n})).length}function bT(n){Ve(new ae("platform-logger",e=>new Sl(e),"PRIVATE")),Ve(new ae("heartbeat",e=>new Ol(e),"PRIVATE")),ce(kl,jp,n),ce(kl,jp,"esm2017"),ce("fire-js","")}bT("");var CT="firebase",RT="10.1.0";ce(CT,RT,"app");var AT=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},ot={},w,iu=iu||{},S=AT||self;function sa(n){var e=typeof n;return e=e!="object"?e:n?Array.isArray(n)?"array":e:"null",e=="array"||e=="object"&&typeof n.length=="number"}function us(n){var e=typeof n;return e=="object"&&n!=null||e=="function"}function NT(n){return Object.prototype.hasOwnProperty.call(n,Ml)&&n[Ml]||(n[Ml]=++ST)}var Ml="closure_uid_"+(1e9*Math.random()>>>0),ST=0;function kT(n,e,t){return n.call.apply(n.bind,arguments)}function PT(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function Ce(n,e,t){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Ce=kT:Ce=PT,Ce.apply(null,arguments)}function Ho(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function pe(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function nn(){this.s=this.s,this.o=this.o}var DT=0;nn.prototype.s=!1;nn.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),DT!=0)&&NT(this)};nn.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var am=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if(typeof n=="string")return typeof e!="string"||e.length!=1?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function su(n){let e=n.length;if(0<e){let t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function Qp(n,e){for(let t=1;t<arguments.length;t++){let r=arguments[t];if(sa(r)){let i=n.length||0,s=r.length||0;n.length=i+s;for(let o=0;o<s;o++)n[i+o]=r[o]}else n.push(r)}}function Re(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}Re.prototype.h=function(){this.defaultPrevented=!0};var xT=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{S.addEventListener("test",()=>{},e),S.removeEventListener("test",()=>{},e)}catch{}return n}();function ns(n){return/^[\s\xa0]*$/.test(n)}function oa(){var n=S.navigator;return n&&(n=n.userAgent)?n:""}function Ct(n){return oa().indexOf(n)!=-1}function ou(n){return ou[" "](n),n}ou[" "]=function(){};function OT(n,e){var t=TI;return Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=e(n)}var VT=Ct("Opera"),Vr=Ct("Trident")||Ct("MSIE"),cm=Ct("Edge"),$l=cm||Vr,lm=Ct("Gecko")&&!(oa().toLowerCase().indexOf("webkit")!=-1&&!Ct("Edge"))&&!(Ct("Trident")||Ct("MSIE"))&&!Ct("Edge"),LT=oa().toLowerCase().indexOf("webkit")!=-1&&!Ct("Edge");function um(){var n=S.document;return n?n.documentMode:void 0}var jl;e:{if(Ko="",zo=function(){var n=oa();if(lm)return/rv:([^\);]+)(\)|;)/.exec(n);if(cm)return/Edge\/([\d\.]+)/.exec(n);if(Vr)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n);if(LT)return/WebKit\/(\S+)/.exec(n);if(VT)return/(?:Version)[ \/]?(\S+)/.exec(n)}(),zo&&(Ko=zo?zo[1]:""),Vr&&(Go=um(),Go!=null&&Go>parseFloat(Ko))){jl=String(Go);break e}jl=Ko}var Ko,zo,Go,Wl;S.document&&Vr?(Fl=um(),Wl=Fl||parseInt(jl,10)||void 0):Wl=void 0;var Fl,MT=Wl;function rs(n,e){if(Re.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(lm){e:{try{ou(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else t=="mouseover"?e=n.fromElement:t=="mouseout"&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType=typeof n.pointerType=="string"?n.pointerType:FT[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&rs.$.h.call(this)}}pe(rs,Re);var FT={2:"touch",3:"pen",4:"mouse"};rs.prototype.h=function(){rs.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var hs="closure_listenable_"+(1e6*Math.random()|0),UT=0;function BT(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.la=i,this.key=++UT,this.fa=this.ia=!1}function aa(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function au(n,e,t){for(let r in n)e.call(t,n[r],r,n)}function qT(n,e){for(let t in n)e.call(void 0,n[t],t,n)}function hm(n){let e={};for(let t in n)e[t]=n[t];return e}var Yp="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function dm(n,e){let t,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(t in r)n[t]=r[t];for(let s=0;s<Yp.length;s++)t=Yp[s],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function ca(n){this.src=n,this.g={},this.h=0}ca.prototype.add=function(n,e,t,r,i){var s=n.toString();n=this.g[s],n||(n=this.g[s]=[],this.h++);var o=Kl(n,e,r,i);return-1<o?(e=n[o],t||(e.ia=!1)):(e=new BT(e,this.src,s,!!r,i),e.ia=t,n.push(e)),e};function Hl(n,e){var t=e.type;if(t in n.g){var r=n.g[t],i=am(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(aa(e),n.g[t].length==0&&(delete n.g[t],n.h--))}}function Kl(n,e,t,r){for(var i=0;i<n.length;++i){var s=n[i];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==r)return i}return-1}var cu="closure_lm_"+(1e6*Math.random()|0),Ul={};function fm(n,e,t,r,i){if(r&&r.once)return mm(n,e,t,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)fm(n,e[s],t,r,i);return null}return t=hu(t),n&&n[hs]?n.O(e,t,us(r)?!!r.capture:!!r,i):pm(n,e,t,!1,r,i)}function pm(n,e,t,r,i,s){if(!e)throw Error("Invalid event type");var o=us(i)?!!i.capture:!!i,a=uu(n);if(a||(n[cu]=a=new ca(n)),t=a.add(e,t,r,o,s),t.proxy)return t;if(r=$T(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)xT||(i=o),i===void 0&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(_m(e.toString()),r);else if(n.addListener&&n.removeListener)n.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return t}function $T(){function n(t){return e.call(n.src,n.listener,t)}let e=jT;return n}function mm(n,e,t,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)mm(n,e[s],t,r,i);return null}return t=hu(t),n&&n[hs]?n.P(e,t,us(r)?!!r.capture:!!r,i):pm(n,e,t,!0,r,i)}function gm(n,e,t,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)gm(n,e[s],t,r,i);else r=us(r)?!!r.capture:!!r,t=hu(t),n&&n[hs]?(n=n.i,e=String(e).toString(),e in n.g&&(s=n.g[e],t=Kl(s,t,r,i),-1<t&&(aa(s[t]),Array.prototype.splice.call(s,t,1),s.length==0&&(delete n.g[e],n.h--)))):n&&(n=uu(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Kl(e,t,r,i)),(t=-1<n?e[n]:null)&&lu(t))}function lu(n){if(typeof n!="number"&&n&&!n.fa){var e=n.src;if(e&&e[hs])Hl(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(_m(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=uu(e))?(Hl(t,n),t.h==0&&(t.src=null,e[cu]=null)):aa(n)}}}function _m(n){return n in Ul?Ul[n]:Ul[n]="on"+n}function jT(n,e){if(n.fa)n=!0;else{e=new rs(e,this);var t=n.listener,r=n.la||n.src;n.ia&&lu(n),n=t.call(r,e)}return n}function uu(n){return n=n[cu],n instanceof ca?n:null}var Bl="__closure_events_fn_"+(1e9*Math.random()>>>0);function hu(n){return typeof n=="function"?n:(n[Bl]||(n[Bl]=function(e){return n.handleEvent(e)}),n[Bl])}function fe(){nn.call(this),this.i=new ca(this),this.S=this,this.J=null}pe(fe,nn);fe.prototype[hs]=!0;fe.prototype.removeEventListener=function(n,e,t,r){gm(this,n,e,t,r)};function Ie(n,e){var t,r=n.J;if(r)for(t=[];r;r=r.J)t.push(r);if(n=n.S,r=e.type||e,typeof e=="string")e=new Re(e,n);else if(e instanceof Re)e.target=e.target||n;else{var i=e;e=new Re(r,n),dm(e,i)}if(i=!0,t)for(var s=t.length-1;0<=s;s--){var o=e.g=t[s];i=Qo(o,r,!0,e)&&i}if(o=e.g=n,i=Qo(o,r,!0,e)&&i,i=Qo(o,r,!1,e)&&i,t)for(s=0;s<t.length;s++)o=e.g=t[s],i=Qo(o,r,!1,e)&&i}fe.prototype.N=function(){if(fe.$.N.call(this),this.i){var n=this.i,e;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)aa(t[r]);delete n.g[e],n.h--}}this.J=null};fe.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)};fe.prototype.P=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};function Qo(n,e,t,r){if(e=n.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==t){var a=o.listener,c=o.la||o.src;o.ia&&Hl(n.i,o),i=a.call(c,r)!==!1&&i}}return i&&!r.defaultPrevented}var du=S.JSON.stringify,zl=class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function WT(){var n=fu;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var Gl=class{constructor(){this.h=this.g=null}add(e,t){let r=ym.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}},ym=new zl(()=>new Ql,n=>n.reset()),Ql=class{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}};function HT(n){var e=1;n=n.split(":");let t=[];for(;0<e&&n.length;)t.push(n.shift()),e--;return n.length&&t.push(n.join(":")),t}function KT(n){S.setTimeout(()=>{throw n},0)}var is,ss=!1,fu=new Gl,vm=()=>{let n=S.Promise.resolve(void 0);is=()=>{n.then(zT)}},zT=()=>{for(var n;n=WT();){try{n.h.call(n.g)}catch(t){KT(t)}var e=ym;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}ss=!1};function la(n,e){fe.call(this),this.h=n||1,this.g=e||S,this.j=Ce(this.qb,this),this.l=Date.now()}pe(la,fe);w=la.prototype;w.ga=!1;w.T=null;w.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Ie(this,"tick"),this.ga&&(pu(this),this.start()))}};w.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function pu(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}w.N=function(){la.$.N.call(this),pu(this),delete this.g};function mu(n,e,t){if(typeof n=="function")t&&(n=Ce(n,t));else if(n&&typeof n.handleEvent=="function")n=Ce(n.handleEvent,n);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:S.setTimeout(n,e||0)}function Em(n){n.g=mu(()=>{n.g=null,n.i&&(n.i=!1,Em(n))},n.j);let e=n.h;n.h=null,n.m.apply(null,e)}var Yl=class extends nn{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Em(this)}N(){super.N(),this.g&&(S.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function os(n){nn.call(this),this.h=n,this.g={}}pe(os,nn);var Jp=[];function wm(n,e,t,r){Array.isArray(t)||(t&&(Jp[0]=t.toString()),t=Jp);for(var i=0;i<t.length;i++){var s=fm(e,t[i],r||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function Tm(n){au(n.g,function(e,t){this.g.hasOwnProperty(t)&&lu(e)},n),n.g={}}os.prototype.N=function(){os.$.N.call(this),Tm(this)};os.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function ua(){this.g=!0}ua.prototype.Ea=function(){this.g=!1};function GT(n,e,t,r,i,s){n.info(function(){if(n.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&h[1]=="type"?o+(u+"="+l+"&"):o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+t+`
`+o})}function QT(n,e,t,r,i,s,o){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+t+`
`+s+" "+o})}function xr(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+JT(n,t)+(r?" "+r:"")})}function YT(n,e){n.info(function(){return"TIMEOUT: "+e})}ua.prototype.info=function(){};function JT(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t){for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return du(t)}catch{return e}}var Bn={},Xp=null;function ha(){return Xp=Xp||new fe}Bn.Ta="serverreachability";function Im(n){Re.call(this,Bn.Ta,n)}pe(Im,Re);function as(n){let e=ha();Ie(e,new Im(e))}Bn.STAT_EVENT="statevent";function bm(n,e){Re.call(this,Bn.STAT_EVENT,n),this.stat=e}pe(bm,Re);function Le(n){let e=ha();Ie(e,new bm(e,n))}Bn.Ua="timingevent";function Cm(n,e){Re.call(this,Bn.Ua,n),this.size=e}pe(Cm,Re);function ds(n,e){if(typeof n!="function")throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){n()},e)}var da={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Rm={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function gu(){}gu.prototype.h=null;function Zp(n){return n.h||(n.h=n.i())}function Am(){}var fs={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function _u(){Re.call(this,"d")}pe(_u,Re);function yu(){Re.call(this,"c")}pe(yu,Re);var Jl;function fa(){}pe(fa,gu);fa.prototype.g=function(){return new XMLHttpRequest};fa.prototype.i=function(){return{}};Jl=new fa;function ps(n,e,t,r){this.l=n,this.j=e,this.m=t,this.W=r||1,this.U=new os(this),this.P=XT,n=$l?125:void 0,this.V=new la(n),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Nm}function Nm(){this.i=null,this.g="",this.h=!1}var XT=45e3,Xl={},Xo={};w=ps.prototype;w.setTimeout=function(n){this.P=n};function Zl(n,e,t){n.L=1,n.v=ma(qt(e)),n.s=t,n.S=!0,Sm(n,null)}function Sm(n,e){n.G=Date.now(),ms(n),n.A=qt(n.v);var t=n.A,r=n.W;Array.isArray(r)||(r=[String(r)]),Mm(t.i,"t",r),n.C=0,t=n.l.J,n.h=new Nm,n.g=ig(n.l,t?e:null,!n.s),0<n.O&&(n.M=new Yl(Ce(n.Pa,n,n.g),n.O)),wm(n.U,n.g,"readystatechange",n.nb),e=n.I?hm(n.I):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.A,n.u,n.s,e)):(n.u="GET",n.g.ha(n.A,n.u,null,e)),as(),GT(n.j,n.u,n.A,n.m,n.W,n.s)}w.nb=function(n){n=n.target;let e=this.M;e&&Rt(n)==3?e.l():this.Pa(n)};w.Pa=function(n){try{if(n==this.g)e:{let u=Rt(this.g);var e=this.g.Ia();let h=this.g.da();if(!(3>u)&&(u!=3||$l||this.g&&(this.h.h||this.g.ja()||rm(this.g)))){this.J||u!=4||e==7||(e==8||0>=h?as(3):as(2)),pa(this);var t=this.g.da();this.ca=t;t:if(km(this)){var r=rm(this.g);n="";var i=r.length,s=Rt(this.g)==4;if(!this.h.i){if(typeof TextDecoder=="undefined"){Mn(this),ts(this);var o="";break t}this.h.i=new S.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.splice(0,i),this.h.g+=n,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=t==200,QT(this.j,this.u,this.A,this.m,this.W,u,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ns(a)){var l=a;break t}}l=null}if(t=l)xr(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,eu(this,t);else{this.i=!1,this.o=3,Le(12),Mn(this),ts(this);break e}}this.S?(Pm(this,u,o),$l&&this.i&&u==3&&(wm(this.U,this.V,"tick",this.mb),this.V.start())):(xr(this.j,this.m,o,null),eu(this,o)),u==4&&Mn(this),this.i&&!this.J&&(u==4?eg(this.l,this):(this.i=!1,ms(this)))}else vI(this.g),t==400&&0<o.indexOf("Unknown SID")?(this.o=3,Le(12)):(this.o=0,Le(13)),Mn(this),ts(this)}}}catch{}finally{}};function km(n){return n.g?n.u=="GET"&&n.L!=2&&n.l.Ha:!1}function Pm(n,e,t){let r=!0,i;for(;!n.J&&n.C<t.length;)if(i=ZT(n,t),i==Xo){e==4&&(n.o=4,Le(14),r=!1),xr(n.j,n.m,null,"[Incomplete Response]");break}else if(i==Xl){n.o=4,Le(15),xr(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}else xr(n.j,n.m,i,null),eu(n,i);km(n)&&i!=Xo&&i!=Xl&&(n.h.g="",n.C=0),e!=4||t.length!=0||n.h.h||(n.o=1,Le(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.ba&&(n.ba=!0,e=n.l,e.g==n&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),bu(e),e.M=!0,Le(11))):(xr(n.j,n.m,t,"[Invalid Chunked Response]"),Mn(n),ts(n))}w.mb=function(){if(this.g){var n=Rt(this.g),e=this.g.ja();this.C<e.length&&(pa(this),Pm(this,n,e),this.i&&n!=4&&ms(this))}};function ZT(n,e){var t=n.C,r=e.indexOf(`
`,t);return r==-1?Xo:(t=Number(e.substring(t,r)),isNaN(t)?Xl:(r+=1,r+t>e.length?Xo:(e=e.slice(r,r+t),n.C=r+t,e)))}w.cancel=function(){this.J=!0,Mn(this)};function ms(n){n.Y=Date.now()+n.P,Dm(n,n.P)}function Dm(n,e){if(n.B!=null)throw Error("WatchDog timer not null");n.B=ds(Ce(n.lb,n),e)}function pa(n){n.B&&(S.clearTimeout(n.B),n.B=null)}w.lb=function(){this.B=null;let n=Date.now();0<=n-this.Y?(YT(this.j,this.A),this.L!=2&&(as(),Le(17)),Mn(this),this.o=2,ts(this)):Dm(this,this.Y-n)};function ts(n){n.l.H==0||n.J||eg(n.l,n)}function Mn(n){pa(n);var e=n.M;e&&typeof e.sa=="function"&&e.sa(),n.M=null,pu(n.V),Tm(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.sa())}function eu(n,e){try{var t=n.l;if(t.H!=0&&(t.g==n||tu(t.i,n))){if(!n.K&&tu(t.i,n)&&t.H==3){try{var r=t.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!t.u){if(t.g)if(t.g.G+3e3<n.G)ta(t),ya(t);else break e;Iu(t),Le(18)}}else t.Fa=i[1],0<t.Fa-t.V&&37500>i[2]&&t.G&&t.A==0&&!t.v&&(t.v=ds(Ce(t.ib,t),6e3));if(1>=Bm(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else Fn(t,11)}else if((n.K||t.g==n)&&ta(t),!ns(e))for(i=t.Ja.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(t.V=l[0],l=l[1],t.H==2)if(l[0]=="c"){t.K=l[1],t.pa=l[2];let u=l[3];u!=null&&(t.ra=u,t.l.info("VER="+t.ra));let h=l[4];h!=null&&(t.Ga=h,t.l.info("SVER="+t.Ga));let d=l[5];d!=null&&typeof d=="number"&&0<d&&(r=1.5*d,t.L=r,t.l.info("backChannelRequestTimeoutMs_="+r)),r=t;let f=n.g;if(f){let p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=r.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(vu(s,s.h),s.h=null))}if(r.F){let y=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;y&&(r.Da=y,Y(r.I,r.F,y))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-n.G,t.l.info("Handshake RTT: "+t.S+"ms")),r=t;var o=n;if(r.wa=rg(r,r.J?r.pa:null,r.Y),o.K){qm(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.B&&(pa(a),ms(a)),r.g=o}else Xm(r);0<t.j.length&&va(t)}else l[0]!="stop"&&l[0]!="close"||Fn(t,7);else t.H==3&&(l[0]=="stop"||l[0]=="close"?l[0]=="stop"?Fn(t,7):Tu(t):l[0]!="noop"&&t.h&&t.h.Aa(l),t.A=0)}}as(4)}catch{}}function eI(n){if(n.Z&&typeof n.Z=="function")return n.Z();if(typeof Map!="undefined"&&n instanceof Map||typeof Set!="undefined"&&n instanceof Set)return Array.from(n.values());if(typeof n=="string")return n.split("");if(sa(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}e=[],t=0;for(r in n)e[t++]=n[r];return e}function tI(n){if(n.ta&&typeof n.ta=="function")return n.ta();if(!n.Z||typeof n.Z!="function"){if(typeof Map!="undefined"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set!="undefined"&&n instanceof Set)){if(sa(n)||typeof n=="string"){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(let r in n)e[t++]=r;return e}}}function xm(n,e){if(n.forEach&&typeof n.forEach=="function")n.forEach(e,void 0);else if(sa(n)||typeof n=="string")Array.prototype.forEach.call(n,e,void 0);else for(var t=tI(n),r=eI(n),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],t&&t[s],n)}var Om=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function nI(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var s=n[t].substring(0,r);i=n[t].substring(r+1)}else s=n[t];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Un(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof Un){this.h=n.h,Zo(this,n.j),this.s=n.s,this.g=n.g,ea(this,n.m),this.l=n.l;var e=n.i,t=new cs;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),em(this,t),this.o=n.o}else n&&(e=String(n).match(Om))?(this.h=!1,Zo(this,e[1]||"",!0),this.s=Zi(e[2]||""),this.g=Zi(e[3]||"",!0),ea(this,e[4]),this.l=Zi(e[5]||"",!0),em(this,e[6]||"",!0),this.o=Zi(e[7]||"")):(this.h=!1,this.i=new cs(null,this.h))}Un.prototype.toString=function(){var n=[],e=this.j;e&&n.push(es(e,tm,!0),":");var t=this.g;return(t||e=="file")&&(n.push("//"),(e=this.s)&&n.push(es(e,tm,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t=this.m,t!=null&&n.push(":",String(t))),(t=this.l)&&(this.g&&t.charAt(0)!="/"&&n.push("/"),n.push(es(t,t.charAt(0)=="/"?sI:iI,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",es(t,aI)),n.join("")};function qt(n){return new Un(n)}function Zo(n,e,t){n.j=t?Zi(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function ea(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function em(n,e,t){e instanceof cs?(n.i=e,cI(n.i,n.h)):(t||(e=es(e,oI)),n.i=new cs(e,n.h))}function Y(n,e,t){n.i.set(e,t)}function ma(n){return Y(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function Zi(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function es(n,e,t){return typeof n=="string"?(n=encodeURI(n).replace(e,rI),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function rI(n){return n=n.charCodeAt(0),"%"+(n>>4&15).toString(16)+(n&15).toString(16)}var tm=/[#\/\?@]/g,iI=/[#\?:]/g,sI=/[#\?]/g,oI=/[#\?@]/g,aI=/#/g;function cs(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function rn(n){n.g||(n.g=new Map,n.h=0,n.i&&nI(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}w=cs.prototype;w.add=function(n,e){rn(this),this.i=null,n=Lr(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this};function Vm(n,e){rn(n),e=Lr(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function Lm(n,e){return rn(n),e=Lr(n,e),n.g.has(e)}w.forEach=function(n,e){rn(this),this.g.forEach(function(t,r){t.forEach(function(i){n.call(e,i,r,this)},this)},this)};w.ta=function(){rn(this);let n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){let i=n[r];for(let s=0;s<i.length;s++)t.push(e[r])}return t};w.Z=function(n){rn(this);let e=[];if(typeof n=="string")Lm(this,n)&&(e=e.concat(this.g.get(Lr(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e};w.set=function(n,e){return rn(this),this.i=null,n=Lr(this,n),Lm(this,n)&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this};w.get=function(n,e){return n?(n=this.Z(n),0<n.length?String(n[0]):e):e};function Mm(n,e,t){Vm(n,e),0<t.length&&(n.i=null,n.g.set(Lr(n,e),su(t)),n.h+=t.length)}w.toString=function(){if(this.i)return this.i;if(!this.g)return"";let n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),n.push(i)}}return this.i=n.join("&")};function Lr(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function cI(n,e){e&&!n.j&&(rn(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(Vm(this,r),Mm(this,i,t))},n)),n.j=e}var lI=class{constructor(n,e){this.g=n,this.map=e}};function Fm(n){this.l=n||uI,S.PerformanceNavigationTiming?(n=S.performance.getEntriesByType("navigation"),n=0<n.length&&(n[0].nextHopProtocol=="hq"||n[0].nextHopProtocol=="h2")):n=!!(S.g&&S.g.Ka&&S.g.Ka()&&S.g.Ka().ec),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var uI=10;function Um(n){return n.h?!0:n.g?n.g.size>=n.j:!1}function Bm(n){return n.h?1:n.g?n.g.size:0}function tu(n,e){return n.h?n.h==e:n.g?n.g.has(e):!1}function vu(n,e){n.g?n.g.add(e):n.h=e}function qm(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}Fm.prototype.cancel=function(){if(this.i=$m(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let n of this.g.values())n.cancel();this.g.clear()}};function $m(n){if(n.h!=null)return n.i.concat(n.h.F);if(n.g!=null&&n.g.size!==0){let e=n.i;for(let t of n.g.values())e=e.concat(t.F);return e}return su(n.i)}var hI=class{stringify(n){return S.JSON.stringify(n,void 0)}parse(n){return S.JSON.parse(n,void 0)}};function dI(){this.g=new hI}function fI(n,e,t){let r=t||"";try{xm(n,function(i,s){let o=i;us(i)&&(o=du(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function pI(n,e){let t=new ua;if(S.Image){let r=new Image;r.onload=Ho(Yo,t,r,"TestLoadImage: loaded",!0,e),r.onerror=Ho(Yo,t,r,"TestLoadImage: error",!1,e),r.onabort=Ho(Yo,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=Ho(Yo,t,r,"TestLoadImage: timeout",!1,e),S.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}function Yo(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function gs(n){this.l=n.fc||null,this.j=n.ob||!1}pe(gs,gu);gs.prototype.g=function(){return new ga(this.l,this.j)};gs.prototype.i=function(n){return function(){return n}}({});function ga(n,e){fe.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=Eu,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}pe(ga,fe);var Eu=0;w=ga.prototype;w.open=function(n,e){if(this.readyState!=Eu)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,ls(this)};w.send=function(n){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||S).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};w.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,_s(this)),this.readyState=Eu};w.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,ls(this)),this.g&&(this.readyState=3,ls(this),this.g)))if(this.responseType==="arraybuffer")n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof S.ReadableStream!="undefined"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;jm(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))};function jm(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}w.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?_s(this):ls(this),this.readyState==3&&jm(this)}};w.Za=function(n){this.g&&(this.response=this.responseText=n,_s(this))};w.Ya=function(n){this.g&&(this.response=n,_s(this))};w.ka=function(){this.g&&_s(this)};function _s(n){n.readyState=4,n.l=null,n.j=null,n.A=null,ls(n)}w.setRequestHeader=function(n,e){this.v.append(n,e)};w.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""};w.getAllResponseHeaders=function(){if(!this.h)return"";let n=[],e=this.h.entries();for(var t=e.next();!t.done;)t=t.value,n.push(t[0]+": "+t[1]),t=e.next();return n.join(`\r
`)};function ls(n){n.onreadystatechange&&n.onreadystatechange.call(n)}Object.defineProperty(ga.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(n){this.m=n?"include":"same-origin"}});var mI=S.JSON.parse;function ee(n){fe.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Wm,this.L=this.M=!1}pe(ee,fe);var Wm="",gI=/^https?$/i,_I=["POST","PUT"];w=ee.prototype;w.Oa=function(n){this.M=n};w.ha=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Jl.g(),this.C=this.u?Zp(this.u):Zp(Jl),this.g.onreadystatechange=Ce(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(s){nm(this,s);return}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)t.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())t.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(t.keys()).find(s=>s.toLowerCase()=="content-type"),i=S.FormData&&n instanceof S.FormData,!(0<=am(_I,e))||r||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of t)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{zm(this),0<this.B&&((this.L=yI(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ce(this.ua,this)):this.A=mu(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){nm(this,s)}};function yI(n){return Vr&&typeof n.timeout=="number"&&n.ontimeout!==void 0}w.ua=function(){typeof iu!="undefined"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ie(this,"timeout"),this.abort(8))};function nm(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,Hm(n),_a(n)}function Hm(n){n.F||(n.F=!0,Ie(n,"complete"),Ie(n,"error"))}w.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,Ie(this,"complete"),Ie(this,"abort"),_a(this))};w.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),_a(this,!0)),ee.$.N.call(this)};w.La=function(){this.s||(this.G||this.v||this.l?Km(this):this.kb())};w.kb=function(){Km(this)};function Km(n){if(n.h&&typeof iu!="undefined"&&(!n.C[1]||Rt(n)!=4||n.da()!=2)){if(n.v&&Rt(n)==4)mu(n.La,0,n);else if(Ie(n,"readystatechange"),Rt(n)==4){n.h=!1;try{let o=n.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=o===0){var i=String(n.I).match(Om)[1]||null;!i&&S.self&&S.self.location&&(i=S.self.location.protocol.slice(0,-1)),r=!gI.test(i?i.toLowerCase():"")}t=r}if(t)Ie(n,"complete"),Ie(n,"success");else{n.m=6;try{var s=2<Rt(n)?n.g.statusText:""}catch{s=""}n.j=s+" ["+n.da()+"]",Hm(n)}}finally{_a(n)}}}}function _a(n,e){if(n.g){zm(n);let t=n.g,r=n.C[0]?()=>{}:null;n.g=null,n.C=null,e||Ie(n,"ready");try{t.onreadystatechange=r}catch{}}}function zm(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(S.clearTimeout(n.A),n.A=null)}w.isActive=function(){return!!this.g};function Rt(n){return n.g?n.g.readyState:0}w.da=function(){try{return 2<Rt(this)?this.g.status:-1}catch{return-1}};w.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};w.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&e.indexOf(n)==0&&(e=e.substring(n.length)),mI(e)}};function rm(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case Wm:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function vI(n){let e={};n=(n.g&&2<=Rt(n)&&n.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<n.length;r++){if(ns(n[r]))continue;var t=HT(n[r]);let i=t[0];if(t=t[1],typeof t!="string")continue;t=t.trim();let s=e[i]||[];e[i]=s,s.push(t)}qT(e,function(r){return r.join(", ")})}w.Ia=function(){return this.m};w.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function Gm(n){let e="";return au(n,function(t,r){e+=r,e+=":",e+=t,e+=`\r
`}),e}function wu(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=Gm(t),typeof n=="string"?t!=null&&encodeURIComponent(String(t)):Y(n,e,t))}function Ji(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function Qm(n){this.Ga=0,this.j=[],this.l=new ua,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Ji("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Ji("baseRetryDelayMs",5e3,n),this.hb=Ji("retryDelaySeedMs",1e4,n),this.eb=Ji("forwardChannelMaxRetries",2,n),this.xa=Ji("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.dc||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new Fm(n&&n.concurrentRequestLimit),this.Ja=new dI,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}w=Qm.prototype;w.ra=8;w.H=1;function Tu(n){if(Ym(n),n.H==3){var e=n.W++,t=qt(n.I);if(Y(t,"SID",n.K),Y(t,"RID",e),Y(t,"TYPE","terminate"),ys(n,t),e=new ps(n,n.l,e),e.L=2,e.v=ma(qt(t)),t=!1,S.navigator&&S.navigator.sendBeacon)try{t=S.navigator.sendBeacon(e.v.toString(),"")}catch{}!t&&S.Image&&(new Image().src=e.v,t=!0),t||(e.g=ig(e.l,null),e.g.ha(e.v)),e.G=Date.now(),ms(e)}ng(n)}function ya(n){n.g&&(bu(n),n.g.cancel(),n.g=null)}function Ym(n){ya(n),n.u&&(S.clearTimeout(n.u),n.u=null),ta(n),n.i.cancel(),n.m&&(typeof n.m=="number"&&S.clearTimeout(n.m),n.m=null)}function va(n){if(!Um(n.i)&&!n.m){n.m=!0;var e=n.Na;is||vm(),ss||(is(),ss=!0),fu.add(e,n),n.C=0}}function EI(n,e){return Bm(n.i)>=n.i.j-(n.m?1:0)?!1:n.m?(n.j=e.F.concat(n.j),!0):n.H==1||n.H==2||n.C>=(n.cb?0:n.eb)?!1:(n.m=ds(Ce(n.Na,n,e),tg(n,n.C)),n.C++,!0)}w.Na=function(n){if(this.m)if(this.m=null,this.H==1){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;let i=new ps(this,this.l,n),s=this.s;if(this.U&&(s?(s=hm(s),dm(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){t:{var r=this.j[t];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=t;break e}if(e===4096||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=Jm(this,i,e),t=qt(this.I),Y(t,"RID",n),Y(t,"CVER",22),this.F&&Y(t,"X-HTTP-Session-Id",this.F),ys(this,t),s&&(this.O?e="headers="+encodeURIComponent(String(Gm(s)))+"&"+e:this.o&&wu(t,this.o,s)),vu(this.i,i),this.bb&&Y(t,"TYPE","init"),this.P?(Y(t,"$req",e),Y(t,"SID","null"),i.aa=!0,Zl(i,t,null)):Zl(i,t,e),this.H=2}}else this.H==3&&(n?im(this,n):this.j.length==0||Um(this.i)||im(this))};function im(n,e){var t;e?t=e.m:t=n.W++;let r=qt(n.I);Y(r,"SID",n.K),Y(r,"RID",t),Y(r,"AID",n.V),ys(n,r),n.o&&n.s&&wu(r,n.o,n.s),t=new ps(n,n.l,t,n.C+1),n.o===null&&(t.I=n.s),e&&(n.j=e.F.concat(n.j)),e=Jm(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),vu(n.i,t),Zl(t,r,e)}function ys(n,e){n.na&&au(n.na,function(t,r){Y(e,r,t)}),n.h&&xm({},function(t,r){Y(e,r,t)})}function Jm(n,e,t){t=Math.min(n.j.length,t);var r=n.h?Ce(n.h.Va,n.h,n):null;e:{var i=n.j;let s=-1;for(;;){let o=["count="+t];s==-1?0<t?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<t;c++){let l=i[c].g,u=i[c].map;if(l-=s,0>l)s=Math.max(0,i[c].g-100),a=!1;else try{fI(u,o,"req"+l+"_")}catch{r&&r(u)}}if(a){r=o.join("&");break e}}}return n=n.j.splice(0,t),e.F=n,r}function Xm(n){if(!n.g&&!n.u){n.ba=1;var e=n.Ma;is||vm(),ss||(is(),ss=!0),fu.add(e,n),n.A=0}}function Iu(n){return n.g||n.u||3<=n.A?!1:(n.ba++,n.u=ds(Ce(n.Ma,n),tg(n,n.A)),n.A++,!0)}w.Ma=function(){if(this.u=null,Zm(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=ds(Ce(this.jb,this),n)}};w.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Le(10),ya(this),Zm(this))};function bu(n){n.B!=null&&(S.clearTimeout(n.B),n.B=null)}function Zm(n){n.g=new ps(n,n.l,"rpc",n.ba),n.o===null&&(n.g.I=n.s),n.g.O=0;var e=qt(n.wa);Y(e,"RID","rpc"),Y(e,"SID",n.K),Y(e,"AID",n.V),Y(e,"CI",n.G?"0":"1"),!n.G&&n.qa&&Y(e,"TO",n.qa),Y(e,"TYPE","xmlhttp"),ys(n,e),n.o&&n.s&&wu(e,n.o,n.s),n.L&&n.g.setTimeout(n.L);var t=n.g;n=n.pa,t.L=1,t.v=ma(qt(e)),t.s=null,t.S=!0,Sm(t,n)}w.ib=function(){this.v!=null&&(this.v=null,ya(this),Iu(this),Le(19))};function ta(n){n.v!=null&&(S.clearTimeout(n.v),n.v=null)}function eg(n,e){var t=null;if(n.g==e){ta(n),bu(n),n.g=null;var r=2}else if(tu(n.i,e))t=e.F,qm(n.i,e),r=1;else return;if(n.H!=0){if(e.i)if(r==1){t=e.s?e.s.length:0,e=Date.now()-e.G;var i=n.C;r=ha(),Ie(r,new Cm(r,t)),va(n)}else Xm(n);else if(i=e.o,i==3||i==0&&0<e.ca||!(r==1&&EI(n,e)||r==2&&Iu(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),i){case 1:Fn(n,5);break;case 4:Fn(n,10);break;case 3:Fn(n,6);break;default:Fn(n,2)}}}function tg(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(t*=2),t*e}function Fn(n,e){if(n.l.info("Error code "+e),e==2){var t=null;n.h&&(t=null);var r=Ce(n.pb,n);t||(t=new Un("//www.google.com/images/cleardot.gif"),S.location&&S.location.protocol=="http"||Zo(t,"https"),ma(t)),pI(t.toString(),r)}else Le(2);n.H=0,n.h&&n.h.za(e),ng(n),Ym(n)}w.pb=function(n){n?(this.l.info("Successfully pinged google.com"),Le(2)):(this.l.info("Failed to ping google.com"),Le(1))};function ng(n){if(n.H=0,n.ma=[],n.h){let e=$m(n.i);(e.length!=0||n.j.length!=0)&&(Qp(n.ma,e),Qp(n.ma,n.j),n.i.i.length=0,su(n.j),n.j.length=0),n.h.ya()}}function rg(n,e,t){var r=t instanceof Un?qt(t):new Un(t);if(r.g!="")e&&(r.g=e+"."+r.g),ea(r,r.m);else{var i=S.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Un(null);r&&Zo(s,r),e&&(s.g=e),i&&ea(s,i),t&&(s.l=t),r=s}return t=n.F,e=n.Da,t&&e&&Y(r,t,e),Y(r,"VER",n.ra),ys(n,r),r}function ig(n,e,t){if(e&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t&&n.Ha&&!n.va?new ee(new gs({ob:!0})):new ee(n.va),e.Oa(n.J),e}w.isActive=function(){return!!this.h&&this.h.isActive(this)};function sg(){}w=sg.prototype;w.Ba=function(){};w.Aa=function(){};w.za=function(){};w.ya=function(){};w.isActive=function(){return!0};w.Va=function(){};function na(){if(Vr&&!(10<=Number(MT)))throw Error("Environmental error: no available transport.")}na.prototype.g=function(n,e){return new $e(n,e)};function $e(n,e){fe.call(this),this.g=new Qm(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!ns(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!ns(e)&&(this.g.F=e,n=this.h,n!==null&&e in n&&(n=this.h,e in n&&delete n[e])),this.j=new Mr(this)}pe($e,fe);$e.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,e=this.l,t=this.h||void 0;Le(0),n.Y=e,n.na=t||{},n.G=n.aa,n.I=rg(n,null,n.Y),va(n)};$e.prototype.close=function(){Tu(this.g)};$e.prototype.u=function(n){var e=this.g;if(typeof n=="string"){var t={};t.__data__=n,n=t}else this.v&&(t={},t.__data__=du(n),n=t);e.j.push(new lI(e.fb++,n)),e.H==3&&va(e)};$e.prototype.N=function(){this.g.h=null,delete this.j,Tu(this.g),delete this.g,$e.$.N.call(this)};function og(n){_u.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var e=n.__sm__;if(e){e:{for(let t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=e!==null&&n in e?e[n]:void 0),this.data=e}else this.data=n}pe(og,_u);function ag(){yu.call(this),this.status=1}pe(ag,yu);function Mr(n){this.g=n}pe(Mr,sg);Mr.prototype.Ba=function(){Ie(this.g,"a")};Mr.prototype.Aa=function(n){Ie(this.g,new og(n))};Mr.prototype.za=function(n){Ie(this.g,new ag)};Mr.prototype.ya=function(){Ie(this.g,"b")};function wI(){this.blockSize=-1}function st(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}pe(st,wI);st.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function ql(n,e,t){t||(t=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(i=0;16>i;++i)r[i]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;e=n.g[0],t=n.g[1],i=n.g[2];var s=n.g[3],o=e+(s^t&(i^s))+r[0]+3614090360&4294967295;e=t+(o<<7&4294967295|o>>>25),o=s+(i^e&(t^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(t^s&(e^t))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=t+(e^i&(s^e))+r[3]+3250441966&4294967295,t=i+(o<<22&4294967295|o>>>10),o=e+(s^t&(i^s))+r[4]+4118548399&4294967295,e=t+(o<<7&4294967295|o>>>25),o=s+(i^e&(t^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(t^s&(e^t))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=t+(e^i&(s^e))+r[7]+4249261313&4294967295,t=i+(o<<22&4294967295|o>>>10),o=e+(s^t&(i^s))+r[8]+1770035416&4294967295,e=t+(o<<7&4294967295|o>>>25),o=s+(i^e&(t^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(t^s&(e^t))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=t+(e^i&(s^e))+r[11]+2304563134&4294967295,t=i+(o<<22&4294967295|o>>>10),o=e+(s^t&(i^s))+r[12]+1804603682&4294967295,e=t+(o<<7&4294967295|o>>>25),o=s+(i^e&(t^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(t^s&(e^t))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=t+(e^i&(s^e))+r[15]+1236535329&4294967295,t=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(t^i))+r[1]+4129170786&4294967295,e=t+(o<<5&4294967295|o>>>27),o=s+(t^i&(e^t))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^t&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=t+(s^e&(i^s))+r[0]+3921069994&4294967295,t=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(t^i))+r[5]+3593408605&4294967295,e=t+(o<<5&4294967295|o>>>27),o=s+(t^i&(e^t))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^t&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=t+(s^e&(i^s))+r[4]+3889429448&4294967295,t=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(t^i))+r[9]+568446438&4294967295,e=t+(o<<5&4294967295|o>>>27),o=s+(t^i&(e^t))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^t&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=t+(s^e&(i^s))+r[8]+1163531501&4294967295,t=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(t^i))+r[13]+2850285829&4294967295,e=t+(o<<5&4294967295|o>>>27),o=s+(t^i&(e^t))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^t&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=t+(s^e&(i^s))+r[12]+2368359562&4294967295,t=i+(o<<20&4294967295|o>>>12),o=e+(t^i^s)+r[5]+4294588738&4294967295,e=t+(o<<4&4294967295|o>>>28),o=s+(e^t^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^t)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=t+(i^s^e)+r[14]+4259657740&4294967295,t=i+(o<<23&4294967295|o>>>9),o=e+(t^i^s)+r[1]+2763975236&4294967295,e=t+(o<<4&4294967295|o>>>28),o=s+(e^t^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^t)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=t+(i^s^e)+r[10]+3200236656&4294967295,t=i+(o<<23&4294967295|o>>>9),o=e+(t^i^s)+r[13]+681279174&4294967295,e=t+(o<<4&4294967295|o>>>28),o=s+(e^t^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^t)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=t+(i^s^e)+r[6]+76029189&4294967295,t=i+(o<<23&4294967295|o>>>9),o=e+(t^i^s)+r[9]+3654602809&4294967295,e=t+(o<<4&4294967295|o>>>28),o=s+(e^t^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^t)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=t+(i^s^e)+r[2]+3299628645&4294967295,t=i+(o<<23&4294967295|o>>>9),o=e+(i^(t|~s))+r[0]+4096336452&4294967295,e=t+(o<<6&4294967295|o>>>26),o=s+(t^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~t))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=t+(s^(i|~e))+r[5]+4237533241&4294967295,t=i+(o<<21&4294967295|o>>>11),o=e+(i^(t|~s))+r[12]+1700485571&4294967295,e=t+(o<<6&4294967295|o>>>26),o=s+(t^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~t))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=t+(s^(i|~e))+r[1]+2240044497&4294967295,t=i+(o<<21&4294967295|o>>>11),o=e+(i^(t|~s))+r[8]+1873313359&4294967295,e=t+(o<<6&4294967295|o>>>26),o=s+(t^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~t))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=t+(s^(i|~e))+r[13]+1309151649&4294967295,t=i+(o<<21&4294967295|o>>>11),o=e+(i^(t|~s))+r[4]+4149444226&4294967295,e=t+(o<<6&4294967295|o>>>26),o=s+(t^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~t))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=t+(s^(i|~e))+r[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,n.g[2]=n.g[2]+i&4294967295,n.g[3]=n.g[3]+s&4294967295}st.prototype.j=function(n,e){e===void 0&&(e=n.length);for(var t=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=t;)ql(this,n,s),s+=this.blockSize;if(typeof n=="string"){for(;s<e;)if(r[i++]=n.charCodeAt(s++),i==this.blockSize){ql(this,r),i=0;break}}else for(;s<e;)if(r[i++]=n[s++],i==this.blockSize){ql(this,r),i=0;break}}this.h=i,this.i+=e};st.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=t&255,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var r=0;32>r;r+=8)n[t++]=this.g[e]>>>r&255;return n};function H(n,e){this.h=e;for(var t=[],r=!0,i=n.length-1;0<=i;i--){var s=n[i]|0;r&&s==e||(t[i]=s,r=!1)}this.g=t}var TI={};function Cu(n){return-128<=n&&128>n?OT(n,function(e){return new H([e|0],0>e?-1:0)}):new H([n|0],0>n?-1:0)}function At(n){if(isNaN(n)||!isFinite(n))return Or;if(0>n)return Te(At(-n));for(var e=[],t=1,r=0;n>=t;r++)e[r]=n/t|0,t*=nu;return new H(e,0)}function cg(n,e){if(n.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(n.charAt(0)=="-")return Te(cg(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=At(Math.pow(e,8)),r=Or,i=0;i<n.length;i+=8){var s=Math.min(8,n.length-i),o=parseInt(n.substring(i,i+s),e);8>s?(s=At(Math.pow(e,s)),r=r.R(s).add(At(o))):(r=r.R(t),r=r.add(At(o)))}return r}var nu=4294967296,Or=Cu(0),ru=Cu(1),sm=Cu(16777216);w=H.prototype;w.ea=function(){if(Je(this))return-Te(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var r=this.D(t);n+=(0<=r?r:nu+r)*e,e*=nu}return n};w.toString=function(n){if(n=n||10,2>n||36<n)throw Error("radix out of range: "+n);if(Bt(this))return"0";if(Je(this))return"-"+Te(this).toString(n);for(var e=At(Math.pow(n,6)),t=this,r="";;){var i=ia(t,e).g;t=ra(t,i.R(e));var s=((0<t.g.length?t.g[0]:t.h)>>>0).toString(n);if(t=i,Bt(t))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};w.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h};function Bt(n){if(n.h!=0)return!1;for(var e=0;e<n.g.length;e++)if(n.g[e]!=0)return!1;return!0}function Je(n){return n.h==-1}w.X=function(n){return n=ra(this,n),Je(n)?-1:Bt(n)?0:1};function Te(n){for(var e=n.g.length,t=[],r=0;r<e;r++)t[r]=~n.g[r];return new H(t,~n.h).add(ru)}w.abs=function(){return Je(this)?Te(this):this};w.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(n.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(n.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,t[i]=o<<16|s}return new H(t,t[t.length-1]&-2147483648?-1:0)};function ra(n,e){return n.add(Te(e))}w.R=function(n){if(Bt(this)||Bt(n))return Or;if(Je(this))return Je(n)?Te(this).R(Te(n)):Te(Te(this).R(n));if(Je(n))return Te(this.R(Te(n)));if(0>this.X(sm)&&0>n.X(sm))return At(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],r=0;r<2*e;r++)t[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<n.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=n.D(i)>>>16,c=n.D(i)&65535;t[2*r+2*i]+=o*c,Jo(t,2*r+2*i),t[2*r+2*i+1]+=s*c,Jo(t,2*r+2*i+1),t[2*r+2*i+1]+=o*a,Jo(t,2*r+2*i+1),t[2*r+2*i+2]+=s*a,Jo(t,2*r+2*i+2)}for(r=0;r<e;r++)t[r]=t[2*r+1]<<16|t[2*r];for(r=e;r<2*e;r++)t[r]=0;return new H(t,0)};function Jo(n,e){for(;(n[e]&65535)!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function Xi(n,e){this.g=n,this.h=e}function ia(n,e){if(Bt(e))throw Error("division by zero");if(Bt(n))return new Xi(Or,Or);if(Je(n))return e=ia(Te(n),e),new Xi(Te(e.g),Te(e.h));if(Je(e))return e=ia(n,Te(e)),new Xi(Te(e.g),e.h);if(30<n.g.length){if(Je(n)||Je(e))throw Error("slowDivide_ only works with positive integers.");for(var t=ru,r=e;0>=r.X(n);)t=om(t),r=om(r);var i=Dr(t,1),s=Dr(r,1);for(r=Dr(r,2),t=Dr(t,2);!Bt(r);){var o=s.add(r);0>=o.X(n)&&(i=i.add(t),s=o),r=Dr(r,1),t=Dr(t,1)}return e=ra(n,i.R(e)),new Xi(i,e)}for(i=Or;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),r=Math.ceil(Math.log(t)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=At(t),o=s.R(e);Je(o)||0<o.X(n);)t-=r,s=At(t),o=s.R(e);Bt(s)&&(s=ru),i=i.add(s),n=ra(n,o)}return new Xi(i,n)}w.gb=function(n){return ia(this,n).h};w.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)&n.D(r);return new H(t,this.h&n.h)};w.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)|n.D(r);return new H(t,this.h|n.h)};w.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)^n.D(r);return new H(t,this.h^n.h)};function om(n){for(var e=n.g.length+1,t=[],r=0;r<e;r++)t[r]=n.D(r)<<1|n.D(r-1)>>>31;return new H(t,n.h)}function Dr(n,e){var t=e>>5;e%=32;for(var r=n.g.length-t,i=[],s=0;s<r;s++)i[s]=0<e?n.D(s+t)>>>e|n.D(s+t+1)<<32-e:n.D(s+t);return new H(i,n.h)}na.prototype.createWebChannel=na.prototype.g;$e.prototype.send=$e.prototype.u;$e.prototype.open=$e.prototype.m;$e.prototype.close=$e.prototype.close;da.NO_ERROR=0;da.TIMEOUT=8;da.HTTP_ERROR=6;Rm.COMPLETE="complete";Am.EventType=fs;fs.OPEN="a";fs.CLOSE="b";fs.ERROR="c";fs.MESSAGE="d";fe.prototype.listen=fe.prototype.O;ee.prototype.listenOnce=ee.prototype.P;ee.prototype.getLastError=ee.prototype.Sa;ee.prototype.getLastErrorCode=ee.prototype.Ia;ee.prototype.getStatus=ee.prototype.da;ee.prototype.getResponseJson=ee.prototype.Wa;ee.prototype.getResponseText=ee.prototype.ja;ee.prototype.send=ee.prototype.ha;ee.prototype.setWithCredentials=ee.prototype.Oa;st.prototype.digest=st.prototype.l;st.prototype.reset=st.prototype.reset;st.prototype.update=st.prototype.j;H.prototype.add=H.prototype.add;H.prototype.multiply=H.prototype.R;H.prototype.modulo=H.prototype.gb;H.prototype.compare=H.prototype.X;H.prototype.toNumber=H.prototype.ea;H.prototype.toString=H.prototype.toString;H.prototype.getBits=H.prototype.D;H.fromNumber=At;H.fromString=cg;var lg=ot.createWebChannelTransport=function(){return new na},ug=ot.getStatEventTarget=function(){return ha()},Ea=ot.ErrorCode=da,hg=ot.EventType=Rm,dg=ot.Event=Bn,Ru=ot.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},fg=ot.FetchXmlHttpFactory=gs,vs=ot.WebChannel=Am,pg=ot.XhrIo=ee,mg=ot.Md5=st,qn=ot.Integer=H;var gg="@firebase/firestore";var me=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};me.UNAUTHENTICATED=new me(null),me.GOOGLE_CREDENTIALS=new me("google-credentials-uid"),me.FIRST_PARTY=new me("first-party-uid"),me.MOCK_USER=new me("mock-user");var ri="10.1.0";var Kn=new Ye("@firebase/firestore");function _g(){return Kn.logLevel}function I(n,...e){if(Kn.logLevel<=O.DEBUG){let t=e.map(Qh);Kn.debug(`Firestore (${ri}): ${n}`,...t)}}function jt(n,...e){if(Kn.logLevel<=O.ERROR){let t=e.map(Qh);Kn.error(`Firestore (${ri}): ${n}`,...t)}}function Hr(n,...e){if(Kn.logLevel<=O.WARN){let t=e.map(Qh);Kn.warn(`Firestore (${ri}): ${n}`,...t)}}function Qh(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function D(n="Unexpected state"){let e=`FIRESTORE (${ri}) INTERNAL ASSERTION FAILED: `+n;throw jt(e),new Error(e)}function ue(n,e){n||D()}function q(n,e){return n}var E={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},C=class extends we{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var kt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Ca=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Du=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(me.UNAUTHENTICATED))}shutdown(){}},xu=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Ou=class{constructor(e){this.t=e,this.currentUser=me.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new kt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new kt,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},a=c=>{I("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(I("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new kt)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(I("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ue(typeof r.accessToken=="string"),new Ca(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return ue(e===null||typeof e=="string"),new me(e)}},Vu=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=me.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Lu=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new Vu(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(me.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Mu=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Fu=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=s=>{s.error!=null&&I("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,I("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{I("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):I("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ue(typeof t.token=="string"),this.R=t.token,new Mu(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function II(n){let e=typeof self!="undefined"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Uu=class{static V(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=II(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function W(n,e){return n<e?-1:n>e?1:0}function Kr(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var _e=class{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new C(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new C(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new C(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new C(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return _e.fromMillis(Date.now())}static fromDate(e){return _e.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new _e(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?W(this.nanoseconds,e.nanoseconds):W(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var k=class{constructor(e){this.timestamp=e}static fromTimestamp(e){return new k(e)}static min(){return new k(new _e(0,0))}static max(){return new k(new _e(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var zn=class{constructor(e,t,r){t===void 0?t=0:t>e.length&&D(),r===void 0?r=e.length-t:r>e.length-t&&D(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return zn.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof zn?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},X=class extends zn{construct(e,t,r){return new X(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new C(E.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new X(t)}static emptyPath(){return new X([])}},bI=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ne=class extends zn{construct(e,t,r){return new Ne(e,t,r)}static isValidIdentifier(e){return bI.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ne.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ne(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new C(E.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new C(E.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new C(E.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new C(E.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ne(t)}static emptyPath(){return new Ne([])}};var A=class{constructor(e){this.path=e}static fromPath(e){return new A(X.fromString(e))}static fromName(e){return new A(X.fromString(e).popFirst(5))}static empty(){return new A(X.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&X.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return X.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new A(new X(e.slice()))}};var Bu=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Bu.UNKNOWN_ID=-1;function CI(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=k.fromTimestamp(r===1e9?new _e(t+1,0):new _e(t,r));return new Pt(i,A.empty(),e)}function RI(n){return new Pt(n.readTime,n.key,-1)}var Pt=class{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Pt(k.min(),A.empty(),-1)}static max(){return new Pt(k.max(),A.empty(),-1)}};function AI(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=A.comparator(n.documentKey,e.documentKey),t!==0?t:W(n.largestBatchId,e.largestBatchId))}var NI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",qu=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function Yh(n){if(n.code!==E.FAILED_PRECONDITION||n.message!==NI)throw n;I("LocalStore","Unexpectedly lost primary lease")}var g=class{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&D(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new g((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof g?t:g.resolve(t)}catch(t){return g.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):g.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):g.reject(t)}static resolve(e){return new g((t,r)=>{t(e)})}static reject(e){return new g((t,r)=>{r(e)})}static waitFor(e){return new g((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=g.resolve(!1);for(let r of e)t=t.next(i=>i?g.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new g((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;t(e[l]).next(u=>{o[l]=u,++a,a===s&&r(o)},u=>i(u))}})}static doWhile(e,t){return new g((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function $s(n){return n.name==="IndexedDbTransactionError"}var bs=class{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.oe(r),this._e=r=>t.writeSequenceNumber(r))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this._e&&this._e(e),e}};bs.ae=-1;function za(n){return n==null}function Ra(n){return n===0&&1/n==-1/0}var SI=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],sL=[...SI,"documentOverlays"],kI=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],PI=kI,oL=[...PI,"indexConfiguration","indexState","indexEntries"];function yg(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ga(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function DI(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Z=class{constructor(e,t){this.comparator=e,this.root=t||le.EMPTY}insert(e,t){return new Z(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,le.BLACK,null,null))}remove(e){return new Z(this.comparator,this.root.remove(e,this.comparator).copy(null,null,le.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Br(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Br(this.root,e,this.comparator,!1)}getReverseIterator(){return new Br(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Br(this.root,e,this.comparator,!0)}},Br=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},le=class{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r!=null?r:le.RED,this.left=i!=null?i:le.EMPTY,this.right=s!=null?s:le.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new le(e!=null?e:this.key,t!=null?t:this.value,r!=null?r:this.color,i!=null?i:this.left,s!=null?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return le.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return le.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,le.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,le.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw D();let e=this.left.check();if(e!==this.right.check())throw D();return e+(this.isRed()?0:1)}};le.EMPTY=null,le.RED=!0,le.BLACK=!1;le.EMPTY=new class{constructor(){this.size=0}get key(){throw D()}get value(){throw D()}get color(){throw D()}get left(){throw D()}get right(){throw D()}copy(e,t,r,i,s){return this}insert(e,t,r){return new le(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var ye=class{constructor(e){this.comparator=e,this.data=new Z(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Aa(this.data.getIterator())}getIteratorFrom(e){return new Aa(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof ye)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new ye(this.comparator);return t.data=e,t}},Aa=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Nt=class{constructor(e){this.fields=e,e.sort(Ne.comparator)}static empty(){return new Nt([])}unionWith(e){let t=new ye(Ne.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new Nt(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Kr(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Na=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var ve=class{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException!="undefined"&&s instanceof DOMException?new Na("Invalid base64 string: "+s):s}}(e);return new ve(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new ve(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return W(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};ve.EMPTY_BYTE_STRING=new ve("");var xI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function cn(n){if(ue(!!n),typeof n=="string"){let e=0,t=xI.exec(n);if(ue(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:te(n.seconds),nanos:te(n.nanos)}}function te(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ln(n){return typeof n=="string"?ve.fromBase64String(n):ve.fromUint8Array(n)}function Jh(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Xh(n){let e=n.mapValue.fields.__previous_value__;return Jh(e)?Xh(e):e}function Cs(n){let e=cn(n.mapValue.fields.__local_write_time__.timestampValue);return new _e(e.seconds,e.nanos)}var $u=class{constructor(e,t,r,i,s,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},Gn=class{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Gn("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Gn&&e.projectId===this.projectId&&e.database===this.database}};var wa={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Qn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Jh(n)?4:Hg(n)?9007199254740991:10:D()}function Dt(n,e){if(n===e)return!0;let t=Qn(n);if(t!==Qn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Cs(n).isEqual(Cs(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=cn(i.timestampValue),a=cn(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return ln(i.bytesValue).isEqual(ln(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return te(i.geoPointValue.latitude)===te(s.geoPointValue.latitude)&&te(i.geoPointValue.longitude)===te(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return te(i.integerValue)===te(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=te(i.doubleValue),a=te(s.doubleValue);return o===a?Ra(o)===Ra(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Kr(n.arrayValue.values||[],e.arrayValue.values||[],Dt);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(yg(o)!==yg(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Dt(o[c],a[c])))return!1;return!0}(n,e);default:return D()}}function Rs(n,e){return(n.values||[]).find(t=>Dt(t,e))!==void 0}function zr(n,e){if(n===e)return 0;let t=Qn(n),r=Qn(e);if(t!==r)return W(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return W(n.booleanValue,e.booleanValue);case 2:return function(s,o){let a=te(s.integerValue||s.doubleValue),c=te(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return vg(n.timestampValue,e.timestampValue);case 4:return vg(Cs(n),Cs(e));case 5:return W(n.stringValue,e.stringValue);case 6:return function(s,o){let a=ln(s),c=ln(o);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){let u=W(a[l],c[l]);if(u!==0)return u}return W(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let a=W(te(s.latitude),te(o.latitude));return a!==0?a:W(te(s.longitude),te(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],c=o.values||[];for(let l=0;l<a.length&&l<c.length;++l){let u=zr(a[l],c[l]);if(u)return u}return W(a.length,c.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===wa.mapValue&&o===wa.mapValue)return 0;if(s===wa.mapValue)return 1;if(o===wa.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),l=o.fields||{},u=Object.keys(l);c.sort(),u.sort();for(let h=0;h<c.length&&h<u.length;++h){let d=W(c[h],u[h]);if(d!==0)return d;let f=zr(a[c[h]],l[u[h]]);if(f!==0)return f}return W(c.length,u.length)}(n.mapValue,e.mapValue);default:throw D()}}function vg(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return W(n,e);let t=cn(n),r=cn(e),i=W(t.seconds,r.seconds);return i!==0?i:W(t.nanos,r.nanos)}function Gr(n){return ju(n)}function ju(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=cn(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return ln(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return A.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=ju(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${ju(t.fields[o])}`;return i+"}"}(n.mapValue):D()}function Wu(n){return!!n&&"integerValue"in n}function Zh(n){return!!n&&"arrayValue"in n}function Eg(n){return!!n&&"nullValue"in n}function wg(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Au(n){return!!n&&"mapValue"in n}function ws(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Ga(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=ws(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ws(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Hg(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Xe=class{constructor(e){this.value=e}static empty(){return new Xe({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Au(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ws(t)}setAll(e){let t=Ne.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=ws(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Au(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Dt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Au(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Ga(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new Xe(ws(this.value))}};var ge=class{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new ge(e,0,k.min(),k.min(),k.min(),Xe.empty(),0)}static newFoundDocument(e,t,r,i){return new ge(e,1,t,k.min(),r,i,0)}static newNoDocument(e,t){return new ge(e,2,t,k.min(),k.min(),Xe.empty(),0)}static newUnknownDocument(e,t){return new ge(e,3,t,k.min(),k.min(),Xe.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(k.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Xe.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Xe.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=k.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ge&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ge(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Qr=class{constructor(e,t){this.position=e,this.inclusive=t}};function Tg(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=A.comparator(A.fromName(o.referenceValue),t.key):r=zr(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ig(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Dt(n.position[t],e.position[t]))return!1;return!0}var Hn=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function OI(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Sa=class{},ne=class extends Sa{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Ku(e,t,r):t==="array-contains"?new Qu(e,r):t==="in"?new Yu(e,r):t==="not-in"?new Ju(e,r):t==="array-contains-any"?new Xu(e,r):new ne(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new zu(e,r):new Gu(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(zr(t,this.value)):t!==null&&Qn(this.value)===Qn(t)&&this.matchesComparison(zr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return D()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}},Ze=class extends Sa{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new Ze(e,t)}matches(e){return Kg(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){let e=this.le(t=>t.isInequality());return e!==null?e.field:null}le(e){for(let t of this.getFlattenedFilters())if(e(t))return t;return null}};function Kg(n){return n.op==="and"}function zg(n){return VI(n)&&Kg(n)}function VI(n){for(let e of n.filters)if(e instanceof Ze)return!1;return!0}function Hu(n){if(n instanceof ne)return n.field.canonicalString()+n.op.toString()+Gr(n.value);if(zg(n))return n.filters.map(e=>Hu(e)).join(",");{let e=n.filters.map(t=>Hu(t)).join(",");return`${n.op}(${e})`}}function Gg(n,e){return n instanceof ne?function(r,i){return i instanceof ne&&r.op===i.op&&r.field.isEqual(i.field)&&Dt(r.value,i.value)}(n,e):n instanceof Ze?function(r,i){return i instanceof Ze&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&Gg(o,i.filters[a]),!0):!1}(n,e):void D()}function Qg(n){return n instanceof ne?function(t){return`${t.field.canonicalString()} ${t.op} ${Gr(t.value)}`}(n):n instanceof Ze?function(t){return t.op.toString()+" {"+t.getFilters().map(Qg).join(" ,")+"}"}(n):"Filter"}var Ku=class extends ne{constructor(e,t,r){super(e,t,r),this.key=A.fromName(r.referenceValue)}matches(e){let t=A.comparator(e.key,this.key);return this.matchesComparison(t)}},zu=class extends ne{constructor(e,t){super(e,"in",t),this.keys=Yg("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Gu=class extends ne{constructor(e,t){super(e,"not-in",t),this.keys=Yg("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Yg(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>A.fromName(r.referenceValue))}var Qu=class extends ne{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Zh(t)&&Rs(t.arrayValue,this.value)}},Yu=class extends ne{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Rs(this.value.arrayValue,t)}},Ju=class extends ne{constructor(e,t){super(e,"not-in",t)}matches(e){if(Rs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Rs(this.value.arrayValue,t)}},Xu=class extends ne{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Zh(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Rs(this.value.arrayValue,r))}};var Zu=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.he=null}};function bg(n,e=null,t=[],r=[],i=null,s=null,o=null){return new Zu(n,e,t,r,i,s,o)}function ed(n){let e=q(n);if(e.he===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Hu(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),za(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Gr(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Gr(r)).join(",")),e.he=t}return e.he}function td(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!OI(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Gg(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ig(n.startAt,e.startAt)&&Ig(n.endAt,e.endAt)}function eh(n){return A.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Yr=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.Pe=null,this.Ie=null,this.startAt,this.endAt}};function LI(n,e,t,r,i,s,o,a){return new Yr(n,e,t,r,i,s,o,a)}function Qa(n){return new Yr(n)}function Cg(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function MI(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function FI(n){for(let e of n.filters){let t=e.getFirstInequalityField();if(t!==null)return t}return null}function UI(n){return n.collectionGroup!==null}function qr(n){let e=q(n);if(e.Pe===null){e.Pe=[];let t=FI(e),r=MI(e);if(t!==null&&r===null)t.isKeyField()||e.Pe.push(new Hn(t)),e.Pe.push(new Hn(Ne.keyField(),"asc"));else{let i=!1;for(let s of e.explicitOrderBy)e.Pe.push(s),s.field.isKeyField()&&(i=!0);if(!i){let s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.Pe.push(new Hn(Ne.keyField(),s))}}}return e.Pe}function Wt(n){let e=q(n);if(!e.Ie)if(e.limitType==="F")e.Ie=bg(e.path,e.collectionGroup,qr(e),e.filters,e.limit,e.startAt,e.endAt);else{let t=[];for(let s of qr(e)){let o=s.dir==="desc"?"asc":"desc";t.push(new Hn(s.field,o))}let r=e.endAt?new Qr(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new Qr(e.startAt.position,e.startAt.inclusive):null;e.Ie=bg(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}return e.Ie}function th(n,e,t){return new Yr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Ya(n,e){return td(Wt(n),Wt(e))&&n.limitType===e.limitType}function Jg(n){return`${ed(Wt(n))}|lt:${n.limitType}`}function nh(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>Qg(i)).join(", ")}]`),za(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Gr(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Gr(i)).join(",")),`Target(${r})`}(Wt(n))}; limitType=${n.limitType})`}function Ja(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):A.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of qr(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let l=Tg(o,a,c);return o.inclusive?l<=0:l<0}(r.startAt,qr(r),i)||r.endAt&&!function(o,a,c){let l=Tg(o,a,c);return o.inclusive?l>=0:l>0}(r.endAt,qr(r),i))}(n,e)}function BI(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Xg(n){return(e,t)=>{let r=!1;for(let i of qr(n)){let s=qI(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function qI(n,e,t){let r=n.field.isKeyField()?A.comparator(e.key,t.key):function(s,o,a){let c=o.data.field(s),l=a.data.field(s);return c!==null&&l!==null?zr(c,l):D()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return D()}}var un=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ga(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return DI(this.inner)}size(){return this.innerSize}};var $I=new Z(A.comparator);function hn(){return $I}var Zg=new Z(A.comparator);function Es(...n){let e=Zg;for(let t of n)e=e.insert(t.key,t);return e}function jI(n){let e=Zg;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function $n(){return Ts()}function e_(){return Ts()}function Ts(){return new un(n=>n.toString(),(n,e)=>n.isEqual(e))}var cL=new Z(A.comparator),WI=new ye(A.comparator);function U(...n){let e=WI;for(let t of n)e=e.add(t);return e}var HI=new ye(W);function KI(){return HI}function zI(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ra(e)?"-0":e}}function GI(n){return{integerValue:""+n}}var Jr=class{constructor(){this._=void 0}};function QI(n,e,t){return n instanceof As?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Jh(s)&&(s=Xh(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Xr?t_(n,e):n instanceof Zr?n_(n,e):function(i,s){let o=JI(i,s),a=Rg(o)+Rg(i.Te);return Wu(o)&&Wu(i.Te)?GI(a):zI(i.serializer,a)}(n,e)}function YI(n,e,t){return n instanceof Xr?t_(n,e):n instanceof Zr?n_(n,e):t}function JI(n,e){return n instanceof Ns?function(r){return Wu(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var As=class extends Jr{},Xr=class extends Jr{constructor(e){super(),this.elements=e}};function t_(n,e){let t=r_(e);for(let r of n.elements)t.some(i=>Dt(i,r))||t.push(r);return{arrayValue:{values:t}}}var Zr=class extends Jr{constructor(e){super(),this.elements=e}};function n_(n,e){let t=r_(e);for(let r of n.elements)t=t.filter(i=>!Dt(i,r));return{arrayValue:{values:t}}}var Ns=class extends Jr{constructor(e,t){super(),this.serializer=e,this.Te=t}};function Rg(n){return te(n.integerValue||n.doubleValue)}function r_(n){return Zh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function XI(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Xr&&i instanceof Xr||r instanceof Zr&&i instanceof Zr?Kr(r.elements,i.elements,Dt):r instanceof Ns&&i instanceof Ns?Dt(r.Te,i.Te):r instanceof As&&i instanceof As}(n.transform,e.transform)}var $t=class{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new $t}static exists(e){return new $t(void 0,e)}static updateTime(e){return new $t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function ba(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Ss=class{};function i_(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new rh(n.key,$t.none()):new ks(n.key,n.data,$t.none());{let t=n.data,r=Xe.empty(),i=new ye(Ne.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new ei(n.key,r,new Nt(i.toArray()),$t.none())}}function ZI(n,e,t){n instanceof ks?function(i,s,o){let a=i.value.clone(),c=Ng(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof ei?function(i,s,o){if(!ba(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=Ng(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(s_(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Is(n,e,t,r){return n instanceof ks?function(s,o,a,c){if(!ba(s.precondition,o))return a;let l=s.value.clone(),u=Sg(s.fieldTransforms,c,o);return l.setAll(u),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof ei?function(s,o,a,c){if(!ba(s.precondition,o))return a;let l=Sg(s.fieldTransforms,c,o),u=o.data;return u.setAll(s_(s)),u.setAll(l),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(n,e,t,r):function(s,o,a){return ba(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function Ag(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Kr(r,i,(s,o)=>XI(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var ks=class extends Ss{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},ei=class extends Ss{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function s_(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Ng(n,e,t){let r=new Map;ue(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,YI(o,a,t[i]))}return r}function Sg(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,QI(s,o,e))}return r}var rh=class extends Ss{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}};var ih=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&ZI(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Is(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Is(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=e_();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=i_(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(k.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),U())}isEqual(e){return this.batchId===e.batchId&&Kr(this.mutations,e.mutations,(t,r)=>Ag(t,r))&&Kr(this.baseMutations,e.baseMutations,(t,r)=>Ag(t,r))}};var sh=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var oh=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var re,M;function o_(n){if(n===void 0)return jt("GRPC error has no .code"),E.UNKNOWN;switch(n){case re.OK:return E.OK;case re.CANCELLED:return E.CANCELLED;case re.UNKNOWN:return E.UNKNOWN;case re.DEADLINE_EXCEEDED:return E.DEADLINE_EXCEEDED;case re.RESOURCE_EXHAUSTED:return E.RESOURCE_EXHAUSTED;case re.INTERNAL:return E.INTERNAL;case re.UNAVAILABLE:return E.UNAVAILABLE;case re.UNAUTHENTICATED:return E.UNAUTHENTICATED;case re.INVALID_ARGUMENT:return E.INVALID_ARGUMENT;case re.NOT_FOUND:return E.NOT_FOUND;case re.ALREADY_EXISTS:return E.ALREADY_EXISTS;case re.PERMISSION_DENIED:return E.PERMISSION_DENIED;case re.FAILED_PRECONDITION:return E.FAILED_PRECONDITION;case re.ABORTED:return E.ABORTED;case re.OUT_OF_RANGE:return E.OUT_OF_RANGE;case re.UNIMPLEMENTED:return E.UNIMPLEMENTED;case re.DATA_LOSS:return E.DATA_LOSS;default:return D()}}(M=re||(re={}))[M.OK=0]="OK",M[M.CANCELLED=1]="CANCELLED",M[M.UNKNOWN=2]="UNKNOWN",M[M.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",M[M.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",M[M.NOT_FOUND=5]="NOT_FOUND",M[M.ALREADY_EXISTS=6]="ALREADY_EXISTS",M[M.PERMISSION_DENIED=7]="PERMISSION_DENIED",M[M.UNAUTHENTICATED=16]="UNAUTHENTICATED",M[M.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",M[M.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",M[M.ABORTED=10]="ABORTED",M[M.OUT_OF_RANGE=11]="OUT_OF_RANGE",M[M.UNIMPLEMENTED=12]="UNIMPLEMENTED",M[M.INTERNAL=13]="INTERNAL",M[M.UNAVAILABLE=14]="UNAVAILABLE",M[M.DATA_LOSS=15]="DATA_LOSS";var Ps=class{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return Ta}static getOrCreateInstance(){return Ta===null&&(Ta=new Ps),Ta}onExistenceFilterMismatch(e){let t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}},Ta=null;function eb(){return new TextEncoder}var tb=new qn([4294967295,4294967295],0);function kg(n){let e=eb().encode(n),t=new mg;return t.update(e),new Uint8Array(t.digest())}function Pg(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new qn([t,r],0),new qn([i,s],0)]}var Ds=class{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new jn(`Invalid padding: ${t}`);if(r<0)throw new jn(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new jn(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new jn(`Invalid padding when bitmap length is 0: ${t}`);this.de=8*e.length-t,this.Ae=qn.fromNumber(this.de)}Re(e,t,r){let i=e.add(t.multiply(qn.fromNumber(r)));return i.compare(tb)===1&&(i=new qn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ae).toNumber()}Ve(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.de===0)return!1;let t=kg(e),[r,i]=Pg(t);for(let s=0;s<this.hashCount;s++){let o=this.Re(r,i,s);if(!this.Ve(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Ds(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.de===0)return;let t=kg(e),[r,i]=Pg(t);for(let s=0;s<this.hashCount;s++){let o=this.Re(r,i,s);this.me(o)}}me(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},jn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var ti=class{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Yn.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new ti(k.min(),i,new Z(W),hn(),U())}},Yn=class{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Yn(r,t,U(),U(),U())}};var $r=class{constructor(e,t,r,i){this.fe=e,this.removedTargetIds=t,this.key=r,this.ge=i}},ka=class{constructor(e,t){this.targetId=e,this.pe=t}},Pa=class{constructor(e,t,r=ve.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Da=class{constructor(){this.ye=0,this.we=xg(),this.Se=ve.EMPTY_BYTE_STRING,this.be=!1,this.De=!0}get current(){return this.be}get resumeToken(){return this.Se}get ve(){return this.ye!==0}get Ce(){return this.De}Fe(e){e.approximateByteSize()>0&&(this.De=!0,this.Se=e)}Me(){let e=U(),t=U(),r=U();return this.we.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:D()}}),new Yn(this.Se,this.be,e,t,r)}xe(){this.De=!1,this.we=xg()}Oe(e,t){this.De=!0,this.we=this.we.insert(e,t)}Ne(e){this.De=!0,this.we=this.we.remove(e)}Be(){this.ye+=1}Le(){this.ye-=1}ke(){this.De=!0,this.be=!0}},ah=class{constructor(e){this.qe=e,this.Qe=new Map,this.Ke=hn(),this.$e=Dg(),this.Ue=new Z(W)}We(e){for(let t of e.fe)e.ge&&e.ge.isFoundDocument()?this.Ge(t,e.ge):this.ze(t,e.key,e.ge);for(let t of e.removedTargetIds)this.ze(t,e.key,e.ge)}je(e){this.forEachTarget(e,t=>{let r=this.He(t);switch(e.state){case 0:this.Je(t)&&r.Fe(e.resumeToken);break;case 1:r.Le(),r.ve||r.xe(),r.Fe(e.resumeToken);break;case 2:r.Le(),r.ve||this.removeTarget(t);break;case 3:this.Je(t)&&(r.ke(),r.Fe(e.resumeToken));break;case 4:this.Je(t)&&(this.Ye(t),r.Fe(e.resumeToken));break;default:D()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qe.forEach((r,i)=>{this.Je(i)&&t(i)})}Ze(e){var t,r;let i=e.targetId,s=e.pe.count,o=this.Xe(i);if(o){let a=o.target;if(eh(a))if(s===0){let c=new A(a.path);this.ze(i,c,ge.newNoDocument(c,k.min()))}else ue(s===1);else{let c=this.et(i);if(c!==s){let l=this.tt(e,c);if(l.status!==0){this.Ye(i);let u=l.status===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ue=this.Ue.insert(i,u)}(t=Ps.instance)===null||t===void 0||t.notifyOnExistenceFilterMismatch(function(h,d,f,p){var y,m,b,x,T,R;let N={localCacheCount:f,existenceFilterCount:p.count},B=p.unchangedNames;return B&&(N.bloomFilter={applied:h===0,hashCount:(y=B==null?void 0:B.hashCount)!==null&&y!==void 0?y:0,bitmapLength:(x=(b=(m=B==null?void 0:B.bits)===null||m===void 0?void 0:m.bitmap)===null||b===void 0?void 0:b.length)!==null&&x!==void 0?x:0,padding:(R=(T=B==null?void 0:B.bits)===null||T===void 0?void 0:T.padding)!==null&&R!==void 0?R:0},d&&(N.bloomFilter.mightContain=d)),N}(l.status,(r=l.nt)!==null&&r!==void 0?r:null,c,e.pe))}}}}tt(e,t){let{unchangedNames:r,count:i}=e.pe;if(!r||!r.bits)return{status:1};let{bits:{bitmap:s="",padding:o=0},hashCount:a=0}=r,c,l;try{c=ln(s).toUint8Array()}catch(h){if(h instanceof Na)return Hr("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),{status:1};throw h}try{l=new Ds(c,o,a)}catch(h){return Hr(h instanceof jn?"BloomFilter error: ":"Applying bloom filter failed: ",h),{status:1}}let u=h=>{let d=this.qe.rt();return l.mightContain(`projects/${d.projectId}/databases/${d.database}/documents/${h}`)};return l.de===0?{status:1}:{status:i===t-this.it(e.targetId,u)?0:2,nt:u}}it(e,t){let r=this.qe.getRemoteKeysForTarget(e),i=0;return r.forEach(s=>{t(s.path.canonicalString())||(this.ze(e,s,null),i++)}),i}st(e){let t=new Map;this.Qe.forEach((s,o)=>{let a=this.Xe(o);if(a){if(s.current&&eh(a.target)){let c=new A(a.target.path);this.Ke.get(c)!==null||this.ot(o,c)||this.ze(o,c,ge.newNoDocument(c,e))}s.Ce&&(t.set(o,s.Me()),s.xe())}});let r=U();this.$e.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.Xe(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.Ke.forEach((s,o)=>o.setReadTime(e));let i=new ti(e,t,this.Ue,this.Ke,r);return this.Ke=hn(),this.$e=Dg(),this.Ue=new Z(W),i}Ge(e,t){if(!this.Je(e))return;let r=this.ot(e,t.key)?2:0;this.He(e).Oe(t.key,r),this.Ke=this.Ke.insert(t.key,t),this.$e=this.$e.insert(t.key,this._t(t.key).add(e))}ze(e,t,r){if(!this.Je(e))return;let i=this.He(e);this.ot(e,t)?i.Oe(t,1):i.Ne(t),this.$e=this.$e.insert(t,this._t(t).delete(e)),r&&(this.Ke=this.Ke.insert(t,r))}removeTarget(e){this.Qe.delete(e)}et(e){let t=this.He(e).Me();return this.qe.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Be(e){this.He(e).Be()}He(e){let t=this.Qe.get(e);return t||(t=new Da,this.Qe.set(e,t)),t}_t(e){let t=this.$e.get(e);return t||(t=new ye(W),this.$e=this.$e.insert(e,t)),t}Je(e){let t=this.Xe(e)!==null;return t||I("WatchChangeAggregator","Detected inactive target",e),t}Xe(e){let t=this.Qe.get(e);return t&&t.ve?null:this.qe.ut(e)}Ye(e){this.Qe.set(e,new Da),this.qe.getRemoteKeysForTarget(e).forEach(t=>{this.ze(e,t,null)})}ot(e,t){return this.qe.getRemoteKeysForTarget(e).has(t)}};function Dg(){return new Z(A.comparator)}function xg(){return new Z(A.comparator)}var nb=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),rb=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),ib=(()=>({and:"AND",or:"OR"}))(),ch=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function lh(n,e){return n.useProto3Json||za(e)?e:{value:e}}function sb(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ob(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function jr(n){return ue(!!n),k.fromTimestamp(function(t){let r=cn(t);return new _e(r.seconds,r.nanos)}(n))}function ab(n,e){return function(r){return new X(["projects",r.projectId,"databases",r.database])}(n).child("documents").child(e).canonicalString()}function a_(n){let e=X.fromString(n);return ue(h_(e)),e}function Nu(n,e){let t=a_(e);if(t.get(1)!==n.databaseId.projectId)throw new C(E.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new C(E.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new A(c_(t))}function uh(n,e){return ab(n.databaseId,e)}function cb(n){let e=a_(n);return e.length===4?X.emptyPath():c_(e)}function Og(n){return new X(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function c_(n){return ue(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function lb(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:D()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,u){return l.useProto3Json?(ue(u===void 0||typeof u=="string"),ve.fromBase64String(u||"")):(ue(u===void 0||u instanceof Uint8Array),ve.fromUint8Array(u||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){let u=l.code===void 0?E.UNKNOWN:o_(l.code);return new C(u,l.message||"")}(o);t=new Pa(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Nu(n,r.document.name),s=jr(r.document.updateTime),o=r.document.createTime?jr(r.document.createTime):k.min(),a=new Xe({mapValue:{fields:r.document.fields}}),c=ge.newFoundDocument(i,s,o,a),l=r.targetIds||[],u=r.removedTargetIds||[];t=new $r(l,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Nu(n,r.document),s=r.readTime?jr(r.readTime):k.min(),o=ge.newNoDocument(i,s),a=r.removedTargetIds||[];t=new $r([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Nu(n,r.document),s=r.removedTargetIds||[];t=new $r([],s,i,null)}else{if(!("filter"in e))return D();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new oh(i,s),a=r.targetId;t=new ka(a,o)}}return t}function ub(n,e){return{documents:[uh(n,e.path)]}}function hb(n,e){let t={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(t.parent=uh(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=uh(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);let i=function(c){if(c.length!==0)return u_(Ze.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);let s=function(c){if(c.length!==0)return c.map(l=>function(h){return{field:Fr(h.field),direction:pb(h.dir)}}(l))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);let o=lh(n,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),t}function db(n){let e=cb(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){ue(r===1);let u=t.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let s=[];t.where&&(s=function(h){let d=l_(h);return d instanceof Ze&&zg(d)?d.getFilters():[d]}(t.where));let o=[];t.orderBy&&(o=function(h){return h.map(d=>function(p){return new Hn(Ur(p.field),function(m){switch(m){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(d))}(t.orderBy));let a=null;t.limit&&(a=function(h){let d;return d=typeof h=="object"?h.value:h,za(d)?null:d}(t.limit));let c=null;t.startAt&&(c=function(h){let d=!!h.before,f=h.values||[];return new Qr(f,d)}(t.startAt));let l=null;return t.endAt&&(l=function(h){let d=!h.before,f=h.values||[];return new Qr(f,d)}(t.endAt)),LI(e,i,o,s,a,"F",c,l)}function fb(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return D()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function l_(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Ur(t.unaryFilter.field);return ne.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Ur(t.unaryFilter.field);return ne.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Ur(t.unaryFilter.field);return ne.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Ur(t.unaryFilter.field);return ne.create(o,"!=",{nullValue:"NULL_VALUE"});default:return D()}}(n):n.fieldFilter!==void 0?function(t){return ne.create(Ur(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return D()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Ze.create(t.compositeFilter.filters.map(r=>l_(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return D()}}(t.compositeFilter.op))}(n):D()}function pb(n){return nb[n]}function mb(n){return rb[n]}function gb(n){return ib[n]}function Fr(n){return{fieldPath:n.canonicalString()}}function Ur(n){return Ne.fromServerFormat(n.fieldPath)}function u_(n){return n instanceof ne?function(t){if(t.op==="=="){if(wg(t.value))return{unaryFilter:{field:Fr(t.field),op:"IS_NAN"}};if(Eg(t.value))return{unaryFilter:{field:Fr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(wg(t.value))return{unaryFilter:{field:Fr(t.field),op:"IS_NOT_NAN"}};if(Eg(t.value))return{unaryFilter:{field:Fr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fr(t.field),op:mb(t.op),value:t.value}}}(n):n instanceof Ze?function(t){let r=t.getFilters().map(i=>u_(i));return r.length===1?r[0]:{compositeFilter:{op:gb(t.op),filters:r}}}(n):D()}function h_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var St=class{constructor(e,t,r,i,s=k.min(),o=k.min(),a=ve.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new St(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new St(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new St(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new St(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var hh=class{constructor(e){this.ct=e}};function _b(n){let e=db({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?th(e,e.limit,"L"):e}var xa=class{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(te(e.integerValue));else if("doubleValue"in e){let r=te(e.doubleValue);isNaN(r)?this.Et(t,13):(this.Et(t,15),Ra(r)?t.dt(0):t.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(t,20),typeof r=="string"?t.At(r):(t.At(`${r.seconds||""}`),t.dt(r.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(ln(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(t,45),t.dt(r.latitude||0),t.dt(r.longitude||0)}else"mapValue"in e?Hg(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):D()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){let r=e.fields||{};this.Et(t,55);for(let i of Object.keys(r))this.Rt(i,t),this.It(r[i],t)}wt(e,t){let r=e.values||[];this.Et(t,50);for(let i of r)this.It(i,t)}gt(e,t){this.Et(t,37),A.fromName(e).path.forEach(r=>{this.Et(t,60),this.St(r,t)})}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}};xa.bt=new xa;var dh=class{constructor(){this.sn=new fh}addToCollectionParentIndex(e,t){return this.sn.add(t),g.resolve()}getCollectionParents(e,t){return g.resolve(this.sn.getEntries(t))}addFieldIndex(e,t){return g.resolve()}deleteFieldIndex(e,t){return g.resolve()}getDocumentsMatchingTarget(e,t){return g.resolve(null)}getIndexType(e,t){return g.resolve(0)}getFieldIndexes(e,t){return g.resolve([])}getNextCollectionGroupToUpdate(e){return g.resolve(null)}getMinOffset(e,t){return g.resolve(Pt.min())}getMinOffsetFromCollectionGroup(e,t){return g.resolve(Pt.min())}updateCollectionGroup(e,t,r){return g.resolve()}updateIndexEntries(e,t){return g.resolve()}},fh=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new ye(X.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new ye(X.comparator)).toArray()}};var lL=new Uint8Array(0);var Fe=class{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Fe(e,Fe.DEFAULT_COLLECTION_PERCENTILE,Fe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};Fe.DEFAULT_COLLECTION_PERCENTILE=10,Fe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Fe.DEFAULT=new Fe(41943040,Fe.DEFAULT_COLLECTION_PERCENTILE,Fe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Fe.DISABLED=new Fe(-1,0,0);var dn=class{constructor(e){this.Mn=e}next(){return this.Mn+=2,this.Mn}static xn(){return new dn(0)}static On(){return new dn(-1)}};var ph=class{constructor(){this.changes=new un(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ge.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?g.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var mh=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var gh=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Is(r.mutation,i,Nt.empty(),_e.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,U()).next(()=>r))}getLocalViewOfDocuments(e,t,r=U()){let i=$n();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Es();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=$n();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,U()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=hn(),o=Ts(),a=function(){return Ts()}();return t.forEach((c,l)=>{let u=r.get(l.key);i.has(l.key)&&(u===void 0||u.mutation instanceof ei)?s=s.insert(l.key,l):u!==void 0?(o.set(l.key,u.mutation.getFieldMask()),Is(u.mutation,l,u.mutation.getFieldMask(),_e.now())):o.set(l.key,Nt.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,u)=>o.set(l,u)),t.forEach((l,u)=>{var h;return a.set(l,new mh(u,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){let r=Ts(),i=new Z((o,a)=>o-a),s=U();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let u=r.get(c)||Nt.empty();u=a.applyToLocalView(l,u),r.set(c,u);let h=(i.get(a.batchId)||U()).add(c);i=i.insert(a.batchId,h)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,u=c.value,h=e_();u.forEach(d=>{if(!s.has(d)){let f=i_(t.get(d),r.get(d));f!==null&&h.set(d,f),s=s.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return g.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r){return function(s){return A.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):UI(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r):this.getDocumentsMatchingCollectionQuery(e,t,r)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):g.resolve($n()),a=-1,c=s;return o.next(l=>g.forEach(l,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(u)?g.resolve():this.remoteDocumentCache.getEntry(e,u).next(d=>{c=c.insert(u,d)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,U())).next(u=>({batchId:a,changes:jI(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new A(t)).next(r=>{let i=Es();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r){let i=t.collectionGroup,s=Es();return this.indexManager.getCollectionParents(e,i).next(o=>g.forEach(o,a=>{let c=function(u,h){return new Yr(h,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt)}(t,a.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r).next(l=>{l.forEach((u,h)=>{s=s.insert(u,h)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i))).next(s=>{i.forEach((a,c)=>{let l=c.getKey();s.get(l)===null&&(s=s.insert(l,ge.newInvalidDocument(l)))});let o=Es();return s.forEach((a,c)=>{let l=i.get(a);l!==void 0&&Is(l.mutation,c,Nt.empty(),_e.now()),Ja(t,c)&&(o=o.insert(a,c))}),o})}};var _h=class{constructor(e){this.serializer=e,this.ar=new Map,this.ur=new Map}getBundleMetadata(e,t){return g.resolve(this.ar.get(t))}saveBundleMetadata(e,t){return this.ar.set(t.id,function(i){return{id:i.id,version:i.version,createTime:jr(i.createTime)}}(t)),g.resolve()}getNamedQuery(e,t){return g.resolve(this.ur.get(t))}saveNamedQuery(e,t){return this.ur.set(t.name,function(i){return{name:i.name,query:_b(i.bundledQuery),readTime:jr(i.readTime)}}(t)),g.resolve()}};var yh=class{constructor(){this.overlays=new Z(A.comparator),this.cr=new Map}getOverlay(e,t){return g.resolve(this.overlays.get(t))}getOverlays(e,t){let r=$n();return g.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),g.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.cr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.cr.delete(r)),g.resolve()}getOverlaysForCollection(e,t,r){let i=$n(),s=t.length+1,o=new A(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return g.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Z((l,u)=>l-u),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let u=s.get(l.largestBatchId);u===null&&(u=$n(),s=s.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}let a=$n(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>a.set(l,u)),!(a.size()>=i)););return g.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.cr.get(i.largestBatchId).delete(r.key);this.cr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new sh(t,r));let s=this.cr.get(t);s===void 0&&(s=U(),this.cr.set(t,s)),this.cr.set(t,s.add(r.key))}};var xs=class{constructor(){this.lr=new ye(ie.hr),this.Pr=new ye(ie.Ir)}isEmpty(){return this.lr.isEmpty()}addReference(e,t){let r=new ie(e,t);this.lr=this.lr.add(r),this.Pr=this.Pr.add(r)}Tr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Er(new ie(e,t))}dr(e,t){e.forEach(r=>this.removeReference(r,t))}Ar(e){let t=new A(new X([])),r=new ie(t,e),i=new ie(t,e+1),s=[];return this.Pr.forEachInRange([r,i],o=>{this.Er(o),s.push(o.key)}),s}Rr(){this.lr.forEach(e=>this.Er(e))}Er(e){this.lr=this.lr.delete(e),this.Pr=this.Pr.delete(e)}Vr(e){let t=new A(new X([])),r=new ie(t,e),i=new ie(t,e+1),s=U();return this.Pr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new ie(e,0),r=this.lr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},ie=class{constructor(e,t){this.key=e,this.mr=t}static hr(e,t){return A.comparator(e.key,t.key)||W(e.mr,t.mr)}static Ir(e,t){return W(e.mr,t.mr)||A.comparator(e.key,t.key)}};var vh=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.gr=1,this.pr=new ye(ie.hr)}checkEmpty(e){return g.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.gr;this.gr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new ih(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.pr=this.pr.add(new ie(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return g.resolve(o)}lookupMutationBatch(e,t){return g.resolve(this.yr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.wr(r),s=i<0?0:i;return g.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return g.resolve(this.mutationQueue.length===0?-1:this.gr-1)}getAllMutationBatches(e){return g.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new ie(t,0),i=new ie(t,Number.POSITIVE_INFINITY),s=[];return this.pr.forEachInRange([r,i],o=>{let a=this.yr(o.mr);s.push(a)}),g.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ye(W);return t.forEach(i=>{let s=new ie(i,0),o=new ie(i,Number.POSITIVE_INFINITY);this.pr.forEachInRange([s,o],a=>{r=r.add(a.mr)})}),g.resolve(this.Sr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;A.isDocumentKey(s)||(s=s.child(""));let o=new ie(new A(s),0),a=new ye(W);return this.pr.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.mr)),!0)},o),g.resolve(this.Sr(a))}Sr(e){let t=[];return e.forEach(r=>{let i=this.yr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ue(this.br(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.pr;return g.forEach(t.mutations,i=>{let s=new ie(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.pr=r})}Cn(e){}containsKey(e,t){let r=new ie(t,0),i=this.pr.firstAfterOrEqual(r);return g.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,g.resolve()}br(e,t){return this.wr(e)}wr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}yr(e){let t=this.wr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Eh=class{constructor(e){this.Dr=e,this.docs=function(){return new Z(A.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Dr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return g.resolve(r?r.document.mutableCopy():ge.newInvalidDocument(t))}getEntries(e,t){let r=hn();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ge.newInvalidDocument(i))}),g.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=hn(),o=t.path,a=new A(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:u}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||AI(RI(u),r)<=0||(i.has(u.key)||Ja(t,u))&&(s=s.insert(u.key,u.mutableCopy()))}return g.resolve(s)}getAllFromCollectionGroup(e,t,r,i){D()}vr(e,t){return g.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new wh(this)}getSize(e){return g.resolve(this.size)}},wh=class extends ph{constructor(e){super(),this.sr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.sr.addEntry(e,i)):this.sr.removeEntry(r)}),g.waitFor(t)}getFromCache(e,t){return this.sr.getEntry(e,t)}getAllFromCache(e,t){return this.sr.getEntries(e,t)}};var Th=class{constructor(e){this.persistence=e,this.Cr=new un(t=>ed(t),td),this.lastRemoteSnapshotVersion=k.min(),this.highestTargetId=0,this.Fr=0,this.Mr=new xs,this.targetCount=0,this.Or=dn.xn()}forEachTarget(e,t){return this.Cr.forEach((r,i)=>t(i)),g.resolve()}getLastRemoteSnapshotVersion(e){return g.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return g.resolve(this.Fr)}allocateTargetId(e){return this.highestTargetId=this.Or.next(),g.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Fr&&(this.Fr=t),g.resolve()}Ln(e){this.Cr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Or=new dn(t),this.highestTargetId=t),e.sequenceNumber>this.Fr&&(this.Fr=e.sequenceNumber)}addTargetData(e,t){return this.Ln(t),this.targetCount+=1,g.resolve()}updateTargetData(e,t){return this.Ln(t),g.resolve()}removeTargetData(e,t){return this.Cr.delete(t.target),this.Mr.Ar(t.targetId),this.targetCount-=1,g.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Cr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Cr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),g.waitFor(s).next(()=>i)}getTargetCount(e){return g.resolve(this.targetCount)}getTargetData(e,t){let r=this.Cr.get(t)||null;return g.resolve(r)}addMatchingKeys(e,t,r){return this.Mr.Tr(t,r),g.resolve()}removeMatchingKeys(e,t,r){this.Mr.dr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),g.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Mr.Ar(t),g.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Mr.Vr(t);return g.resolve(r)}containsKey(e,t){return g.resolve(this.Mr.containsKey(t))}};var Ih=class{constructor(e,t){this.Nr={},this.overlays={},this.Br=new bs(0),this.Lr=!1,this.Lr=!0,this.referenceDelegate=e(this),this.kr=new Th(this),this.indexManager=new dh,this.remoteDocumentCache=function(i){return new Eh(i)}(r=>this.referenceDelegate.qr(r)),this.serializer=new hh(t),this.Qr=new _h(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Lr=!1,Promise.resolve()}get started(){return this.Lr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new yh,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Nr[e.toKey()];return r||(r=new vh(t,this.referenceDelegate),this.Nr[e.toKey()]=r),r}getTargetCache(){return this.kr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Qr}runTransaction(e,t,r){I("MemoryPersistence","Starting transaction:",e);let i=new bh(this.Br.next());return this.referenceDelegate.Kr(),r(i).next(s=>this.referenceDelegate.$r(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ur(e,t){return g.or(Object.values(this.Nr).map(r=>()=>r.containsKey(e,t)))}},bh=class extends qu{constructor(e){super(),this.currentSequenceNumber=e}},Os=class{constructor(e){this.persistence=e,this.Wr=new xs,this.Gr=null}static zr(e){return new Os(e)}get jr(){if(this.Gr)return this.Gr;throw D()}addReference(e,t,r){return this.Wr.addReference(r,t),this.jr.delete(r.toString()),g.resolve()}removeReference(e,t,r){return this.Wr.removeReference(r,t),this.jr.add(r.toString()),g.resolve()}markPotentiallyOrphaned(e,t){return this.jr.add(t.toString()),g.resolve()}removeTarget(e,t){this.Wr.Ar(t.targetId).forEach(i=>this.jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.jr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Kr(){this.Gr=new Set}$r(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return g.forEach(this.jr,r=>{let i=A.fromPath(r);return this.Hr(e,i).next(s=>{s||t.removeEntry(i,k.min())})}).next(()=>(this.Gr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Hr(e,t).next(r=>{r?this.jr.delete(t.toString()):this.jr.add(t.toString())})}qr(e){return 0}Hr(e,t){return g.or([()=>g.resolve(this.Wr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ur(e,t)])}};var Vs=class{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Li=r,this.ki=i}static qi(e,t){let r=U(),i=U();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Vs(e,t.fromCache,r,i)}};var Ch=class{constructor(){this.Qi=!1}initialize(e,t){this.Ki=e,this.indexManager=t,this.Qi=!0}getDocumentsMatchingQuery(e,t,r,i){return this.$i(e,t).next(s=>s||this.Ui(e,t,i,r)).next(s=>s||this.Wi(e,t))}$i(e,t){if(Cg(t))return g.resolve(null);let r=Wt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=th(t,null,"F"),r=Wt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=U(...s);return this.Ki.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.Gi(t,a);return this.zi(t,l,o,c.readTime)?this.$i(e,th(t,null,"F")):this.ji(e,l,t,c)}))})))}Ui(e,t,r,i){return Cg(t)||i.isEqual(k.min())?this.Wi(e,t):this.Ki.getDocuments(e,r).next(s=>{let o=this.Gi(t,s);return this.zi(t,o,r,i)?this.Wi(e,t):(_g()<=O.DEBUG&&I("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),nh(t)),this.ji(e,o,t,CI(i,-1)))})}Gi(e,t){let r=new ye(Xg(e));return t.forEach((i,s)=>{Ja(e,s)&&(r=r.add(s))}),r}zi(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Wi(e,t){return _g()<=O.DEBUG&&I("QueryEngine","Using full collection scan to execute query:",nh(t)),this.Ki.getDocumentsMatchingQuery(e,t,Pt.min())}ji(e,t,r,i){return this.Ki.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Rh=class{constructor(e,t,r,i){this.persistence=e,this.Hi=t,this.serializer=i,this.Ji=new Z(W),this.Yi=new un(s=>ed(s),td),this.Zi=new Map,this.Xi=e.getRemoteDocumentCache(),this.kr=e.getTargetCache(),this.Qr=e.getBundleCache(),this.es(r)}es(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new gh(this.Xi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Xi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ji))}};function yb(n,e,t,r){return new Rh(n,e,t,r)}async function d_(n,e){let t=q(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.es(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=U();for(let l of i){o.push(l.batchId);for(let u of l.mutations)c=c.add(u.key)}for(let l of s){a.push(l.batchId);for(let u of l.mutations)c=c.add(u.key)}return t.localDocuments.getDocuments(r,c).next(l=>({ts:l,removedBatchIds:o,addedBatchIds:a}))})})}function f_(n){let e=q(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.kr.getLastRemoteSnapshotVersion(t))}function vb(n,e){let t=q(n),r=e.snapshotVersion,i=t.Ji;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.Xi.newChangeBuffer({trackRemovals:!0});i=t.Ji;let a=[];e.targetChanges.forEach((u,h)=>{let d=i.get(h);if(!d)return;a.push(t.kr.removeMatchingKeys(s,u.removedDocuments,h).next(()=>t.kr.addMatchingKeys(s,u.addedDocuments,h)));let f=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?f=f.withResumeToken(ve.EMPTY_BYTE_STRING,k.min()).withLastLimboFreeSnapshotVersion(k.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,r)),i=i.insert(h,f),function(y,m,b){return y.resumeToken.approximateByteSize()===0||m.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=3e8?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(d,f,u)&&a.push(t.kr.updateTargetData(s,f))});let c=hn(),l=U();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(Eb(s,o,e.documentUpdates).next(u=>{c=u.ns,l=u.rs})),!r.isEqual(k.min())){let u=t.kr.getLastRemoteSnapshotVersion(s).next(h=>t.kr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(u)}return g.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.Ji=i,s))}function Eb(n,e,t){let r=U(),i=U();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=hn();return t.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(k.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):I("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{ns:o,rs:i}})}function wb(n,e){let t=q(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.kr.getTargetData(r,e).next(s=>s?(i=s,g.resolve(i)):t.kr.allocateTargetId(r).next(o=>(i=new St(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.kr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Ji.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ji=t.Ji.insert(r.targetId,r),t.Yi.set(e,r.targetId)),r})}async function Ah(n,e,t){let r=q(n),i=r.Ji.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!$s(o))throw o;I("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ji=r.Ji.remove(e),r.Yi.delete(i.target)}function Vg(n,e,t){let r=q(n),i=k.min(),s=U();return r.persistence.runTransaction("Execute query","readonly",o=>function(c,l,u){let h=q(c),d=h.Yi.get(u);return d!==void 0?g.resolve(h.Ji.get(d)):h.kr.getTargetData(l,u)}(r,o,Wt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.kr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.Hi.getDocumentsMatchingQuery(o,e,t?i:k.min(),t?s:U())).next(a=>(Tb(r,BI(e),a),{documents:a,ss:s})))}function Tb(n,e,t){let r=n.Zi.get(e)||k.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.Zi.set(e,r)}var Oa=class{constructor(){this.activeTargetIds=KI()}hs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Ps(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ls(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Nh=class{constructor(){this.Hs=new Oa,this.Js={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.Hs.hs(e),this.Js[e]||"not-current"}updateQueryState(e,t,r){this.Js[e]=t}removeLocalQueryTarget(e){this.Hs.Ps(e)}isLocalQueryTarget(e){return this.Hs.activeTargetIds.has(e)}clearQueryState(e){delete this.Js[e]}getAllActiveQueryTargets(){return this.Hs.activeTargetIds}isActiveQueryTarget(e){return this.Hs.activeTargetIds.has(e)}start(){return this.Hs=new Oa,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Sh=class{Ys(e){}shutdown(){}};var Va=class{constructor(){this.Zs=()=>this.Xs(),this.eo=()=>this.no(),this.ro=[],this.io()}Ys(e){this.ro.push(e)}shutdown(){window.removeEventListener("online",this.Zs),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Zs),window.addEventListener("offline",this.eo)}Xs(){I("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ro)e(0)}no(){I("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ro)e(1)}static v(){return typeof window!="undefined"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Ia=null;function Su(){return Ia===null?Ia=function(){return 268435456+Math.round(2147483648*Math.random())}():Ia++,"0x"+Ia.toString(16)}var Ib={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var kh=class{constructor(e){this.so=e.so,this.oo=e.oo}_o(e){this.ao=e}uo(e){this.co=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.so(e)}ho(){this.ao()}Po(e){this.co(e)}Io(e){this.lo(e)}};var Ae="WebChannelConnection",Ph=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.To=r+"://"+t.host,this.Eo=`projects/${i}/databases/${s}`,this.Ao=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Ro(){return!1}Vo(t,r,i,s,o){let a=Su(),c=this.mo(t,r);I("RestConnection",`Sending RPC '${t}' ${a}:`,c,i);let l={"google-cloud-resource-prefix":this.Eo,"x-goog-request-params":this.Ao};return this.fo(l,s,o),this.po(t,c,l,i).then(u=>(I("RestConnection",`Received RPC '${t}' ${a}: `,u),u),u=>{throw Hr("RestConnection",`RPC '${t}' ${a} failed with error: `,u,"url: ",c,"request:",i),u})}yo(t,r,i,s,o,a){return this.Vo(t,r,i,s,o)}fo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ri}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}mo(t,r){let i=Ib[t];return`${this.To}/v1/${r}:${i}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}po(e,t,r,i){let s=Su();return new Promise((o,a)=>{let c=new pg;c.setWithCredentials(!0),c.listenOnce(hg.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Ea.NO_ERROR:let u=c.getResponseJson();I(Ae,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(u)),o(u);break;case Ea.TIMEOUT:I(Ae,`RPC '${e}' ${s} timed out`),a(new C(E.DEADLINE_EXCEEDED,"Request time out"));break;case Ea.HTTP_ERROR:let h=c.getStatus();if(I(Ae,`RPC '${e}' ${s} failed with status:`,h,"response text:",c.getResponseText()),h>0){let d=c.getResponseJson();Array.isArray(d)&&(d=d[0]);let f=d==null?void 0:d.error;if(f&&f.status&&f.message){let p=function(m){let b=m.toLowerCase().replace(/_/g,"-");return Object.values(E).indexOf(b)>=0?b:E.UNKNOWN}(f.status);a(new C(p,f.message))}else a(new C(E.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new C(E.UNAVAILABLE,"Connection failed."));break;default:D()}}finally{I(Ae,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);I(Ae,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",l,r,15)})}wo(e,t,r){let i=Su(),s=[this.To,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=lg(),a=ug(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new fg({})),this.fo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let u=s.join("");I(Ae,`Creating RPC '${e}' stream ${i}: ${u}`,c);let h=o.createWebChannel(u,c),d=!1,f=!1,p=new kh({so:m=>{f?I(Ae,`Not sending because RPC '${e}' stream ${i} is closed:`,m):(d||(I(Ae,`Opening RPC '${e}' stream ${i} transport.`),h.open(),d=!0),I(Ae,`RPC '${e}' stream ${i} sending:`,m),h.send(m))},oo:()=>h.close()}),y=(m,b,x)=>{m.listen(b,T=>{try{x(T)}catch(R){setTimeout(()=>{throw R},0)}})};return y(h,vs.EventType.OPEN,()=>{f||I(Ae,`RPC '${e}' stream ${i} transport opened.`)}),y(h,vs.EventType.CLOSE,()=>{f||(f=!0,I(Ae,`RPC '${e}' stream ${i} transport closed`),p.Po())}),y(h,vs.EventType.ERROR,m=>{f||(f=!0,Hr(Ae,`RPC '${e}' stream ${i} transport errored:`,m),p.Po(new C(E.UNAVAILABLE,"The operation could not be completed")))}),y(h,vs.EventType.MESSAGE,m=>{var b;if(!f){let x=m.data[0];ue(!!x);let T=x,R=T.error||((b=T[0])===null||b===void 0?void 0:b.error);if(R){I(Ae,`RPC '${e}' stream ${i} received error:`,R);let N=R.status,B=function(Dn){let Ir=re[Dn];if(Ir!==void 0)return o_(Ir)}(N),he=R.message;B===void 0&&(B=E.INTERNAL,he="Unknown error status: "+N+" with message "+R.message),f=!0,p.Po(new C(B,he)),h.close()}else I(Ae,`RPC '${e}' stream ${i} received:`,x),p.Io(x)}}),y(a,dg.STAT_EVENT,m=>{m.stat===Ru.PROXY?I(Ae,`RPC '${e}' stream ${i} detected buffering proxy`):m.stat===Ru.NOPROXY&&I(Ae,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.ho()},0),p}};function ku(){return typeof document!="undefined"?document:null}function p_(n){return new ch(n,!0)}var La=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ii=e,this.timerId=t,this.So=r,this.bo=i,this.Do=s,this.vo=0,this.Co=null,this.Fo=Date.now(),this.reset()}reset(){this.vo=0}Mo(){this.vo=this.Do}xo(e){this.cancel();let t=Math.floor(this.vo+this.Oo()),r=Math.max(0,Date.now()-this.Fo),i=Math.max(0,t-r);i>0&&I("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.vo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Co=this.ii.enqueueAfterDelay(this.timerId,i,()=>(this.Fo=Date.now(),e())),this.vo*=this.bo,this.vo<this.So&&(this.vo=this.So),this.vo>this.Do&&(this.vo=this.Do)}No(){this.Co!==null&&(this.Co.skipDelay(),this.Co=null)}cancel(){this.Co!==null&&(this.Co.cancel(),this.Co=null)}Oo(){return(Math.random()-.5)*this.vo}};var Dh=class{constructor(e,t,r,i,s,o,a,c){this.ii=e,this.Bo=r,this.Lo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.ko=0,this.qo=null,this.Qo=null,this.stream=null,this.Ko=new La(e,t)}$o(){return this.state===1||this.state===5||this.Uo()}Uo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Wo()}async stop(){this.$o()&&await this.close(0)}Go(){this.state=0,this.Ko.reset()}zo(){this.Uo()&&this.qo===null&&(this.qo=this.ii.enqueueAfterDelay(this.Bo,6e4,()=>this.jo()))}Ho(e){this.Jo(),this.stream.send(e)}async jo(){if(this.Uo())return this.close(0)}Jo(){this.qo&&(this.qo.cancel(),this.qo=null)}Yo(){this.Qo&&(this.Qo.cancel(),this.Qo=null)}async close(e,t){this.Jo(),this.Yo(),this.Ko.cancel(),this.ko++,e!==4?this.Ko.reset():t&&t.code===E.RESOURCE_EXHAUSTED?(jt(t.toString()),jt("Using maximum backoff delay to prevent overloading the backend."),this.Ko.Mo()):t&&t.code===E.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Zo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.uo(t)}Zo(){}auth(){this.state=1;let e=this.Xo(this.ko),t=this.ko;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.ko===t&&this.e_(r,i)},r=>{e(()=>{let i=new C(E.UNKNOWN,"Fetching auth token failed: "+r.message);return this.t_(i)})})}e_(e,t){let r=this.Xo(this.ko);this.stream=this.n_(e,t),this.stream._o(()=>{r(()=>(this.state=2,this.Qo=this.ii.enqueueAfterDelay(this.Lo,1e4,()=>(this.Uo()&&(this.state=3),Promise.resolve())),this.listener._o()))}),this.stream.uo(i=>{r(()=>this.t_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Wo(){this.state=5,this.Ko.xo(async()=>{this.state=0,this.start()})}t_(e){return I("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget(()=>this.ko===e?t():(I("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},xh=class extends Dh{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}n_(e,t){return this.connection.wo("Listen",e,t)}onMessage(e){this.Ko.reset();let t=lb(this.serializer,e),r=function(s){if(!("targetChange"in s))return k.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?k.min():o.readTime?jr(o.readTime):k.min()}(e);return this.listener.r_(t,r)}i_(e){let t={};t.database=Og(this.serializer),t.addTarget=function(s,o){let a,c=o.target;if(a=eh(c)?{documents:ub(s,c)}:{query:hb(s,c)},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=ob(s,o.resumeToken);let l=lh(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(k.min())>0){a.readTime=sb(s,o.snapshotVersion.toTimestamp());let l=lh(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=fb(this.serializer,e);r&&(t.labels=r),this.Ho(t)}s_(e){let t={};t.database=Og(this.serializer),t.removeTarget=e,this.Ho(t)}};var Oh=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.h_=!1}P_(){if(this.h_)throw new C(E.FAILED_PRECONDITION,"The client has already been terminated.")}Vo(e,t,r){return this.P_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.Vo(e,t,r,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===E.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new C(E.UNKNOWN,i.toString())})}yo(e,t,r,i){return this.P_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.yo(e,t,r,s,o,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===E.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new C(E.UNKNOWN,s.toString())})}terminate(){this.h_=!0}};var Vh=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.T_=0,this.E_=null,this.d_=!0}A_(){this.T_===0&&(this.R_("Unknown"),this.E_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.E_=null,this.V_("Backend didn't respond within 10 seconds."),this.R_("Offline"),Promise.resolve())))}m_(e){this.state==="Online"?this.R_("Unknown"):(this.T_++,this.T_>=1&&(this.f_(),this.V_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.R_("Offline")))}set(e){this.f_(),this.T_=0,e==="Online"&&(this.d_=!1),this.R_(e)}R_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}V_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.d_?(jt(t),this.d_=!1):I("OnlineStateTracker",t)}f_(){this.E_!==null&&(this.E_.cancel(),this.E_=null)}};var Lh=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.g_=[],this.p_=new Map,this.y_=new Set,this.w_=[],this.S_=s,this.S_.Ys(o=>{r.enqueueAndForget(async()=>{Ws(this)&&(I("RemoteStore","Restarting streams for network reachability change."),await async function(c){let l=q(c);l.y_.add(4),await js(l),l.b_.set("Unknown"),l.y_.delete(4),await Xa(l)}(this))})}),this.b_=new Vh(r,i)}};async function Xa(n){if(Ws(n))for(let e of n.w_)await e(!0)}async function js(n){for(let e of n.w_)await e(!1)}function m_(n,e){let t=q(n);t.p_.has(e.targetId)||(t.p_.set(e.targetId,e),id(t)?rd(t):ii(t).Uo()&&nd(t,e))}function g_(n,e){let t=q(n),r=ii(t);t.p_.delete(e),r.Uo()&&__(t,e),t.p_.size===0&&(r.Uo()?r.zo():Ws(t)&&t.b_.set("Unknown"))}function nd(n,e){if(n.D_.Be(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(k.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ii(n).i_(e)}function __(n,e){n.D_.Be(e),ii(n).s_(e)}function rd(n){n.D_=new ah({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>n.p_.get(e)||null,rt:()=>n.datastore.serializer.databaseId}),ii(n).start(),n.b_.A_()}function id(n){return Ws(n)&&!ii(n).$o()&&n.p_.size>0}function Ws(n){return q(n).y_.size===0}function y_(n){n.D_=void 0}async function bb(n){n.p_.forEach((e,t)=>{nd(n,e)})}async function Cb(n,e){y_(n),id(n)?(n.b_.m_(e),rd(n)):n.b_.set("Unknown")}async function Rb(n,e,t){if(n.b_.set("Online"),e instanceof Pa&&e.state===2&&e.cause)try{await async function(i,s){let o=s.cause;for(let a of s.targetIds)i.p_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.p_.delete(a),i.D_.removeTarget(a))}(n,e)}catch(r){I("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Lg(n,r)}else if(e instanceof $r?n.D_.We(e):e instanceof ka?n.D_.Ze(e):n.D_.je(e),!t.isEqual(k.min()))try{let r=await f_(n.localStore);t.compareTo(r)>=0&&await function(s,o){let a=s.D_.st(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let u=s.p_.get(l);u&&s.p_.set(l,u.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{let u=s.p_.get(c);if(!u)return;s.p_.set(c,u.withResumeToken(ve.EMPTY_BYTE_STRING,u.snapshotVersion)),__(s,c);let h=new St(u.target,c,l,u.sequenceNumber);nd(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){I("RemoteStore","Failed to raise snapshot:",r),await Lg(n,r)}}async function Lg(n,e,t){if(!$s(e))throw e;n.y_.add(1),await js(n),n.b_.set("Offline"),t||(t=()=>f_(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{I("RemoteStore","Retrying IndexedDB access"),await t(),n.y_.delete(1),await Xa(n)})}async function Mg(n,e){let t=q(n);t.asyncQueue.verifyOperationInProgress(),I("RemoteStore","RemoteStore received new credentials");let r=Ws(t);t.y_.add(3),await js(t),r&&t.b_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.y_.delete(3),await Xa(t)}async function Ab(n,e){let t=q(n);e?(t.y_.delete(2),await Xa(t)):e||(t.y_.add(2),await js(t),t.b_.set("Unknown"))}function ii(n){return n.v_||(n.v_=function(t,r,i){let s=q(t);return s.P_(),new xh(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{_o:bb.bind(null,n),uo:Cb.bind(null,n),r_:Rb.bind(null,n)}),n.w_.push(async e=>{e?(n.v_.Go(),id(n)?rd(n):n.b_.set("Unknown")):(await n.v_.stop(),y_(n))})),n.v_}var Ls=class{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new kt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new Ls(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new C(E.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function v_(n,e){if(jt("AsyncQueue",`${e}: ${n}`),$s(n))return new C(E.UNAVAILABLE,`${e}: ${n}`);throw n}var sn=class{constructor(e){this.comparator=e?(t,r)=>e(t,r)||A.comparator(t.key,r.key):(t,r)=>A.comparator(t.key,r.key),this.keyedMap=Es(),this.sortedSet=new Z(this.comparator)}static emptySet(e){return new sn(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof sn)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new sn;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Ma=class{constructor(){this.F_=new Z(A.comparator)}track(e){let t=e.doc.key,r=this.F_.get(t);r?e.type!==0&&r.type===3?this.F_=this.F_.insert(t,e):e.type===3&&r.type!==1?this.F_=this.F_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.F_=this.F_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.F_=this.F_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.F_=this.F_.remove(t):e.type===1&&r.type===2?this.F_=this.F_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.F_=this.F_.insert(t,{type:2,doc:e.doc}):D():this.F_=this.F_.insert(t,e)}M_(){let e=[];return this.F_.inorderTraversal((t,r)=>{e.push(r)}),e}},fn=class{constructor(e,t,r,i,s,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new fn(e,t,sn.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ya(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Mh=class{constructor(){this.x_=void 0,this.listeners=[]}},Fh=class{constructor(){this.queries=new un(e=>Jg(e),Ya),this.onlineState="Unknown",this.O_=new Set}};async function sd(n,e){let t=q(n),r=e.query,i=!1,s=t.queries.get(r);if(s||(i=!0,s=new Mh),i)try{s.x_=await t.onListen(r)}catch(o){let a=v_(o,`Initialization of query '${nh(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,s),s.listeners.push(e),e.N_(t.onlineState),s.x_&&e.B_(s.x_)&&ad(t)}async function od(n,e){let t=q(n),r=e.query,i=!1,s=t.queries.get(r);if(s){let o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=s.listeners.length===0)}if(i)return t.queries.delete(r),t.onUnlisten(r)}function Nb(n,e){let t=q(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.listeners)a.B_(i)&&(r=!0);o.x_=i}}r&&ad(t)}function Sb(n,e,t){let r=q(n),i=r.queries.get(e);if(i)for(let s of i.listeners)s.onError(t);r.queries.delete(e)}function ad(n){n.O_.forEach(e=>{e.next()})}var Ms=class{constructor(e,t,r){this.query=e,this.L_=t,this.k_=!1,this.q_=null,this.onlineState="Unknown",this.options=r||{}}B_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new fn(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.k_?this.Q_(e)&&(this.L_.next(e),t=!0):this.K_(e,this.onlineState)&&(this.U_(e),t=!0),this.q_=e,t}onError(e){this.L_.error(e)}N_(e){this.onlineState=e;let t=!1;return this.q_&&!this.k_&&this.K_(this.q_,e)&&(this.U_(this.q_),t=!0),t}K_(e,t){if(!e.fromCache)return!0;let r=t!=="Offline";return(!this.options.W_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Q_(e){if(e.docChanges.length>0)return!0;let t=this.q_&&this.q_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}U_(e){e=fn.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.k_=!0,this.L_.next(e)}};var Fa=class{constructor(e){this.key=e}},Ua=class{constructor(e){this.key=e}},Uh=class{constructor(e,t){this.query=e,this.X_=t,this.ea=null,this.hasCachedResults=!1,this.current=!1,this.ta=U(),this.mutatedKeys=U(),this.na=Xg(e),this.ra=new sn(this.na)}get ia(){return this.X_}sa(e,t){let r=t?t.oa:new Ma,i=t?t.ra:this.ra,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,h)=>{let d=i.get(u),f=Ja(this.query,h)?h:null,p=!!d&&this.mutatedKeys.has(d.key),y=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations),m=!1;d&&f?d.data.isEqual(f.data)?p!==y&&(r.track({type:3,doc:f}),m=!0):this._a(d,f)||(r.track({type:2,doc:f}),m=!0,(c&&this.na(f,c)>0||l&&this.na(f,l)<0)&&(a=!0)):!d&&f?(r.track({type:0,doc:f}),m=!0):d&&!f&&(r.track({type:1,doc:d}),m=!0,(c||l)&&(a=!0)),m&&(f?(o=o.add(f),s=y?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),r.track({type:1,doc:u})}return{ra:o,oa:r,zi:a,mutatedKeys:s}}_a(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){let i=this.ra;this.ra=e.ra,this.mutatedKeys=e.mutatedKeys;let s=e.oa.M_();s.sort((l,u)=>function(d,f){let p=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return D()}};return p(d)-p(f)}(l.type,u.type)||this.na(l.doc,u.doc)),this.aa(r);let o=t?this.ua():[],a=this.ta.size===0&&this.current?1:0,c=a!==this.ea;return this.ea=a,s.length!==0||c?{snapshot:new fn(this.query,e.ra,i,s,e.mutatedKeys,a===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),ca:o}:{ca:o}}N_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ra:this.ra,oa:new Ma,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{ca:[]}}la(e){return!this.X_.has(e)&&!!this.ra.has(e)&&!this.ra.get(e).hasLocalMutations}aa(e){e&&(e.addedDocuments.forEach(t=>this.X_=this.X_.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.X_=this.X_.delete(t)),this.current=e.current)}ua(){if(!this.current)return[];let e=this.ta;this.ta=U(),this.ra.forEach(r=>{this.la(r.key)&&(this.ta=this.ta.add(r.key))});let t=[];return e.forEach(r=>{this.ta.has(r)||t.push(new Ua(r))}),this.ta.forEach(r=>{e.has(r)||t.push(new Fa(r))}),t}ha(e){this.X_=e.ss,this.ta=U();let t=this.sa(e.documents);return this.applyChanges(t,!0)}Pa(){return fn.fromInitialDocuments(this.query,this.ra,this.mutatedKeys,this.ea===0,this.hasCachedResults)}},Bh=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},qh=class{constructor(e){this.key=e,this.Ia=!1}},$h=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ta={},this.Ea=new un(a=>Jg(a),Ya),this.da=new Map,this.Aa=new Set,this.Ra=new Z(A.comparator),this.Va=new Map,this.ma=new xs,this.fa={},this.ga=new Map,this.pa=dn.On(),this.onlineState="Unknown",this.ya=void 0}get isPrimaryClient(){return this.ya===!0}};async function kb(n,e){let t=Mb(n),r,i,s=t.Ea.get(e);if(s)r=s.targetId,t.sharedClientState.addLocalQueryTarget(r),i=s.view.Pa();else{let o=await wb(t.localStore,Wt(e)),a=t.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=await Pb(t,e,r,a==="current",o.resumeToken),t.isPrimaryClient&&m_(t.remoteStore,o)}return i}async function Pb(n,e,t,r,i){n.wa=(h,d,f)=>async function(y,m,b,x){let T=m.view.sa(b);T.zi&&(T=await Vg(y.localStore,m.query,!1).then(({documents:B})=>m.view.sa(B,T)));let R=x&&x.targetChanges.get(m.targetId),N=m.view.applyChanges(T,y.isPrimaryClient,R);return Ug(y,m.targetId,N.ca),N.snapshot}(n,h,d,f);let s=await Vg(n.localStore,e,!0),o=new Uh(e,s.ss),a=o.sa(s.documents),c=Yn.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=o.applyChanges(a,n.isPrimaryClient,c);Ug(n,t,l.ca);let u=new Bh(e,t,o);return n.Ea.set(e,u),n.da.has(t)?n.da.get(t).push(e):n.da.set(t,[e]),l.snapshot}async function Db(n,e){let t=q(n),r=t.Ea.get(e),i=t.da.get(r.targetId);if(i.length>1)return t.da.set(r.targetId,i.filter(s=>!Ya(s,e))),void t.Ea.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||await Ah(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),g_(t.remoteStore,r.targetId),jh(t,r.targetId)}).catch(Yh)):(jh(t,r.targetId),await Ah(t.localStore,r.targetId,!0))}async function E_(n,e){let t=q(n);try{let r=await vb(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Va.get(s);o&&(ue(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Ia=!0:i.modifiedDocuments.size>0?ue(o.Ia):i.removedDocuments.size>0&&(ue(o.Ia),o.Ia=!1))}),await T_(t,r,e)}catch(r){await Yh(r)}}function Fg(n,e,t){let r=q(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Ea.forEach((s,o)=>{let a=o.view.N_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=q(o);c.onlineState=a;let l=!1;c.queries.forEach((u,h)=>{for(let d of h.listeners)d.N_(a)&&(l=!0)}),l&&ad(c)}(r.eventManager,e),i.length&&r.Ta.r_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function xb(n,e,t){let r=q(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Va.get(e),s=i&&i.key;if(s){let o=new Z(A.comparator);o=o.insert(s,ge.newNoDocument(s,k.min()));let a=U().add(s),c=new ti(k.min(),new Map,new Z(W),o,a);await E_(r,c),r.Ra=r.Ra.remove(s),r.Va.delete(e),cd(r)}else await Ah(r.localStore,e,!1).then(()=>jh(r,e,t)).catch(Yh)}function jh(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.da.get(e))n.Ea.delete(r),t&&n.Ta.Sa(r,t);n.da.delete(e),n.isPrimaryClient&&n.ma.Ar(e).forEach(r=>{n.ma.containsKey(r)||w_(n,r)})}function w_(n,e){n.Aa.delete(e.path.canonicalString());let t=n.Ra.get(e);t!==null&&(g_(n.remoteStore,t),n.Ra=n.Ra.remove(e),n.Va.delete(t),cd(n))}function Ug(n,e,t){for(let r of t)r instanceof Fa?(n.ma.addReference(r.key,e),Ob(n,r)):r instanceof Ua?(I("SyncEngine","Document no longer in limbo: "+r.key),n.ma.removeReference(r.key,e),n.ma.containsKey(r.key)||w_(n,r.key)):D()}function Ob(n,e){let t=e.key,r=t.path.canonicalString();n.Ra.get(t)||n.Aa.has(r)||(I("SyncEngine","New document in limbo: "+t),n.Aa.add(r),cd(n))}function cd(n){for(;n.Aa.size>0&&n.Ra.size<n.maxConcurrentLimboResolutions;){let e=n.Aa.values().next().value;n.Aa.delete(e);let t=new A(X.fromString(e)),r=n.pa.next();n.Va.set(r,new qh(t)),n.Ra=n.Ra.insert(t,r),m_(n.remoteStore,new St(Wt(Qa(t.path)),r,"TargetPurposeLimboResolution",bs.ae))}}async function T_(n,e,t){let r=q(n),i=[],s=[],o=[];r.Ea.isEmpty()||(r.Ea.forEach((a,c)=>{o.push(r.wa(c,e,t).then(l=>{if((l||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,l!=null&&l.fromCache?"not-current":"current"),l){i.push(l);let u=Vs.qi(c.targetId,l);s.push(u)}}))}),await Promise.all(o),r.Ta.r_(i),await async function(c,l){let u=q(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>g.forEach(l,d=>g.forEach(d.Li,f=>u.persistence.referenceDelegate.addReference(h,d.targetId,f)).next(()=>g.forEach(d.ki,f=>u.persistence.referenceDelegate.removeReference(h,d.targetId,f)))))}catch(h){if(!$s(h))throw h;I("LocalStore","Failed to update sequence numbers: "+h)}for(let h of l){let d=h.targetId;if(!h.fromCache){let f=u.Ji.get(d),p=f.snapshotVersion,y=f.withLastLimboFreeSnapshotVersion(p);u.Ji=u.Ji.insert(d,y)}}}(r.localStore,s))}async function Vb(n,e){let t=q(n);if(!t.currentUser.isEqual(e)){I("SyncEngine","User change. New user:",e.toKey());let r=await d_(t.localStore,e);t.currentUser=e,function(s,o){s.ga.forEach(a=>{a.forEach(c=>{c.reject(new C(E.CANCELLED,o))})}),s.ga.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await T_(t,r.ts)}}function Lb(n,e){let t=q(n),r=t.Va.get(e);if(r&&r.Ia)return U().add(r.key);{let i=U(),s=t.da.get(e);if(!s)return i;for(let o of s){let a=t.Ea.get(o);i=i.unionWith(a.view.ia)}return i}}function Mb(n){let e=q(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=E_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Lb.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=xb.bind(null,e),e.Ta.r_=Nb.bind(null,e.eventManager),e.Ta.Sa=Sb.bind(null,e.eventManager),e}var Ba=class{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=p_(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return yb(this.persistence,new Ch,e.initialUser,this.serializer)}createPersistence(e){return new Ih(Os.zr,this.serializer)}createSharedClientState(e){return new Nh}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}};var Wh=class{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Fg(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Vb.bind(null,this.syncEngine),await Ab(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Fh}()}createDatastore(e){let t=p_(e.databaseInfo.databaseId),r=function(s){return new Ph(s)}(e.databaseInfo);return function(s,o,a,c){return new Oh(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,a){return new Lh(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>Fg(this.syncEngine,t,0),function(){return Va.v()?new Va:new Sh}())}createSyncEngine(e,t){return function(i,s,o,a,c,l,u){let h=new $h(i,s,o,a,c,l);return u&&(h.ya=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(t){let r=q(t);I("RemoteStore","RemoteStore shutting down."),r.y_.add(5),await js(r),r.S_.shutdown(),r.b_.set("Unknown")}(this.remoteStore)}};var Fs=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.va(this.observer.next,e)}error(e){this.observer.error?this.va(this.observer.error,e):jt("Uncaught Error in snapshot listener:",e.toString())}Ca(){this.muted=!0}va(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var Hh=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=me.UNAUTHENTICATED,this.clientId=Uu.V(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async s=>{I("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(I("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new C(E.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new kt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=v_(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function Pu(n,e){n.asyncQueue.verifyOperationInProgress(),I("FirestoreClient","Initializing OfflineComponentProvider");let t=await n.getConfiguration();await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await d_(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function Bg(n,e){n.asyncQueue.verifyOperationInProgress();let t=await Ub(n);I("FirestoreClient","Initializing OnlineComponentProvider");let r=await n.getConfiguration();await e.initialize(t,r),n.setCredentialChangeListener(i=>Mg(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,s)=>Mg(e.remoteStore,s)),n._onlineComponents=e}function Fb(n){return n.name==="FirebaseError"?n.code===E.FAILED_PRECONDITION||n.code===E.UNIMPLEMENTED:!(typeof DOMException!="undefined"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}async function Ub(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){I("FirestoreClient","Using user provided OfflineComponentProvider");try{await Pu(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!Fb(t))throw t;Hr("Error using user provided cache. Falling back to memory cache: "+t),await Pu(n,new Ba)}}else I("FirestoreClient","Using default OfflineComponentProvider"),await Pu(n,new Ba);return n._offlineComponents}async function Bb(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(I("FirestoreClient","Using user provided OnlineComponentProvider"),await Bg(n,n._uninitializedComponentsProvider._online)):(I("FirestoreClient","Using default OnlineComponentProvider"),await Bg(n,new Wh))),n._onlineComponents}async function qa(n){let e=await Bb(n),t=e.eventManager;return t.onListen=kb.bind(null,e.syncEngine),t.onUnlisten=Db.bind(null,e.syncEngine),t}function qb(n,e,t={}){let r=new kt;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,a,c,l){let u=new Fs({next:d=>{o.enqueueAndForget(()=>od(s,h));let f=d.docs.has(a);!f&&d.fromCache?l.reject(new C(E.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&d.fromCache&&c&&c.source==="server"?l.reject(new C(E.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(d)},error:d=>l.reject(d)}),h=new Ms(Qa(a.path),u,{includeMetadataChanges:!0,W_:!0});return sd(s,h)}(await qa(n),n.asyncQueue,e,t,r)),r.promise}function $b(n,e,t={}){let r=new kt;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,a,c,l){let u=new Fs({next:d=>{o.enqueueAndForget(()=>od(s,h)),d.fromCache&&c.source==="server"?l.reject(new C(E.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(d)},error:d=>l.reject(d)}),h=new Ms(a,u,{includeMetadataChanges:!0,W_:!0});return sd(s,h)}(await qa(n),n.asyncQueue,e,t,r)),r.promise}function I_(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var qg=new Map;function jb(n,e,t){if(!t)throw new C(E.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Wb(n,e,t,r){if(e===!0&&r===!0)throw new C(E.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function $g(n){if(A.isDocumentKey(n))throw new C(E.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Hb(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":D()}function on(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new C(E.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Hb(n);throw new C(E.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var $a=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new C(E.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new C(E.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Wb("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=I_((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new C(E.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new C(E.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new C(E.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Us=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new $a({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new C(E.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new C(E.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new $a(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Du;switch(r.type){case"firstParty":return new Lu(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new C(E.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=qg.get(t);r&&(I("ComponentProvider","Removing Datastore"),qg.delete(t),r.terminate())}(this),Promise.resolve()}};function Kb(n,e,t,r={}){var i;let s=(n=on(n,Us))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Hr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=me.MOCK_USER;else{a=Uo(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new C(E.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new me(l)}n._authCredentials=new xu(new Ca(a,c))}}var Jn=class{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Jn(this.firestore,e,this._query)}},xt=class{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new an(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new xt(this.firestore,e,this._key)}},an=class extends Jn{constructor(e,t,r){super(e,t,Qa(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new xt(this.firestore,null,new A(e))}withConverter(e){return new an(this.firestore,e,this._path)}};function b_(n,e,...t){if(n=qe(n),jb("collection","path",e),n instanceof Us){let r=X.fromString(e,...t);return $g(r),new an(n,null,r)}{if(!(n instanceof xt||n instanceof an))throw new C(E.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(X.fromString(e,...t));return $g(r),new an(n.firestore,null,r)}}var Kh=class{constructor(){this.Wa=Promise.resolve(),this.Ga=[],this.za=!1,this.ja=[],this.Ha=null,this.Ja=!1,this.Ya=!1,this.Za=[],this.Ko=new La(this,"async_queue_retry"),this.Xa=()=>{let t=ku();t&&I("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Ko.No()};let e=ku();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Xa)}get isShuttingDown(){return this.za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.eu(),this.tu(e)}enterRestrictedMode(e){if(!this.za){this.za=!0,this.Ya=e||!1;let t=ku();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Xa)}}enqueue(e){if(this.eu(),this.za)return new Promise(()=>{});let t=new kt;return this.tu(()=>this.za&&this.Ya?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ga.push(e),this.nu()))}async nu(){if(this.Ga.length!==0){try{await this.Ga[0](),this.Ga.shift(),this.Ko.reset()}catch(e){if(!$s(e))throw e;I("AsyncQueue","Operation failed with retryable error: "+e)}this.Ga.length>0&&this.Ko.xo(()=>this.nu())}}tu(e){let t=this.Wa.then(()=>(this.Ja=!0,e().catch(r=>{this.Ha=r,this.Ja=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw jt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Ja=!1,r))));return this.Wa=t,t}enqueueAfterDelay(e,t,r){this.eu(),this.Za.indexOf(e)>-1&&(t=0);let i=Ls.createAndSchedule(this,e,t,r,s=>this.ru(s));return this.ja.push(i),i}eu(){this.Ha&&D()}verifyOperationInProgress(){}async iu(){let e;do e=this.Wa,await e;while(e!==this.Wa)}su(e){for(let t of this.ja)if(t.timerId===e)return!0;return!1}ou(e){return this.iu().then(()=>{this.ja.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.ja)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.iu()})}_u(e){this.Za.push(e)}ru(e){let t=this.ja.indexOf(e);this.ja.splice(t,1)}};function jg(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var Xn=class extends Us{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new Kh}(),this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||C_(this),this._firestoreClient.terminate()}};function ld(n,e){let t=typeof n=="object"?n:tn(),r=typeof n=="string"?n:e||"(default)",i=Pr(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=Fo("firestore");s&&Kb(i,...s)}return i}function ud(n){return n._firestoreClient||C_(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function C_(n){var e,t,r;let i=n._freezeSettings(),s=function(a,c,l,u){return new $u(a,c,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,I_(u.experimentalLongPollingOptions),u.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new Hh(n._authCredentials,n._appCheckCredentials,n._queue,s),((t=i.localCache)===null||t===void 0?void 0:t._offlineComponentProvider)&&((r=i.localCache)===null||r===void 0?void 0:r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var ni=class{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ni(ve.fromBase64String(e))}catch(t){throw new C(E.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ni(ve.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var ja=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new C(E.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ne(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Bs=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new C(E.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new C(E.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return W(this._lat,e._lat)||W(this._long,e._long)}};var zb=new RegExp("[~\\*/\\[\\]]");function Gb(n,e,t){if(e.search(zb)>=0)throw Wg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ja(...e.split("."))._internalPath}catch{throw Wg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Wg(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new C(E.INVALID_ARGUMENT,a+n+c)}var Wa=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new xt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new zh(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(R_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},zh=class extends Wa{data(){return super.data()}};function R_(n,e){return typeof e=="string"?Gb(n,e):e instanceof ja?e._internalPath:e._delegate._internalPath}function A_(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new C(E.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Gh=class{convertValue(e,t="none"){switch(Qn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return te(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ln(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw D()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Ga(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new Bs(te(e.latitude),te(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Xh(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Cs(e));default:return null}}convertTimestamp(e){let t=cn(e);return new _e(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=X.fromString(e);ue(h_(r));let i=new Gn(r.get(1),r.get(3)),s=new A(r.popFirst(5));return i.isEqual(t)||jt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};var Wn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ha=class extends Wa{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Wr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(R_("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Wr=class extends Ha{data(e={}){return super.data(e)}},Ka=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Wn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Wr(this._firestore,this._userDataWriter,r.key,r,new Wn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new C(E.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new Wr(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Wn(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new Wr(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Wn(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,u=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:Qb(a.type),doc:c,oldIndex:l,newIndex:u}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function Qb(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return D()}}function hd(n){n=on(n,xt);let e=on(n.firestore,Xn);return qb(ud(e),n._key).then(t=>S_(e,n,t))}var qs=class extends Gh{constructor(e){super(),this.firestore=e}convertBytes(e){return new ni(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new xt(this.firestore,null,t)}};function N_(n){n=on(n,Jn);let e=on(n.firestore,Xn),t=ud(e),r=new qs(e);return A_(n._query),$b(t,n._query).then(i=>new Ka(e,r,n,i))}function Za(n,...e){var t,r,i;n=qe(n);let s={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||jg(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges};if(jg(e[o])){let h=e[o];e[o]=(t=h.next)===null||t===void 0?void 0:t.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let c,l,u;if(n instanceof xt)l=on(n.firestore,Xn),u=Qa(n._key.path),c={next:h=>{e[o]&&e[o](S_(l,n,h))},error:e[o+1],complete:e[o+2]};else{let h=on(n,Jn);l=on(h.firestore,Xn),u=h._query;let d=new qs(l);c={next:f=>{e[o]&&e[o](new Ka(l,d,h,f))},error:e[o+1],complete:e[o+2]},A_(n._query)}return function(d,f,p,y){let m=new Fs(y),b=new Ms(f,m,p);return d.asyncQueue.enqueueAndForget(async()=>sd(await qa(d),b)),()=>{m.Ca(),d.asyncQueue.enqueueAndForget(async()=>od(await qa(d),b))}}(ud(l),u,a,c)}function S_(n,e,t){let r=t.docs.get(e._key),i=new qs(n);return new Ha(n,i,e._key,r,new Wn(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){ri=i})(bt),Ve(new ae("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Xn(new Ou(r.getProvider("auth-internal")),new Fu(r.getProvider("app-check-internal")),function(l,u){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new C(E.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Gn(l.options.projectId,u)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),ce(gg,"4.1.0",e),ce(gg,"4.1.0","esm2017")})();var Yb={apiKey:"AIzaSyCcRSq6K213Zn_64FKVfQP-GvGKqDlEykk",authDomain:"firumon-9abec.firebaseapp.com",projectId:"firumon-9abec",storageBucket:"firumon-9abec.appspot.com",messagingSenderId:"985218982992",appId:"1:985218982992:web:cb6f437c446a40f204dd55"},Jb=Ll(Yb);var k_=ld(Jb);function ec(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function $_(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var j_=$_,W_=new it("auth","Firebase",$_());var rc=new Ye("@firebase/auth");function Xb(n,...e){rc.logLevel<=O.WARN&&rc.warn(`Auth (${bt}): ${n}`,...e)}function nc(n,...e){rc.logLevel<=O.ERROR&&rc.error(`Auth (${bt}): ${n}`,...e)}function _n(n,...e){throw Nd(n,...e)}function si(n,...e){return Nd(n,...e)}function Zb(n,e,t){let r=Object.assign(Object.assign({},j_()),{[e]:t});return new it("auth","Firebase",r).create(e,{appName:n.name})}function Nd(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return W_.create(n,...e)}function P(n,e,...t){if(!n)throw Nd(e,...t)}function Ot(n){let e="INTERNAL ASSERTION FAILED: "+n;throw nc(e),new Error(e)}function er(n,e){n||Ot(e)}function eC(){return P_()==="http:"||P_()==="https:"}function P_(){var n;return typeof self!="undefined"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function tC(){return typeof navigator!="undefined"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(eC()||Ap()||"connection"in navigator)?navigator.onLine:!0}function nC(){if(typeof navigator=="undefined")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var tr=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,er(t>e,"Short delay should be less than long delay!"),this.isMobile=Hi()||Bo()}get(){return tC()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function rC(n,e){er(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var ic=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self!="undefined"&&"fetch"in self)return self.fetch;Ot("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self!="undefined"&&"Headers"in self)return self.Headers;Ot("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self!="undefined"&&"Response"in self)return self.Response;Ot("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var iC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var sC=new tr(3e4,6e4);function Se(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function je(n,e,t,r,i={}){return H_(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});let a=Nr(Object.assign({key:n.config.apiKey},o)).slice(1),c=await n._getAdditionalHeaders();return c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode),ic.fetch()(K_(n,n.config.apiHost,t,a),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},s))})}async function H_(n,e,t){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},iC),e);try{let i=new md(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=await s.json();if("needConfirmation"in o)throw Hs(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Hs(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Hs(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Hs(n,"user-disabled",o);let u=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw Zb(n,u,l);_n(n,u)}}catch(i){if(i instanceof we)throw i;_n(n,"network-request-failed",{message:String(i)})}}async function or(n,e,t,r,i={}){let s=await je(n,e,t,r,i);return"mfaPendingCredential"in s&&_n(n,"multi-factor-auth-required",{_serverResponse:s}),s}function K_(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?rC(n.config,i):`${n.config.apiScheme}://${i}`}var md=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(si(this.auth,"network-request-failed")),sC.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Hs(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=si(n,e,r);return i.customData._tokenResponse=t,i}async function oC(n,e){return je(n,"POST","/v1/accounts:delete",e)}async function aC(n,e){return je(n,"POST","/v1/accounts:lookup",e)}function Ks(n){if(!!n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function z_(n,e=!1){let t=qe(n),r=await t.getIdToken(e),i=Sd(r);P(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Ks(dd(i.auth_time)),issuedAtTime:Ks(dd(i.iat)),expirationTime:Ks(dd(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function dd(n){return Number(n)*1e3}function Sd(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return nc("JWT malformed, contained fewer than 3 sections"),null;try{let i=Wi(t);return i?JSON.parse(i):(nc("Failed to decode base64 JWT payload"),null)}catch(i){return nc("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function cC(n){let e=Sd(n);return P(e,"internal-error"),P(typeof e.exp!="undefined","internal-error"),P(typeof e.iat!="undefined","internal-error"),Number(e.exp)-Number(e.iat)}async function zs(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof we&&lC(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function lC({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var gd=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var sc=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ks(this.lastLoginAt),this.creationTime=Ks(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function oc(n){var e;let t=n.auth,r=await n.getIdToken(),i=await zs(n,aC(t,{idToken:r}));P(i==null?void 0:i.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?hC(s.providerUserInfo):[],a=uC(n.providerData,o),c=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!(a!=null&&a.length),u=c?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new sc(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(n,h)}async function G_(n){let e=qe(n);await oc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function uC(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function hC(n){return n.map(e=>{var{providerId:t}=e,r=ec(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}async function dC(n,e){let t=await H_(n,{},async()=>{let r=Nr({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=K_(n,i,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",ic.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}var nr=class{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){P(e.idToken,"internal-error"),P(typeof e.idToken!="undefined","internal-error"),P(typeof e.refreshToken!="undefined","internal-error");let t="expiresIn"in e&&typeof e.expiresIn!="undefined"?Number(e.expiresIn):cC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return P(!this.accessToken||this.refreshToken,e,"user-token-expired"),!t&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:i,expiresIn:s}=await dC(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new nr;return r&&(P(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(P(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(P(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new nr,this.toJSON())}_performRefresh(){return Ot("not implemented")}};function pn(n,e){P(typeof n=="string"||typeof n=="undefined","internal-error",{appName:e})}var Ht=class{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=ec(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new gd(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new sc(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){let t=await zs(this,this.stsTokenManager.getToken(this.auth,e));return P(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return z_(this,e)}reload(){return G_(this)}_assign(e){this!==e&&(P(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new Ht(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){P(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await oc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){let e=await this.getIdToken();return await zs(this,oC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,c,l,u;let h=(r=t.displayName)!==null&&r!==void 0?r:void 0,d=(i=t.email)!==null&&i!==void 0?i:void 0,f=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,p=(o=t.photoURL)!==null&&o!==void 0?o:void 0,y=(a=t.tenantId)!==null&&a!==void 0?a:void 0,m=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,b=(l=t.createdAt)!==null&&l!==void 0?l:void 0,x=(u=t.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:T,emailVerified:R,isAnonymous:N,providerData:B,stsTokenManager:he}=t;P(T&&he,e,"internal-error");let Oe=nr.fromJSON(this.name,he);P(typeof T=="string",e,"internal-error"),pn(h,e.name),pn(d,e.name),P(typeof R=="boolean",e,"internal-error"),P(typeof N=="boolean",e,"internal-error"),pn(f,e.name),pn(p,e.name),pn(y,e.name),pn(m,e.name),pn(b,e.name),pn(x,e.name);let Dn=new Ht({uid:T,auth:e,email:d,emailVerified:R,displayName:h,isAnonymous:N,photoURL:p,phoneNumber:f,tenantId:y,stsTokenManager:Oe,createdAt:b,lastLoginAt:x});return B&&Array.isArray(B)&&(Dn.providerData=B.map(Ir=>Object.assign({},Ir))),m&&(Dn._redirectEventId=m),Dn}static async _fromIdTokenResponse(e,t,r=!1){let i=new nr;i.updateFromServerResponse(t);let s=new Ht({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await oc(s),s}};var D_=new Map;function Zn(n){er(n instanceof Function,"Expected a class definition");let e=D_.get(n);return e?(er(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,D_.set(n,e),e)}var ac=class{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){let t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}};ac.type="NONE";var _d=ac;function fd(n,e,t){return`firebase:${n}:${e}:${t}`}var gn=class{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=fd(this.userKey,i.apiKey,s),this.fullPersistenceKey=fd("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);return e?Ht._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new gn(Zn(_d),e,r);let i=(await Promise.all(t.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l),s=i[0]||Zn(_d),o=fd(r,e.config.apiKey,e.name),a=null;for(let l of t)try{let u=await l._get(o);if(u){let h=Ht._fromJSON(e,u);l!==s&&(a=h),s=l;break}}catch{}let c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new gn(s,e,r):(s=c[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async l=>{if(l!==s)try{await l._remove(o)}catch{}})),new gn(s,e,r))}};function x_(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Y_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(fC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(X_(e))return"Blackberry";if(Z_(e))return"Webos";if(Q_(e))return"Safari";if((e.includes("chrome/")||pC(e))&&!e.includes("edge/"))return"Chrome";if(J_(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function fC(n=be()){return/firefox\//i.test(n)}function Q_(n=be()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function pC(n=be()){return/crios\//i.test(n)}function Y_(n=be()){return/iemobile/i.test(n)}function J_(n=be()){return/android/i.test(n)}function X_(n=be()){return/blackberry/i.test(n)}function Z_(n=be()){return/webos/i.test(n)}function ey(n=be()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function mC(){return Np()&&document.documentMode===10}function gC(n=be()){return ey(n)||J_(n)||Z_(n)||X_(n)||/windows phone/i.test(n)||Y_(n)}function _C(){try{return!!(window&&window!==window.top)}catch{return!1}}function ty(n,e=[]){let t;switch(n){case"Browser":t=x_(be());break;case"Worker":t=`${x_(be())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${bt}/${r}`}async function ny(n,e){return je(n,"GET","/v2/recaptchaConfig",Se(n,e))}function O_(n){return n!==void 0&&n.enterprise!==void 0}var cc=class{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(t=>t.provider==="EMAIL_PASSWORD_PROVIDER"&&t.enforcementState!=="OFF")}};function yC(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}function vC(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=si("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",yC().appendChild(r)})}function EC(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var wC="https://www.google.com/recaptcha/enterprise.js?render=",TC="recaptcha-enterprise",IC="NO_RECAPTCHA",lc=class{constructor(e){this.type=TC,this.auth=kd(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{ny(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{let l=new cc(c);return s.tenantId==null?s._agentRecaptchaConfig=l:s._tenantRecaptchaConfigs[s.tenantId]=l,o(l.siteKey)}}).catch(c=>{a(c)})})}function i(s,o,a){let c=window.grecaptcha;O_(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(l=>{o(l)}).catch(()=>{o(IC)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!t&&O_(window.grecaptcha))i(a,s,o);else{if(typeof window=="undefined"){o(new Error("RecaptchaVerifier is only supported in browser"));return}vC(wC+a).then(()=>{i(a,s,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}};async function V_(n,e,t,r=!1){let i=new lc(n),s;try{s=await i.verify(t)}catch{s=await i.verify(t,!0)}let o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}var yd=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}};var vd=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new uc(this),this.idTokenSubscription=new uc(this),this.beforeStateQueue=new yd(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=W_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Zn(t)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await gn.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var t;let r=await this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c==null?void 0:c.user)&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return P(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await oc(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=nC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){let t=e?qe(e):null;return t&&P(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&P(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Zn(e))})}async initializeRecaptchaConfig(){let e=await ny(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),t=new cc(e);this.tenantId==null?this._agentRecaptchaConfig=t:this._tenantRecaptchaConfigs[this.tenantId]=t,t.emailPasswordEnabled&&new lc(this).verify()}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new it("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&Zn(e)||this._popupRedirectResolver;P(t,this,"argument-error"),this.redirectPersistenceManager=await gn.create(this,[Zn(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return P(o,this,"internal-error"),o.then(()=>s(this.currentUser)),typeof t=="function"?e.addObserver(t,r,i):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return P(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ty(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;let t={["X-Client-Version"]:this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);let i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;let t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&Xb(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}};function kd(n){return qe(n)}var uc=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=xp(t=>this.observer=t)}get next(){return P(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};function bC(n,e){let t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Zn);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}var rr=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ot("not implemented")}_getIdTokenResponse(e){return Ot("not implemented")}_linkToIdToken(e,t){return Ot("not implemented")}_getReauthenticationResolver(e){return Ot("not implemented")}};async function CC(n,e){return je(n,"POST","/v1/accounts:update",e)}async function pd(n,e){return or(n,"POST","/v1/accounts:signInWithPassword",Se(n,e))}async function RC(n,e){return or(n,"POST","/v1/accounts:signInWithEmailLink",Se(n,e))}async function AC(n,e){return or(n,"POST","/v1/accounts:signInWithEmailLink",Se(n,e))}var yn=class extends rr{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new yn(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new yn(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if((t==null?void 0:t.email)&&(t==null?void 0:t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){var t;switch(this.signInMethod){case"password":let r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(!((t=e._getRecaptchaConfig())===null||t===void 0)&&t.emailPasswordEnabled){let i=await V_(e,r,"signInWithPassword");return pd(e,i)}else return pd(e,r).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");let s=await V_(e,r,"signInWithPassword");return pd(e,s)}else return Promise.reject(i)});case"emailLink":return RC(e,{email:this._email,oobCode:this._password});default:_n(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return CC(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return AC(e,{idToken:t,email:this._email,oobCode:this._password});default:_n(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};async function oi(n,e){return or(n,"POST","/v1/accounts:signInWithIdp",Se(n,e))}var NC="http://localhost",Vt=class extends rr{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new Vt(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):_n("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=ec(t,["providerId","signInMethod"]);if(!r||!i)return null;let o=new Vt(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){let t=this.buildRequest();return oi(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,oi(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,oi(e,t)}buildRequest(){let e={requestUri:NC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Nr(t)}return e}};async function SC(n,e){return je(n,"POST","/v1/accounts:sendVerificationCode",Se(n,e))}async function kC(n,e){return or(n,"POST","/v1/accounts:signInWithPhoneNumber",Se(n,e))}async function PC(n,e){let t=await or(n,"POST","/v1/accounts:signInWithPhoneNumber",Se(n,e));if(t.temporaryProof)throw Hs(n,"account-exists-with-different-credential",t);return t}var DC={USER_NOT_FOUND:"user-not-found"};async function xC(n,e){let t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return or(n,"POST","/v1/accounts:signInWithPhoneNumber",Se(n,t),DC)}var Kt=class extends rr{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Kt({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Kt({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return kC(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return PC(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return xC(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));let{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new Kt({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}};function OC(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function VC(n){let e=Sr(kr(n)).link,t=e?Sr(kr(e)).deep_link_id:null,r=Sr(kr(n)).deep_link_id;return(r?Sr(kr(r)).link:null)||r||t||e||n}var ai=class{constructor(e){var t,r,i,s,o,a;let c=Sr(kr(e)),l=(t=c.apiKey)!==null&&t!==void 0?t:null,u=(r=c.oobCode)!==null&&r!==void 0?r:null,h=OC((i=c.mode)!==null&&i!==void 0?i:null);P(l&&u&&h,"argument-error"),this.apiKey=l,this.operation=h,this.code=u,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){let t=VC(e);try{return new ai(t)}catch{return null}}};var vn=class{constructor(){this.providerId=vn.PROVIDER_ID}static credential(e,t){return yn._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){let r=ai.parseLink(t);return P(r,"argument-error"),yn._fromEmailAndCode(e,r.code,r.tenantId)}};vn.PROVIDER_ID="password";vn.EMAIL_PASSWORD_SIGN_IN_METHOD="password";vn.EMAIL_LINK_SIGN_IN_METHOD="emailLink";var Ed=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var ci=class extends Ed{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var at=class extends ci{constructor(){super("facebook.com")}static credential(e){return Vt._fromParams({providerId:at.PROVIDER_ID,signInMethod:at.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return at.credentialFromTaggedObject(e)}static credentialFromError(e){return at.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return at.credential(e.oauthAccessToken)}catch{return null}}};at.FACEBOOK_SIGN_IN_METHOD="facebook.com";at.PROVIDER_ID="facebook.com";var ct=class extends ci{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Vt._fromParams({providerId:ct.PROVIDER_ID,signInMethod:ct.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ct.credentialFromTaggedObject(e)}static credentialFromError(e){return ct.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return ct.credential(t,r)}catch{return null}}};ct.GOOGLE_SIGN_IN_METHOD="google.com";ct.PROVIDER_ID="google.com";var lt=class extends ci{constructor(){super("github.com")}static credential(e){return Vt._fromParams({providerId:lt.PROVIDER_ID,signInMethod:lt.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return lt.credentialFromTaggedObject(e)}static credentialFromError(e){return lt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return lt.credential(e.oauthAccessToken)}catch{return null}}};lt.GITHUB_SIGN_IN_METHOD="github.com";lt.PROVIDER_ID="github.com";var ut=class extends ci{constructor(){super("twitter.com")}static credential(e,t){return Vt._fromParams({providerId:ut.PROVIDER_ID,signInMethod:ut.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ut.credentialFromTaggedObject(e)}static credentialFromError(e){return ut.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return ut.credential(t,r)}catch{return null}}};ut.TWITTER_SIGN_IN_METHOD="twitter.com";ut.PROVIDER_ID="twitter.com";var En=class{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){let s=await Ht._fromIdTokenResponse(e,r,i),o=L_(r);return new En({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);let i=L_(r);return new En({user:e,providerId:i,_tokenResponse:r,operationType:t})}};function L_(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var li=class extends we{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,li.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new li(e,t,r,i)}};function ry(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?li._fromErrorAndOperation(n,s,e,r):s})}async function LC(n,e,t=!1){let r=await zs(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return En._forOperation(n,"link",r)}async function MC(n,e,t=!1){let{auth:r}=n,i="reauthenticate";try{let s=await zs(n,ry(r,i,e,n),t);P(s.idToken,r,"internal-error");let o=Sd(s.idToken);P(o,r,"internal-error");let{sub:a}=o;return P(n.uid===a,r,"user-mismatch"),En._forOperation(n,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&_n(r,"user-mismatch"),s}}async function FC(n,e,t=!1){let r="signIn",i=await ry(n,r,e),s=await En._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}function UC(n,e){return je(n,"POST","/v2/accounts/mfaEnrollment:start",Se(n,e))}function BC(n,e){return je(n,"POST","/v2/accounts/mfaEnrollment:finalize",Se(n,e))}function qC(n,e){return je(n,"POST","/v2/accounts/mfaEnrollment:start",Se(n,e))}function $C(n,e){return je(n,"POST","/v2/accounts/mfaEnrollment:finalize",Se(n,e))}var hc="__sak";var dc=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(hc,"1"),this.storage.removeItem(hc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};function jC(){let n=be();return Q_(n)||ey(n)}var WC=1e3,HC=10,wd=class extends dc{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=jC()&&_C(),this.fallbackToPolling=gC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(let t of Object.keys(this.listeners)){let r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}let r=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){let o=this.storage.getItem(r);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!t)return}let i=()=>{let o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);mC()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,HC):i()}notifyListeners(e,t){this.localCache[e]=t;let r=this.listeners[e];if(r)for(let i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},WC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){let t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}};wd.type="LOCAL";var Td=class extends dc{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}};Td.type="SESSION";function KC(n){return Promise.all(n.map(async e=>{try{let t=await e;return{fulfilled:!0,value:t}}catch(t){return{fulfilled:!1,reason:t}}}))}var ui=class{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){let t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;let r=new ui(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){let t=e,{eventId:r,eventType:i,data:s}=t.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});let a=Array.from(o).map(async l=>l(t.origin,s)),c=await KC(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}};ui.receivers=[];function iy(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var Id=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){let i=typeof MessageChannel!="undefined"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let l=iy("",20);i.port1.start();let u=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){let d=h;if(d.data.eventId===l)switch(d.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(d.data.response);break;default:clearTimeout(u),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}};function M_(){return window}function sy(){return typeof M_().WorkerGlobalScope!="undefined"&&typeof M_().importScripts=="function"}async function zC(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function GC(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function QC(){return sy()?self:null}var oy="firebaseLocalStorageDb",YC=1,fc="firebaseLocalStorage",ay="fbase_key",ir=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function _c(n,e){return n.transaction([fc],e?"readwrite":"readonly").objectStore(fc)}function JC(){let n=indexedDB.deleteDatabase(oy);return new ir(n).toPromise()}function bd(){let n=indexedDB.open(oy,YC);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(fc,{keyPath:ay})}catch(i){t(i)}}),n.addEventListener("success",async()=>{let r=n.result;r.objectStoreNames.contains(fc)?e(r):(r.close(),await JC(),e(await bd()))})})}async function F_(n,e,t){let r=_c(n,!0).put({[ay]:e,value:t});return new ir(r).toPromise()}async function XC(n,e){let t=_c(n,!1).get(e),r=await new ir(t).toPromise();return r===void 0?null:r.value}function U_(n,e){let t=_c(n,!0).delete(e);return new ir(t).toPromise()}var ZC=800,eR=3,Cd=class{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await bd(),this.db)}async _withRetries(e){let t=0;for(;;)try{let r=await this._openDb();return await e(r)}catch(r){if(t++>eR)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return sy()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ui._getInstance(QC()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await zC(),!this.activeServiceWorker)return;this.sender=new Id(this.activeServiceWorker);let r=await this.sender._send("ping",{},800);!r||((e=r[0])===null||e===void 0?void 0:e.fulfilled)&&((t=r[0])===null||t===void 0?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||GC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let e=await bd();return await F_(e,hc,"1"),await U_(e,hc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>F_(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){let t=await this._withRetries(r=>XC(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>U_(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){let e=await this._withRetries(i=>{let s=_c(i,!1).getAll();return new ir(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];let t=[],r=new Set;for(let{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(let i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;let r=this.listeners[e];if(r)for(let i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ZC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}};Cd.type="LOCAL";function tR(n,e){return je(n,"POST","/v2/accounts/mfaSignIn:start",Se(n,e))}function nR(n,e){return je(n,"POST","/v2/accounts/mfaSignIn:finalize",Se(n,e))}function rR(n,e){return je(n,"POST","/v2/accounts/mfaSignIn:finalize",Se(n,e))}var CL=EC("rcb"),RL=new tr(3e4,6e4);var iR="recaptcha";async function sR(n,e,t){var r;let i=await t.verify();try{P(typeof i=="string",n,"argument-error"),P(t.type===iR,n,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){let o=s.session;if("phoneNumber"in s)return P(o.type==="enroll",n,"internal-error"),(await UC(n,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{P(o.type==="signin",n,"internal-error");let a=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return P(a,n,"missing-multi-factor-info"),(await tR(n,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{let{sessionInfo:o}=await SC(n,{phoneNumber:s.phoneNumber,recaptchaToken:i});return o}}finally{t._reset()}}var zt=class{constructor(e){this.providerId=zt.PROVIDER_ID,this.auth=kd(e)}verifyPhoneNumber(e,t){return sR(this.auth,e,qe(t))}static credential(e,t){return Kt._fromVerification(e,t)}static credentialFromResult(e){let t=e;return zt.credentialFromTaggedObject(t)}static credentialFromError(e){return zt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{phoneNumber:t,temporaryProof:r}=e;return t&&r?Kt._fromTokenResponse(t,r):null}};zt.PROVIDER_ID="phone";zt.PHONE_SIGN_IN_METHOD="phone";var Gs=class extends rr{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return oi(e,this._buildIdpRequest())}_linkToIdToken(e,t){return oi(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return oi(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function oR(n){return FC(n.auth,new Gs(n),n.bypassAuthState)}function aR(n){let{auth:e,user:t}=n;return P(t,e,"internal-error"),MC(t,new Gs(n),n.bypassAuthState)}async function cR(n){let{auth:e,user:t}=n;return P(t,e,"internal-error"),LC(t,new Gs(n),n.bypassAuthState)}var Rd=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return oR;case"linkViaPopup":case"linkViaRedirect":return cR;case"reauthViaPopup":case"reauthViaRedirect":return aR;default:_n(this.auth,"internal-error")}}resolve(e){er(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){er(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var lR=new tr(2e3,1e4);var mn=class extends Rd{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,mn.currentPopupAction&&mn.currentPopupAction.cancel(),mn.currentPopupAction=this}async executeNotNull(){let e=await this.execute();return P(e,this.auth,"internal-error"),e}async onExecution(){er(this.filter.length===1,"Popup operations only handle one event");let e=iy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(si(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(si(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,mn.currentPopupAction=null}pollUserCancellation(){let e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(si(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,lR.get())};e()}};mn.currentPopupAction=null;var AL=10*60*1e3;var NL=new tr(3e4,6e4);var SL=new tr(5e3,15e3);var kL=encodeURIComponent("fac");var pc=class{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return Ot("unexpected MultiFactorSessionType")}}},Qs=class extends pc{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Qs(e)}_finalizeEnroll(e,t,r){return BC(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return nR(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},mc=class{constructor(){}static assertion(e){return Qs._fromCredential(e)}};mc.FACTOR_ID="phone";var gc=class{static assertionForEnrollment(e,t){return sr._fromSecret(e,t)}static assertionForSignIn(e,t){return sr._fromEnrollmentId(e,t)}static async generateSecret(e){var t;let r=e;P(typeof((t=r.user)===null||t===void 0?void 0:t.auth)!="undefined","internal-error");let i=await qC(r.user.auth,{idToken:r.credential,totpEnrollmentInfo:{}});return hi._fromStartTotpMfaEnrollmentResponse(i,r.user.auth)}};gc.FACTOR_ID="totp";var sr=class extends pc{constructor(e,t,r){super("totp"),this.otp=e,this.enrollmentId=t,this.secret=r}static _fromSecret(e,t){return new sr(t,void 0,e)}static _fromEnrollmentId(e,t){return new sr(t,e)}async _finalizeEnroll(e,t,r){return P(typeof this.secret!="undefined",e,"argument-error"),$C(e,{idToken:t,displayName:r,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,t){P(this.enrollmentId!==void 0&&this.otp!==void 0,e,"argument-error");let r={verificationCode:this.otp};return rR(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:r})}},hi=class{constructor(e,t,r,i,s,o,a){this.sessionInfo=o,this.auth=a,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=r,this.codeIntervalSeconds=i,this.enrollmentCompletionDeadline=s}static _fromStartTotpMfaEnrollmentResponse(e,t){return new hi(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,t)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){var r;let i=!1;return(tc(e)||tc(t))&&(i=!0),i&&(tc(e)&&(e=((r=this.auth.currentUser)===null||r===void 0?void 0:r.email)||"unknownuser"),tc(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}};function tc(n){return typeof n=="undefined"||(n==null?void 0:n.length)===0}var B_="@firebase/auth",q_="1.1.0";var Ad=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);!t||(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){P(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function uR(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function hR(n){Ve(new ae("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;P(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ty(n)},l=new vd(r,i,s,c);return bC(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Ve(new ae("auth-internal",e=>{let t=kd(e.getProvider("auth").getImmediate());return(r=>new Ad(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ce(B_,q_,uR(n)),ce(B_,q_,"esm2017")}var dR=5*60,PL=Rp("authIdTokenMaxAge")||dR;hR("Browser");function yc(n,e){let t=Object.create(null),r=n.split(",");for(let i=0;i<r.length;i++)t[r[i]]=!0;return e?i=>!!t[i.toLowerCase()]:i=>!!t[i]}var uy={};var di=()=>{},hy=()=>!1;var dy=(n,e)=>{let t=n.indexOf(e);t>-1&&n.splice(t,1)},mR=Object.prototype.hasOwnProperty,fi=(n,e)=>mR.call(n,e),Ue=Array.isArray,ar=n=>Ec(n)==="[object Map]",fy=n=>Ec(n)==="[object Set]";var Lt=n=>typeof n=="function",Pd=n=>typeof n=="string",vc=n=>typeof n=="symbol",wn=n=>n!==null&&typeof n=="object",py=n=>wn(n)&&Lt(n.then)&&Lt(n.catch),gR=Object.prototype.toString,Ec=n=>gR.call(n),Dd=n=>Ec(n).slice(8,-1),my=n=>Ec(n)==="[object Object]",wc=n=>Pd(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n;var Tc=n=>{let e=Object.create(null);return t=>e[t]||(e[t]=n(t))},_R=/-(\w)/g,yR=Tc(n=>n.replace(_R,(e,t)=>t?t.toUpperCase():"")),vR=/\B([A-Z])/g,ER=Tc(n=>n.replace(vR,"-$1").toLowerCase()),gy=Tc(n=>n.charAt(0).toUpperCase()+n.slice(1)),wR=Tc(n=>n?`on${gy(n)}`:""),cr=(n,e)=>!Object.is(n,e);var ly,xd=()=>ly||(ly=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});var TR="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly";var GM=yc(TR+",async,autofocus,autoplay,controls,default,defer,disabled,hidden,inert,loop,open,required,reversed,scoped,seamless,checked,muted,multiple,selected");var Nc;function CR(n,e=Nc){e&&e.active&&e.effects.push(n)}function Zs(){return Nc}function Ud(n){Nc&&Nc.cleanups.push(n)}var Bd=n=>{let e=new Set(n);return e.w=0,e.n=0,e},by=n=>(n.w&bn)>0,Cy=n=>(n.n&bn)>0,RR=({deps:n})=>{if(n.length)for(let e=0;e<n.length;e++)n[e].w|=bn},AR=n=>{let{deps:e}=n;if(e.length){let t=0;for(let r=0;r<e.length;r++){let i=e[r];by(i)&&!Cy(i)?i.delete(n):e[t++]=i,i.w&=~bn,i.n&=~bn}e.length=t}},Od=new WeakMap,Ys=0,bn=1,Vd=30,ht,lr=Symbol(""),Ld=Symbol(""),Js=class{constructor(e,t=null,r){this.fn=e,this.scheduler=t,this.active=!0,this.deps=[],this.parent=void 0,CR(this,r)}run(){if(!this.active)return this.fn();let e=ht,t=In;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=ht,ht=this,In=!0,bn=1<<++Ys,Ys<=Vd?RR(this):_y(this),this.fn()}finally{Ys<=Vd&&AR(this),bn=1<<--Ys,ht=this.parent,In=t,this.parent=void 0,this.deferStop&&this.stop()}}stop(){ht===this?this.deferStop=!0:this.active&&(_y(this),this.onStop&&this.onStop(),this.active=!1)}};function _y(n){let{deps:e}=n;if(e.length){for(let t=0;t<e.length;t++)e[t].delete(n);e.length=0}}var In=!0,Ry=[];function Sc(){Ry.push(In),In=!1}function kc(){let n=Ry.pop();In=n===void 0?!0:n}function We(n,e,t){if(In&&ht){let r=Od.get(n);r||Od.set(n,r=new Map);let i=r.get(t);i||r.set(t,i=Bd()),Ay(i,void 0)}}function Ay(n,e){let t=!1;Ys<=Vd?Cy(n)||(n.n|=bn,t=!by(n)):t=!n.has(ht),t&&(n.add(ht),ht.deps.push(n))}function Gt(n,e,t,r,i,s){let o=Od.get(n);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(t==="length"&&Ue(n)){let l=Number(r);o.forEach((u,h)=>{(h==="length"||h>=l)&&a.push(u)})}else switch(t!==void 0&&a.push(o.get(t)),e){case"add":Ue(n)?wc(t)&&a.push(o.get("length")):(a.push(o.get(lr)),ar(n)&&a.push(o.get(Ld)));break;case"delete":Ue(n)||(a.push(o.get(lr)),ar(n)&&a.push(o.get(Ld)));break;case"set":ar(n)&&a.push(o.get(lr));break}let c=void 0;if(a.length===1)a[0]&&Md(a[0]);else{let l=[];for(let u of a)u&&l.push(...u);Md(Bd(l))}}function Md(n,e){let t=Ue(n)?n:[...n];for(let r of t)r.computed&&yy(r,e);for(let r of t)r.computed||yy(r,e)}function yy(n,e){(n!==ht||n.allowRecurse)&&(n.scheduler?n.scheduler():n.run())}var NR=yc("__proto__,__v_isRef,__isVue"),Ny=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(vc)),SR=Sy();var kR=Sy(!0);var vy=PR();function PR(){let n={};return["includes","indexOf","lastIndexOf"].forEach(e=>{n[e]=function(...t){let r=j(this);for(let s=0,o=this.length;s<o;s++)We(r,"get",s+"");let i=r[e](...t);return i===-1||i===!1?r[e](...t.map(j)):i}}),["push","pop","shift","unshift","splice"].forEach(e=>{n[e]=function(...t){Sc();let r=j(this)[e].apply(this,t);return kc(),r}}),n}function DR(n){let e=j(this);return We(e,"has",n),e.hasOwnProperty(n)}function Sy(n=!1,e=!1){return function(r,i,s){if(i==="__v_isReactive")return!n;if(i==="__v_isReadonly")return n;if(i==="__v_isShallow")return e;if(i==="__v_raw"&&s===(n?e?GR:Dy:e?zR:Py).get(r))return r;let o=Ue(r);if(!n){if(o&&fi(vy,i))return Reflect.get(vy,i,s);if(i==="hasOwnProperty")return DR}let a=Reflect.get(r,i,s);return(vc(i)?Ny.has(i):NR(i))||(n||We(r,"get",i),e)?a:Me(a)?o&&wc(i)?a:a.value:wn(a)?n?$d(a):Dc(a):a}}var xR=OR();function OR(n=!1){return function(t,r,i,s){let o=t[r];if(ur(o)&&Me(o)&&!Me(i))return!1;if(!n&&(!mi(i)&&!ur(i)&&(o=j(o),i=j(i)),!Ue(t)&&Me(o)&&!Me(i)))return o.value=i,!0;let a=Ue(t)&&wc(r)?Number(r)<t.length:fi(t,r),c=Reflect.set(t,r,i,s);return t===j(s)&&(a?cr(i,o)&&Gt(t,"set",r,i,o):Gt(t,"add",r,i)),c}}function VR(n,e){let t=fi(n,e),r=n[e],i=Reflect.deleteProperty(n,e);return i&&t&&Gt(n,"delete",e,void 0,r),i}function LR(n,e){let t=Reflect.has(n,e);return(!vc(e)||!Ny.has(e))&&We(n,"has",e),t}function MR(n){return We(n,"iterate",Ue(n)?"length":lr),Reflect.ownKeys(n)}var FR={get:SR,set:xR,deleteProperty:VR,has:LR,ownKeys:MR},UR={get:kR,set(n,e){return!0},deleteProperty(n,e){return!0}};var qd=n=>n,Pc=n=>Reflect.getPrototypeOf(n);function Ic(n,e,t=!1,r=!1){n=n.__v_raw;let i=j(n),s=j(e);t||(e!==s&&We(i,"get",e),We(i,"get",s));let{has:o}=Pc(i),a=r?qd:t?jd:Xs;if(o.call(i,e))return a(n.get(e));if(o.call(i,s))return a(n.get(s));n!==i&&n.get(e)}function bc(n,e=!1){let t=this.__v_raw,r=j(t),i=j(n);return e||(n!==i&&We(r,"has",n),We(r,"has",i)),n===i?t.has(n):t.has(n)||t.has(i)}function Cc(n,e=!1){return n=n.__v_raw,!e&&We(j(n),"iterate",lr),Reflect.get(n,"size",n)}function Ey(n){n=j(n);let e=j(this);return Pc(e).has.call(e,n)||(e.add(n),Gt(e,"add",n,n)),this}function wy(n,e){e=j(e);let t=j(this),{has:r,get:i}=Pc(t),s=r.call(t,n);s||(n=j(n),s=r.call(t,n));let o=i.call(t,n);return t.set(n,e),s?cr(e,o)&&Gt(t,"set",n,e,o):Gt(t,"add",n,e),this}function Ty(n){let e=j(this),{has:t,get:r}=Pc(e),i=t.call(e,n);i||(n=j(n),i=t.call(e,n));let s=r?r.call(e,n):void 0,o=e.delete(n);return i&&Gt(e,"delete",n,void 0,s),o}function Iy(){let n=j(this),e=n.size!==0,t=void 0,r=n.clear();return e&&Gt(n,"clear",void 0,void 0,t),r}function Rc(n,e){return function(r,i){let s=this,o=s.__v_raw,a=j(o),c=e?qd:n?jd:Xs;return!n&&We(a,"iterate",lr),o.forEach((l,u)=>r.call(i,c(l),c(u),s))}}function Ac(n,e,t){return function(...r){let i=this.__v_raw,s=j(i),o=ar(s),a=n==="entries"||n===Symbol.iterator&&o,c=n==="keys"&&o,l=i[n](...r),u=t?qd:e?jd:Xs;return!e&&We(s,"iterate",c?Ld:lr),{next(){let{value:h,done:d}=l.next();return d?{value:h,done:d}:{value:a?[u(h[0]),u(h[1])]:u(h),done:d}},[Symbol.iterator](){return this}}}}function Tn(n){return function(...e){return n==="delete"?!1:this}}function BR(){let n={get(s){return Ic(this,s)},get size(){return Cc(this)},has:bc,add:Ey,set:wy,delete:Ty,clear:Iy,forEach:Rc(!1,!1)},e={get(s){return Ic(this,s,!1,!0)},get size(){return Cc(this)},has:bc,add:Ey,set:wy,delete:Ty,clear:Iy,forEach:Rc(!1,!0)},t={get(s){return Ic(this,s,!0)},get size(){return Cc(this,!0)},has(s){return bc.call(this,s,!0)},add:Tn("add"),set:Tn("set"),delete:Tn("delete"),clear:Tn("clear"),forEach:Rc(!0,!1)},r={get(s){return Ic(this,s,!0,!0)},get size(){return Cc(this,!0)},has(s){return bc.call(this,s,!0)},add:Tn("add"),set:Tn("set"),delete:Tn("delete"),clear:Tn("clear"),forEach:Rc(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{n[s]=Ac(s,!1,!1),t[s]=Ac(s,!0,!1),e[s]=Ac(s,!1,!0),r[s]=Ac(s,!0,!0)}),[n,t,e,r]}var[qR,$R,jR,WR]=BR();function ky(n,e){let t=e?n?WR:jR:n?$R:qR;return(r,i,s)=>i==="__v_isReactive"?!n:i==="__v_isReadonly"?n:i==="__v_raw"?r:Reflect.get(fi(t,i)&&i in r?t:r,i,s)}var HR={get:ky(!1,!1)};var KR={get:ky(!0,!1)};var Py=new WeakMap,zR=new WeakMap,Dy=new WeakMap,GR=new WeakMap;function QR(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function YR(n){return n.__v_skip||!Object.isExtensible(n)?0:QR(Dd(n))}function Dc(n){return ur(n)?n:xy(n,!1,FR,HR,Py)}function $d(n){return xy(n,!0,UR,KR,Dy)}function xy(n,e,t,r,i){if(!wn(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;let s=i.get(n);if(s)return s;let o=YR(n);if(o===0)return n;let a=new Proxy(n,o===2?r:t);return i.set(n,a),a}function pi(n){return ur(n)?pi(n.__v_raw):!!(n&&n.__v_isReactive)}function ur(n){return!!(n&&n.__v_isReadonly)}function mi(n){return!!(n&&n.__v_isShallow)}function j(n){let e=n&&n.__v_raw;return e?j(e):n}var Xs=n=>wn(n)?Dc(n):n,jd=n=>wn(n)?$d(n):n;function JR(n){In&&ht&&(n=j(n),Ay(n.dep||(n.dep=Bd())))}function XR(n,e){n=j(n);let t=n.dep;t&&Md(t)}function Me(n){return!!(n&&n.__v_isRef===!0)}function Qt(n){return Oy(n,!1)}function Wd(n){return Oy(n,!0)}function Oy(n,e){return Me(n)?n:new Fd(n,e)}var Fd=class{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:j(e),this._value=t?e:Xs(e)}get value(){return JR(this),this._value}set value(e){let t=this.__v_isShallow||mi(e)||ur(e);e=t?e:j(e),cr(e,this._rawValue)&&(this._rawValue=e,this._value=t?e:Xs(e),XR(this,e))}};function dt(n){return Me(n)?n.value:n}var eo=[];function sA(n,...e){}function oA(){let n=eo[eo.length-1];if(!n)return[];let e=[];for(;n;){let t=e[0];t&&t.vnode===n?t.recurseCount++:e.push({vnode:n,recurseCount:0});let r=n.component&&n.component.parent;n=r&&r.vnode}return e}function aA(n){let e=[];return n.forEach((t,r)=>{e.push(...r===0?[]:[`
`],...cA(t))}),e}function cA({vnode:n,recurseCount:e}){let t=e>0?`... (${e} recursive calls)`:"",r=n.component?n.component.parent==null:!1,i=` at <${Gy(n.component,n.type,r)}`,s=">"+t;return n.props?[i,...lA(n.props),s]:[i+s]}function lA(n){let e=[],t=Object.keys(n);return t.slice(0,3).forEach(r=>{e.push(...Uy(r,n[r]))}),t.length>3&&e.push(" ..."),e}function Uy(n,e,t){return Pd(e)?(e=JSON.stringify(e),t?e:[`${n}=${e}`]):typeof e=="number"||typeof e=="boolean"||e==null?t?e:[`${n}=${e}`]:Me(e)?(e=Uy(n,j(e.value),!0),t?e:[`${n}=Ref<`,e,">"]):Lt(e)?[`${n}=fn${e.name?`<${e.name}>`:""}`]:(e=j(e),t?e:[`${n}=`,e])}function dr(n,e,t,r){let i;try{i=r?n(...r):n()}catch(s){By(s,e,t)}return i}function to(n,e,t,r){if(Lt(n)){let s=dr(n,e,t,r);return s&&py(s)&&s.catch(o=>{By(o,e,t)}),s}let i=[];for(let s=0;s<n.length;s++)i.push(to(n[s],e,t,r));return i}function By(n,e,t,r=!0){let i=e?e.vnode:null;if(e){let s=e.parent,o=e.proxy,a=t;for(;s;){let l=s.ec;if(l){for(let u=0;u<l.length;u++)if(l[u](n,o,a)===!1)return}s=s.parent}let c=e.appContext.config.errorHandler;if(c){dr(c,null,10,[n,o,a]);return}}uA(n,t,i,r)}function uA(n,e,t,r=!0){console.error(n)}var Oc=!1,Hd=!1,ft=[],Cn=0,yi=[],Yt=null,hr=0,hA=Promise.resolve(),qy=null;function dA(n){let e=Cn+1,t=ft.length;for(;e<t;){let r=e+t>>>1;no(ft[r])<n?e=r+1:t=r}return e}function fA(n){(!ft.length||!ft.includes(n,Oc&&n.allowRecurse?Cn+1:Cn))&&(n.id==null?ft.push(n):ft.splice(dA(n.id),0,n),$y())}function $y(){!Oc&&!Hd&&(Hd=!0,qy=hA.then(jy))}function pA(n){Ue(n)?yi.push(...n):(!Yt||!Yt.includes(n,n.allowRecurse?hr+1:hr))&&yi.push(n),$y()}function mA(n){if(yi.length){let e=[...new Set(yi)];if(yi.length=0,Yt){Yt.push(...e);return}for(Yt=e,Yt.sort((t,r)=>no(t)-no(r)),hr=0;hr<Yt.length;hr++)Yt[hr]();Yt=null,hr=0}}var no=n=>n.id==null?1/0:n.id,gA=(n,e)=>{let t=no(n)-no(e);if(t===0){if(n.pre&&!e.pre)return-1;if(e.pre&&!n.pre)return 1}return t};function jy(n){Hd=!1,Oc=!0,ft.sort(gA);let e=di;try{for(Cn=0;Cn<ft.length;Cn++){let t=ft[Cn];t&&t.active!==!1&&dr(t,null,14)}}finally{Cn=0,ft.length=0,mA(n),Oc=!1,qy=null,(ft.length||yi.length)&&jy(n)}}var Wy=null;function _A(n,e){e&&e.pendingBranch?Ue(n)?e.effects.push(...n):e.effects.push(n):pA(n)}var xc={};function Hy(n,e,t){return yA(n,e,t)}function yA(n,e,{immediate:t,deep:r,flush:i,onTrack:s,onTrigger:o}=uy){var a;let c=N=>{sA("Invalid watch source: ",N,"A watch source can only be a getter/effect function, a ref, a reactive object, or an array of these types.")},l=Zs()===((a=Jt)==null?void 0:a.scope)?Jt:null,u,h=!1,d=!1;if(Me(n)?(u=()=>n.value,h=mi(n)):pi(n)?(u=()=>n,r=!0):Ue(n)?(d=!0,h=n.some(N=>pi(N)||mi(N)),u=()=>n.map(N=>{if(Me(N))return N.value;if(pi(N))return _i(N);if(Lt(N))return dr(N,l,2)})):Lt(n)?e?u=()=>dr(n,l,2):u=()=>{if(!(l&&l.isUnmounted))return f&&f(),to(n,l,3,[p])}:u=di,e&&r){let N=u;u=()=>_i(N())}let f,p=N=>{f=T.onStop=()=>{dr(N,l,4)}},y;if(zy)if(p=di,e?t&&to(e,l,3,[u(),d?[]:void 0,p]):u(),i==="sync"){let N=AA();y=N.__watcherHandles||(N.__watcherHandles=[])}else return di;let m=d?new Array(n.length).fill(xc):xc,b=()=>{if(!!T.active)if(e){let N=T.run();(r||h||(d?N.some((B,he)=>cr(B,m[he])):cr(N,m)))&&(f&&f(),to(e,l,3,[N,m===xc?void 0:d&&m[0]===xc?[]:m,p]),m=N)}else T.run()};b.allowRecurse=!!e;let x;i==="sync"?x=b:i==="post"?x=()=>Ly(b,l&&l.suspense):(b.pre=!0,l&&(b.id=l.uid),x=()=>fA(b));let T=new Js(u,x);e?t?b():m=T.run():i==="post"?Ly(T.run.bind(T),l&&l.suspense):T.run();let R=()=>{T.stop(),l&&l.scope&&dy(l.scope.effects,T)};return y&&y.push(R),R}function _i(n,e){if(!wn(n)||n.__v_skip||(e=e||new Set,e.has(n)))return n;if(e.add(n),Me(n))_i(n.value,e);else if(Ue(n))for(let t=0;t<n.length;t++)_i(n[t],e);else if(fy(n)||ar(n))n.forEach(t=>{_i(t,e)});else if(my(n))for(let t in n)_i(n[t],e);return n}function vA(n,e,t=Jt,r=!1){if(t){let i=t[n]||(t[n]=[]),s=e.__weh||(e.__weh=(...o)=>{if(t.isUnmounted)return;Sc(),wA(t);let a=to(e,t,n,o);return TA(),kc(),a});return r?i.unshift(s):i.push(s),s}}var Xt=n=>(e,t=Jt)=>(!zy||n==="sp")&&vA(n,(...r)=>e(...r),t),T1=Xt("bm"),I1=Xt("m"),b1=Xt("bu"),C1=Xt("u"),R1=Xt("bum"),A1=Xt("um"),Ky=Xt("sp"),N1=Xt("rtg"),S1=Xt("rtc");var k1=Symbol.for("v-ndc");function EA(){return{app:null,config:{isNativeTag:hy,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}var Vy=null;function Vc(n,e,t=!1){let r=Jt||Wy;if(r||Vy){let i=r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:Vy._context.provides;if(i&&n in i)return i[n];if(arguments.length>1)return t&&Lt(e)?e.call(r&&r.proxy):e}}var Ly=_A;var P1=Symbol.for("v-fgt"),D1=Symbol.for("v-txt"),x1=Symbol.for("v-cmt"),O1=Symbol.for("v-stc");var V1=EA();var Jt=null,ro=()=>Jt||Wy,Kd,gi,My="__VUE_INSTANCE_SETTERS__";(gi=xd()[My])||(gi=xd()[My]=[]),gi.push(n=>Jt=n),Kd=n=>{gi.length>1?gi.forEach(e=>e(n)):gi[0](n)};var wA=n=>{Kd(n),n.scope.on()},TA=()=>{Jt&&Jt.scope.off(),Kd(null)};var zy=!1;var IA=/(?:^|[-_])(\w)/g,bA=n=>n.replace(IA,e=>e.toUpperCase()).replace(/[-_]/g,"");function CA(n,e=!0){return Lt(n)?n.displayName||n.name:n.name||e&&n.__name}function Gy(n,e,t=!1){let r=CA(e);if(!r&&e.__file){let i=e.__file.match(/([^/\\]+)\.\w+$/);i&&(r=i[1])}if(!r&&n&&n.parent){let i=s=>{for(let o in s)if(s[o]===e)return o};r=i(n.components||n.parent.type.components)||i(n.appContext.components)}return r?bA(r):t?"App":"Anonymous"}var RA=Symbol.for("v-scx"),AA=()=>{{let n=Vc(RA);return n}};var Qy=!1;var SA=new Map,kA={activated:!1,tokenObservers:[]},PA={initialized:!1,enabled:!1};function pt(n){return SA.get(n)||Object.assign({},kA)}function ev(){return PA}var DA="https://content-firebaseappcheck.googleapis.com/v1";var xA="exchangeDebugToken",Yy={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},G1=24*60*60*1e3;var Gd=class{constructor(e,t,r,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new Et,await OA(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new Et,await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function OA(n){return new Promise(e=>{setTimeout(e,n)})}var VA={["already-initialized"]:"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.",["use-before-activation"]:"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.",["fetch-network-error"]:"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",["fetch-parse-error"]:"Fetch client could not parse response. Original error: {$originalErrorMessage}.",["fetch-status-error"]:"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["recaptcha-error"]:"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Rn=new it("appCheck","AppCheck",VA);function tv(n){if(!pt(n).activated)throw Rn.create("use-before-activation",{appName:n.name})}async function nv({url:n,body:e},t){let r={"Content-Type":"application/json"},i=t.getImmediate({optional:!0});if(i){let h=await i.getHeartbeatsHeader();h&&(r["X-Firebase-Client"]=h)}let s={method:"POST",body:JSON.stringify(e),headers:r},o;try{o=await fetch(n,s)}catch(h){throw Rn.create("fetch-network-error",{originalErrorMessage:h==null?void 0:h.message})}if(o.status!==200)throw Rn.create("fetch-status-error",{httpStatus:o.status});let a;try{a=await o.json()}catch(h){throw Rn.create("fetch-parse-error",{originalErrorMessage:h==null?void 0:h.message})}let c=a.ttl.match(/^([\d.]+)(s)$/);if(!c||!c[2]||isNaN(Number(c[1])))throw Rn.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${a.ttl}`});let l=Number(c[1])*1e3,u=Date.now();return{token:a.token,expireTimeMillis:u+l,issuedAtTimeMillis:u}}function rv(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${DA}/projects/${t}/apps/${r}:${xA}?key=${i}`,body:{debug_token:e}}}var LA="firebase-app-check-database",MA=1,Qd="firebase-app-check-store";var Lc=null;function FA(){return Lc||(Lc=new Promise((n,e)=>{try{let t=indexedDB.open(LA,MA);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(Rn.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Qd,{keyPath:"compositeKey"})}}}catch(t){e(Rn.create("storage-open",{originalErrorMessage:t==null?void 0:t.message}))}}),Lc)}function UA(n,e){return BA(qA(n),e)}async function BA(n,e){let r=(await FA()).transaction(Qd,"readwrite"),s=r.objectStore(Qd).put({compositeKey:n,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},r.onerror=c=>{var l;a(Rn.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})}function qA(n){return`${n.options.appId}-${n.name}`}var Yd=new Ye("@firebase/app-check");function zd(n,e){return Ki()?UA(n,e).catch(t=>{Yd.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function iv(){return ev().enabled}async function sv(){let n=ev();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)}var $A={error:"UNKNOWN_ERROR"};function jA(n){return Rr.encodeString(JSON.stringify(n),!1)}async function Jd(n,e=!1){let t=n.app;tv(t);let r=pt(t),i=r.token,s;if(i&&!io(i)&&(r.token=void 0,i=void 0),!i){let c=await r.cachedTokenPromise;c&&(io(c)?i=c:await zd(t,void 0))}if(!e&&i&&io(i))return{token:i.token};let o=!1;if(iv()){r.exchangeTokenPromise||(r.exchangeTokenPromise=nv(rv(t,await sv()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let c=await r.exchangeTokenPromise;return await zd(t,c),r.token=c,{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=await pt(t).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?Yd.warn(c.message):Yd.error(c),s=c}let a;return i?s?io(i)?a={token:i.token,internalError:s}:a=Xy(s):(a={token:i.token},r.token=i,await zd(t,i)):a=Xy(s),o&&zA(t,a),a}async function WA(n){let e=n.app;tv(e);let{provider:t}=pt(e);if(iv()){let r=await sv(),{token:i}=await nv(rv(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=await t.getToken();return{token:r}}}function HA(n,e,t,r){let{app:i}=n,s=pt(i),o={next:t,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&io(s.token)){let a=s.token;Promise.resolve().then(()=>{t({token:a.token}),Jy(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>Jy(n))}function ov(n,e){let t=pt(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function Jy(n){let{app:e}=n,t=pt(e),r=t.tokenRefresher;r||(r=KA(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function KA(n){let{app:e}=n;return new Gd(async()=>{let t=pt(e),r;if(t.token?r=await Jd(n,!0):r=await Jd(n),r.error)throw r.error;if(r.internalError)throw r.internalError},()=>!0,()=>{let t=pt(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},Yy.RETRIAL_MIN_WAIT,Yy.RETRIAL_MAX_WAIT)}function zA(n,e){let t=pt(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function io(n){return n.expireTimeMillis-Date.now()>0}function Xy(n){return{token:jA($A),error:n}}var Xd=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=pt(this.app);for(let t of e)ov(this.app,t.next);return Promise.resolve()}};function GA(n,e){return new Xd(n,e)}function QA(n){return{getToken:e=>Jd(n,e),getLimitedUseToken:()=>WA(n),addTokenListener:e=>HA(n,"INTERNAL",e),removeTokenListener:e=>ov(n.app,e)}}var YA="@firebase/app-check",JA="0.8.0";var XA="app-check",Zy="app-check-internal";function ZA(){Ve(new ae(XA,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return GA(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(Zy).initialize()})),Ve(new ae(Zy,n=>{let e=n.getProvider("app-check").getImmediate();return QA(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),ce(YA,JA)}ZA();var av=Symbol("firebaseApp");function Zd(n){return ro()&&Vc(av,null)||tn(n)}var mt=()=>{};function Mc(n,e){return e.split(".").reduce((t,r)=>t&&t[r],n)}function cv(n,e,t){let r=(""+e).split("."),i=r.pop(),s=r.reduce((o,a)=>o&&o[a],n);if(s!=null)return Array.isArray(s)?s.splice(Number(i),1,t):s[i]=t}function An(n){return!!n&&typeof n=="object"}var tN=Object.prototype;function lv(n){return An(n)&&Object.getPrototypeOf(n)===tN}function Fc(n){return An(n)&&n.type==="document"}function ef(n){return An(n)&&n.type==="collection"}function uv(n){return Fc(n)||ef(n)}function hv(n){return An(n)&&n.type==="query"}function dv(n){return An(n)&&"ref"in n}function fv(n){return An(n)&&typeof n.bucket=="string"}function pv(n,e){let t;return()=>{if(!t)return t=!0,n(e())}}var nN=Symbol.for("v-scx");function mv(){let n=ro();return!!(Qy?n&&n.proxy.$isServer:Vc(nN,0))}var iF=Symbol("app-check-token");var gv="@firebase/database",_v="1.0.1";var Hf="";function rN(n){Hf=n}var lf=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),de(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Cr(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var uf=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Tt(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var Yv=function(n){try{if(typeof window!="undefined"&&typeof window[n]!="undefined"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new lf(e)}}catch{}return new uf},pr=Yv("localStorage"),hf=Yv("sessionStorage");var Ti=new Ye("@firebase/database"),iN=function(){let n=1;return function(){return n++}}(),Jv=function(n){let e=Vp(n),t=new Mo;t.update(e);let r=t.digest();return Rr.encodeByteArray(r)},Io=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Io.apply(null,r):typeof r=="object"?e+=de(r):e+=r,e+=" "}return e},mr=null,yv=!0,sN=function(n,e){v(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Ti.logLevel=O.VERBOSE,mr=Ti.log.bind(Ti),e&&hf.set("logging_enabled",!0)):typeof n=="function"?mr=n:(mr=null,hf.remove("logging_enabled"))},ke=function(...n){if(yv===!0&&(yv=!1,mr===null&&hf.get("logging_enabled")===!0&&sN(!0)),mr){let e=Io.apply(null,n);mr(e)}},bo=function(n){return function(...e){ke(n,...e)}},df=function(...n){let e="FIREBASE INTERNAL ERROR: "+Io(...n);Ti.error(e)},gr=function(...n){let e=`FIREBASE FATAL ERROR: ${Io(...n)}`;throw Ti.error(e),new Error(e)},Ke=function(...n){let e="FIREBASE WARNING: "+Io(...n);Ti.warn(e)},oN=function(){typeof window!="undefined"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Ke("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Xv=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},aN=function(n){if(wt()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},bi="[MIN_NAME]",_r="[MAX_NAME]",ki=function(n,e){if(n===e)return 0;if(n===bi||e===_r)return-1;if(e===bi||n===_r)return 1;{let t=vv(n),r=vv(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},cN=function(n,e){return n===e?0:n<e?-1:1},so=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+de(e))},Kf=function(n){if(typeof n!="object"||n===null)return de(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=de(e[r]),t+=":",t+=Kf(n[e[r]]);return t+="}",t},Zv=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function tt(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var eE=function(n){v(!Xv(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,s,o,a,c;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));let l=[];for(c=t;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();let u=l.join(""),h="";for(c=0;c<64;c+=8){let d=parseInt(u.substr(c,8),2).toString(16);d.length===1&&(d="0"+d),h=h+d}return h.toLowerCase()},lN=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},uN=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};var hN=new RegExp("^-?(0*)\\d{1,10}$"),dN=-2147483648,fN=2147483647,vv=function(n){if(hN.test(n)){let e=Number(n);if(e>=dN&&e<=fN)return e}return null},Co=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw Ke("Exception was thrown by user callback.",t),e},Math.floor(0))}},pN=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},lo=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno!="undefined"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var ff=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Ke(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var pf=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(ke("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ke(e)}},fo=class{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}};fo.OWNER="owner";var Bc="5",tE="v",nE="s",rE="r",iE="f",sE=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,oE="ls",aE="p",mf="ac",cE="websocket",lE="long_polling";var gf=class{constructor(e,t,r,i,s=!1,o="",a=!1,c=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=pr.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&pr.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function mN(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function uE(n,e,t){v(typeof e=="string","typeof type must == string"),v(typeof t=="object","typeof params must == object");let r;if(e===cE)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===lE)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);mN(n)&&(t.ns=n.namespace);let i=[];return tt(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var _f=class{constructor(){this.counters_={}}incrementCounter(e,t=1){Tt(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Tp(this.counters_)}};var tf={},nf={};function zf(n){let e=n.toString();return tf[e]||(tf[e]=new _f),tf[e]}function gN(n,e){let t=n.toString();return nf[t]||(nf[t]=e()),nf[t]}var yf=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Co(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var Ev="start",_N="close",yN="pLPCommand",vN="pRTLPCB",hE="id",dE="pw",fE="ser",EN="cb",wN="seg",TN="ts",IN="d",bN="dframe",pE=1870,mE=30,CN=pE-mE,RN=25e3,AN=3e4,Nn=class{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=bo(e),this.stats_=zf(t),this.urlFn=c=>(this.appCheckToken&&(c[mf]=this.appCheckToken),uE(t,lE,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new yf(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(AN)),aN(()=>{if(this.isClosed_)return;this.scriptTagHolder=new po((...s)=>{let[o,a,c,l,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===Ev)this.id=a,this.password=c;else if(o===_N)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[Ev]="t",r[fE]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[EN]=this.scriptTagHolder.uniqueCallbackIdentifier),r[tE]=Bc,this.transportSessionId&&(r[nE]=this.transportSessionId),this.lastSessionId&&(r[oE]=this.lastSessionId),this.applicationId&&(r[aE]=this.applicationId),this.appCheckToken&&(r[mf]=this.appCheckToken),typeof location!="undefined"&&location.hostname&&sE.test(location.hostname)&&(r[rE]=iE);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Nn.forceAllow_=!0}static forceDisallow(){Nn.forceDisallow_=!0}static isAvailable(){return wt()?!1:Nn.forceAllow_?!0:!Nn.forceDisallow_&&typeof document!="undefined"&&document.createElement!=null&&!lN()&&!uN()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=de(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=El(t),i=Zv(r,CN);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(wt())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[bN]="t",r[hE]=e,r[dE]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=de(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},po=class{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,wt())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=iN(),window[yN+this.uniqueCallbackIdentifier]=e,window[vN+this.uniqueCallbackIdentifier]=t,this.myIFrame=po.createIFrame_();let s="";if(this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"){let a=document.domain;s='<script>document.domain="'+a+'";<\/script>'}let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){ke("frame writing exception"),a.stack&&ke(a.stack),ke(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||ke("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[hE]=this.myID,e[dE]=this.myPW,e[fE]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+mE+r.length<=pE;){let o=this.pendingSegs.shift();r=r+"&"+wN+i+"="+o.seg+"&"+TN+i+"="+o.ts+"&"+IN+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(RN)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){wt()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{ke("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var NN=16384,SN=45e3,qc=null;typeof MozWebSocket!="undefined"?qc=MozWebSocket:typeof WebSocket!="undefined"&&(qc=WebSocket);var He=class{constructor(e,t,r,i,s,o,a){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=bo(this.connId),this.stats_=zf(t),this.connURL=He.connectionURL_(t,o,a,i,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,r,i,s){let o={};return o[tE]=Bc,!wt()&&typeof location!="undefined"&&location.hostname&&sE.test(location.hostname)&&(o[rE]=iE),t&&(o[nE]=t),r&&(o[oE]=r),i&&(o[mf]=i),s&&(o[aE]=s),uE(e,cE,o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,pr.set("previous_websocket_failure",!0);try{let r;if(wt()){let i=this.nodeAdmin?"AdminNode":"Node";r={headers:{"User-Agent":`Firebase/${Bc}/${Hf}/${process.platform}/${i}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);let s=process.env,o=this.connURL.indexOf("wss://")===0?s.HTTPS_PROXY||s.https_proxy:s.HTTP_PROXY||s.http_proxy;o&&(r.proxy={origin:o})}this.mySock=new qc(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");let i=r.message||r.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");let i=r.message||r.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){He.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator!="undefined"&&navigator.userAgent){let t=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(t);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&qc!==null&&!He.forceDisallow_}static previouslyFailed(){return pr.isInMemoryStorage||pr.get("previous_websocket_failure")===!0}markConnectionHealthy(){pr.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){let t=this.frames.join("");this.frames=null;let r=Cr(t);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(v(this.frames===null,"We already have a frame buffer"),e.length<=6){let t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;let t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{let r=this.extractFrameCount_(t);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();let t=de(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=Zv(t,NN);r.length>1&&this.sendString_(String(r.length));for(let i=0;i<r.length;i++)this.sendString_(r[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(SN))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}};He.responsesRequiredToBeHealthy=2;He.healthyTimeout=3e4;var yr=class{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Nn,He]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){let t=He&&He.isAvailable(),r=t&&!He.previouslyFailed();if(e.webSocketOnly&&(t||Ke("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[He];else{let i=this.transports_=[];for(let s of yr.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);yr.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}};yr.globalTransportInitialized_=!1;var kN=6e4,PN=5e3,DN=10*1024,xN=100*1024,rf="t",wv="d",ON="s",Tv="r",VN="e",Iv="o",bv="a",Cv="n",Rv="p",LN="h",vf=class{constructor(e,t,r,i,s,o,a,c,l,u){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=bo("c:"+this.id+":"),this.transportManager_=new yr(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=lo(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>xN?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>DN?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(rf in e){let t=e[rf];t===bv?this.upgradeIfSecondaryHealthy_():t===Tv?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===Iv&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=so("t",e),r=so("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Rv,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:bv,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Cv,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=so("t",e),r=so("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=so(rf,e);if(wv in e){let r=e[wv];if(t===LN){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===Cv){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===ON?this.onConnectionShutdown_(r):t===Tv?this.onReset_(r):t===VN?df("Server Error: "+r):t===Iv?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):df("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Bc!==r&&Ke("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),lo(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(kN))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):lo(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(PN))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Rv,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(pr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var $c=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var jc=class{constructor(e){this.allowedEvents_=e,this.listeners_={},v(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){v(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var Ci=class extends jc{constructor(){super(["online"]),this.online_=!0,typeof window!="undefined"&&typeof window.addEventListener!="undefined"&&!Hi()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Ci}getInitialEvent(e){return v(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var Av=32,Nv=768,G=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function K(){return new G("")}function F(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function kn(n){return n.pieces_.length-n.pieceNum_}function J(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new G(n.pieces_,e)}function gE(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function MN(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function _E(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function yE(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new G(e,0)}function Ee(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof G)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new G(t,0)}function L(n){return n.pieceNum_>=n.pieces_.length}function et(n,e){let t=F(n),r=F(e);if(t===null)return e;if(t===r)return et(J(n),J(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function vE(n,e){if(kn(n)!==kn(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function gt(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(kn(n)>kn(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var Ef=class{constructor(e,t){this.errorPrefix_=t,this.parts_=_E(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Gi(this.parts_[r]);EE(this)}};function FN(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Gi(e),EE(n)}function UN(n){let e=n.parts_.pop();n.byteLength_-=Gi(e),n.parts_.length>0&&(n.byteLength_-=1)}function EE(n){if(n.byteLength_>Nv)throw new Error(n.errorPrefix_+"has a key path longer than "+Nv+" bytes ("+n.byteLength_+").");if(n.parts_.length>Av)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Av+") or object contains a cycle "+fr(n))}function fr(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var mo=class extends jc{constructor(){super(["visible"]);let e,t;typeof document!="undefined"&&typeof document.addEventListener!="undefined"&&(typeof document.hidden!="undefined"?(t="visibilitychange",e="hidden"):typeof document.mozHidden!="undefined"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden!="undefined"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden!="undefined"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new mo}getInitialEvent(e){return v(e==="visible","Unknown event type: "+e),[this.visible_]}};var oo=1e3,BN=60*5*1e3,Sv=30*1e3,qN=1.3,$N=3e4,jN="server_kill",kv=3,yt=class extends $c{constructor(e,t,r,i,s,o,a,c){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=r,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=c,this.id=yt.nextPersistentConnectionId_++,this.log_=bo("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=oo,this.maxReconnectDelay_=BN,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!wt())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");mo.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Ci.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,r){let i=++this.requestNumber_,s={r:i,a:e,b:t};this.log_(de(s)),v(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();let t=new Et,r={p:e._path.toString(),q:e._queryObject},i={action:"g",request:r,onComplete:o=>{let a=o.d;o.s==="ok"?t.resolve(a):t.reject(a)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;let s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),t.promise}listen(e,t,r,i){this.initConnection_();let s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),v(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),v(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");let a={onComplete:i,hashFn:t,query:e,tag:r};this.listens.get(o).set(s,a),this.connected_&&this.sendListen_(a)}sendGet_(e){let t=this.outstandingGets_[e];this.sendRequest("g",t.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(r)})}sendListen_(e){let t=e.query,r=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+r+" for "+i);let s={p:r},o="q";e.tag&&(s.q=t._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(o,s,a=>{let c=a.d,l=a.s;yt.warnOnListenWarnings_(c,t),(this.listens.get(r)&&this.listens.get(r).get(i))===e&&(this.log_("listen response",a),l!=="ok"&&this.removeListen_(r,i),e.onComplete&&e.onComplete(l,c))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&Tt(e,"w")){let r=On(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){let i='".indexOn": "'+t._queryParams.getIndex().toString()+'"',s=t._path.toString();Ke(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||Dp(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Sv)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let e=this.authToken_,t=Pp(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(t,r,i=>{let s=i.s,o=i.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{let t=e.s,r=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,r)})}unlisten(e,t){let r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),v(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,t)}sendUnlisten_(e,t,r,i){this.log_("Unlisten on "+e+" for "+t);let s={p:e},o="n";i&&(s.q=r,s.t=i),this.sendRequest(o,s)}onDisconnectPut(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:r})}onDisconnectMerge(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:r})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,r,i){let s={p:t,d:r};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,t,r,i){this.putInternal("p",e,t,r,i)}merge(e,t,r,i){this.putInternal("m",e,t,r,i)}putInternal(e,t,r,i,s){this.initConnection_();let o={p:t,d:r};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;let a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)}sendPut_(e){let t=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,r,s=>{this.log_(t+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(e){if(this.connected_){let t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,r=>{if(r.s!=="ok"){let s=r.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+de(e));let t=e.r,r=this.requestCBHash_[t];r&&(delete this.requestCBHash_[t],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):df("Unrecognized action received from server: "+de(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){v(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=oo,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=oo,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>$N&&(this.reconnectDelay_=oo),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let e=new Date().getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*qN)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+yt.nextConnectionId_++,s=this.lastSessionId,o=!1,a=null,c=function(){a?a.close():(o=!0,r())},l=function(h){v(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(h)};this.realtime_={close:c,sendRequest:l};let u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,d]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?ke("getToken() completed but was canceled"):(ke("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=d&&d.token,a=new vf(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,r,f=>{Ke(f+" ("+this.repoInfo_.toString()+")"),this.interrupt(jN)},s))}catch(h){this.log_("Failed to get token: "+h),o||(this.repoInfo_.nodeAdmin&&Ke(h),c())}}}interrupt(e){ke("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){ke("Resuming connection for reason: "+e),delete this.interruptReasons_[e],qo(this.interruptReasons_)&&(this.reconnectDelay_=oo,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){let t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){let t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let r;t?r=t.map(s=>Kf(s)).join("$"):r="default";let i=this.removeListen_(e,r);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){let r=new G(e).toString(),i;if(this.listens.has(r)){let s=this.listens.get(r);i=s.get(t),s.delete(t),s.size===0&&this.listens.delete(r)}else i=void 0;return i}onAuthRevoked_(e,t){ke("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=kv&&(this.reconnectDelay_=Sv,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){ke("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=kv&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let e of this.listens.values())for(let t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){let e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){let e={},t="js";wt()&&(this.repoInfo_.nodeAdmin?t="admin_node":t="node"),e["sdk."+t+"."+Hf.replace(/\./g,"-")]=1,Hi()?e["framework.cordova"]=1:Bo()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){let e=Ci.getInstance().currentlyOnline();return qo(this.interruptReasons_)&&e}};yt.nextPersistentConnectionId_=0;yt.nextConnectionId_=0;var V=class{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new V(e,t)}};var Ri=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new V(bi,e),i=new V(bi,t);return this.compare(r,i)!==0}minPost(){return V.MIN}};var Uc,Wc=class extends Ri{static get __EMPTY_NODE(){return Uc}static set __EMPTY_NODE(e){Uc=e}compare(e,t){return ki(e.name,t.name)}isDefinedOn(e){throw xn("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return V.MIN}maxPost(){return new V(_r,Uc)}makePost(e,t){return v(typeof e=="string","KeyIndex indexValue must always be a string."),new V(e,Uc)}toString(){return".key"}},Ii=new Wc;var Ei=class{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},oe=class{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r!=null?r:oe.RED,this.left=i!=null?i:De.EMPTY_NODE,this.right=s!=null?s:De.EMPTY_NODE}copy(e,t,r,i,s){return new oe(e!=null?e:this.key,t!=null?t:this.value,r!=null?r:this.color,i!=null?i:this.left,s!=null?s:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i=i.copy(null,t,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return De.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let r,i;if(r=this,t(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),t(e,r.key)===0){if(r.right.isEmpty())return De.EMPTY_NODE;i=r.right.min_(),r=r.copy(i.key,i.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){let e=this.copy(null,null,oe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){let e=this.copy(null,null,oe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){let e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}};oe.RED=!0;oe.BLACK=!1;var wf=class{copy(e,t,r,i,s){return this}insert(e,t,r){return new oe(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},De=class{constructor(e,t=De.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new De(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,oe.BLACK,null,null))}remove(e){return new De(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,oe.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ei(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Ei(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Ei(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Ei(this.root_,null,this.comparator_,!0,e)}};De.EMPTY_NODE=new wf;function WN(n,e){return ki(n.name,e.name)}function Gf(n,e){return ki(n,e)}var Tf;function HN(n){Tf=n}var wE=function(n){return typeof n=="number"?"number:"+eE(n):"string:"+n},TE=function(n){if(n.isLeafNode()){let e=n.val();v(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Tt(e,".sv"),"Priority must be a string or number.")}else v(n===Tf||n.isEmpty(),"priority of unexpected type.");v(n===Tf||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var Pv,se=class{constructor(e,t=se.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,v(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),TE(this.priorityNode_)}static set __childrenNodeConstructor(e){Pv=e}static get __childrenNodeConstructor(){return Pv}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new se(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:se.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return L(e)?this:F(e)===".priority"?this.priorityNode_:se.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:se.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){let r=F(e);return r===null?t:t.isEmpty()&&r!==".priority"?this:(v(r!==".priority"||kn(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,se.__childrenNodeConstructor.EMPTY_NODE.updateChild(J(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+wE(this.priorityNode_.val())+":");let t=typeof this.value_;e+=t+":",t==="number"?e+=eE(this.value_):e+=this.value_,this.lazyHash_=Jv(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===se.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof se.__childrenNodeConstructor?-1:(v(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){let t=typeof e.value_,r=typeof this.value_,i=se.VALUE_TYPE_ORDER.indexOf(t),s=se.VALUE_TYPE_ORDER.indexOf(r);return v(i>=0,"Unknown leaf type: "+t),v(s>=0,"Unknown leaf type: "+r),i===s?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){let t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}};se.VALUE_TYPE_ORDER=["object","boolean","number","string"];var IE,bE;function KN(n){IE=n}function zN(n){bE=n}var If=class extends Ri{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?ki(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return V.MIN}maxPost(){return new V(_r,new se("[PRIORITY-POST]",bE))}makePost(e,t){let r=IE(e);return new V(t,new se("[PRIORITY-POST]",r))}toString(){return".priority"}},xe=new If;var GN=Math.log(2),bf=class{constructor(e){let t=s=>parseInt(Math.log(s)/GN,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Hc=function(n,e,t,r){n.sort(e);let i=function(c,l){let u=l-c,h,d;if(u===0)return null;if(u===1)return h=n[c],d=t?t(h):h,new oe(d,h.node,oe.BLACK,null,null);{let f=parseInt(u/2,10)+c,p=i(c,f),y=i(f+1,l);return h=n[f],d=t?t(h):h,new oe(d,h.node,oe.BLACK,p,y)}},s=function(c){let l=null,u=null,h=n.length,d=function(p,y){let m=h-p,b=h;h-=p;let x=i(m+1,b),T=n[m],R=t?t(T):T;f(new oe(R,T.node,y,null,x))},f=function(p){l?(l.left=p,l=p):(u=p,l=p)};for(let p=0;p<c.count;++p){let y=c.nextBitIsOne(),m=Math.pow(2,c.count-(p+1));y?d(m,oe.BLACK):(d(m,oe.BLACK),d(m,oe.RED))}return u},o=new bf(n.length),a=s(o);return new De(r||e,a)};var sf,vi={},_t=class{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return v(vi&&xe,"ChildrenNode.ts has not been loaded"),sf=sf||new _t({".priority":vi},{".priority":xe}),sf}get(e){let t=On(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof De?t:null}hasIndex(e){return Tt(this.indexSet_,e.toString())}addIndex(e,t){v(e!==Ii,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=t.getIterator(V.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=Hc(r,e.getCompare()):a=vi;let c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;let u=Object.assign({},this.indexes_);return u[c]=a,new _t(u,l)}addToIndexes(e,t){let r=zi(this.indexes_,(i,s)=>{let o=On(this.indexSet_,s);if(v(o,"Missing index implementation for "+s),i===vi)if(o.isDefinedOn(e.node)){let a=[],c=t.getIterator(V.Wrap),l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),Hc(a,o.getCompare())}else return vi;else{let a=t.get(e.name),c=i;return a&&(c=c.remove(new V(e.name,a))),c.insert(e,e.node)}});return new _t(r,this.indexSet_)}removeFromIndexes(e,t){let r=zi(this.indexes_,i=>{if(i===vi)return i;{let s=t.get(e.name);return s?i.remove(new V(e.name,s)):i}});return new _t(r,this.indexSet_)}};var ao,$=class{constructor(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&TE(this.priorityNode_),this.children_.isEmpty()&&v(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return ao||(ao=new $(new De(Gf),null,_t.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ao}updatePriority(e){return this.children_.isEmpty()?this:new $(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{let t=this.children_.get(e);return t===null?ao:t}}getChild(e){let t=F(e);return t===null?this:this.getImmediateChild(t).getChild(J(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(v(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{let r=new V(e,t),i,s;t.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,t),s=this.indexMap_.addToIndexes(r,this.children_));let o=i.isEmpty()?ao:this.priorityNode_;return new $(i,o,s)}}updateChild(e,t){let r=F(e);if(r===null)return t;{v(F(e)!==".priority"||kn(e)===1,".priority must be the last token in a path");let i=this.getImmediateChild(r).updateChild(J(e),t);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;let t={},r=0,i=0,s=!0;if(this.forEachChild(xe,(o,a)=>{t[o]=a.val(e),r++,s&&$.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):s=!1}),!e&&s&&i<2*r){let o=[];for(let a in t)o[a]=t[a];return o}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+wE(this.getPriority().val())+":"),this.forEachChild(xe,(t,r)=>{let i=r.hash();i!==""&&(e+=":"+t+":"+i)}),this.lazyHash_=e===""?"":Jv(e)}return this.lazyHash_}getPredecessorChildName(e,t,r){let i=this.resolveIndex_(r);if(i){let s=i.getPredecessorKey(new V(e,t));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){let t=this.resolveIndex_(e);if(t){let r=t.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){let t=this.getFirstChildName(e);return t?new V(t,this.children_.get(t)):null}getLastChildName(e){let t=this.resolveIndex_(e);if(t){let r=t.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){let t=this.getLastChildName(e);return t?new V(t,this.children_.get(t)):null}forEachChild(e,t){let r=this.resolveIndex_(e);return r?r.inorderTraversal(i=>t(i.name,i.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){let r=this.resolveIndex_(t);if(r)return r.getIteratorFrom(e,i=>i);{let i=this.children_.getIteratorFrom(e.name,V.Wrap),s=i.peek();for(;s!=null&&t.compare(s,e)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){let r=this.resolveIndex_(t);if(r)return r.getReverseIteratorFrom(e,i=>i);{let i=this.children_.getReverseIteratorFrom(e.name,V.Wrap),s=i.peek();for(;s!=null&&t.compare(s,e)>0;)i.getNext(),s=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Ro?-1:0}withIndex(e){if(e===Ii||this.indexMap_.hasIndex(e))return this;{let t=this.indexMap_.addIndex(e,this.children_);return new $(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Ii||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{let t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){let r=this.getIterator(xe),i=t.getIterator(xe),s=r.getNext(),o=i.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=r.getNext(),o=i.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Ii?null:this.indexMap_.get(e.toString())}};$.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;var Cf=class extends ${constructor(){super(new De(Gf),$.EMPTY_NODE,_t.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return $.EMPTY_NODE}isEmpty(){return!1}},Ro=new Cf;Object.defineProperties(V,{MIN:{value:new V(bi,$.EMPTY_NODE)},MAX:{value:new V(_r,Ro)}});Wc.__EMPTY_NODE=$.EMPTY_NODE;se.__childrenNodeConstructor=$;HN(Ro);zN(Ro);var QN=!0;function Pe(n,e=null){if(n===null)return $.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),v(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new se(t,Pe(e))}if(!(n instanceof Array)&&QN){let t=[],r=!1;if(tt(n,(o,a)=>{if(o.substring(0,1)!=="."){let c=Pe(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new V(o,c)))}}),t.length===0)return $.EMPTY_NODE;let s=Hc(t,WN,o=>o.name,Gf);if(r){let o=Hc(t,xe.getCompare());return new $(s,Pe(e),new _t({".priority":o},{".priority":xe}))}else return new $(s,Pe(e),_t.Default)}else{let t=$.EMPTY_NODE;return tt(n,(r,i)=>{if(Tt(n,r)&&r.substring(0,1)!=="."){let s=Pe(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(Pe(e))}}KN(Pe);var Rf=class extends Ri{constructor(e){super(),this.indexPath_=e,v(!L(e)&&F(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?ki(e.name,t.name):s}makePost(e,t){let r=Pe(e),i=$.EMPTY_NODE.updateChild(this.indexPath_,r);return new V(t,i)}maxPost(){let e=$.EMPTY_NODE.updateChild(this.indexPath_,Ro);return new V(_r,e)}toString(){return _E(this.indexPath_,0).join("/")}};var Af=class extends Ri{compare(e,t){let r=e.node.compareTo(t.node);return r===0?ki(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return V.MIN}maxPost(){return V.MAX}makePost(e,t){let r=Pe(e);return new V(t,r)}toString(){return".value"}},YN=new Af;function JN(n){return{type:"value",snapshotNode:n}}function XN(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function ZN(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Dv(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function eS(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var go=class{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=xe}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return v(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return v(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:bi}hasEnd(){return this.endSet_}getIndexEndValue(){return v(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return v(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:_r}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return v(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===xe}copy(){let e=new go;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function xv(n){let e={};if(n.isDefault())return e;let t;if(n.index_===xe?t="$priority":n.index_===YN?t="$value":n.index_===Ii?t="$key":(v(n.index_ instanceof Rf,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=de(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=de(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+de(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=de(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+de(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function Ov(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==xe&&(e.i=n.index_.toString()),e}var Ai=class extends $c{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=bo("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(v(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=Ai.getListenId_(e,r),a={};this.listens_[o]=a;let c=xv(e._queryParams);this.restRequest_(s+".json",c,(l,u)=>{let h=u;if(l===404&&(h=null,l=null),l===null&&this.onDataUpdate_(s,h,!1,r),On(this.listens_,o)===a){let d;l?l===401?d="permission_denied":d="rest_error:"+l:d="ok",i(d,null)}})}unlisten(e,t){let r=Ai.getListenId_(e,t);delete this.listens_[r]}get(e){let t=xv(e._queryParams),r=e._path.toString(),i=new Et;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Nr(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=Cr(a.responseText)}catch{Ke("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&Ke("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var Nf=class{constructor(){this.rootNode_=$.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function Kc(){return{value:null,children:new Map}}function CE(n,e,t){if(L(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=F(e);n.children.has(r)||n.children.set(r,Kc());let i=n.children.get(r);e=J(e),CE(i,e,t)}}function Sf(n,e,t){n.value!==null?t(e,n.value):tS(n,(r,i)=>{let s=new G(e.toString()+"/"+r);Sf(i,s,t)})}function tS(n,e){n.children.forEach((t,r)=>{e(r,t)})}var kf=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&tt(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var Vv=10*1e3,nS=30*1e3,rS=5*60*1e3,Pf=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new kf(e);let r=Vv+(nS-Vv)*Math.random();lo(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;tt(e,(i,s)=>{s>0&&Tt(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),lo(this.reportStats_.bind(this),Math.floor(Math.random()*2*rS))}};var Mt;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Mt||(Mt={}));function RE(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function AE(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function NE(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var Ni=class{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Mt.ACK_USER_WRITE,this.source=RE()}operationForChild(e){if(L(this.path)){if(this.affectedTree.value!=null)return v(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new G(e));return new Ni(K(),t,this.revert)}}else return v(F(this.path)===e,"operationForChild called for unrelated child."),new Ni(J(this.path),this.affectedTree,this.revert)}};var Zt=class{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Mt.OVERWRITE}operationForChild(e){return L(this.path)?new Zt(this.source,K(),this.snap.getImmediateChild(e)):new Zt(this.source,J(this.path),this.snap)}};var vr=class{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Mt.MERGE}operationForChild(e){if(L(this.path)){let t=this.children.subtree(new G(e));return t.isEmpty()?null:t.value?new Zt(this.source,K(),t.value):new vr(this.source,K(),t)}else return v(F(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new vr(this.source,J(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var _o=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(L(e))return this.isFullyInitialized()&&!this.filtered_;let t=F(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};function iS(n,e,t,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(eS(o.childName,o.snapshotNode))}),co(n,i,"child_removed",e,r,t),co(n,i,"child_added",e,r,t),co(n,i,"child_moved",s,r,t),co(n,i,"child_changed",e,r,t),co(n,i,"value",e,r,t),i}function co(n,e,t,r,i,s){let o=r.filter(a=>a.type===t);o.sort((a,c)=>oS(n,a,c)),o.forEach(a=>{let c=sS(n,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,n.query_))})})}function sS(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function oS(n,e,t){if(e.childName==null||t.childName==null)throw xn("Should only compare child_ events.");let r=new V(e.childName,e.snapshotNode),i=new V(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function SE(n,e){return{eventCache:n,serverCache:e}}function uo(n,e,t,r){return SE(new _o(e,t,r),n.serverCache)}function kE(n,e,t,r){return SE(n.eventCache,new _o(e,t,r))}function Df(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Er(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var of,aS=()=>(of||(of=new De(cN)),of),z=class{constructor(e,t=aS()){this.value=e,this.children=t}static fromObject(e){let t=new z(null);return tt(e,(r,i)=>{t=t.set(new G(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:K(),value:this.value};if(L(e))return null;{let r=F(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(J(e),t);return s!=null?{path:Ee(new G(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(L(e))return this;{let t=F(e),r=this.children.get(t);return r!==null?r.subtree(J(e)):new z(null)}}set(e,t){if(L(e))return new z(t,this.children);{let r=F(e),s=(this.children.get(r)||new z(null)).set(J(e),t),o=this.children.insert(r,s);return new z(this.value,o)}}remove(e){if(L(e))return this.children.isEmpty()?new z(null):new z(null,this.children);{let t=F(e),r=this.children.get(t);if(r){let i=r.remove(J(e)),s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new z(null):new z(this.value,s)}else return this}}get(e){if(L(e))return this.value;{let t=F(e),r=this.children.get(t);return r?r.get(J(e)):null}}setTree(e,t){if(L(e))return t;{let r=F(e),s=(this.children.get(r)||new z(null)).setTree(J(e),t),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new z(this.value,o)}}fold(e){return this.fold_(K(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Ee(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,K(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(L(e))return null;{let s=F(e),o=this.children.get(s);return o?o.findOnPath_(J(e),Ee(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,K(),t)}foreachOnPath_(e,t,r){if(L(e))return this;{this.value&&r(t,this.value);let i=F(e),s=this.children.get(i);return s?s.foreachOnPath_(J(e),Ee(t,i),r):new z(null)}}foreach(e){this.foreach_(K(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Ee(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var ze=class{constructor(e){this.writeTree_=e}static empty(){return new ze(new z(null))}};function ho(n,e,t){if(L(e))return new ze(new z(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=et(i,e);return s=s.updateChild(o,t),new ze(n.writeTree_.set(i,s))}else{let i=new z(t),s=n.writeTree_.setTree(e,i);return new ze(s)}}}function Lv(n,e,t){let r=n;return tt(t,(i,s)=>{r=ho(r,Ee(e,i),s)}),r}function Mv(n,e){if(L(e))return ze.empty();{let t=n.writeTree_.setTree(e,new z(null));return new ze(t)}}function xf(n,e){return wr(n,e)!=null}function wr(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(et(t.path,e)):null}function Fv(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(xe,(r,i)=>{e.push(new V(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new V(r,i.value))}),e}function Sn(n,e){if(L(e))return n;{let t=wr(n,e);return t!=null?new ze(new z(t)):new ze(n.writeTree_.subtree(e))}}function Of(n){return n.writeTree_.isEmpty()}function Si(n,e){return PE(K(),n.writeTree_,e)}function PE(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(v(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=PE(Ee(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(Ee(n,".priority"),r)),t}}function DE(n,e){return ME(e,n)}function cS(n,e,t,r,i){v(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=ho(n.visibleWrites,e,t)),n.lastWriteId=r}function lS(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function uS(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);v(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){let a=n.allWrites[o];a.visible&&(o>=t&&hS(a,r.path)?i=!1:gt(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return dS(n),!0;if(r.snap)n.visibleWrites=Mv(n.visibleWrites,r.path);else{let a=r.children;tt(a,c=>{n.visibleWrites=Mv(n.visibleWrites,Ee(r.path,c))})}return!0}else return!1}function hS(n,e){if(n.snap)return gt(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&gt(Ee(n.path,t),e))return!0;return!1}function dS(n){n.visibleWrites=xE(n.allWrites,fS,K()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function fS(n){return n.visible}function xE(n,e,t){let r=ze.empty();for(let i=0;i<n.length;++i){let s=n[i];if(e(s)){let o=s.path,a;if(s.snap)gt(t,o)?(a=et(t,o),r=ho(r,a,s.snap)):gt(o,t)&&(a=et(o,t),r=ho(r,K(),s.snap.getChild(a)));else if(s.children){if(gt(t,o))a=et(t,o),r=Lv(r,a,s.children);else if(gt(o,t))if(a=et(o,t),L(a))r=Lv(r,K(),s.children);else{let c=On(s.children,F(a));if(c){let l=c.getChild(J(a));r=ho(r,K(),l)}}}else throw xn("WriteRecord should have .snap or .children")}}return r}function OE(n,e,t,r,i){if(!r&&!i){let s=wr(n.visibleWrites,e);if(s!=null)return s;{let o=Sn(n.visibleWrites,e);if(Of(o))return t;if(t==null&&!xf(o,K()))return null;{let a=t||$.EMPTY_NODE;return Si(o,a)}}}else{let s=Sn(n.visibleWrites,e);if(!i&&Of(s))return t;if(!i&&t==null&&!xf(s,K()))return null;{let o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(gt(l.path,e)||gt(e,l.path))},a=xE(n.allWrites,o,e),c=t||$.EMPTY_NODE;return Si(a,c)}}}function pS(n,e,t){let r=$.EMPTY_NODE,i=wr(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(xe,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){let s=Sn(n.visibleWrites,e);return t.forEachChild(xe,(o,a)=>{let c=Si(Sn(s,new G(o)),a);r=r.updateImmediateChild(o,c)}),Fv(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=Sn(n.visibleWrites,e);return Fv(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function mS(n,e,t,r,i){v(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=Ee(e,t);if(xf(n.visibleWrites,s))return null;{let o=Sn(n.visibleWrites,s);return Of(o)?i.getChild(t):Si(o,i.getChild(t))}}function gS(n,e,t,r){let i=Ee(e,t),s=wr(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){let o=Sn(n.visibleWrites,i);return Si(o,r.getNode().getImmediateChild(t))}else return null}function _S(n,e){return wr(n.visibleWrites,e)}function yS(n,e,t,r,i,s,o){let a,c=Sn(n.visibleWrites,e),l=wr(c,K());if(l!=null)a=l;else if(t!=null)a=Si(c,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let u=[],h=o.getCompare(),d=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),f=d.getNext();for(;f&&u.length<i;)h(f,r)!==0&&u.push(f),f=d.getNext();return u}else return[]}function vS(){return{visibleWrites:ze.empty(),allWrites:[],lastWriteId:-1}}function Vf(n,e,t,r){return OE(n.writeTree,n.treePath,e,t,r)}function VE(n,e){return pS(n.writeTree,n.treePath,e)}function Uv(n,e,t,r){return mS(n.writeTree,n.treePath,e,t,r)}function zc(n,e){return _S(n.writeTree,Ee(n.treePath,e))}function ES(n,e,t,r,i,s){return yS(n.writeTree,n.treePath,e,t,r,i,s)}function Qf(n,e,t){return gS(n.writeTree,n.treePath,e,t)}function LE(n,e){return ME(Ee(n.treePath,e),n.writeTree)}function ME(n,e){return{treePath:n,writeTree:e}}var Lf=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;v(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),v(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,Dv(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,ZN(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,XN(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,Dv(r,e.snapshotNode,i.oldSnap));else throw xn("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var Mf=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},FE=new Mf,yo=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new _o(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Qf(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Er(this.viewCache_),s=ES(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}};function wS(n,e){v(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),v(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function TS(n,e,t,r,i){let s=new Lf,o,a;if(t.type===Mt.OVERWRITE){let l=t;l.source.fromUser?o=Ff(n,e,l.path,l.snap,r,i,s):(v(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!L(l.path),o=Gc(n,e,l.path,l.snap,r,i,a,s))}else if(t.type===Mt.MERGE){let l=t;l.source.fromUser?o=bS(n,e,l.path,l.children,r,i,s):(v(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=Uf(n,e,l.path,l.children,r,i,a,s))}else if(t.type===Mt.ACK_USER_WRITE){let l=t;l.revert?o=AS(n,e,l.path,r,i,s):o=CS(n,e,l.path,l.affectedTree,r,i,s)}else if(t.type===Mt.LISTEN_COMPLETE)o=RS(n,e,t.path,r,s);else throw xn("Unknown operation type: "+t.type);let c=s.getChanges();return IS(e,o,c),{viewCache:o,changes:c}}function IS(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Df(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(JN(Df(e)))}}function UE(n,e,t,r,i,s){let o=e.eventCache;if(zc(r,t)!=null)return e;{let a,c;if(L(t))if(v(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=Er(e),u=l instanceof $?l:$.EMPTY_NODE,h=VE(r,u);a=n.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{let l=Vf(r,Er(e));a=n.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=F(t);if(l===".priority"){v(kn(t)===1,"Can't have a priority with additional path components");let u=o.getNode();c=e.serverCache.getNode();let h=Uv(r,t,u,c);h!=null?a=n.filter.updatePriority(u,h):a=o.getNode()}else{let u=J(t),h;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();let d=Uv(r,t,o.getNode(),c);d!=null?h=o.getNode().getImmediateChild(l).updateChild(u,d):h=o.getNode().getImmediateChild(l)}else h=Qf(r,l,e.serverCache);h!=null?a=n.filter.updateChild(o.getNode(),l,h,u,i,s):a=o.getNode()}}return uo(e,a,o.isFullyInitialized()||L(t),n.filter.filtersNodes())}}function Gc(n,e,t,r,i,s,o,a){let c=e.serverCache,l,u=o?n.filter:n.filter.getIndexedFilter();if(L(t))l=u.updateFullNode(c.getNode(),r,null);else if(u.filtersNodes()&&!c.isFiltered()){let f=c.getNode().updateChild(t,r);l=u.updateFullNode(c.getNode(),f,null)}else{let f=F(t);if(!c.isCompleteForPath(t)&&kn(t)>1)return e;let p=J(t),m=c.getNode().getImmediateChild(f).updateChild(p,r);f===".priority"?l=u.updatePriority(c.getNode(),m):l=u.updateChild(c.getNode(),f,m,p,FE,null)}let h=kE(e,l,c.isFullyInitialized()||L(t),u.filtersNodes()),d=new yo(i,h,s);return UE(n,h,t,i,d,a)}function Ff(n,e,t,r,i,s,o){let a=e.eventCache,c,l,u=new yo(i,e,s);if(L(t))l=n.filter.updateFullNode(e.eventCache.getNode(),r,o),c=uo(e,l,!0,n.filter.filtersNodes());else{let h=F(t);if(h===".priority")l=n.filter.updatePriority(e.eventCache.getNode(),r),c=uo(e,l,a.isFullyInitialized(),a.isFiltered());else{let d=J(t),f=a.getNode().getImmediateChild(h),p;if(L(d))p=r;else{let y=u.getCompleteChild(h);y!=null?gE(d)===".priority"&&y.getChild(yE(d)).isEmpty()?p=y:p=y.updateChild(d,r):p=$.EMPTY_NODE}if(f.equals(p))c=e;else{let y=n.filter.updateChild(a.getNode(),h,p,d,u,o);c=uo(e,y,a.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function Bv(n,e){return n.eventCache.isCompleteForChild(e)}function bS(n,e,t,r,i,s,o){let a=e;return r.foreach((c,l)=>{let u=Ee(t,c);Bv(e,F(u))&&(a=Ff(n,a,u,l,i,s,o))}),r.foreach((c,l)=>{let u=Ee(t,c);Bv(e,F(u))||(a=Ff(n,a,u,l,i,s,o))}),a}function qv(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function Uf(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;L(t)?l=r:l=new z(null).setTree(t,r);let u=e.serverCache.getNode();return l.children.inorderTraversal((h,d)=>{if(u.hasChild(h)){let f=e.serverCache.getNode().getImmediateChild(h),p=qv(n,f,d);c=Gc(n,c,new G(h),p,i,s,o,a)}}),l.children.inorderTraversal((h,d)=>{let f=!e.serverCache.isCompleteForChild(h)&&d.value===null;if(!u.hasChild(h)&&!f){let p=e.serverCache.getNode().getImmediateChild(h),y=qv(n,p,d);c=Gc(n,c,new G(h),y,i,s,o,a)}}),c}function CS(n,e,t,r,i,s,o){if(zc(i,t)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(L(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return Gc(n,e,t,c.getNode().getChild(t),i,s,a,o);if(L(t)){let l=new z(null);return c.getNode().forEachChild(Ii,(u,h)=>{l=l.set(new G(u),h)}),Uf(n,e,t,l,i,s,a,o)}else return e}else{let l=new z(null);return r.foreach((u,h)=>{let d=Ee(t,u);c.isCompleteForPath(d)&&(l=l.set(u,c.getNode().getChild(d)))}),Uf(n,e,t,l,i,s,a,o)}}function RS(n,e,t,r,i){let s=e.serverCache,o=kE(e,s.getNode(),s.isFullyInitialized()||L(t),s.isFiltered());return UE(n,o,t,r,FE,i)}function AS(n,e,t,r,i,s){let o;if(zc(r,t)!=null)return e;{let a=new yo(r,e,i),c=e.eventCache.getNode(),l;if(L(t)||F(t)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=Vf(r,Er(e));else{let h=e.serverCache.getNode();v(h instanceof $,"serverChildren would be complete if leaf node"),u=VE(r,h)}u=u,l=n.filter.updateFullNode(c,u,s)}else{let u=F(t),h=Qf(r,u,e.serverCache);h==null&&e.serverCache.isCompleteForChild(u)&&(h=c.getImmediateChild(u)),h!=null?l=n.filter.updateChild(c,u,h,J(t),a,s):e.eventCache.getNode().hasChild(u)?l=n.filter.updateChild(c,u,$.EMPTY_NODE,J(t),a,s):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Vf(r,Er(e)),o.isLeafNode()&&(l=n.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||zc(r,K())!=null,uo(e,l,o,n.filter.filtersNodes())}}function NS(n,e){let t=Er(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!L(e)&&!t.getImmediateChild(F(e)).isEmpty())?t.getChild(e):null}function $v(n,e,t,r){e.type===Mt.MERGE&&e.source.queryId!==null&&(v(Er(n.viewCache_),"We should always have a full cache before handling merges"),v(Df(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,s=TS(n.processor_,i,e,t,r);return wS(n.processor_,s.viewCache),v(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,SS(n,s.changes,s.viewCache.eventCache.getNode(),null)}function SS(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return iS(n.eventGenerator_,e,t,i)}var jv;function kS(n){v(!jv,"__referenceConstructor has already been defined"),jv=n}function Yf(n,e,t,r){let i=e.source.queryId;if(i!==null){let s=n.views.get(i);return v(s!=null,"SyncTree gave us an op for an invalid query."),$v(s,e,t,r)}else{let s=[];for(let o of n.views.values())s=s.concat($v(o,e,t,r));return s}}function Jf(n,e){let t=null;for(let r of n.views.values())t=t||NS(r,e);return t}var Wv;function PS(n){v(!Wv,"__referenceConstructor has already been defined"),Wv=n}var Qc=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new z(null),this.pendingWriteTree_=vS(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function DS(n,e,t,r,i){return cS(n.pendingWriteTree_,e,t,r,i),i?Jc(n,new Zt(RE(),e,t)):[]}function wi(n,e,t=!1){let r=lS(n.pendingWriteTree_,e);if(uS(n.pendingWriteTree_,e)){let s=new z(null);return r.snap!=null?s=s.set(K(),!0):tt(r.children,o=>{s=s.set(new G(o),!0)}),Jc(n,new Ni(r.path,s,t))}else return[]}function Yc(n,e,t){return Jc(n,new Zt(AE(),e,t))}function xS(n,e,t){let r=z.fromObject(t);return Jc(n,new vr(AE(),e,r))}function OS(n,e,t,r){let i=jE(n,r);if(i!=null){let s=WE(i),o=s.path,a=s.queryId,c=et(o,e),l=new Zt(NE(a),c,t);return HE(n,o,l)}else return[]}function VS(n,e,t,r){let i=jE(n,r);if(i){let s=WE(i),o=s.path,a=s.queryId,c=et(o,e),l=z.fromObject(t),u=new vr(NE(a),c,l);return HE(n,o,u)}else return[]}function BE(n,e,t){let i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{let c=et(o,e),l=Jf(a,c);if(l)return l});return OE(i,e,s,t,!0)}function Jc(n,e){return qE(e,n.syncPointTree_,null,DE(n.pendingWriteTree_,K()))}function qE(n,e,t,r){if(L(n.path))return $E(n,e,t,r);{let i=e.get(K());t==null&&i!=null&&(t=Jf(i,K()));let s=[],o=F(n.path),a=n.operationForChild(o),c=e.children.get(o);if(c&&a){let l=t?t.getImmediateChild(o):null,u=LE(r,o);s=s.concat(qE(a,c,l,u))}return i&&(s=s.concat(Yf(i,n,r,t))),s}}function $E(n,e,t,r){let i=e.get(K());t==null&&i!=null&&(t=Jf(i,K()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=t?t.getImmediateChild(o):null,l=LE(r,o),u=n.operationForChild(o);u&&(s=s.concat($E(u,a,c,l)))}),i&&(s=s.concat(Yf(i,n,r,t))),s}function jE(n,e){return n.tagToQueryMap.get(e)}function WE(n){let e=n.indexOf("$");return v(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new G(n.substr(0,e))}}function HE(n,e,t){let r=n.syncPointTree_.get(e);v(r,"Missing sync point for query tag that we're tracking");let i=DE(n.pendingWriteTree_,e);return Yf(r,t,i,null)}var vo=class{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new vo(t)}node(){return this.node_}},Eo=class{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=Ee(this.path_,e);return new Eo(this.syncTree_,t)}node(){return BE(this.syncTree_,this.path_)}},LS=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},Hv=function(n,e,t){if(!n||typeof n!="object")return n;if(v(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return MS(n[".sv"],e,t);if(typeof n[".sv"]=="object")return FS(n[".sv"],e);v(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},MS=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:v(!1,"Unexpected server value: "+n)}},FS=function(n,e,t){n.hasOwnProperty("increment")||v(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&v(!1,"Unexpected increment value: "+r);let i=e.node();if(v(i!==null&&typeof i!="undefined","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},US=function(n,e,t,r){return Xf(e,new Eo(t,n),r)},BS=function(n,e,t){return Xf(n,new vo(e),t)};function Xf(n,e,t){let r=n.getPriority().val(),i=Hv(r,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,a=Hv(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new se(a,Pe(i)):n}else{let o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new se(i))),o.forEachChild(xe,(a,c)=>{let l=Xf(c,e.getImmediateChild(a),t);l!==c&&(s=s.updateImmediateChild(a,l))}),s}}var wo=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function Zf(n,e){let t=e instanceof G?e:new G(e),r=n,i=F(t);for(;i!==null;){let s=On(r.node.children,i)||{children:{},childCount:0};r=new wo(i,r,s),t=J(t),i=F(t)}return r}function Pi(n){return n.node.value}function KE(n,e){n.node.value=e,Bf(n)}function zE(n){return n.node.childCount>0}function qS(n){return Pi(n)===void 0&&!zE(n)}function Xc(n,e){tt(n.node.children,(t,r)=>{e(new wo(t,n,r))})}function GE(n,e,t,r){t&&!r&&e(n),Xc(n,i=>{GE(i,e,!0,r)}),t&&r&&e(n)}function $S(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Ao(n){return new G(n.parent===null?n.name:Ao(n.parent)+"/"+n.name)}function Bf(n){n.parent!==null&&jS(n.parent,n.name,n)}function jS(n,e,t){let r=qS(t),i=Tt(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,Bf(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,Bf(n))}var WS=/[\[\].#$\/\u0000-\u001F\u007F]/,HS=/[\[\].#$\u0000-\u001F\u007F]/,af=10*1024*1024,QE=function(n){return typeof n=="string"&&n.length!==0&&!WS.test(n)},KS=function(n){return typeof n=="string"&&n.length!==0&&!HS.test(n)},zS=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),KS(n)};var YE=function(n,e,t){let r=t instanceof G?new Ef(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+fr(r));if(typeof e=="function")throw new Error(n+"contains a function "+fr(r)+" with contents = "+e.toString());if(Xv(e))throw new Error(n+"contains "+e.toString()+" "+fr(r));if(typeof e=="string"&&e.length>af/3&&Gi(e)>af)throw new Error(n+"contains a string greater than "+af+" utf8 bytes "+fr(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(tt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!QE(o)))throw new Error(n+" contains an invalid key ("+o+") "+fr(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);FN(r,o),YE(n,a,r),UN(r)}),i&&s)throw new Error(n+' contains ".value" child '+fr(r)+" in addition to actual children.")}};var GS=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!QE(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!zS(t))throw new Error(Op(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var qf=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function QS(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();t!==null&&!vE(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function Tr(n,e,t){QS(n,t),YS(n,r=>gt(r,e)||gt(e,r))}function YS(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let s=i.path;e(s)?(JS(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function JS(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();mr&&ke("event: "+t.toString()),Co(r)}}}var XS="repo_interrupt",ZS=25,$f=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new qf,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Kc(),this.transactionQueueTree_=new wo,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function e0(n,e,t){if(n.stats_=zf(n.repoInfo_),n.forceRestClient_||pN())n.server_=new Ai(n.repoInfo_,(r,i,s,o)=>{Kv(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>zv(n,!0),0);else{if(typeof t!="undefined"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{de(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new yt(n.repoInfo_,e,(r,i,s,o)=>{Kv(n,r,i,s,o)},r=>{zv(n,r)},r=>{n0(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=gN(n.repoInfo_,()=>new Pf(n.stats_,n.server_)),n.infoData_=new Nf,n.infoSyncTree_=new Qc({startListening:(r,i,s,o)=>{let a=[],c=n.infoData_.getNode(r._path);return c.isEmpty()||(a=Yc(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),ep(n,"connected",!1),n.serverSyncTree_=new Qc({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,c)=>{let l=o(a,c);Tr(n.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function t0(n){let t=n.infoData_.getNode(new G(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function JE(n){return LS({timestamp:t0(n)})}function Kv(n,e,t,r,i){n.dataUpdateCount++;let s=new G(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){let c=zi(t,l=>Pe(l));o=VS(n.serverSyncTree_,s,c,i)}else{let c=Pe(t);o=OS(n.serverSyncTree_,s,c,i)}else if(r){let c=zi(t,l=>Pe(l));o=xS(n.serverSyncTree_,s,c)}else{let c=Pe(t);o=Yc(n.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=np(n,s)),Tr(n.eventQueue_,a,o)}function zv(n,e){ep(n,"connected",e),e===!1&&i0(n)}function n0(n,e){tt(e,(t,r)=>{ep(n,t,r)})}function ep(n,e,t){let r=new G("/.info/"+e),i=Pe(t);n.infoData_.updateSnapshot(r,i);let s=Yc(n.infoSyncTree_,r,i);Tr(n.eventQueue_,r,s)}function r0(n){return n.nextWriteId_++}function i0(n){XE(n,"onDisconnectEvents");let e=JE(n),t=Kc();Sf(n.onDisconnect_,K(),(i,s)=>{let o=US(i,s,n.serverSyncTree_,e);CE(t,i,o)});let r=[];Sf(t,K(),(i,s)=>{r=r.concat(Yc(n.serverSyncTree_,i,s));let o=c0(n,i);np(n,o)}),n.onDisconnect_=Kc(),Tr(n.eventQueue_,K(),r)}function s0(n){n.persistentConnection_&&n.persistentConnection_.interrupt(XS)}function XE(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),ke(t,...e)}function ZE(n,e,t){return BE(n.serverSyncTree_,e,t)||$.EMPTY_NODE}function tp(n,e=n.transactionQueueTree_){if(e||Zc(n,e),Pi(e)){let t=tw(n,e);v(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&o0(n,Ao(e),t)}else zE(e)&&Xc(e,t=>{tp(n,t)})}function o0(n,e,t){let r=t.map(l=>l.currentWriteId),i=ZE(n,e,r),s=i,o=i.hash();for(let l=0;l<t.length;l++){let u=t[l];v(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;let h=et(e,u.path);s=s.updateChild(h,u.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;n.server_.put(c.toString(),a,l=>{XE(n,"transaction put response",{path:c.toString(),status:l});let u=[];if(l==="ok"){let h=[];for(let d=0;d<t.length;d++)t[d].status=2,u=u.concat(wi(n.serverSyncTree_,t[d].currentWriteId)),t[d].onComplete&&h.push(()=>t[d].onComplete(null,!0,t[d].currentOutputSnapshotResolved)),t[d].unwatcher();Zc(n,Zf(n.transactionQueueTree_,e)),tp(n,n.transactionQueueTree_),Tr(n.eventQueue_,e,u);for(let d=0;d<h.length;d++)Co(h[d])}else{if(l==="datastale")for(let h=0;h<t.length;h++)t[h].status===3?t[h].status=4:t[h].status=0;else{Ke("transaction at "+c.toString()+" failed: "+l);for(let h=0;h<t.length;h++)t[h].status=4,t[h].abortReason=l}np(n,e)}},o)}function np(n,e){let t=ew(n,e),r=Ao(t),i=tw(n,t);return a0(n,i,r),r}function a0(n,e,t){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],l=et(t,c.path),u=!1,h;if(v(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)u=!0,h=c.abortReason,i=i.concat(wi(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=ZS)u=!0,h="maxretry",i=i.concat(wi(n.serverSyncTree_,c.currentWriteId,!0));else{let d=ZE(n,c.path,o);c.currentInputSnapshot=d;let f=e[a].update(d.val());if(f!==void 0){YE("transaction failed: Data returned ",f,c.path);let p=Pe(f);typeof f=="object"&&f!=null&&Tt(f,".priority")||(p=p.updatePriority(d.getPriority()));let m=c.currentWriteId,b=JE(n),x=BS(p,d,b);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=x,c.currentWriteId=r0(n),o.splice(o.indexOf(m),1),i=i.concat(DS(n.serverSyncTree_,c.path,x,c.currentWriteId,c.applyLocally)),i=i.concat(wi(n.serverSyncTree_,m,!0))}else u=!0,h="nodata",i=i.concat(wi(n.serverSyncTree_,c.currentWriteId,!0))}Tr(n.eventQueue_,t,i),i=[],u&&(e[a].status=2,function(d){setTimeout(d,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}Zc(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)Co(r[a]);tp(n,n.transactionQueueTree_)}function ew(n,e){let t,r=n.transactionQueueTree_;for(t=F(e);t!==null&&Pi(r)===void 0;)r=Zf(r,t),e=J(e),t=F(e);return r}function tw(n,e){let t=[];return nw(n,e,t),t.sort((r,i)=>r.order-i.order),t}function nw(n,e,t){let r=Pi(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);Xc(e,i=>{nw(n,i,t)})}function Zc(n,e){let t=Pi(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,KE(e,t.length>0?t:void 0)}Xc(e,r=>{Zc(n,r)})}function c0(n,e){let t=Ao(ew(n,e)),r=Zf(n.transactionQueueTree_,e);return $S(r,i=>{cf(n,i)}),cf(n,r),GE(r,i=>{cf(n,i)}),t}function cf(n,e){let t=Pi(e);if(t){let r=[],i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(v(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(v(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(wi(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?KE(e,void 0):t.length=s+1,Tr(n.eventQueue_,Ao(e),i);for(let o=0;o<r.length;o++)Co(r[o])}}function l0(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function u0(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Ke(`Invalid query segment '${t}' in query '${n}'`)}return e}var Gv=function(n,e){let t=h0(n),r=t.namespace;t.domain==="firebase.com"&&gr(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&gr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||oN();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new gf(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new G(t.pathString)}},h0=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",c=443;if(typeof n=="string"){let l=n.indexOf("//");l>=0&&(a=n.substring(0,l-1),n=n.substring(l+2));let u=n.indexOf("/");u===-1&&(u=n.length);let h=n.indexOf("?");h===-1&&(h=n.length),e=n.substring(0,Math.min(u,h)),u<h&&(i=l0(n.substring(u,h)));let d=u0(n.substring(Math.min(n.length,h)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;let f=e.slice(0,l);if(f.toLowerCase()==="localhost")t="localhost";else if(f.split(".").length<=2)t=f;else{let p=e.indexOf(".");r=e.substring(0,p).toLowerCase(),t=e.substring(p+1),s=r}"ns"in d&&(s=d.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var Qv="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",uF=function(){let n=0,e=[];return function(t){let r=t===n;n=t;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=Qv.charAt(t%64),t=Math.floor(t/64);v(t===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=Qv.charAt(e[i]);return v(o.length===20,"nextPushId: Length should be 20."),o}}();var To=class{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return L(this._path)?null:gE(this._path)}get ref(){return new Pn(this._repo,this._path)}get _queryIdentifier(){let e=Ov(this._queryParams),t=Kf(e);return t==="{}"?"default":t}get _queryObject(){return Ov(this._queryParams)}isEqual(e){if(e=qe(e),!(e instanceof To))return!1;let t=this._repo===e._repo,r=vE(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+MN(this._path)}};var Pn=class extends To{constructor(e,t){super(e,t,new go,!1)}get parent(){let e=yE(this._path);return e===null?null:new Pn(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}};kS(Pn);PS(Pn);var d0="FIREBASE_DATABASE_EMULATOR_HOST",jf={},f0=!1;function p0(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||gr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),ke("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=Gv(s,i),a=o.repoInfo,c,l;typeof process!="undefined"&&process.env&&(l=process.env[d0]),l?(c=!0,s=`http://${l}?ns=${a.namespace}`,o=Gv(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let u=i&&c?new fo(fo.OWNER):new pf(n.name,n.options,e);GS("Invalid Firebase Database URL",o),L(o.path)||gr("Database URL must point to the root of a Firebase Database (not including a child path).");let h=g0(a,n,u,new ff(n.name,t));return new Wf(h,n)}function m0(n,e){let t=jf[e];(!t||t[n.key]!==n)&&gr(`Database ${e}(${n.repoInfo_}) has already been deleted.`),s0(n),delete t[n.key]}function g0(n,e,t,r){let i=jf[e.name];i||(i={},jf[e.name]=i);let s=i[n.toURLString()];return s&&gr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new $f(n,f0,t,r),i[n.toURLString()]=s,s}var Wf=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(e0(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Pn(this._repo,K())),this._rootInternal}_delete(){return this._rootInternal!==null&&(m0(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&gr("Cannot call "+e+" on a deleted database.")}};function _0(n){rN(bt),Ve(new ae("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return p0(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),ce(gv,_v,n),ce(gv,_v,"esm2017")}yt.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};yt.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};_0();var cw="firebasestorage.googleapis.com",y0="storageBucket",v0=2*60*1e3,E0=10*60*1e3;var nt=class extends we{constructor(e,t,r=0){super(rp(e),`Firebase Storage: ${t} (${rp(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,nt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return rp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Ft;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ft||(Ft={}));function rp(n){return"storage/"+n}function w0(){let n="An unknown error occurred, please check the error payload for server response.";return new nt(Ft.UNKNOWN,n)}function T0(){return new nt(Ft.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function I0(){return new nt(Ft.CANCELED,"User canceled the upload/download.")}function b0(n){return new nt(Ft.INVALID_URL,"Invalid URL '"+n+"'.")}function C0(n){return new nt(Ft.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function rw(n){return new nt(Ft.INVALID_ARGUMENT,n)}function lw(){return new nt(Ft.APP_DELETED,"The Firebase app was deleted.")}function R0(n){return new nt(Ft.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}var Ge=class{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=Ge.makeFromUrl(e,t)}catch{return new Ge(e,"")}if(r.path==="")return r;throw C0(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(R){R.path.charAt(R.path.length-1)==="/"&&(R.path_=R.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function l(R){R.path_=decodeURIComponent(R.path)}let u="v[A-Za-z0-9_]+",h=t.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",f=new RegExp(`^https?://${h}/${u}/b/${i}/o${d}`,"i"),p={bucket:1,path:3},y=t===cw?"(?:storage.googleapis.com|storage.cloud.google.com)":t,m="([^?#]*)",b=new RegExp(`^https?://${y}/${i}/${m}`,"i"),T=[{regex:a,indices:c,postModify:s},{regex:f,indices:p,postModify:l},{regex:b,indices:{bucket:1,path:2},postModify:l}];for(let R=0;R<T.length;R++){let N=T[R],B=N.regex.exec(e);if(B){let he=B[N.indices.bucket],Oe=B[N.indices.path];Oe||(Oe=""),r=new Ge(he,Oe),N.postModify(r);break}}if(r==null)throw b0(e);return r}},ip=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function A0(n,e,t){let r=1,i=null,s=null,o=!1,a=0;function c(){return a===2}let l=!1;function u(...m){l||(l=!0,e.apply(null,m))}function h(m){i=setTimeout(()=>{i=null,n(f,c())},m)}function d(){s&&clearTimeout(s)}function f(m,...b){if(l){d();return}if(m){d(),u.call(null,m,...b);return}if(c()||o){d(),u.call(null,m,...b);return}r<64&&(r*=2);let T;a===1?(a=2,T=0):T=(r+Math.random())*1e3,h(T)}let p=!1;function y(m){p||(p=!0,d(),!l&&(i!==null?(m||(a=2),clearTimeout(i),h(0)):m||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,y(!0)},t),y}function N0(n){n(!1)}function S0(n){return n!==void 0}function iw(n,e,t,r){if(r<e)throw rw(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw rw(`Invalid value for '${n}'. Expected ${t} or less.`)}function k0(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var el;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(el||(el={}));function P0(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}var sp=class{constructor(e,t,r,i,s,o,a,c,l,u,h,d=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=u,this.connectionFactory_=h,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((f,p)=>{this.resolve_=f,this.reject_=p,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new Di(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===el.NO_ERROR,c=s.getStatus();if(!a||P0(c,this.additionalRetryCodes_)&&this.retry){let u=s.getErrorCode()===el.ABORT;r(!1,new Di(!1,null,u));return}let l=this.successCodes_.indexOf(c)!==-1;r(!0,new Di(l,s))})},t=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let c=this.callback_(a,a.getResponse());S0(c)?s(c):s()}catch(c){o(c)}else if(a!==null){let c=w0();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(i.canceled){let c=this.appDelete_?lw():I0();o(c)}else{let c=T0();o(c)}};this.canceled_?t(!1,new Di(!1,null,!0)):this.backoffId_=A0(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&N0(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},Di=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function D0(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function x0(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e!=null?e:"AppManager")}function O0(n,e){e&&(n["X-Firebase-GMPID"]=e)}function V0(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function L0(n,e,t,r,i,s,o=!0){let a=k0(n.urlParams),c=n.url+a,l=Object.assign({},n.headers);return O0(l,e),D0(l,t),x0(l,s),V0(l,r),new sp(c,n.method,l,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o)}function M0(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function F0(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}var yF=256*1024;var xi=class{constructor(e,t){this._service=e,t instanceof Ge?this._location=t:this._location=Ge.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new xi(e,t)}get root(){let e=new Ge(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return F0(this._location.path)}get storage(){return this._service}get parent(){let e=M0(this._location.path);if(e===null)return null;let t=new Ge(this._location.bucket,e);return new xi(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw R0(e)}};function sw(n,e){let t=e==null?void 0:e[y0];return t==null?null:Ge.makeFromBucketSpec(t,n)}var op=class{constructor(e,t,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=cw,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=v0,this._maxUploadRetryTime=E0,this._requests=new Set,i!=null?this._bucket=Ge.makeFromBucketSpec(i,this._host):this._bucket=sw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ge.makeFromBucketSpec(this._url,e):this._bucket=sw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){iw("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){iw("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new xi(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new ip(lw());{let o=L0(e,this._appId,r,i,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){let[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()}},ow="@firebase/storage",aw="0.11.2";var U0="storage";function B0(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new op(t,r,i,e,bt)}function q0(){Ve(new ae(U0,B0,"PUBLIC").setMultipleInstances(!0)),ce(ow,aw,""),ce(ow,aw,"esm2017")}q0();var ap=new WeakMap;function uw(n,e){return ap.has(e)||ap.set(e,n||{f:{},r:{},s:{},u:{}}),ap.get(e)}function $0(n,e,t,r){if(!n)return t;let[i,s]=hw(n);if(!i)return t;let o=uw(void 0,r)[i]||{},a=e||s;return a&&a in o?o[a]:t}function j0(n,e,t,r){if(!n)return;let[i,s]=hw(n);if(!i)return;let o=uw(void 0,r)[i],a=e||s;if(a)return t.then(c=>{o[a]=c}).catch(mt),a}function hw(n){return uv(n)||hv(n)?["f",n.path]:dv(n)?["r",n.toString()]:fv(n)?["s",n.toString()]:[]}var cp=new WeakMap;function W0(n,e,t){let r=Zd();cp.has(r)||cp.set(r,new Map);let i=cp.get(r),s=j0(e,t,n,r);return s&&i.set(s,n),s?()=>i.delete(s):mt}var H0={toFirestore(n){return n},fromFirestore(n,e){return n.exists()?Object.defineProperties(n.data(e),{id:{value:n.id}}):null}};function lp(n,e,t,r){if(!lv(n))return[n,{}];let i=[{},{}],s=Object.keys(t).reduce((a,c)=>{let l=t[c];return a[l.path]=l.data(),a},{});function o(a,c,l,u){c=c||{};let[h,d]=u;Object.getOwnPropertyNames(a).forEach(f=>{let p=Object.getOwnPropertyDescriptor(a,f);p&&!p.enumerable&&Object.defineProperty(h,f,p)});for(let f in a){let p=a[f];if(p==null||p instanceof Date||p instanceof _e||p instanceof Bs)h[f]=p;else if(Fc(p)){let y=l+f;h[f]=y in t?c[f]:p.path,d[y]=p.converter?p:p.withConverter(r.converter)}else if(Array.isArray(p)){h[f]=Array(p.length);for(let y=0;y<p.length;y++){let m=p[y];m&&m.path in s&&(h[f][y]=s[m.path])}o(p,c[f]||h[f],l+f+".",[h[f],d])}else An(p)?(h[f]={},o(p,c[f],l+f+".",[h[f],d])):h[f]=p}}return o(n,e,"",i),i}var dp={reset:!1,wait:!0,maxRefDepth:2,converter:H0,snapshotOptions:{serverTimestamps:"estimate"}};function tl(n){for(let e in n)n[e].unsub()}function up(n,e,t,r,i,s,o,a,c){let[l,u]=lp(r.data(n.snapshotOptions),Mc(e,t),i,n);s.set(e,t,l),hp(n,e,t,i,u,s,o,a,c)}function K0({ref:n,target:e,path:t,depth:r,resolve:i,reject:s,ops:o},a){let c=Object.create(null),l=mt;return a.once?hd(n).then(u=>{u.exists()?up(a,e,t,u,c,o,r,i,s):(o.set(e,t,null),i())}).catch(s):l=Za(n,u=>{u.exists()?up(a,e,t,u,c,o,r,i,s):(o.set(e,t,null),i())},s),()=>{l(),tl(c)}}function hp(n,e,t,r,i,s,o,a,c){let l=Object.keys(i);if(Object.keys(r).filter(y=>l.indexOf(y)<0).forEach(y=>{r[y].unsub(),delete r[y]}),!l.length||++o>n.maxRefDepth)return a(t);let h=0,d=l.length,f=Object.create(null);function p(y){y in f&&++h>=d&&a(t)}l.forEach(y=>{let m=r[y],b=i[y],x=`${t}.${y}`;if(f[x]=!0,m)if(m.path!==b.path)m.unsub();else return;r[y]={data:()=>Mc(e,x),unsub:K0({ref:b,target:e,path:x,depth:o,ops:s,resolve:p.bind(null,x),reject:c},n),path:b.path}})}function z0(n,e,t,r,i,s){let o=Object.assign({},dp,s),{snapshotListenOptions:a,snapshotOptions:c,wait:l,once:u}=o,h="value",d=Qt(l?[]:n.value);l||t.set(n,h,[]);let f=r,p,y=mt,m=[],b={added:({newIndex:T,doc:R})=>{m.splice(T,0,Object.create(null));let N=m[T],[B,he]=lp(R.data(c),void 0,N,o);t.add(dt(d),T,B),hp(o,d,`${h}.${T}`,N,he,t,0,r.bind(null,R),i)},modified:({oldIndex:T,newIndex:R,doc:N})=>{let B=dt(d),he=m[T],Oe=B[T],[Dn,Ir]=lp(N.data(c),Oe,he,o);m.splice(R,0,he),t.remove(B,T),t.add(B,R,Dn),hp(o,d,`${h}.${R}`,he,Ir,t,0,r,i)},removed:({oldIndex:T})=>{let R=dt(d);t.remove(R,T),tl(m.splice(T,1)[0])}};function x(T){let R=T.docChanges(a);if(!p&&R.length){p=!0;let N=0,B=R.length,he=Object.create(null);for(let Oe=0;Oe<B;Oe++)he[R[Oe].doc.id]=!0;r=Oe=>{Oe&&Oe.id in he&&++N>=B&&(l&&(t.set(n,h,dt(d)),d=n),f(dt(d)),r=mt)}}R.forEach(N=>{b[N.type](N)}),R.length||(l&&(t.set(n,h,dt(d)),d=n),r(dt(d)))}return u?N_(e).then(x).catch(i):y=Za(e,x,i),T=>{if(y(),T){let R=typeof T=="function"?T():[];t.set(n,h,R)}m.forEach(tl)}}function G0(n,e,t,r,i,s){let o=Object.assign({},dp,s),a="value",c=Object.create(null);r=pv(r,()=>Mc(n,a));let l=mt;function u(h){h.exists()?up(o,n,a,h,c,t,0,r,i):(t.set(n,a,null),r(null))}return o.once?hd(e).then(u).catch(i):l=Za(e,u,i),h=>{if(l(),h){let d=typeof h=="function"?h():null;t.set(n,a,d)}tl(c)}}function Q0(n,e){let t=mt,r=Object.assign({},dp,e),i=dt(n),s=r.target||Qt();mv()&&(r.once=!0);let o=$0(i,r.ssrKey,s.value,Zd());s.value=o;let c=!(ef(i)?(o||[]).length>0:o!==void 0),l=Qt(!1),u=Qt(),h=Wd(),d=Zs(),f=mt;function p(){let b=dt(n),x=new Promise((T,R)=>{if(t(r.reset),!b)return t=mt,T(null);l.value=c,c=!0,b.converter||(b=b.withConverter(r.converter)),t=(Fc(b)?G0:z0)(s,b,Y0,T,R,r)}).catch(T=>(h.value===x&&(u.value=T),Promise.reject(T))).finally(()=>{h.value===x&&(l.value=!1)});h.value=x}let y=mt;Me(n)&&(y=Hy(n,p)),p(),i&&(f=W0(h.value,i,r.ssrKey)),ro()&&Ky(()=>h.value),d&&Ud(m);function m(b=r.reset){y(),f(),t(b)}return Object.defineProperties(s,{error:{get:()=>u},data:{get:()=>s},pending:{get:()=>l},promise:{get:()=>h},stop:{get:()=>m}})}var Y0={set:(n,e,t)=>cv(n,e,t),add:(n,e,t)=>n.splice(e,0,t),remove:(n,e)=>n.splice(e,1)};function dw(n,e){return Q0(n,{target:Qt([]),...e})}self.skipWaiting();ll();ml([{"revision":"cf7aed79cf6e5de38c81913bfc86010c","url":"assets/ErrorNotFound.1b13b296.js"},{"revision":"7f917eab0618feae9874a7155876d651","url":"assets/firebase.bc5971c8.js"},{"revision":"3e1afe59fa075c9e04c436606b77f640","url":"assets/flUhRq6tzZclQEJ-Vdg-IuiaDsNa.fd84f88b.woff"},{"revision":"a4160421d2605545f69a4cd6cd642902","url":"assets/flUhRq6tzZclQEJ-Vdg-IuiaDsNcIhQ8tQ.4a4dbc62.woff2"},{"revision":"009c1e464776e946c9bd92528ccb2764","url":"assets/index.84d81ece.js"},{"revision":"dea8457aef807dae18a6f3b9fffad5d9","url":"assets/index.e110aa66.css"},{"revision":"07dfd96202071b90512f778ee58a6f25","url":"assets/IndexPage.300d758b.js"},{"revision":"4aa2e69855e3b83110a251c47fdd05fc","url":"assets/KFOkCnqEu92Fr1MmgVxIIzQ.34e9582c.woff"},{"revision":"40bcb2b8cc5ed94c4c21d06128e0e532","url":"assets/KFOlCnqEu92Fr1MmEU9fBBc-.9ce7f3ac.woff"},{"revision":"ea60988be8d6faebb4bc2a55b1f76e22","url":"assets/KFOlCnqEu92Fr1MmSU5fBBc-.bf14c7d7.woff"},{"revision":"0774a8b7ca338dc1aba5a0ec8f2b9454","url":"assets/KFOlCnqEu92Fr1MmWUlfBBc-.e0fd57c0.woff"},{"revision":"bcb7c7e2499a055f0e2f93203bdb282b","url":"assets/KFOlCnqEu92Fr1MmYUtfBBc-.f6537e32.woff"},{"revision":"d3907d0ccd03b1134c24d3bcaf05b698","url":"assets/KFOmCnqEu92Fr1Mu4mxM.f2abf7fb.woff"},{"revision":"7d474f19fa1b78fbd1495162e847530e","url":"assets/MainLayout.b6e647ba.js"},{"revision":"becd125f13016c3ef761cd6edc07afd5","url":"assets/QBtn.109c428b.js"},{"revision":"ef0c03f0d188f763626d94f6d2318d5d","url":"assets/quasar-logo-vertical.55e9c854.svg"},{"revision":"53bfaf8c7a6f432f624f855465347bbc","url":"assets/render.8440ebcc.js"},{"revision":"a58bd563384b77cb776860062a046a69","url":"assets/vuefire.39952a5b.js"},{"revision":"f4facfeaed834544d622544acfbb7722","url":"favicon.ico"},{"revision":"d082235f6e6d2109e84e397f66fa868d","url":"icons/apple-icon-120x120.png"},{"revision":"3c728ce3e709b7395be487becf76283a","url":"icons/apple-icon-152x152.png"},{"revision":"3fec89672a18e4b402ede58646917c2d","url":"icons/apple-icon-167x167.png"},{"revision":"aa47843bd47f34b7ca4b99f65dd25955","url":"icons/apple-icon-180x180.png"},{"revision":"ab92df0270f054ca388127c9703a4911","url":"icons/favicon-128x128.png"},{"revision":"e4b046d41e08e6fa06626d6410ab381d","url":"icons/favicon-16x16.png"},{"revision":"410858b01fa6d3d66b7bf21447c5f1fc","url":"icons/favicon-32x32.png"},{"revision":"db2bde7f824fb4057ffd1c42f6ed756e","url":"icons/favicon-96x96.png"},{"revision":"ab92df0270f054ca388127c9703a4911","url":"icons/icon-128x128.png"},{"revision":"7659f0d3e9602e71811f8b7cf2ce0e8e","url":"icons/icon-192x192.png"},{"revision":"cf5ad3498fb6fda43bdafd3c6ce9b824","url":"icons/icon-256x256.png"},{"revision":"fdfc1b3612b6833a27a7b260c9990247","url":"icons/icon-384x384.png"},{"revision":"2c2dc987945806196bd18cb6028d8bf4","url":"icons/icon-512x512.png"},{"revision":"8de1b0e67a62b881cd22d935f102a0e6","url":"icons/ms-icon-144x144.png"},{"revision":"3e4c3730b00c89591de9505efb73afd3","url":"icons/safari-pinned-tab.svg"},{"revision":"0c5cb4bf1ac1c19950be6ef0119973a7","url":"index.html"},{"revision":"6d406d10fbb782a29ffca7aa13602922","url":"manifest.json"}]);dl();Bi(new $i(fl("index.html"),{denylist:[/sw\.js$/,/workbox-(.)*\.js$/]}));var J0=b_(k_,"history_calendar/orders/bookings"),X0=dw(J0);X0.value.forEach(n=>console.log(n));})();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
